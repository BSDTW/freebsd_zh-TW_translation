<html>

<head>
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=big5">
<style type="text/css">
<!--
.p13{font-size:14.8px;font-family:宋體;}
.p14{font-size:14.8px;font-family:宋體;line-height:14pt;}
a:hover{color:red;}
a.t1:visited{color:red;}
-->
</style>
<title>MySQL中文參考手冊- 4 安裝MySQL</title>
</head>

<body BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#101090" VLINK="#7030B0" class="p3">

<h1><img src="Img/mysql-logo.gif" alt="mysql-logo.gif (3082 bytes)" WIDTH="127" HEIGHT="60"><font color="#FF0000">MySQL中文參考手冊</font></h1>

<p>譯者：晏子 <a href="mailto:(clyan@sohu.com">(clyan@sohu.com</a>）<br>
GB 碼主頁：<a href="http://linuxdb.yeah.net">http://linuxdb.yeah.net</a></p>

<p>Big5 轉碼者：statue <a href="mailto:statue.bbs@bbs.yzu.edu.tw">
(statue@bbs.yzu.edu.tw</a>） <br>
詞彙轉換：彭武興 (<a href="mailto:wilson@mailbox.com.tw">wilson@mailbox.com.tw</a>)<br>
Big5 碼主頁：
<a href="http://cnpa.yzu.edu.tw/~cfc/docs/mysqldoc_big5/manual_toc.html">
http://cnpa.yzu.edu.tw/~cfc/docs/mysqldoc_big5/manual_toc.html</a><br>
Big5 碼分站：
<a href="http://php.wilson.gs/mysqldoc/big5/manual_toc.html">
http://php.wilson.gs/mysqldoc/big5/manual_toc.html
</p>

<hr>

<p><a HREF="manual_Introduction.html">第一章</a>, <a href="manual_Licensing_and_Support.html">前一章</a>, <a HREF="manual_Compatibility.html">下一章</a>, <a HREF="manual_Concept_Index.html">最後一章</a>，<a HREF="manual_toc.html">目錄</a>. </p>

<hr>

<h1><a NAME="Installing" HREF="manual_toc.html#Installing">4 安裝MySQL</a></h1>

<p>本章描述怎樣獲得並安裝<strong>MySQL</strong>： 

<ul>
  <li>對於你能從其獲得<strong>MySQL</strong>的站點列表，見<a HREF="manual_Installing.html#Getting_MySQL">4.1 怎樣獲得MySQL</a>。 </li>
  <li>要了解支援哪些平台，見<a HREF="manual_Installing.html#Which_OS">4.2 MySQL支援的作業系統</a>。 
  </li>
  <li>可獲得<strong>MySQL</strong>的多個版本，以二進制代碼和原始程式形式分發。為了確定你應該使用的分發的版本和類型，見<a HREF="manual_Installing.html#Many_versions">4.4 怎樣和何時發布更新版本</a>。</li>
  <li>針對二進制代碼和原始碼版本的安裝指令在<a HREF="manual_Installing.html#Installing_binary">4.6 安裝 MySQL 可執行檔版本</a>和<a HREF="manual_Installing.html#Installing_source">4.7 安裝 MySQL 原始碼版本</a>講述。每套指令均包含一個關於你可能涉及的系統特定問題的部分。 
  </li>
  <li>為安裝後期程序，見<a HREF="manual_Installing.html#Post-installation">4.15 
    安裝後期的設置與測試</a>。不管你是用一個二進制代碼還是原始碼版本來安裝<strong>MySQL</strong>，這些程序均適用。 
  </li>
</ul>

<p><a NAME="IDX28"></a> <a NAME="IDX29"></a> <a NAME="IDX30"></a> <a NAME="IDX31"></a> </p>

<h2><a NAME="Getting_MySQL" HREF="manual_toc.html#Getting_MySQL">4.1 怎樣獲得MySQL</a></h2>

<p>檢查<a HREF="http://www.mysql.com/"><strong>MySQL</strong>主頁</a>獲得當前版本的資訊和下載指令。 
</p>

<p>然而，TcX的網際網路鏈接不是很快的﹔我們<em>更希望</em>讓你從下列鏡像站點之一進行真正的下載。 
</p>

<p>請向<a HREF="mailto:webmaster@mysql.com">webmaster@mysql.com</a>報告不存在的或過時的鏡像站點。 
</p>

<p><strong>歐洲：</strong> 

<ul>
  <li><img SRC="Img/austria.gif" WIDTH="32" HEIGHT="22">奧地利 [ 維也納技術大學 ]<a HREF="http://gd.tuwien.ac.at/db/mysql/">WWW</a> <a HREF="ftp://gd.tuwien.ac.at/db/mysql/">ftp</a> 
  </li>
  <li><img SRC="Img/bulgaria.gif" WIDTH="32" HEIGHT="22">保加利亞 [ Naturella ]<a HREF="ftp://ftp.ntrl.net/pub/mirror/mysql">ftp</a> </li>
  <li><img SRC="Img/croatia.gif" WIDTH="32" HEIGHT="22">克羅地亞 [ HULK ]<a HREF="http://ftp.linux.hr/pub/mysql/">WWW</a> 
    <a HREF="ftp://ftp.linux.hr/pub/mysql/">ftp</a> </li>
  <li><img SRC="Img/czech-republic.gif" WIDTH="32" HEIGHT="22">捷克共和國 [ 在Brno的Masaryk大學 ]<a HREF="http://mysql.linux.cz/index.html">WWW</a> <a HREF="ftp://ftp.fi.muni.cz/pub/mysql/">ftp</a> 
  </li>
  <li><img SRC="Img/czech-republic.gif" WIDTH="32" HEIGHT="22">捷克共和國 [ <a href="http://www.sopik.cz">www.sopik.cz</a> 
    ]<a HREF="http://www.mysql.cz/">WWW</a> </li>
  <li><img SRC="Img/denmark.gif" WIDTH="32" HEIGHT="22">丹麥 [ Borsen ]<a HREF="http://mysql.borsen.dk/">WWW</a> </li>
  <li><img SRC="Img/denmark.gif" WIDTH="32" HEIGHT="22">丹麥 [ SunSITE ]<a HREF="http://SunSITE.auc.dk/mysql/">WWW</a> 
    <a HREF="ftp://SunSITE.auc.dk/pub/databases/mysql/">ftp</a> </li>
  <li><img SRC="Img/estonia.gif" WIDTH="32" HEIGHT="22">愛沙尼亞 [ OKinteractive ]<a HREF="http://mysql.mirror.ok.ee">WWW</a> </li>
  <li><img SRC="Img/france.gif" WIDTH="32" HEIGHT="22">法國 [ minet ]<a HREF="http://www.minet.net/devel/mysql/">WWW</a> 
  </li>
  <li><img SRC="Img/finland.gif" WIDTH="32" HEIGHT="22">芬蘭 [ EUnet ]<a HREF="http://mysql.eunet.fi/">WWW</a> </li>
  <li><img SRC="Img/finland.gif" WIDTH="32" HEIGHT="22">芬蘭 [ clinet ]<a HREF="ftp://ftp.clinet.fi/mirrors/ftp.mysql.org/pub/mysql/">ftp</a> </li>
  <li><img SRC="Img/germany.gif" WIDTH="32" HEIGHT="22">德國 [ 波恩大學, 波恩 ]<a HREF="http://www.wipol.uni-bonn.de/MySQL//">WWW</a> <a HREF="ftp://ftp.wipol.uni-bonn.de/pub/mirror/MySQL/">ftp</a> </li>
  <li><img SRC="Img/germany.gif" WIDTH="32" HEIGHT="22">德國 [ Wolfenbuettel ]<a HREF="http://www.fh-wolfenbuettel.de/ftp/pub/database/mysql/">WWW</a> <a HREF="ftp://ftp.fh-wolfenbuettel.de/pub/database/mysql/">ftp</a> </li>
  <li><img SRC="Img/germany.gif" WIDTH="32" HEIGHT="22">德國 [ Staufen ]<a HREF="http://mysql.staufen.de/">WWW</a> </li>
  <li><img SRC="Img/germany.gif" WIDTH="32" HEIGHT="22">德國 [ Cable &amp; Wireless ]<a HREF="ftp://ftp.ecrc.net/pub/database/mysql/">ftp</a> </li>
  <li><img SRC="Img/greece.gif" WIDTH="32" HEIGHT="22">希臘 [ NTUA , 雅典]<a HREF="http://www.ntua.gr/mysql/">WWW</a> 
    <a HREF="ftp://ftp.ntua.gr/pub/databases/mysql/">ftp</a> </li>
  <li><img SRC="Img/iceland.gif" WIDTH="32" HEIGHT="22">Island [ GM ]<a HREF="http://mysql.gm.is/">WWW</a> <a HREF="ftp://ftp.gm.is/pub/mysql">WWW</a> </li>
  <li><img SRC="Img/italy.gif" WIDTH="32" HEIGHT="22">意大利 [ Teta Srl ]<a HREF="http://www.teta.it/mysql/">WWW</a> 
  </li>
  <li><img SRC="Img/ireland.gif" WIDTH="32" HEIGHT="22">愛爾蘭 [ Ireland On-Line/Dublin ]<a HREF="http://mysql.iol.ie">WWW</a> <a HREF="ftp://ftp.iol.ie/pub/mysql">ftp</a> </li>
  <li><img SRC="Img/poland.gif" WIDTH="32" HEIGHT="22">波蘭 [ Sunsite ]<a HREF="http://sunsite.icm.edu.pl/mysql/">WWW</a> 
    <a HREF="ftp://sunsite.icm.edu.pl/pub/unix/mysql/">ftp</a> </li>
  <li><img SRC="Img/portugal.gif" WIDTH="32" HEIGHT="22">葡萄牙 [ lerianet ]<a HREF="http://mysql.leirianet.pt">WWW</a> 
    <a HREF="ftp://ftp.leirianet.pt/pub/mysql/">ftp</a> </li>
  <li><img SRC="Img/russia.gif" WIDTH="32" HEIGHT="22">俄國 [ DirectNet ]<a HREF="http://mysql.directnet.ru">WWW</a> 
  </li>
  <li><img SRC="Img/russia.gif" WIDTH="32" HEIGHT="22">俄國 [ IZHCOM ]<a HREF="http://mysql.udm.net/">WWW</a> <a HREF="ftp://ftp.izhcom.ru/pub/mysql/">ftp</a> </li>
  <li><img SRC="Img/russia.gif" WIDTH="32" HEIGHT="22">俄國 [ Scientific Center/Chernogolovka ]<a HREF="ftp://ftp.chg.ru/pub/databases/mysql/">ftp</a> </li>
  <li><img SRC="Img/romania.gif" WIDTH="32" HEIGHT="22">羅馬尼亞 [ Timisoara ]<a HREF="http://www.dnttm.ro/mysql">WWW</a> 
    <a HREF="ftp://ftp.dnttm.ro/pub/mysql">ftp</a> </li>
  <li><img SRC="Img/romania.gif" WIDTH="32" HEIGHT="22">羅馬尼亞 [ Bucharest ]<a HREF="http://www.lbi.ro/MySQL">WWW</a> 
    <a HREF="ftp://ftp.lbi.ro/mirrors/ftp.tcx.se">ftp</a> </li>
  <li><img SRC="Img/spain.gif" WIDTH="32" HEIGHT="22">西班牙 [ MasterD ]<a HREF="http://mysql.masterd.es">WWW</a> </li>
  <li><img SRC="Img/sweden.gif" WIDTH="32" HEIGHT="22">瑞典 [ Sunet ]<a HREF="http://ftp.sunet.se/pub/unix/databases/relational/mysql/">WWW</a> <a HREF="ftp://ftp.sunet.se/pub/unix/databases/relational/mysql/">ftp</a> </li>
  <li><img SRC="Img/switzerland.gif" WIDTH="32" HEIGHT="22">瑞士 [ Sunsite ]<a HREF="http://sunsite.cnlab-switch.ch/ftp/mirror/mysql/">WWW</a> <a HREF="ftp://sunsite.cnlab-switch.ch/mirror/mysql/">ftp</a> </li>
  <li><img SRC="Img/great-britain.gif" WIDTH="32" HEIGHT="22">英國 [ Omnipotent/UK ]<a HREF="http://mysql.omnipotent.net/">WWW</a> <a HREF="ftp://mysql.omnipotent.net/">ftp</a> </li>
  <li><img SRC="Img/great-britain.gif" WIDTH="32" HEIGHT="22">英國 [ PLiG/UK ]<a HREF="http://ftp.plig.org/pub/mysql/">WWW</a> <a HREF="ftp://ftp.plig.org/pub/mysql/">ftp</a> 
  </li>
  <li><img SRC="Img/great-britain.gif" WIDTH="32" HEIGHT="22">英國 [ SunSITE ]<a HREF="http://sunsite.org.uk/packages/mysql/">WWW</a> <a HREF="ftp://sunsite.org.uk/packages/mysql/">ftp</a> </li>
  <li><img SRC="Img/ukraine.gif" WIDTH="32" HEIGHT="22">烏克蘭 [ PACO ]<a HREF="http://mysql.paco.net.ua">WWW</a> <a HREF="ftp://mysql.paco.net.ua/">ftp</a> </li>
</ul>

<p><strong>北美洲：</strong> 

<ul>
  <li><img SRC="Img/canada.gif" WIDTH="32" HEIGHT="22">加拿大 [ Tryc ]<a HREF="http://web.tryc.on.ca/mysql/">WWW</a> 
  </li>
  <li><img SRC="Img/canada.gif" WIDTH="32" HEIGHT="22">加拿大 [ Cyberus ]<a HREF="http://mysql.cyberus.ca/">WWW</a> 
    <a HREF="ftp://mysql.cyberus.ca/">ftp</a> </li>
  <li><img SRC="Img/usa.gif" WIDTH="32" HEIGHT="22">美國 [ Hurricane Electric/San Jose ]<a HREF="http://mysql.he.net">WWW</a> </li>
  <li><img SRC="Img/usa.gif" WIDTH="32" HEIGHT="22">美國 [ Circle Net/North Carolina ]<a HREF="http://www.mysql.net">WWW</a> </li>
  <li><img SRC="Img/usa.gif" WIDTH="32" HEIGHT="22">美國 [ Gina net/Florida ]<a HREF="http://www.gina.net/mysql/">WWW</a> 
  </li>
  <li><img SRC="Img/usa.gif" WIDTH="32" HEIGHT="22">美國 [ pingzero/Los Angeles ]<a HREF="http://mysql.pingzero.net/">WWW</a> </li>
  <li><img SRC="Img/usa.gif" WIDTH="32" HEIGHT="22">美國 [ 威斯康星大學 / 威斯康星]<a HREF="http://mirror.sit.wisc.edu/mysql/">WWW</a> <a HREF="ftp://mirror.sit.wisc.edu/mirrors/mysql/">ftp</a> </li>
  <li><img SRC="Img/usa.gif" WIDTH="32" HEIGHT="22">美國 [ DIGEX ]<a HREF="ftp://ftp.digex.net/pub/packages/database/mysql/">ftp</a> </li>
</ul>

<p><strong>南美洲：</strong> 

<ul>
  <li><img SRC="Img/brazil.gif" WIDTH="32" HEIGHT="22">巴西 [ Matrix ]<a HREF="http://mysql.matrix.com.br">WWW</a> </li>
  <li><img SRC="Img/chile.gif" WIDTH="32" HEIGHT="22">智利 [ Vision ]<a HREF="http://mysql.vision.cl/">WWW</a> </li>
</ul>

<p><strong>亞洲：</strong> 

<ul>
  <li><img SRC="Img/china.gif" WIDTH="32" HEIGHT="22">中國 [ Freecode ]<a HREF="http://www.freecode.com.cn/mirror/mysql/">WWW</a> </li>
  <li><img SRC="Img/china.gif" WIDTH="32" HEIGHT="22">中國 [ Netfirm ]<a HREF="http://mysql.netfirm.net">WWW</a> </li>
  <li><img SRC="Img/south-korea.gif" WIDTH="32" HEIGHT="22">朝鮮 [ KREONet ]<a HREF="http://linux.kreonet.re.kr/mysql/">WWW</a> </li>
  <li><img SRC="Img/japan.gif" WIDTH="32" HEIGHT="22">日本 [ Soft Agency ]<a HREF="http://www.softagency.co.jp/MySQL">WWW</a> </li>
  <li><img SRC="Img/japan.gif" WIDTH="32" HEIGHT="22">日本 [ Nagoya Syouka University ]<a HREF="http://mirror.nucba.ac.jp/mirror/mysql">WWW</a> <a HREF="ftp://mirror.nucba.ac.jp/mirror/mysql">ftp</a> </li>
  <li><img SRC="Img/singapore.gif" WIDTH="32" HEIGHT="22">新加坡 [ HJC ]<a HREF="http://mysql.hjc.edu.sg">WWW</a> <a HREF="ftp://ftp.hjc.edu.sg/mysql">ftp</a> </li>
  <li><img SRC="Img/taiwan.gif" WIDTH="32" HEIGHT="22">台灣 [ HT ]<a HREF="http://mysql.ht.net.tw">WWW</a> </li>
</ul>

<p><strong>澳洲：</strong> 

<ul>
  <li><img SRC="Img/australia.gif" WIDTH="32" HEIGHT="22">澳洲 [ AARNet/Queensland ]<a HREF="http://mirror.aarnet.edu.au/mysql">WWW</a> <a HREF="ftp://mirror.aarnet.edu.au/pub/mysql">ftp</a> </li>
  <li><img SRC="Img/australia.gif" WIDTH="32" HEIGHT="22">澳洲 [ Tas ]<a HREF="http://ftp.tas.gov.au/mysql">WWW</a> 
    <a HREF="ftp://ftp.tas.gov.au/pub/mysql">ftp</a> </li>
  <li><img SRC="Img/australia.gif" WIDTH="32" HEIGHT="22">澳洲 [ Blue Planet/Melbourne ]<a HREF="http://mysql.bluep.com/">WWW</a> </li>
  <li><img SRC="Img/australia.gif" WIDTH="32" HEIGHT="22">澳洲 [ ITworks Consulting/Victoria ]<a HREF="http://mysql.itworks.com.au">WWW</a> </li>
</ul>

<p><strong>非洲：</strong> 

<ul>
  <li><img SRC="Img/south-africa1.gif" WIDTH="32" HEIGHT="22">南非 [ Mweb/ ]<a HREF="http://www.mysql.mweb.co.za">WWW</a> 
  </li>
  <li><img SRC="Img/south-africa1.gif" WIDTH="32" HEIGHT="22">南非 [ The Internet Solution/Johannesburg ]<a HREF="ftp://ftp.is.co.za/linux/mysql/">ftp</a> </li>
</ul>

<h2><a NAME="Which_OS" HREF="manual_toc.html#Which_OS">4.2 MySQL 支援的作業系統</a></h2>

<p>我們使用 GNU Autoconf，因此將<strong>MySQL</strong>移植到所有使用 Posix 
執行緒和一個 C++ 編譯器的現代系統是可能的。(僅僅為了編譯客戶代碼，只需要一個 
C++ 編譯器而不是執行緒)。我們主要在Sun Solaris(版本 2.5 &amp; 2.6)上使用並開發軟件本身，而RedHat 
Linux 5.0 居其次。 </p>

<p><strong>MySQL</strong>已經被報告在下列作業系統/執行緒包的組合上成功地編譯。注意，對很多作業系統，原生的執行緒支援僅工作於最新的版本。 

<ul>
  <li>有原生執行緒的AIX 4.x</li>
  <li>包括 MIT-pthreads 包的BSDI 2.x</li>
  <li>有原生執行緒的BSDI 3.0、3.1和4.x</li>
  <li>有原生執行緒的DEC UNIX 4.x</li>
  <li>包括MIT-pthreads包的FreeBSD 2.x</li>
  <li>有原生程的FreeBSD 3.x</li>
  <li>包括 MIT-pthreads 包的 HP-UX 10.20</li>
  <li>有原生執行緒的 HP-UX 11.x 。 </li>
  <li>有 LinuxThreads 0.7.1 的 Linux 2.0 + 或<code>glibc</code>2.0.7</li>
  <li>MacOS X 伺服器</li>
  <li>NetBSD 1.3/1.4 Intel 和 NetBSD 1.3 Alpha ( 需要 GNU make）</li>
  <li>包括 MIT-pthreads 包的 OpenBSD 2.x</li>
  <li>OS/2 Wrap 3、FixPack 29和OS/2 Wrap 4、FixPack 4</li>
  <li>有原生執行緒的SGI Irix 6.x</li>
  <li>SPARC和x86上有原生執行緒的Solaris 2.5、2.6和2.7</li>
  <li>包括 MIT-pthreads 包的SunOS 4.x</li>
  <li>有最新FSU Pthreads移植包的SCO OpenServer</li>
  <li>SCO UnixWare 7.0.1</li>
  <li>Tru64 Unix</li>
  <li>Win95、Win98和NT(只有擁有<strong>MySQL</strong>使用授權或<strong>MySQL</strong>電子郵件支援的用戶可得到最新版本)。對那些在購買之前想測試的人，我們以共享軟件方式發布了<a HREF="http://www.mysql.com/mysql_w32.htmy"><strong>MySQL</strong> 3.21.29</a>（一個較老的版本）。 
  </li>
</ul>

<p><a NAME="IDX32"></a> <a NAME="IDX33"></a> <a NAME="IDX34"></a> <a NAME="IDX35"></a> <a NAME="IDX36"></a> </p>

<h2><a NAME="Which_version" HREF="manual_toc.html#Which_version">4.3 使用MySQL哪個版本</a></h2>

<p>首先要作出決策，你是否想要使用最新的開發版本或最終的穩定版本： 

<ul>
  <li>通常, 如果你是第一次開始使用<strong>MySQL</strong>或嘗試移植它到一些還沒有可執行檔版本系統上，我們推薦使用開發版本(當前 
    3.22.x)。這是因為通常在開發版本中沒用真正嚴重的錯誤，並且你能容易用你的機器上的<code>crash-me</code>和效能測試套件來測試它。見<a href="manual_Performance.html#Benchmarks">10.8 使用你自己的效能測試</a>。</li>
  <li>否則，如果你正在運行一個老的系統並且想要升級，但是又不想要用3.22冒險，你應該升級到3.21.33。我們已經試著僅修復致命錯誤，並且對那個版本進行更小的相對安全的改動。 
  </li>
</ul>

<p>要做的第二項決策是你是否想要使用原始碼版本或可執行檔版本： 

<ul>
  <li>如果你想在一個已經存在一個最新可執行檔版本的平台上運行<strong>MySQL</strong>，就用它。通常，這比一個原始碼版本更容易安裝。 
  </li>
  <li>如果你想要閱讀(或修改)構成<strong>MySQL</strong>的C和C++代碼，你應該拿到原始碼版本。原始程式總是最終的手冊。原始碼版本也比可執行檔版本包含更多的測試和實例。 
  </li>
</ul>

<p><strong>MySQL</strong>的命名機制使用由3個數字和一個後綴組成的版本號。例如，一個像<code>mysql-3.21.17-beta</code>的版本號這樣解釋： 

<ul>
  <li>第1數字(<code>3</code>)描述文件格式。所有版本3的發行都有相同的文件格式。當一個版本4出現時，每個資料庫表都將必須轉換到新格式(當然，為此有一個很不錯的工具)。 
  </li>
  <li>第2數字(<code>21</code>)是發行級別。通常有2種選擇。一個是發部/穩定分支(當前<code>為21</code>)而其它是開發分支(當前<code>22</code>)。通常兩者都是穩定的，但是開發版本可能有毛病，新功能缺乏文檔或可能在某些系統上編譯失敗。 
  </li>
  <li>第3個數字(<code>17</code>)是在此發行級別的版本號，這隨每個新分發遞增。通常你需要你已經選擇的發行(release)的最新版本(version)。 
  </li>
  <li>後綴(<code>beta</code>)顯示發行的穩定性級別。可能的後綴有： <ul>
      <li><code>alpha</code> 表明發行包含大量未被100%測試的新代碼。已知的錯誤(通常沒有)應該在新聞小節被記錄。見<a HREF="manual_News.html#News">D MySQL 變遷的歷史記錄</a>。在大多數 alpha 
        版本也有新的命令和擴展。 </li>
      <li><code>beta</code> 
        意味著所有的新代碼被測試了，沒有增加重要的新特徵，應該沒有已知的錯誤。 
      </li>
      <li><code>gamma</code> 是一個發行了一段時間的beta版本，看起來應該運行正常。這就是很多其他公司稱為一個發布的東西。 
      </li>
      <li>如果沒有後綴，這意味著該版本已經在很多地方運行一段時間了，而且沒有非平台特定的錯誤報告。這就是我們稱為一個穩定版本的東西。 
      </li>
    </ul>
  </li>
</ul>

<p><strong>MySQL</strong>所有版本都經過我們的標準測試和效能測試運行，以保証他們可相當安全地使用。因為標準測試不斷擴充以檢測以前發現的錯誤，測試套件一直在改進之中。 
</p>

<p>注意，所有版本都至少已經用下列套件進行了測試： 

<dl COMPACT="manual_News.html#News">
  <dt>一個內部測試套件</dt>
  <dd>這是一個客戶生產系統的一部分。它可能有很多幾百個兆字節數據的資料庫表。 
  </dd>
  <dt><strong>MySQL</strong>效能測試套件</dt>
  <dd>它運行一定範圍的常用查詢。它也是一個測試，檢測最新的最佳化處理是否真的使代碼更快。見<a HREF="manual_Performance.html#Benchmarks">10.8 使用你自己的效能測試</a>。 </dd>
  <dt><code>crash-me</code>測試</dt>
  <dd>這嘗試決定資料庫支援什麼功能和它的能力與限制是什麼。見<a HREF="manual_Performance.html#Benchmarks">10.8 使用你的自己效能測試</a>。 </dd>
</dl>

<p>其他測試是在內部的生產環境中使用最新<strong>MySQL</strong>版本，至少在一台機器上。我們有超過100GB的數據可用使用。 
</p>

<h2><a NAME="Many_versions" HREF="manual_toc.html#Many_versions">4.4 
怎樣和何時發布更新版本</a></h2>

<p>在TcX，<strong>MySQL</strong>進展的相當快，並且我們想要與其它<strong>MySQL</strong>用戶分享它。當我們有一個看來其它人似乎需要的非常有用的功能時，我們就試著制作一個發行版本。 
</p>

<p>我們也嘗試幫助那些需要很容易實現的功能的用戶，我們也關注我們授權的用戶想要什麼，我們更特別關注我們的擴展電子郵件支援的客戶想要什麼，並且盡力幫助他們。 
</p>

<p>沒有人一定要下載一個新版本，新聞小節中將告訴你新版本是否有一些你確實想要的東西。見<a HREF="manual_News.html#News">D MySQL 變遷的歷史記錄</a>。 </p>

<p>當更新<strong>MySQL</strong>時，我們使用下列方針： 

<ul>
  <li>對每個小的改進，在版本字符串的最後數字增加1。當有主要的新功能或與先前版本比有較小不兼容性時，在版本字符串的第2數字增加1。當文件格式變化時，第1數字加1。 
  </li>
  <li>穩定的測試過的版本每年準備出現1-2次，但是如果發現小錯誤，只有錯誤修復的一個版本將被發行。 
  </li>
  <li>工作版本準備每1-8周出現一次。 </li>
  <li>對一些平台的可執行檔版本，主要版本由我們制作。其他人可以為其他系統制作可執行檔版本，但是可能不多見。 
  </li>
  <li>一旦我們找到並修復了小錯誤，我們通常使用戶可以得到修補。 </li>
  <li>對非緊急但煩人的錯誤，如果他們被發給我們，我們將使用戶可以得到修補，否則我們將集中許多錯誤到一個更大的修補中。 
  </li>
  <li>在任何情況下，如果在一個發行中有一個致命錯誤，我們將盡快制作一個新版本。我們想其他公司也這樣做。:) 
  </li>
</ul>

<p>當前的穩定版本是3.22﹔我們已經轉移到3.23的積極開發中。在穩定版本中，錯誤仍將被修復。我們不相信一個完全凍結，因為這也留下的錯誤修復和“必須做”的事情。“某種程度的凍結”意味著我們可以增加小東西，它“將幾乎肯定不影響已經能工作的任何東西”。 
</p>

<h2><a NAME="Installation_layouts" HREF="manual_toc.html#Installation_layouts">4.5 
安裝布局</a></h2>

<p>這節描述安裝二進制代碼和原始碼版本時創建的內定目錄布局。 </p>

<p>可執行檔版本通過在你選擇的安裝地點(典型的<tt>“/usr/local/mysql”</tt>)解壓縮來安裝，並且在該處創建下列目錄： 
</p>

<table BORDER="1" WIDTH="100%" NOSAVE="#101090" class="p3">
  <tr>
    <td><strong>目錄</strong> </td>
    <td><strong>目錄的內容</strong> </td>
  </tr>
  <tr>
    <td><tt>“bin”</tt> </td>
    <td>客戶程式和<code>mysqld</code>伺服器</td>
  </tr>
  <tr>
    <td><tt>“data”</tt> </td>
    <td>日誌文件, 資料庫</td>
  </tr>
  <tr>
    <td><tt>“include”</tt> </td>
    <td>包含(頭)文件</td>
  </tr>
  <tr>
    <td><tt>“lib”</tt> </td>
    <td>庫文件</td>
  </tr>
  <tr>
    <td><tt>“scripts”</tt> </td>
    <td><code>mysql_install_db</code> </td>
  </tr>
  <tr>
    <td><tt>“share/mysql ”</tt> </td>
    <td>錯誤消息文件</td>
  </tr>
  <tr>
    <td><tt>“sql-bench”</tt> </td>
    <td>效能程式</td>
  </tr>
</table>

<p>原始碼版本在你配置並編譯後進行安裝。內定地，安裝步驟將文件安裝在<tt>“/usr/local”</tt>下的下列子目錄： 
</p>

<table BORDER="1" WIDTH="100%" NOSAVE="#101090" class="p4">
  <tr>
    <td><strong>目錄</strong> </td>
    <td><strong>目錄的內容</strong> </td>
  </tr>
  <tr>
    <td><tt>“bin”</tt> </td>
    <td>客戶程式和腳本</td>
  </tr>
  <tr>
    <td><tt>“include/mysql”</tt> </td>
    <td>包含(頭)文件</td>
  </tr>
  <tr>
    <td><tt>“info”</tt> </td>
    <td>Info格式的文檔</td>
  </tr>
  <tr>
    <td><tt>“lib/mysql”</tt> </td>
    <td>庫文件</td>
  </tr>
  <tr>
    <td><tt>“libexec”</tt> </td>
    <td><code>mysqld</code>伺服器</td>
  </tr>
  <tr>
    <td><tt>“share/mysql”</tt> </td>
    <td>錯誤消息文件</td>
  </tr>
  <tr>
    <td><tt>“sql-bench”</tt> </td>
    <td>效能程式和<code>crash-me</code>測試</td>
  </tr>
  <tr>
    <td><tt>“var”</tt> </td>
    <td>資料庫和日誌文件。 </td>
  </tr>
</table>

<p>在一個安裝目錄內，原始程式安裝的布局在下列方面不同於二進制安裝： 

<ul>
  <li><code>mysqld</code>伺服器被安裝在<tt>“libexec”</tt>目錄而不是<tt>“bin”</tt>目錄內。 
  </li>
  <li>數據目錄是<tt>“var”</tt>而非<tt>“data”</tt>。 </li>
  <li><code>mysql_install_db</code>被安裝在<tt>“/usr/local/bin”</tt>目錄而非<tt>“/usr/local/mysql/scripts”</tt>內。 
  </li>
  <li>頭文件和庫目錄是<tt>“include/mysql”</tt>和<tt>“lib/mysql”</tt>而非<tt>“include”</tt>和<tt>“lib”</tt>。 
  </li>
</ul>

<h2><a NAME="Installing_binary" HREF="manual_toc.html#Installing_binary">4.6 安裝MySQL可執行檔版本</a></h2>

<p>你需要下列工具安裝一個<strong>MySQL</strong>可執行檔版本： 

<ul>
  <li>GNU <code>gunzip</code>解壓縮分發。 </li>
  <li>一個適當的<code>tar</code>解包分發。 GNU <code>tar</code>已知可以。 </li>
</ul>

<p><a NAME="IDX37"></a><a NAME="IDX38"></a>在Linux下的另一個安裝方法是使用RPM(RedHat包管理器)分發。見<a HREF="manual_Installing.html#Linux-RPM">4.6.1 Linux RPM 注意事項</a>。 </p>

<p>如果你碰到問題，在把問題郵寄到<a HREF="mailto:mysql@lists.mysql.com">mysql@lists.mysql.com</a>時，<strong>請總是使用</strong><code>mysqlbug</code>，就算問題不是一個bug，<code>mysqlbug</code>收集系統資訊，將有助於其它人解決你的問題。不使用<code>mysqlbug</code>，你將減少得到你問題的一個解決方案的可能性！在你解包分發後，你會<tt>在“bin”</tt>目錄下找到<code>mysqlbug</code>。見<a HREF="manual_Questions.html#Bug_reports">2.3 怎樣報告錯誤或問題</a>。 </p>

<p>你必須執行以便安裝並使用一個<strong>MySQL</strong>可執行檔版本的基本命令是： 
</p>

<pre>
shell&gt; gunzip &lt; mysql-VERSION-OS.tar.gz |tar  xvf - 
shell&gt; ln - s  mysql-VERSION-OS  mysql 
shell&gt; cd mysql 
shell&gt; scripts/mysql_install_db 
shell&gt; bin/safe_mysqld &amp;

</pre>

<p>如果你安裝<code>了DBI</code>和<code>Msql-Mysql-modules</code>Perl模組，你可以使用<code>bin/mysql_setpermission</code>腳本增加新用戶。 
</p>

<p>以下是更詳細的描述： </p>

<p>對於安裝可執行檔版本，遵循以下步驟，然後繼續到<a HREF="manual_Installing.html#Post-installation">4.15 安裝後期的設置與測試</a>，進行安裝後期的設置和測試： 

<ol>
  <li>挑選一個你想解開分發包的目錄，進入給目錄。在下面的例子中，我們將分發解包在<tt>“/usr/local”</tt>下並且創建一個安裝<strong>MySQL</strong>的<tt>“/usr/local/mysql”</tt>目錄。（因此，下列指令假設你有權限在<tt>“/usr/local”</tt>中創建文件，如果該目錄被保護，你需要以<code>root</code>實施安裝。) 
  </li>
  <li>從<a HREF="manual_Installing.html#Getting_MySQL">4.1 怎樣獲得MySQL</a>中列出的站點之一獲得一個分發文件。<strong>MySQL</strong>可執行檔版本以壓縮的<code>tar</code>文檔提供，並且有類似<tt>“mysql-VERSION-OS.tar.gz”</tt>的名字，這裡<code>VERSION</code>是一個數字(例如，<code>3.21.15</code>)，且<code>OS</code>表明分發能運行的作業系統類型(例如，<code>pc-linux-gnu-i586</code>)。 
  </li>
  <li>解開分發並且創建立安裝目錄： <pre>
shell&gt; gunzip &lt; mysql-VERSION-OS.tar.gz |tar  xvf - 
shell&gt; ln - s  mysql-VERSION-OS  mysql
</pre>
    <p>第一個命令創建一個名為<tt>“mysql-VERSION-OS”</tt>的目錄，第二個命令產生到該目錄的一個符號鏈接。這讓你更容易地把安裝目錄指定為<tt>“/usr/local/mysql”</tt>。 
    </p>
  </li>
  <li>進入安裝目錄： <pre>
shell&gt; cd  mysql</pre>
    <p>你會在<code>mysql</code>目錄下發現幾個文件和子目錄，對安裝目的最重要的是<tt>“bin”</tt>和<tt>“scripts”</tt>子目錄。 
    <dl COMPACT="manual_Installing.html#Getting_MySQL">
      <dt><tt>“bin”</tt> </dt>
      <dd><a NAME="IDX39"></a> <a NAME="IDX40"></a>這個目錄包含客戶程式和伺服器，你應該把這個目錄的完整路徑加到你的<code>PATH</code>環境變數，以便你的shell能正確的找到<strong>MySQL</strong>程式。 
      </dd>
      <dt><tt>“scripts”</tt> </dt>
      <dd>這個目錄包含<code>mysql_install_db</code>腳本，用來初始化伺服器存取權限。 
      </dd>
    </dl>
  </li>
  <li>如果你想使用<code>mysqlaccess</code>而在某個非標準的地點有<strong>MySQL</strong>分發，你必須改變地點，在哪兒<code>mysqlaccess</code>期望找到<code>mysql</code>客戶。編輯<tt>“bin/mysqlaccess”</tt>腳本，大約在第18行，尋找類似下面的行： 
    <pre>$MYSQL = “/usr/local/bin/mysql”;　# path to mysql executable</pre>
    <p>改變路徑以反映出<code>mysql</code>實際儲存在你系統上的地點。如果你不這樣做，當你運行<code>mysqlaccess</code>時，你將得到一個<code>broken 
    pipe</code>的錯誤。</p>
  </li>
  <li>創造<strong>MySQL</strong>授權表(只有在你以前沒安裝過<strong>MySQL</strong>是必要的)： 
    <pre>shell&gt; scripts/mysql_install_db</pre>
    <p>注意當你運行時<code>mysql_install_db</code>時，比版本3.22.10老的<strong>MySQL</strong>版本啟動<strong>MySQL</strong>伺服器。這不再是真的了！ 
    </p>
  </li>
  <li>如果你想要安裝對Perl <code>DBI</code>/<code>DBD</code>介面的支援，見<a HREF="manual_Installing.html#Perl_support">4.10 Perl安裝注意事項</a>。 </li>
  <li>如果你喜歡在引導機器時自動啟動<strong>MySQL</strong>，你可以拷貝<code>support-files/mysql.server</code>文件到你系統有啟動文件的地方。更多的資訊可以在<code>support-files/mysql.server</code>腳本中和<a HREF="manual_Installing.html#Automatic_start">4.15.3 自動啟動和停止MySQL</a>找到。 
  </li>
</ol>

<p>在所有東西被解包並且安裝以後，你應該初始化並且測試你的分發。 
</p>

<p>你可以用下列命令啟動<strong>MySQL</strong>伺服器： </p>

<pre>shell&gt; bin/safe_mysqld &amp;
</pre>

<p>見<a HREF="manual_Installing.html#Post-installation">4.15 
安裝後期的設置和測試</a>。 </p>

<p><a NAME="IDX41"></a> <a NAME="IDX42"></a> </p>

<h3><a NAME="Linux-RPM" HREF="manual_toc.html#Linux-RPM">4.6.1 Linux RPM 注意事項</a></h3>

<p>在Linux上安裝<strong>MySQL</strong>推薦的方法是使用一個RPM文件。<strong>MySQL</strong> 
RPM目前是在一個 RedHat 5.2 系統上建立的，但是應該能工作在支援<code>rpm</code>且使用<code>glibc</code>的其他 
Linux 版本上。 </p>

<p>如果一個RPM文件有問題，例如<code>Sorry, the host 'xxxx' could not be looked 
up</code>，見<a HREF="manual_Installing.html#Binary_notes-Linux">4.6.3.1 Linux 
注意事項</a>。 </p>

<p>你可能要使用的RPM文件有： 

<ul>
  <li><code>MySQL-VERSION.i386.rpm</code> <strong>MySQL</strong>伺服器。除非你只是想要與運行在其他機器上<strong>MySQL</strong>伺服器連接，否則你將需要它。 
  </li>
  <li><code>MySQL-client-VERSION.i386.rpm</code> 標準<strong>MySQL</strong>客戶程式。你可能總是需要安裝這個包。 
  </li>
  <li><code>MySQL-bench-VERSION.i386.rpm</code> 測試和效能程式。需要Perl和msql-mysql-modules 
    RPM。 </li>
  <li><code>MySQL-devel-VERSION.i386.rpm</code> 
    所需的庫和包含文件。如果你想要編譯其他<strong>MySQL</strong>客戶程式, 
    例如Perl模組。 </li>
  <li><code>MySQL-VERSION.src.rpm</code> 
    包含上述所有包的原始程式。它也能被用來嘗試為其他硬件平台構造RPM(例如，Alpha或SPARC)。 
  </li>
</ul>

<p>查看一個RPM包中的所有文件： </p>

<pre>shell&gt; rpm - qpl  MySQL-VERSION.i386.rpm</pre>

<p>實施一個標準的最小安裝，運行這個命令： </p>

<pre>shell&gt; rpm -i MySQL-VERSION.i386.rpm  MySQL-client-VERSION.i386.rpm</pre>

<p>只安裝客戶包： </p>

<pre>shell&gt; rpm -i MySQL-client-VERSION.i386.rpm</pre>

<p>RPM將數據放在<tt>“/var/lib/mysql”</tt>裡，RPM也在<tt>“/etc/rc.d/”</tt>裡創建適當的入口以便在引導時自動啟動伺服器。（這意味著如果你以前已經安裝過，在對它改變之前，你可以把你以前安裝的<strong>MySQL</strong>啟動文件做個拷貝，因此你不會丟失改動）。</p>

<p>在安裝了RPM文件後，<tt>“mysqld”</tt>背景執行程式應該正在運行，並且現在你應該可以開始使用<strong>MySQL</strong>。見<a HREF="manual_Installing.html#Post-installation">4.15 安裝後期的設置和測試</a>。 
</p>

<p>如果一些東西出錯，可以在二進制的安裝一節裡找到更多的資訊。見<a HREF="manual_Installing.html#Installing_binary">4.6 安裝MySQL可執行檔版本</a>。</p>

<p><a NAME="IDX43"></a> <a NAME="IDX44"></a> </p>

<h3><a NAME="Building_clients" HREF="manual_toc.html#Building_clients">4.6.2 
構造客戶程式</a></h3>

<p>如果你編譯你自己寫的或你從第三方獲得的<strong>MySQL</strong>客戶程式，他們必須用link命令的<code>-lmysqlclient</code>選項進行鏈接。你可能也需要指定一<code>個 
-L</code> 
選項，告訴鏈接器在哪兒查找庫文件。例如，如果庫文件安裝在<tt>“/usr/local/mysql/lib”</tt>裡，在鏈接命令上使用<code> 
-L/usr/local/mysql/lib -lmysqlclient</code>。 </p>

<p>對使用<strong>MySQL</strong>頭文件的客戶程式，當你編譯他們時，你可能需要指定一<code>個 
-I</code> 選項(例如，<code>-I/usr/local/mysql/include</code>)， 
使得編譯器能找到頭文件。</p>

<h3><a NAME="Binary_install_system_issues" HREF="manual_toc.html#Binary_install_system_issues">4.6.3 系統特定的問題</a></h3>

<p>下一節說明在從一個可執行檔版本安裝<strong>MySQL</strong>時，已經在特定的系統上觀察到已發生過一些問題。 
</p>

<h4><a NAME="Binary_notes-Linux" HREF="manual_toc.html#Binary_notes-Linux">4.6.3.1 Linux 
注意事項</a></h4>

<p><strong>MySQL</strong>需要至少Linux 2.0。 </p>

<p>二進制發行版用<code>-static</code>鏈接的，這意味著你一般不必擔心你擁有的系統庫是哪個版本。你也不必安裝LinuxThreads。一個用<code>-static</code>鏈接的程式比一個動態鏈接程式稍大些但更快(3-5%)。然而，一個問題是你不能使用靜態鏈接的用戶定義函數(UDF)。如果你準備編寫或使用UDF函數(這只對C或C++程式員)，你必須編譯<strong>MySQL</strong>本身，使用動態鏈接。 
</p>

<p>如果你正在使用一<code>個基於libc</code>-的系統(而不是一個<code>glibc2</code>系統)，你將可能碰到二進制發行的主機名解析和getpwnam()的一些問題（這是因為<code>glibc</code>不幸地依賴於一些包括解析主機名和getwpent()的外部庫，甚至在用<code>-static</code>編譯時)。在這種情況下，當你運行<code>mysql_install_db</code>時，你可能得到下列錯誤資訊： 
</p>

<pre>sorry, the host 'xxxx' could not be looked up</pre>

<p>或當你嘗試以 <code>--user</code> 選項運行 mysqld 時的下列錯誤： </p>

<pre>getpwnam : No such fileor directory</pre>

<p>你能用下列方法之一解決這個問題： 

<ul>
  <li>獲得一個<strong>MySQL</strong>原始碼版本(一個RPM或<code>tar</code>分發)並且安裝它。 
  </li>
  <li>執行<code>mysql_install_db --force</code>﹔這將不執行<code>mysql_install_db</code>裡面<code>的resolveip</code>測試。缺點是你不能在授權表中使用主機名字﹔相反你必須使用IP數字(除了<code>localhost</code>)。如果你正在使用一個老的不支援<code>--force</code>的<strong>MySQL</strong>版本，你必須用編輯器刪除<code>mysql_install</code>中的<code>resolveip</code>測試。</li>
  <li>用<code>su</code>啟動mysqld而不使用<code>--user</code>。</li>
</ul>

<p><strong>MySQL</strong>的Linux-Intel二進制代碼和RPM發行版是為最高可能的速度而配置的。我們總是努力使用可用的最快的穩定的編譯器。 
</p>

<p><strong>MySQL</strong>的Perl支援要求Perl 5.004_03或更新。 </p>

<h4><a NAME="Binary_notes-HP-UX" HREF="manual_toc.html#Binary_notes-HP-UX">4.6.3.2 HP-UX 
注意事項</a></h4>

<p>針對HP-UX的<strong>MySQL</strong>可執行檔版本作為一個HP depot（倉庫）或tar 
文件格式分發的。為了使用depot文件，你必須運行至少HP-UX 10.x 
以便訪問HP的軟件倉庫工具。 </p>

<p><strong>MySQL</strong>的HP版本在運行HP-UX 10.20下的HP 9000/8xx 
伺服器上編譯，並且使用MIT-pthreads。它已知可在這種配置下很好地工作。<strong>MySQL</strong> 
3.22.26和更新版也用HP原生執行緒包構造。 </p>

<p>其他可以運行的配置： 

<ul>
  <li>運行 HP-UX 10.20 + 的 HP 9000/7xx</li>
  <li>運行 HP-UX 10.30 的 HP 9000/8xx</li>
</ul>

<p>下列配置幾乎肯定不能運行： 

<ul>
  <li>運行 HP-UX 10.x 的 HP 9000/7xx 或 8xx ，x &lt; 2 </li>
  <li>運行 HP-UX 9.x 的 HP 9000/7xx 或 8xx</li>
</ul>

<p>為了安裝分發，使用下面的命令之一, 這裡<code>/path/to/depot</code>是倉庫文件的完整路徑： 

<ul>
  <li>要安裝所有東西，包括伺服器、客戶和開發工具： <pre> shell&gt; /usr/sbin/swinstall - s  /path/to/depot  mysql.full</pre>
  </li>
  <li>僅僅安裝伺服器： <pre>shell&gt; /usr/sbin/swinstall - s  /path/to/depot  mysql.server</pre>
  </li>
  <li>僅僅安裝客戶軟件包： <pre>shell&gt; /usr/sbin/swinstall - s  /path/to/depot  mysql.client</pre>
  </li>
  <li>僅僅安裝開發工具： <pre>shell&gt; /usr/sbin/swinstall - s  /path/to/depot  mysql.developer</pre>
  </li>
</ul>

<p>depot<tt>在“/opt/mysql”</tt>存放二進制代碼和庫文件並在<tt>“/var/opt/mysql”</tt>存放數據。depot也在<tt>“/sbin/init.d”</tt>和<tt>“ 
/sbin/rc2.d”</tt>裡創建適當的入口以自動地在引導時啟動伺服器。顯然, 
這有必要以<code>root</code>身份來安裝。 </p>

<p>為了安裝HP-UX tar分發，你必須有GNU <code>tar</code>的一個拷貝。</p>

<h2><a NAME="Installing_source" HREF="manual_toc.html#Installing_source">4.7 安裝MySQL原始碼版本</a></h2>

<p>你需要下列工具構造並安裝<strong>MySQL</strong>原始程式： 

<ul>
  <li>GNU <code>gunzip</code>解壓縮該分發。 </li>
  <li>一個合適的<code>tar</code>解包分發。GNU <code>tar</code>已知可以工作。 </li>
  <li>一個能運行的ANSI C++編譯器。<code>gcc</code>&gt; = 2.8.1 、<code>egcs</code>&gt; 
    = 1.0.2 、SGI C++和SunPro C++是一些已知能工作編譯器。 當使<code>gcc</code>用時，不需要<code>libg++</code>。gcc2.7.x 
    有一個bug，使得它可能不能編譯一些完全合法的C++文件，例如<tt>“sql/sql_base.cc”</tt>。如果你僅有<code>gcc</code>2.7.x，你必須升級<code>gcc</code>才能編譯<strong>MySQL</strong>。 
  </li>
  <li>一個優秀的<code>make</code>程式。GNU <code>make</code>總是被推薦且有時必須。如果你有問題，我們推薦試一試GNU<code> 
    make</code>3.75或更新。 </li>
</ul>

<p>如果你遇到問題，當向<a HREF="mailto:mysql@lists.mysql.com">mysql@lists.mysql.com</a>郵寄問題時，<strong>請一直使用<code>mysqlbug</code></strong>。就算問題不是一個bug，<code>mysqlbug</code>收集系統資訊，將有助於其它人解決你的問題。如果不使用<code>mysqlbug</code>，你減少得到關你問題的一個解決方案的可能性！在你解包分發後，你會在<tt>“scripts”</tt>目錄下找到<code>mysqlbug</code>。見<a HREF="manual_Questions.html#Bug_reports">2.3 怎樣報告錯誤或問題</a>。 </p>

<h3><a NAME="Quick_install" HREF="manual_toc.html#Quick_install">4.7.1 快速安裝概述</a></h3>

<p>你必須執行的安裝<strong>MySQL</strong>原始碼版本的基本命令是(從一個解包的<code>tar</code>文件)： 
</p>

<pre>shell&gt;configure
shell&gt;make
shell&gt;make install
shell&gt;scripts/mysql_install_db 
shell&gt;/usr/local/mysql/bin/safe_mysqld &amp;
</pre>

<p>如果你從一個原始程式RPM開始，那麼執行如下命令。 </p>

<pre>shell&gt; rpm -- rebuild MySQL-VERSION.src.rpm</pre>

<p>這樣你制作一個可以安裝的二進制RPM。 </p>

<p>如果你安裝<code>了DBI</code>和<code>Msql-Mysql-modules</code>Perl模組，你可以利用<code>bin/mysql_setpermission</code>腳本增加新用戶。 
</p>

<p>以下是更詳細的描述： </p>

<p>為了安裝原始碼版本，按照下列步驟，然後繼續到<a HREF="manual_Installing.html#Post-installation">4.15 安裝後期的設置與測試</a>，進行安裝後期的初始化與測試。 

<ol>
  <li>挑選一個你要在其下面解包分發的目錄，並且進入該目錄。 </li>
  <li>從節<a HREF="manual_Installing.html#Getting_MySQL">4.1 怎樣獲得MySQL</a>中列出的站點之一獲得一個分發文件。<strong>MySQL</strong>原始碼版本以壓縮的<code>tar</code>檔案提供，並且有類似於<tt>“mysql-VERSION.tar.gz”</tt>的名字，這裡的<code>VERSION</code>是一個類似3.23.7-alpha的數字。 
  </li>
  <li>在當前目錄下解包分發： <pre>shell&gt; gunzip &lt; mysql-VERSION.tar.gz | tar  xvf -</pre>
    <p>這個命令創建名為<tt>“mysql-VERSION”</tt>的一個目錄。 </p>
  </li>
  <li>進入解包分發的頂級目錄： <pre>
 shell&gt; cd  mysql-VERSION</pre>
  </li>
  <li>設置發行版本並且編譯： <pre>shell&gt;./configure--prefix=/usr/local/mysql 
shell&gt;make 
</pre>
    <p>當你運行<code>configure</code>時，你可能想要指定一些選項，運行<code>./configure 
    --help</code>得到一張選項表。<a HREF="manual_Installing.html#configure_options">4.7.3 
    典型<code>的configure</code>選項</a>討論一些很有用的選項。如果<code>configure</code>失敗，你將發送包含<tt>你認為能幫你解決該問題的“config.log”</tt>的郵件，如果<code>configure</code>異常退出，也要包括<code>configure</code>的最後幾行輸出。<code>用mysqlbug</code>腳本郵寄錯誤報告。見<a HREF="manual_Questions.html#Bug_reports">2.3 怎樣報告錯誤和問題</a>。如果編譯失敗，見節<a HREF="manual_Installing.html#Compilation_problems">4.8 編譯問題？</a>，幫助解決很多常見問題。 
    </p>
  </li>
  <li>安裝所有東西： <pre>shell&gt;make install</pre>
    <p>你可能需要<code>root</code>用戶來運行這個命令。 </p>
  </li>
  <li>創造<strong>MySQL</strong>授權表(只有你以前沒安裝<strong>MySQL</strong>是必需的)： 
    <pre>shell&gt;scripts/mysql_install_db</pre>
    <p>注意，在運行<code>mysql_install_db</code>時，那些比3.22.10舊的<strong>MySQL</strong>版本啟動<strong>MySQL</strong>伺服器。現在不是這樣了！ 
    </p>
  </li>
  <li>如果你想要安裝對Perl <code>DBI</code>/<code>DBD</code>介面的支援，見<a HREF="manual_Installing.html#Perl_support">4.10 Perl安裝注意說明</a>。 </li>
  <li>如果你想要<strong>MySQL</strong>在你引導機器時自動地啟動，你可以拷貝<code>support-files/mysql.server</code>到你的系統中有啟動文件的地方。更多的資訊可以在<code>support-files/mysql.server</code>腳本裡和<a HREF="manual_Installing.html#Automatic_start">4.15.3 自動啟動和停止MySQL</a>找到。 
  </li>
</ol>

<p>在所有東西安裝完以後，你應該初始化並且測試你的分發。 </p>

<p>你可以用下列命令啟動<strong>MySQL</strong>伺服器，這裡<code>BINDIR</code>是<code>safe_mysqld</code>被安裝的目錄(<tt>內定為“/usr/local/bin</tt>”)： 
</p>

<pre>
shell&gt; BINDIR/safe_mysqld &amp;
</pre>

<p>如果這個命令提示<code>mysqld daemon ended</code>並馬上失敗，那麼你能<tt>在文件“mysql-data-directory/'hostname'.err”</tt>找到一些資訊。可能的原因是你已經有另外一個<code>正在運行的mysqld</code>伺服器。見<a HREF="manual_Common_problems.html#Multiple_servers">19.3 在同一台機器上運行多個MySQL伺服器</a>。 
</p>

<p>參見<a HREF="manual_Installing.html#Post-installation">4.15 
安裝後期的設置與測試</a>。 </p>

<h3><a NAME="Applying_patches" HREF="manual_toc.html#Applying_patches">4.7.2 運用修補</a></h3>

<p>有時修補出現在郵件列表上或放在<strong>MySQL</strong> FTP地點的<a HREF="ftp://www.mysql.com/pub/mysql/Downloads/Patches">修補區</a>。 </p>

<p>為了使用來自郵件列表的一個修補，保存修補出現在文件的消息，進入你的<strong>MySQL</strong>原始程式樹的頂級目錄並運行這些命令： 
</p>

<pre>
shell&gt;patch - p1 &lt;patch-file-name 
shell&gt;rm config.cache
shell&gt;make clean
</pre>

<p>來自FTP地點的修補是作為純文字版文件或作為被壓縮了<code>的gzip</code>文件分發。運用一個文本的修補如上述郵件列表修補，為了使用一個壓縮的修補，進入你的<strong>MySQL</strong>原始程式樹頂級目錄並運行這些命令： 
</p>

<pre>
shell&gt;gunzip &lt;patch-file-name.gz |patch - p1 
shell&gt;rm  config.cache 
shell&gt;make clean
</pre>

<p>在使用一個修補以後，按照正常的原始程式安裝的指令，開始<code>./configure</code>步驟。在運行<code>make 
install</code>後，重啟你的<strong>MySQL</strong>伺服器。 </p>

<p>在運行<code>make install</code>前，你可能需要關閉所有正在運行的伺服器（使用<code>mysqladmin 
shutdown</code>)。如果一個程式的新版本替代當前正在執行的版本，一些系統不允許你安裝它。 
</p>

<h3><a NAME="configure_options" HREF="manual_toc.html#configure_options">4.7.3 典型<code>的configure</code>選項</a></h3>

<p><code>configure</code>腳本給你一個很大的控制權來如何配置你的<strong>MySQL</strong>分發。典型地，你使用<code>configure</code>命令行的選項進行。你也可以用正確的環境變數作用於<code>configure</code>。對於一個由<code>configure</code>支援的選擇列表，運行這個命令： 
</p>

<pre>
shell&gt; ./configure -- help</pre>

<p>一些更常用的<code>configure</code>選項見下面的描述： 

<ul>
  <li>只編譯<strong>MySQL</strong>客戶庫和客戶程式而不是伺服器，使用<code>--without-server</code>選項： 
    <pre>
shell&gt; ./configure --without-server</pre>
    <p>如果你沒有一個 C++ 編譯器，<code>mysql</code>將不編譯(有一個客戶程式需要C++)。在這種情況下，你可以去掉<code>configure</code>裡面測試C++編譯器的代碼，然後運行帶有 
    <code>--without-server</code>選項的<code>./configure</code>。編譯步驟步將仍然嘗試構造<code>mysql</code>，但是你可以忽笨酚何關於<tt>“ 
    mysql.cc ”</tt>的警告。（如果<code>make</code>停止，試試<code>make -k</code>告訴它即使出錯繼續剩下的構造步驟）。</p>
  </li>
  <li>如果你不想要位於<tt>“/usr/local/var”</tt>目錄下面的日誌(log)文件和資料庫，使用類似於下列<code>configure</code>命令的一個： 
    <pre>
shell&gt;./configure--prefix=/usr/local/mysql 
shell&gt;./configure--prefix=/usr/local --localstatedir=/usr/local/mysql/data
</pre>
    <p>第一個命令改變安裝前綴以便任何東西被安裝在<tt>“/usr/local/mysql”</tt>下面而非內定<tt>的“/usr/local”</tt>。第二個命令保留內定安裝前綴，但是覆蓋了資料庫目錄內定目錄(通常是<tt>“/usr/local/var”</tt>)並且把它改/<code>usr/local/mysql/data</code>. 
    </p>
  </li>
  <li>如果你正在使用Unix並且你想要<strong>MySQL</strong>的套接字位於內定地點以外的某個地方(通常在目錄<tt>“/tmp”</tt>或<tt>“/var/run”</tt>，使用像這樣的<code>configure</code>的命令： 
    <pre>
shell&gt; ./configure -- with-unix-socket-path=/usr/local/mysql/tmp/mysql.sock</pre>
    <p>注意給出的文件必須是一個絕對路徑！ </p>
  </li>
  <li>如果你想編譯靜態鏈接程式(例如，制作可執行檔版本、獲得更快的速度或與解決與RedHat分發的一些)，像這樣運行<code>configure</code>： 
    <pre>
shell&gt;./configure --with-client-ldflags=-all-static --with-mysqld-ldflags=-all-static
</pre>
  </li>
  <li>如果你正在使用<code>gcc</code>並且沒有安裝<code>libg++</code>或<code>libstdc++</code>，你可以告訴<code>configure</code>使用<code>gcc</code>作為C++編譯器： 
    <a NAME="IDX45"></a> <a NAME="IDX46"></a> <a NAME="IDX47"></a> <a NAME="IDX48"></a> <pre>
shell&gt; CC=gcc  CXX=gcc  ./configure</pre>
    <p>當你使用時<code>gcc</code>作為C++編譯器是，它將不試圖鏈接<code>libg++</code>或<code>libstdc++</code>。如果構造失敗並且產生有關編譯器或鏈接器的錯誤，不能創建共享庫<tt>“libmysqlclient.so.#”</tt>(<samp>“#”</samp>是一個版本號), 
    你可以通過為<code>configure</code>指定<code>--disable-shared</code>選項來解決此問題。在這種情況下，<code>configure</code>將不構造一個共享<code>libmysqlclient.so.#</code>庫。 
    </p>
  </li>
  <li>你可以設置<strong>MySQL</strong>對於非<code>NULL</code>的列不使用<code>DEFAULT</code>列值(即，不允許列是<code>NULL</code>)。這導致<code>INSERT</code>語句產生一個錯誤，除非你明確地為所有要求非<code>NULL</code>值的列指定值。為了禁止使用內定值，這樣運行<code>configure</code>： 
    <a NAME="IDX49"></a> <a NAME="IDX50"></a> <pre>shell&gt; CXXFLAGS=-DDONT_USE_DEFAULT_FIELDS  ./configure</pre>
  </li>
  <li>內定地，<strong>MySQL</strong>使用ISO-8859-1(Latin1)字符集。為了改變內定設置，使用<code>--with-charset</code>選項目： 
    <pre>
shell&gt; ./configure -- with-charset=CHARSET</pre>
    <p><code>CHARSET</code>可以是<code>big5</code>、<code>cp1251</code>、<code>cp1257</code>、<code>czech</code>、<code>danish</code>、<code>dec8</code>、<code>dos</code>、<code>euc_kr</code>、<code>gb2312</code> 
    <code>gbk、german1</code>、<code>hebrew</code>、 <code>hp8</code>、<code>hungarian</code>、<code>koi8_ru</code>、<code>koi8_ukr</code>、<code>latin1</code>、<code>latin2</code>、<code>sjis</code>、<code>swe7</code>、<code>tis620</code>、<code>ujis</code>、<code>usa7</code>、<code>win1251</code>或<code>win1251ukr</code>之一。見<a HREF="manual_Server.html#Character_sets">9.1.1 用於數據和排序的字符集</a>。注意：如果你想要改變字符集，你必須在配置期間做<code>make 
    distclean</code>！如果你想在伺服器和客戶之間變換字符，你應該看一下<code>SET 
    OPTION CHARACTER SET</code>命令。見<a HREF="manual_Reference.html#SET_OPTION">7.25<code> 
    SET OPTION</code>句法</a>。<strong>警告：</strong>如果你在創建了任何資料庫表之後改變字符集，你將必須對每個表運行<code>myisamchk 
    -r -q</code>，否則你的索引可能不正確地排序。（如果你安裝了<strong>MySQL</strong>，創建一些表，然後重新配置<strong>MySQL</strong>使用一個不同的字符集並且重新安裝它，這時就可能發生這種情況。）</p>
  </li>
  <li>為了配置<strong>MySQL</strong>帶有調試代碼，使用<code>--with-debug</code>選項： 
    <pre>
shell&gt; ./configure --with-debug</pre>
    <p>這導致包含一個安全的內存分配器，能發現一些錯誤和並提供關於正在發生的事情的輸出。見<a HREF="manual_Porting.html#Debugging_server">G.1調試一個MySQL伺服器</a>。 </p>
  </li>
  <li>屬於特定系統的選項可在本章特定系統的小節裡找到。見<a HREF="manual_Installing.html#Source_install_system_issues">4.11 系統特定的問題</a>。</li>
</ul>

<h2><a NAME="Compilation_problems" HREF="manual_toc.html#Compilation_problems">4.8 
編譯問題？</a></h2>

<p>所有<strong>MySQL</strong>程式在Solaris上使用<code>gcc</code>編譯並且沒有任何警告。在其他系統上，由於系統包含文件的差別可能會發生警告。對於使用MIT-pthreads時發生的警告，見<a HREF="manual_Installing.html#MIT-pthreads">4.9 MIT-pthreads 注意事項</a>。其他問題，檢查下面的表。 
</p>

<p>許多問題的解決方案涉及重新配置。如果你確實需要重新配置，注意下列事項： 
<a NAME="IDX52"></a> <a NAME="IDX53"></a> 

<ul>
  <li>如果<code>configure</code>在它已經被運行了以後運行，它可以使用先前收集的資訊。這個資訊被儲存在<tt>“config.cache”</tt>裡面。當<code>configure</code>啟動時，它尋找該文件而且如果它存在，假定資訊仍然是正確的，讀入它的內容。當你重新配置時，該假設是無效的。 
  </li>
  <li>每次你運行<code>configure</code>時候，你必須運行<code>make</code>再重新編譯。然而, 
    你可能想要把先前構造的老的目標文件刪除，因為他們使用不同的配置選項被編譯。 
  </li>
</ul>

<p>為了防止使用舊的配置資訊或目標文件，在重新運行<code>configure</code>前運行這些命令： 
</p>

<pre>
shell&gt;rm  config.cache 
shell&gt;make clean
</pre>

<p>另外，你可以運行<code>make distclean</code>。 </p>

<p>下表描述了一些最常發生的編譯<strong>MySQL</strong>的問題： 

<ul>
  <li><a NAME="IDX58"></a>如果在編譯<tt>“sql_yacc.cc”</tt>時，你得到如下的一個錯誤，你可能是儲存器或交換空間溢出： 
    <pre>Internal compiler error: program cc1plus got fatal signal 11
  或
Out of virtual memory
  或
Virtual memory exhausted
</pre>
    <p>該問題是<code>gcc</code>要求大量的內存編譯<tt>帶有嵌入函數(inline 
    function)的“sql_yacc.cc”</tt>。試試以<code>--with-low-memory</code>選項運行<code>configure</code>： 
    </p>
    <pre>
shell&gt;./configure -- with-low-memory</pre>
    <p>如果你正在使用<code>gcc</code>，該選項使得<code>將-fno-inline</code>加到編譯行，如果你正在使用其他的編譯器，則加入<code>-O0</code>。你應該試一試<code>--with-low-memory</code>選項，即使你有特別多的儲存器和交換空間，而你認為不能可能運行得溢出。這個問題甚至在很慷慨的硬件配置的系統上出現，通常用<code>--with-low-memory</code>選項修正它。 
    </p>
  </li>
  <li>內定地，<code>configure</code>挑選<code>c++</code>作為編譯器名字並用<code>-lg++</code>選項的GNU<code> 
    c++</code>鏈接。如果你正在使用<code>gcc</code>，這個特性在配置期間導致如下問題： 
    <a NAME="IDX59"></a> <pre>configure: error: installation or configuration problem:
C++ compiler cannot create executables.
</pre>
    <p><a NAME="IDX60"></a><a NAME="IDX61"></a>你可能也在編譯期間看到<code>g++</code>、<code>libg++</code>或<code>libstdc++</code>相關的問題。這些問題的一個原因是你可能沒有<code>g++</code>，或你可能有<code>g++</code>但無<code>libg++</code>或<code>libstdc++</code>。看一下<tt>“config.log”</tt>文件。它應該包含你的c++編譯器不能工作的準確原因！為了解決這些問題，你可以使用<code>gcc</code>作為你的C++編譯器。試試設置環境變數<code>CXX</code>為<code>&quot;gcc 
    -O3&quot;</code>。例如： <a NAME="IDX62"></a> <a NAME="IDX63"></a> </p>
    <pre>
shell&gt;CXX=&quot;gcc -O3&quot; ./configure</pre>
    <p>它能工作，因為<code>gcc</code>像<code>g++</code>一樣編譯C++原始程式，但內定地它不鏈接<code>libg++</code>或<code>libstdc++</code>。解決這些問題的其他方法當然是安裝<code>g++</code>、<code>libg++</code>和<code>libstdc++</code>。 
    </p>
  </li>
  <li>如果你的編譯以下面任何錯誤而失敗，你必須升級<code>make</code>版本到GNU<code>make</code>： 
    <pre>making all in mit-pthreads 
make: Fatal error in reader: Makefile, line 18: 
Badly formed macro assignment 
　or 
make: file `Makefile' line 18: Must be a separator (: 
　or 
pthread.h: No such file or directory
</pre>
    <p><a NAME="IDX64"></a><a NAME="IDX67"></a>Solaris和FreeBSD已知<code>make</code>程式有問題。GNU 
    <code>make</code>版本3.75已知能工作。 <a NAME="IDX68"></a> <a NAME="IDX69"></a> <a NAME="IDX70"></a> <a NAME="IDX71"></a> <a NAME="IDX72"></a> <a NAME="IDX73"></a> <a NAME="IDX74"></a> <a NAME="IDX75"></a> </p>
  </li>
  <li>如果你想要定義你的C或C++編譯器所使用的標誌，把標誌加到<code>CFLAGS</code>和<code>CXXFLAGS</code>環境變數中即可。你也能使用<code>CC</code>和<code>CXX</code>來指定編譯器名字。例如： 
    <pre>
shell&gt;CC=gcc 
shell&gt;CFLAGS=-O6 
shell&gt;CXX=gcc 
shell&gt;CXXFLAGS=-O6 
shell&gt;export CC  CFLAGS  CXX  CXXFLAGS
</pre>
    <p>對於已經知道在不同系統上有用的標誌定義列表，見<a HREF="manual_Installing.html#TcX_binaries">4.14 TcX 二進制代碼</a>。 </p>
  </li>
  <li>如果你得到像如下的一條錯誤消息，你需要升級你的<code>gcc</code>編譯器： 
    <pre>
client/libmysql.c:273: parse error brfore '__attribute__'</pre>
    <p><code>gcc</code>2.8.1已知可以工作，但是我們推薦使用<code>egcs</code>1.0.3a或更新。 
    </p>
  </li>
  <li>如果你在編譯<code>mysqld</code>時顯示例如下面的那些錯誤, <code>configure</code>沒有正確地檢測傳到<code>accept()</code>、<code>getsockname()</code>或<code>getpeername()</code>最後參數的類型： 
    <pre>cxx: Error: mysqld.cc, line 645: In this statement, the referenced
     type of the pointer value &quot;&amp;length&quot; is &quot;unsigned long&quot;, which
     is not compatible with &quot;int&quot;.
new_sock = accept(sock, (struct sockaddr *)&amp;cAddr, &amp;length);
</pre>
    <p>為了修正它，編輯<tt>“config.h”</tt>文件(它由<code>configure</code>產生)。尋找這些行： 
    </p>
    <pre>/* Define as the base type of the last arg to accept */
#define SOCKET_SIZE_TYPE XXX
</pre>
    <p>更改<code>XXX</code>為<code>size_t</code>或<code>int</code>，這取決於你的作業系統。（注意：你每次運行<code>configure</code>都必須這樣做，因為<code>configure</code>重新產生<tt>“config.h”</tt>。)</p>
  </li>
  <li><tt>“sql_yacc.cc”</tt>文件由<tt>“sql_yacc.yy”</tt>產生。通常構造程序不需要創造<tt>“sql_yacc.cc”</tt>，因為<strong>MySQL</strong>有一個已經產生的拷貝，然而，如果你確實需要再創建它，你可能碰到這個錯誤： 
    <pre>&quot;sql_yacc.yy&quot;, line xxx fatal: default action causes potential...
</pre>
    <p>這是一個你的<code>yacc</code>版本不完善的跡像。你可能需要安裝<code>bison</code>（GNU 
    版本<code>yacc</code>)並使用它。 </p>
  </li>
  <li>如果你需要調試<code>mysqld</code>或<strong>MySQL</strong>客戶，運行<code>configure</code>，使用<code>--with-debug</code>選項，然後重新編譯並且鏈接你客戶程式到新的客戶庫。見<a HREF="manual_Porting.html#Debugging_client">G.2 調試一個MySQL客戶</a>。 </li>
</ul>

<h2><a NAME="MIT-pthreads" HREF="manual_toc.html#MIT-pthreads">4.9 MIT-pthreads注意事項</a></h2>

<p>這節描述在使用 MIT-pthreads 所涉及的一些問題。 </p>

<p>注意：在Linux上，你應該不使用MIT-pthreads而是安裝LinuxThreads！見<a HREF="manual_Installing.html#Linux">4.11.5 Linux 注意事項(所有的Linux 版本)</a>。 
</p>

<p>如果你的系統不提供原生的執行緒支援，你將需要使用MIT-pthreads包構造<strong>MySQL</strong>。這包括大多數FreeBSD系統、SunOS 
4.x 、Solaris 2.4和更早版本及其他，見<a HREF="manual_Installing.html#Which_OS">4.2 
MySQL 支援的作業系統</a>。 

<ul>
  <li>在大多數系統上，你能通過使用<code>configure</code>，用<code>--with-mit-threads</code>選項來強迫運行MIT-pthreads： 
    <pre>
shell&gt; ./configure -- with-mit-threads</pre>
    <p>當使用MIT-pthreads時，不支援在一個非原始程式目錄構造，因為我們想要使我們對代碼的改變減到最小。 
    </p>
  </li>
  <li>MIT-pthreads不支援用於實現Unix套接字<code>的AF_UNIX</code>協議。這意味著如果你使用MIT-pthreads進行編譯，所有的鏈接必須使用TCP/IP進行(它有點慢)。如果在構造<strong>MySQL</strong>後，你發現你不能與本地的伺服器連接，很可能是客戶程式正在試圖用內定的Unix套接字與<code>localhost</code>連接。使用主機選擇(<code>-h</code>或<code>--host</code>)明確地指定本地的主機名字，嘗試做一個TCP/IP連接<code>到mysql</code>。 
  </li>
  <li>決定是否使用MIT-pthreads的檢查僅在處理伺服器代碼的配置程序期間發生。如果已經用<code>--without-server</code>配置了分發並只構造客戶代碼，客戶將不知道MIT-pthreads是否正在被使用並且是否使用內定的Unix套接字連接。因為Unix套接字不能在MIT-pthreads下面工作，這意味著當你運行客戶程式時，你將需要使用<code>-h</code>或<code>--host</code>。 
  </li>
  <li>當使用MIT-pthreads編譯<strong>MySQL</strong>時，因為性能原因，系統鎖定內定為禁止使用。你可以用<code>--use-locking</code>選項告訴伺服器使用系統鎖定。 
  </li>
  <li>有時pthread<code>bind()</code>命令不能綁定一個套接字但沒有任何錯誤消息(至少在Solaris上)，結果是所有到伺服器的連接均失敗。例如： 
    <pre>shell&gt; mysqladmin version
mysqladmin: connect to server at '' failed;
error: 'Can't connect to mysql server on localhost (146)'
</pre>
    <p>解決它的方法是殺死<code>mysqld</code>伺服器並且重啟它。這只有當我們強迫伺服器停止並馬上進行重啟時在發生。 
    </p>
  </li>
  <li>使用MIT-pthreads，<code>sleep()</code>系統調用不是可中斷的<code>SIGINT</code>（break)。這只有在你運行<code>mysqladmin 
    --sleep</code>時才能注意到。你在中斷起作用並且進程停止之前必須等待<code>sleep()</code>終止。 
  </li>
  <li>當鏈接時，你可能會收到這樣的警告消息(至少在Solaris上)﹔他們可以被忽視： 
    <pre>ld: warning: symbol `_iob' has differing sizes:
    (file /my/local/pthreads/lib/libpthread.a(findfp.o) value=0x4;
file /usr/lib/libc.so value=0x140);
    /my/local/pthreads/lib/libpthread.a(findfp.o) definition taken
ld: warning: symbol `__iob' has differing sizes:
    (file /my/local/pthreads/lib/libpthread.a(findfp.o) value=0x4;
file /usr/lib/libc.so value=0x140);
    /my/local/pthreads/lib/libpthread.a(findfp.o) definition taken
</pre>
  </li>
  <li>一些其他的警告也可被忽略： <pre>implicit declaration of function `int strtoll(...)'
implicit declaration of function `int strtoul(...)'
</pre>
  </li>
  <li>我們還沒有讓<code>readline</code>可在MIT-pthreads上工作。（這不需要，但是可能某些人有興趣。）</li>
</ul>

<h2><a NAME="Perl_support" HREF="manual_toc.html#Perl_support">4.10 Perl 安裝說明</a></h2>

<h3><a NAME="Perl_installation" HREF="manual_toc.html#Perl_installation">4.10.1 在Unix上安裝Perl</a></h3>

<p>Perl對<strong>MySQL</strong>的支援借助<code>DBI</code>/<code>DBD</code>客戶介面而提供。見<a HREF="manual_Clients.html#Perl">20.5 MySQL Perl API</a>。Perl<code> DBD</code>/<code>DBI</code>客戶代碼要求Perl 
5.004或以後版本。如果你有Perl的一個更舊的版本，介面<em>將不能工作</em>。 
</p>

<p><strong>MySQL</strong> Perl支援也要求你安裝了<strong>MySQL</strong>客戶編程支援。如果你從RPM文件安裝<strong>MySQL</strong>，客戶程式在客戶RPM中，但是客戶編程支援在開發者RPM。確定你安裝了後一個RPM 
。 </p>

<p>對於版本3.22.8，Perl支援是與主要<strong>MySQL</strong>發行版本單獨分發。如果你想要安裝Perl支援，你需要的文件能從<a HREF="http://www.mysql.com/Contrib">http://www.mysql.com/Contrib</a>獲得。 </p>

<p>Perl 分發以壓縮的<code>tar</code>檔案提供，並且有一個類似<tt>“MODULE-VERSION.tar.gz”</tt>的名字，這裡<code>MODULE</code>是模組名字並且<code>VERSION</code>是版本號。你應該得到<code>Data-Dumper</code>、DBI和<code>Msql-Mysql-modules</code>分發並按此次序安裝他們。安裝程序顯示出在下面，顯示的例子針對<code>Data-Dumper</code>模組, 
但是所有3個程序是相同的。 

<ol>
  <li>解包分發到當前目錄： <pre>
shell&gt; gunzip &lt; Data-Dumper-VERSION.tar.gz | tar  xvf -</pre>
    <p>這個命令創建的一個名為<tt>“Data-Dumper-VERSION”</tt>的目錄。 </p>
  </li>
  <li>進入解包分發的頂級目錄： <pre>shell&gt; cd  Data-Dumper-VERSION</pre>
  </li>
  <li>構造分發並且編譯所有東西： <pre>shell&gt; perl Makefile.PL
shell&gt; make
shell&gt; make test
shell&gt; make install
</pre>
  </li>
</ol>

<p><code>make test</code>命令很重要，因為它驗証模組正在工作。注意：在你<code>Msql-Mysql-modules</code>安裝期間運行該命令試驗介面代碼時，<strong>MySQL</strong>伺服器必須正在運行，否則測試將失敗。 
</p>

<p>無論何時你安裝一個新版本的<strong>MySQL</strong>，重建並且重新安裝<code>Msql-Mysql-modules</code>分發是一個好主意, 
特別是如果你在升級<strong>MySQL</strong>後，觀察所有異常，如你的<code>DBI</code>腳本核心傾倒(core 
dump)。 </p>

<p>如果你沒有權限在系統目錄下安裝Perl模組，或如果你安裝本地Perl模組，下列參考書可以幫助你： 
</p>

<pre>
<a HREF="http://www.iserver.com/support/contrib/perl5/modules.html">http://www.iserver.com/support/contrib/perl5/modules.html</a>
</pre>

<p>在標題<code>Installing New Modules that Require Locally Installed Modules</code>下面查找。 
</p>

<h3><a NAME="ActiveState_Perl" HREF="manual_toc.html#ActiveState_Perl">4.10.2 在Win32上安裝ActiveState 
Perl</a></h3>

<p>在 Win32 上安裝 ActiveState Perl的<strong>MySQL</strong> <code>DBD</code>的模組, 
你應該做下列步驟： 

<ul>
  <li>打開一個DOS shell。 </li>
  <li>如果需要，設置HTTP_proxy變數。例如, 你可以試一試：<code>set 
    HTTP_proxy=my.proxy.com:3128</code> </li>
  <li>啟動PPM程式：<code>C:\perl\bin\ppm.pl</code> </li>
  <li>如果你還沒有這樣做，安裝<code>DBI</code>： <code>install DBI</code> </li>
  <li>如果成功，安裝<code>DBD::mysql：http://www.mysql.com/Contrib/ppd/DBD-mysql.ppd</code> 
  </li>
</ul>

<p>如果你不能使上述步驟工作，你應該安裝<strong>MyODBC</strong>驅動程式並且通過ODBC連接<strong>MySQL</strong>伺服器。 
</p>

<pre>use DBI;
$dbh= DBI-&gt;connect(&quot;DBI:ODBC:$dsn&quot;,&quot;$user&quot;,&quot;$password&quot;) || 
  die &quot;Got error $DBI::errstr when connecting to $dsn\n&quot;;
</pre>

<h3><a NAME="Win32_Perl" HREF="manual_toc.html#Win32_Perl">4.10.3 在Win32上安裝MySQL 
Perl分發</a></h3>

<p><strong>MySQL</strong> Perl分發包含<code>DBI</code>、<code>DBD:MySQL</code>和<code>DBD:ODBC</code>。 

<ul>
  <li>從<a HREF="http://www.mysql.com/download.html">http://www.mysql.com/download.html</a>得到Win32的Perl分發。</li>
  <li>在<code>C:</code>解壓縮分發，這樣你得到一<tt>個“C:\PERL”</tt>目錄。 
  </li>
  <li>增加目錄<tt>“C:\PERL\BIN”</tt>到你的路徑。 </li>
  <li>增加目錄<tt>“C:\PERL\BIN\MSWin32-x86-thread”</tt>或<tt>“C:\PERL\BIN\MSWin32-x86”</tt>到你的路徑。 
  </li>
  <li>在 DOS shell執行<code>perl -v</code>測試<code>perl</code>的運行。 </li>
</ul>

<h3><a NAME="Perl_support_problems" HREF="manual_toc.html#Perl_support_problems">4.10.4 
使用Perl<code>DBI</code>/<code>DBD</code>介面的問題</a></h3>

<p>如果 Perl 報告它不能找到<code>../mysql/mysql.so</code>模組，那麼問題可能是該Perl不能找到共享庫文件<tt>“libmysqlclient.so”</tt>。 
</p>

<p>你可用下列任何一個方法修正它這： 

<ul>
  <li>用<code>perl Makefile.PL -static</code>而非<code>perl Makefile.PL</code>編<code>譯Msql-Mysql-modules</code>分發。</li>
  <li>拷貝<code>libmysqlclient.so</code>到其他共享庫文件所在的目錄(可能<tt>是“/usr/lib”</tt>或<tt>“/lib”</tt>)。 
  </li>
  <li>在<code>Linux</code>上，你可以把<code>libmysqlclient.so</code>所在目錄的路徑名加到<tt>“/etc/ld.so.conf”</tt>文件中。 
  </li>
  <li><a NAME="IDX76"></a><a NAME="IDX77"></a>把<code>libmysqlclient.so</code>所在目錄的路徑名加到<code>LD_RUN_PATH</code>環境變數中。 
  </li>
</ul>

<p>如果你從<code>DBD-mysql</code>得到下列錯誤，你可能正在使用<code>gcc</code>（或使用一個舊的用<code>gcc</code>編譯的二進制代碼)： 
</p>

<pre>/usr/bin/perl: can't resolve symbol '__moddi3'
/usr/bin/perl: can't resolve symbol '__divdi3'
</pre>

<p>當<tt>“mysql.so”</tt>庫文件被構造時候，為鏈接命令加上<code>-L/usr/lib/gcc-lib/... 
-lgcc</code>(當你編譯Perl客戶時檢查<tt>針對“mysql.so”</tt>的<code>make</code>輸出)。<code>-L</code>選項應該指定<tt>“libgcc.a”</tt>在你系統上所在目錄的路徑名。</p>

<p>這個問題的另一個原因可能是Perl和<strong>MySQL</strong>都不是用<code>gcc</code>編譯的。在這種情況下，你可以都用<code>gcc</code>編譯以解決不匹配。 
</p>

<p>如果你想要在一個不支援動態鏈接(像SCO那樣)的系統上使用Perl模組，你可以產生包括<code>DBI</code>和<code>DBD-mysql</code>的Perl的一個靜態版本。這種運行方法是你產生一個<code>鏈接了DBI</code>代碼的Perl版本並在最新的Perl上安裝它，然後你使用它來構造附加鏈接了<code>DBD</code>代碼的Perl版本，並且安裝它。 
</p>

<p>在 SCO 上，你必須有下列環境變數設置： </p>

<pre>
shell&gt; LD_LIBRARY_PATH=/lib:/usr/lib:/usr/local/lib:/usr/progressive/lib
或
shell&gt; LD_LIBRARY_PATH=/usr/lib:/lib:/usr/local/lib:/usr/ccs/lib:/usr/progressive/lib:/usr/skunk/lib
shell&gt; LIBPATH=/usr/lib:/lib:/usr/local/lib:/usr/ccs/lib:/usr/progressive/lib:/usr/skunk/lib
shell&gt; MANPATH=scohelp:/usr/man:/usr/local1/man:/usr/local/man:/usr/skunk/man:
</pre>

<p>首先, 在<code>DBI</code>分發所在目錄下運行下列命令，創造包括一個靜態鏈接的Perl<code> 
DBI</code>： </p>

<pre>shell&gt; perl Makefile.PL LINKTYPE=static
shell&gt; make
shell&gt; make install
shell&gt; make perl
</pre>

<p>然後你必須安裝新的Perl。<code>make perl</code>的輸出將顯示正確的你需要執行施行安裝的<code>make</code>的命令。在SCO上，是<code>make 
-f Makefile.aperl inst_perl MAP_TARGET=perl</code>. </p>

<p>接下來，在<code>Msql-Mysql-modules</code>分發所在目錄下，使用剛才創建的Perl來創建同樣包括一個靜態鏈接的Perl<code>DBD::mysql</code>的另一個Perl： 
</p>

<pre>shell&gt; perl Makefile.PL LINKTYPE=static 
shell&gt; make 
shell&gt; make install 
shell&gt; make perl
</pre>

<p>最後, 你應該安裝這個新的Perl。而且，<code>make perl</code>的輸出指出使用的命令。 
</p>

<h2><a NAME="Source_install_system_issues" HREF="manual_toc.html#Source_install_system_issues">4.11 系統特定的問題</a></h2>

<p>下面的章節說明在從原始碼版本安裝<strong>MySQL</strong>時，發生在特定的系統上並已觀察到的一些問題。 
</p>

<h3><a NAME="Solaris" HREF="manual_toc.html#Solaris">4.11.1 Solaris注意事項</a></h3>

<p>在Solaris上，甚至在你解開<strong>MySQL</strong>分發以前，你可能陷入困境！Solaris 
<code>tar</code>不能處理長文件名字，因此你在打開<strong>MySQL</strong>時，可能看到這樣的一個錯誤： 
</p>

<pre>x mysql-3.22.12-beta/bench/Results/ATIS-mysql_odbc-NT_4.0-cmp-db2,informix,ms-sql,mysql,oracle,solid,sybase, 0 bytes, 0 tape blocks
tar: directory checksum error
</pre>

<p>在這種情況下，你必須使用 GNU<code> tar</code>(<code>gtar</code>) 
打開分發。你能在<a HREF="http://www.mysql.com/Downloads/">http://www.mysql.com/Downloads/</a>找到為Solaris的一個預編譯的拷貝。 
</p>

<p>Sun的原生執行緒只工作在Solaris 2.5和更高版本上。對於2.4和更早的版本，<strong>MySQL</strong>將自動地使用 
MIT-pthreads 。見<a HREF="manual_Installing.html#MIT-pthreads">4.9 MIT-pthreads 
注意事項</a>。 </p>

<p>如果你從配置得到下列錯誤： </p>

<pre>checking for restartable system calls... configure: error can not run test 
programs while cross compiling
</pre>

<p>這意味著你的編譯器安裝有些問題！在這種情況下，你應該升級編譯器到一個更新的版本。你也可以把下列行插入到<code>config.cache</code>文件來解決這個問題： 
</p>

<pre>ac_cv_sys_restartable_syscalls=${ac_cv_sys_restartable_syscalls='no'}</pre>

<p>如果你在一個SPARC上使用Solaris，推薦的編譯器是<code>egcs</code>1.1.2 
或更新。你能在<a HREF="http://egcs.cygnus.com/">http://egcs.cygnus.com/</a>找到它。注意：<code>egs</code>1.1.1 
和<code>gcc</code>2.8.1 不能在 SPARC 上可靠地工作！ </p>

<p>當使用時<code>egcs</code>1.1.2時，推薦<code>的configure</code>命令行是： </p>

<pre>shell&gt; CC=gcc CFLAGS=&quot;-O6&quot; \
       CXX=gcc CXXFLAGS=&quot;-O6 -felide-constructors -fno-exceptions -fno-rtti&quot; \
       ./configure --prefix=/usr/local/mysql --with-low-memory
</pre>

<p>如果你有Sun Workshop 4.2 編譯器，你能這樣運行<code>configure</code>： </p>

<p>CC=cc CFLAGS=&quot;-xstrconst -Xa -xO4 -native -mt&quot; CXX=CC CXXFLAGS=&quot;-xO4 
-native -noex -mt&quot; ./configure --prefix=/usr/local/mysql </p>

<pre>shell&gt; CC=cc CFLAGS=&quot;-Xa -fast -xO4 -native -xstrconst -mt&quot; \
       CXX=CC CXXFLAGS=&quot;-noex -XO4 -mt&quot; \
       ./configure
</pre>

<pre>你也可以編輯<code>configure</code>腳本改變該行： </pre>

<pre>#if !defined(__STDC__) || __STDC__ != 1
</pre>

<pre>為： </pre>

<pre>#if !defined(__STDC__)</pre>

<p>如果你使用<code>-Xc</code>選項打開<code>__STDC__</code>，Sun編譯器不能用 
Solaris 的<tt>“pthread.h”</tt>頭文件編譯。這是Sun的一個bug。 </p>

<p>如果<code>mysqld</code>在運行時發出顯示在下面的錯誤消息，你已經嘗試用Sun編譯器編譯<strong>MySQL</strong>，沒有啟用多執行緒選擇(<code>-mt</code>)： 
</p>

<pre>libc internal error: _rmutex_unlock: rmutex not held
</pre>

<p>增加<code>-mt</code>到<code>CFLAGS</code>和<code>CXXFLAGS</code>並且再試一試。 
</p>

<p>如果你在用<code>gcc</code>編譯<strong>MySQL</strong>時得到下列錯誤，它意味著你的<code>gcc</code>沒有對你的Solaris版本進行配置！ 
</p>

<pre>shell&gt; gcc -O3 -g -O2 -DDBUG_OFF  -o thr_alarm ...
./thr_alarm.c: In function `signal_hand':
./thr_alarm.c:556: too many arguments to function `sigwait'
</pre>

<p>在這種情況下正確的做法是得到最新版本<code>的egcs</code>，並且用你當前的<code>gcc</code>編譯器編譯它！至少對於 
Solaris 2.5，幾乎所有的<code>gcc</code>二進制版本都有舊的、不可用的包含文件，將破懷使用執行緒的所有程式的文件(並且可能是其他的程式)！ 
</p>

<p>Solaris不提供所有系統庫的靜態版本(<code>libpthreads</code>和<code>libdl</code>)，所以你不能用<code>--static</code>編譯<strong>MySQL</strong>。如果你嘗試這樣做，你將得到錯誤： 
</p>

<pre>ld: fatal: library -ldl: not found
</pre>

<p>如果太多進程試圖很快地連接<code>mysqld</code>，你將在<strong>MySQL</strong>日誌文件中看見這個錯誤： 
</p>

<pre>Error in accept: Protocol error
</pre>

<p>你可以試著用<code>--set-variable back_log=50</code>選項啟動伺服器作為它的一個解決辦法。 
</p>

<p>如果你正在鏈接你自己的<strong>MySQL</strong>客戶，當你試著執行它時，你可能得到下列錯誤： 
</p>

<pre>ld.so.1: ./my: fatal: libmysqlclient.so.#: open failed: No such file or directory
</pre>

<p>這個問題能用下列方法之一避免： 

<ul>
  <li>用下列符號連結客戶(而不是<code>-Lpath</code>)： <code>-Wl,r/full-path-to-libmysqlclient.so</code>。 
  </li>
  <li>拷貝<code>libmysqclient.so</code>到<tt>“/usr/lib”</tt>。 </li>
  <li>在運行你的客戶程式前，把<code>libmysqlclient.so</code>所在目錄的路徑名加到<code>LD_RUN_PATH</code>的環境變數中。 
  </li>
</ul>

<h3><a NAME="Solaris_2.7" HREF="manual_toc.html#Solaris_2.7">4.11.2 Solaris 2.7 
注意事項</a></h3>

<p>通常你能在 Solaris 2.7 上使用 Solaris 2.6 二進制代碼。大多數Solaris 
2.6 的問題也適用於Solaris 2.7。 </p>

<p>注意：<strong>MySQL</strong>3.23.4 和更高版本應該能自動檢測 Solaris 2.7 
並且啟用下列問題的解決辦法！ </p>

<p>Solaris 2.7 在包括文件中有一些bug，在使用<code>gcc</code>時，你可以看見下列錯誤： 
</p>

<pre>/usr/include/widec.h:42: warning: `getwc' redefined
/usr/include/wchar.h:326: warning: this is the location of the previous
definition
</pre>

<p>如果出現這種情況，你可以做下列事情解決這個問題： </p>

<p>拷貝<code>/usr/include/widec.h</code>到<code>.../lib/gcc-lib/os/gcc-version/include</code>並且改變第41行： 
</p>

<pre>#if     !defined(lint) &amp;&amp; !defined(__lint)

為

#if     !defined(lint) &amp;&amp; !defined(__lint) &amp;&amp; !defined(getwc)
</pre>

<p>另外，你可以直接編輯<tt>“/usr/include/widec.h”</tt>。這兩種方法，在你進行修正以後，你應該刪除<tt>“config.cache”</tt>並且再運行<code>configure</code>！ 
</p>

<p>如果當你運行<code>make</code>時，你得到像這樣錯誤，那是因為<code>configure</code>沒檢測<tt>“curses.h”</tt>文件(可能因為<code>/usr/include/widec.h</code>的錯誤)： 
</p>

<pre>In file included from mysql.cc:50:
/usr/include/term.h:1060: syntax error before `,'
/usr/include/term.h:1081: syntax error before `;'
</pre>

<p>解決它的方案是做下列步驟之一： 

<ul>
  <li>如上所述編輯<tt>“/usr/include/widec.h”</tt>並且再次運行configure。</li>
  <li>從<tt>“config.h”</tt>文件刪除<code>#define HAVE_TERM</code>行並再次運行<code>make</code>。 
  </li>
  <li>用<code>CFLAGS=-DHAVE_CURSES CXXFLAGS=-DHAVE_CURSES ./configure</code>進行配置。 </li>
</ul>

<h3><a NAME="Solaris_x86" HREF="manual_toc.html#Solaris_x86">4.11.3 Solaris x86 
注意事項</a></h3>

<p>如果你正在在 Solaris x86上使用<code>gcc</code>或<code>egcs</code>，並且你碰到了在裝載時的核心傾倒（core 
dump）問題，你應該使用下列<code>configure</code>命令： </p>

<pre>shell&gt; CC=gcc CFLAGS=&quot;-O6 -fomit-frame-pointer&quot; \
       CXX=gcc \
       CXXFLAGS=&quot;-O6 -fomit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti&quot; \
       ./configure --prefix=/usr/local/mysql
</pre>

<p>用<code>libstdc++</code>庫和與C++異常處理來避免這個問題。 </p>

<p>如果這沒有幫助，你應該編譯一個調試版本並且用一個蹤跡文件運行它或在<code>gdb</code>下運行它。見<a HREF="manual_Porting.html#Debugging_server">G.1 調試一個 MySQL 伺服器</a>。 </p>

<h3><a NAME="SunOS" HREF="manual_toc.html#SunOS">4.11.4 SunOS 4 注意事項</a></h3>

<p>在 SunOS 4 上， 需要MIT-pthreads 編譯<strong>MySQL</strong>，反過來這意味著你將需要GNU<code> 
make</code>。 </p>

<p>一些SunOS 4系統的動態庫和<code>libtool</code>有問題。你可以使用下列<code>configure</code>行來避免這個問題： 
</p>

<pre>shell&gt; ./configure --disable-shared --with-mysqld-ldflags=-all-static
</pre>

<p>當編譯<code>readline</code>時，你可能得到關於重複定義的警告，這些可以被忽略。 
</p>

<p>當編譯<code>mysqld</code>時候， 將有一些<code>implicit declaration of 
function</code>警告，這些可以被忽略。 </p>

<h3><a NAME="Linux" HREF="manual_toc.html#Linux">4.11.5 Linux 注意事項(所有Linux版本)</a></h3>

<p><strong>MySQL</strong>在Linux上使用 LinuxThreads 
。如果你正在使用一個沒有<code>glibc2</code>的老的Linux版本，你必須在嘗試編譯<strong>MySQL</strong>前安裝LinuxThreads。<a HREF="http://www.mysql.com/Downloads/Linux">http://www.mysql.com/Downloads/Linux</a> </p>

<p>注意：但你做<code>INSERT DELAYED</code>時，所用的包括2.1.1及以前的glibc版本在pthread_mutex_timedwait處理上有一個致命錯誤，如果你正在使用<code>INSERT 
DELAYED</code>，你<strong>必須</strong>把下列修補加到你的glibc庫中：<a HREF="http://www.mysql.com/Downloads/Patches/glibc-pthread_cond_timedwait.patch">http：//www.mysql.com/Downloads/Patches/glibc-pthread_cond_timedwait.patch</a>。<strong>MySQL 
3.23.7</strong>包含了對這個錯誤的一個臨時解決辦法。 </p>

<p>如果你不能啟動<code>mysqld</code>或如果<code>mysql_install_db</code>不工作，請繼續讀下去！這僅發生在有LinuxThreads問題或<code>libc</code>/<code>glibc</code>庫為題的Linux系統上。有很多簡單的解決辦法讓<strong>MySQL</strong>工作！最簡單是使用針對Linux 
x86的二進制版本的<strong>MySQL</strong>（不是RPM)，這個版本的一個好的方面是它可能比你編譯你自己的任何版本快10%！見<a HREF="manual_Performance.html#Compile_and_link_options">10.2.1 編譯和鏈接如何影響 
MySQL 的速度</a>。 </p>

<p>可執行檔版本的一個已知問題是與使用<code>libc</code>的更老的Linux系統（如RedHat 
4.x 或 Slackware)，你將得到有關主機名解決的一些非致命問題。見<a HREF="manual_Installing.html#Binary_notes-Linux">4.6.3.1 Linux注意事項</a>。 </p>

<p>使用<code>libc.so.5.3.12，myisamchk</code>將掛起，升級到最新<code>libc</code>以解決這個問題。 
</p>

<p>當使用 LinuxThreads 時，你將看到最少 3 
進程在運行。這些事實上的執行緒，對LinuxThreads管理器將有一個執行緒，一個執行緒處理連接，還有一個執行緒處理告警和信號。 
</p>

<p>如果你用<code>ps</code>看到了一個死掉的<code>mysqld</code>背景執行程式，這通常意味著你發現了<strong>MySQL</strong>裡面的一個錯誤或你有一個被破壞的資料庫表。見<a HREF="manual_Problems.html#Crashing">18.1 如果MySQL總是崩潰怎麼辦</a>。 </p>

<p>如果你正在使用LinuxThreads並且<code>mysqladmin shutdown</code>不工作，你必須升級到 
LinuxThreads 0.7.1 或更新。 </p>

<p>如果你正在使用 RedHat ，你可能得到像這樣的錯誤： </p>

<pre>/usr/bin/perl is needed...
/usr/sh is needed...
/usr/sh is needed...
</pre>

<p>如果是這樣，你應該升級<code>rpm</code>版本到<tt>“rpm-2.4.11-1.i386.rpm”</tt>和<tt>“rpm-devel-2.4.11-1.i386.rpm”</tt>(或以後)。 
</p>

<p>你能從<a HREF="ftp://ftp.redhat.com/updates/4.2/i386">ftp://ftp.redhat.com/updates/4.2/i386</a>得到RedHat 
4.2的庫文件升級，或對其他分發<a HREF="http://www.sunsite.unc.edu/pub/Linux/distributions/redhat/code/rpm/">http://www.sunsite.unc.edu/pub/Linux/distributions/redhat/code/rpm/</a>。 
</p>

<p>如果你正在鏈接你自己的<strong>MySQL</strong>客戶並且得到錯誤： </p>

<pre>ld.so.1: ./my: fatal: libmysqlclient.so.4: open failed: No such file or directory
</pre>

<p>當執行它們時，這個問題可用下列方法之一避免： 

<ul>
  <li>用下列符號連結客戶(而不是<code>-Lpath</code>)： <code>-Wl,r/path-libmysqlclient.so</code>。 
  </li>
  <li>拷貝<code>libmysqclient.so</code>到<tt>“/usr/lib”</tt>。 </li>
  <li><a NAME="IDX80"></a>在運行你的客戶程式前，把<code>libmysqlclient.so</code>所在目錄的路徑名加到<code>LD_RUN_PATH</code>的環境變數中。 
  </li>
</ul>

<p>如果你正在使用 Fujitsu 編譯器<code>(fcc / FCC)</code>，編譯<strong>MySQL</strong>你將有一些問題，因為 
Linux 頭文件面向<code>gcc</code>。 </p>

<p>下列<code>configure</code>行應該與<code>fcc/FCC</code>工作： </p>

<pre>CC=fcc CFLAGS=&quot;-O -K fast -K lib -K omitfp -Kpreex -D_GNU_SOURCE -DCONST=const \
-DNO_STRTOLL_PROTO&quot; CXX=FCC CXXFLAGS=&quot;-O -K fast -K lib  -K omitfp \
-K preex --no_exceptions --no_rtti -D_GNU_SOURCE -DCONST=const \
-Dalloca=__builtin_alloca -DNO_STRTOLL_PROTO '-D_EXTERN_INLINE=static __inline'&quot; \
./configure --prefix=/usr/local/mysql --enable-assembler \
--with-mysqld-ldflags=-all-static --disable-shared --with-low-memory
</pre>

<h4><a NAME="Linux-x86" HREF="manual_toc.html#Linux-x86">4.11.5.1 Linux-x86 注意事項</a></h4>

<p><strong>MySQL</strong>要求<code>libc</code>版本 5.4.12 
或更新，已知可工作在<code>libc</code> 5.4.46。<code>glibc</code>版本2.0.6和以後版本應該也工作。使用RedHat的<code>glibc</code> 
RPM有一些問題，所以如果你有問題，檢查是否有任何更新！<code>glibc</code>2.0.7-19和2.0.7-29 
RPM已知可以工作。 </p>

<p>在一些更老的 Linux 分發上，<code>configure</code>可能產生像這樣的一個錯誤： 
</p>

<pre>Syntax error in sched.h. Change _P to __P in the /usr/include/sched.h file.
See the Installation chapter in the Reference Manual.
</pre>

<p>按照錯誤消息所說的去做，並且給只有一條下畫線的<code>_P</code>宏增加一個額外下畫線 
(<code>'__P'</code>), 然後再試一試。 </p>

<p>在編譯時，你可能得到一些警告﹔顯示在下面的那些可以被忽略： 
</p>

<pre>mysqld.cc -o objs-thread/mysqld.o
mysqld.cc: In function `void init_signals()':
mysqld.cc:315: warning: assignment of negative value `-1' to `long unsigned int'
mysqld.cc: In function `void * signal_hand(void *)':
mysqld.cc:346: warning: assignment of negative value `-1' to `long unsigned int'
</pre>

<p>在Debian GNU/Linux上，如果你想要在系統啟動時自動啟動<strong>MySQL</strong>，做下列命令： 
</p>

<pre>shell&gt; cp support-files/mysql.server /etc/init.d/mysql.server
shell&gt; /usr/sbin/update-rc.d mysql.server defaults 99
</pre>

<p><code>mysql.server</code>可以在<strong>MySQL</strong>安裝目錄的<tt>“share/mysql”</tt>目錄下面找到, 
或在<strong>MySQL</strong>原始程式樹<tt>的“support-files”</tt>目錄下找到。 </p>

<p>如果<code>mysqld</code>在它啟動時總是核心傾倒(core dump), 
問題可能是你有一個老版本的<tt>“/lib/libc.a”</tt>，重命名它，然後刪除<tt>“sql/mysqld”</tt>並且重新<code>make 
install</code>再試一試。這個問題在一些 Slackware 安裝上被報告了。<code>有最新版本的glibc</code>的RedHat 
5.0也有一些類似的問題。見<a HREF="manual_Installing.html#Linux-RedHat50">4.11.5.2 
RedHat 5.0 注意事項</a>。 </p>

<p>如果再鏈接<code>mysqld</code>時，你得到下列錯誤, 它意味著你的<tt>“libg++.a”</tt>沒有正確安裝： 
</p>

<pre>/usr/lib/libc.a(putc.o): In function `_IO_putc':
putc.o(.text+0x0): multiple definition of `_IO_putc'
</pre>

<p>像這樣運行<code>configure</code>，你能避免使用<tt>“libg++.a”</tt>： </p>

<pre>shell&gt; CXX=gcc ./configure
</pre>

<h4><a NAME="Linux-RedHat50" HREF="manual_toc.html#Linux-RedHat50">4.11.5.2 RedHat 5.0 
注意事項</a></h4>

<p>如果你在RedHat上有<strong>MySQL</strong>的任何問題，你應該開始升級<code>glibc</code>到最新可能的版本！ 
</p>

<p>如果你安裝所有的官方RedHat修補(包括<code>glibc-2.0.7-19</code>和<code>glibc-devel-2.0.7-19</code>)，<strong>MySQL</strong>的二進制代碼和原始碼版本運行應該沒有任何麻煩！ 
</p>

<p>因為在<code>glibc</code>2.0.5裡面有關如何釋放<code>pthread_key_create</code>變數有一個錯誤，更新是需要的。用<code>glibc</code>2.0.5，你必須使用一個靜態地鏈接的<strong>MySQL</strong>可執行檔版本。如果你想要從原始程式編譯，你必須安裝來自於<a HREF="http://www.mysql.com/Downloads/Linux">http://www.mysql.com/Downloads/Linux</a> 的LinuxThreads修正版本或升級你的<code>glibc</code>。 
</p>

<p>如果你有一個不正確的<code>glibc</code>或LinuxThreads版本，其結果是<code>mysqld</code>在每個連接以後崩潰。例如，<code>mysqladmin 
version</code>完成後，<code>mysqld</code>將崩潰！ </p>

<p>另一個不正確的庫的症狀是當<code>mysqld</code>啟動時，馬上崩潰。在一些Linux系統上，這個問題可以通過這樣的配置來修正： 
</p>

<pre>
shell&gt; ./configure -- with-mysqld-ldflags=-all-static</pre>

<p>在Redhat 5.0上，容易的方法是安裝<code>glibc</code>2.0.7-19 RPM並運行<code>configure</code> 
<code>--with-mysqld-ldflags=-all-static</code>選項。 </p>

<p>對於<code>glibc</code>2.0.7的原始碼版本，容易運用並被<strong>MySQL</strong>測試的一個修補可以在下面找到： 
</p>

<pre>
<a HREF="http://www.mysql.com/Download/Linux/glibc-2.0.7-total-patch.tar.gz">http://www.mysql.com/Download/Linux/glibc-2.0.7-total-patch.tar.gz</a>
</pre>

<p>如果當你構造<strong>MySQL</strong>時，你有類似於這些崩潰的經歷, 
你總能下載到最新的<strong>MySQL</strong>二進制版本。這是靜態鏈接的以避免庫衝突而且應該在所有的Linux系統上工作！ 
</p>

<p><strong>MySQL</strong>自帶一個內部的調試器可以有很多資訊產生蹤跡文件，能被用來發現並解決大量不同的問題。見<a HREF="manual_Porting.html#Debugging_server">G.1 調試一個MySQL伺服器</a>。</p>

<h4><a NAME="Linux-RedHat51" HREF="manual_toc.html#Linux-RedHat51">4.11.5.3 RedHat 5.1 
注意事項</a></h4>

<p>RedHat 5.1<code>的glibc</code>(<code>glibc</code>2.0.7-13 )有一個內存缺陷，所以要得到一個穩定的<strong>MySQL</strong>版本，你必須升級<code>glibc</code>到2.0.7-19、降級<code>glibc</code>或使用一個<code>mysqld</code>的二進制版本。如果你不這樣做，你將碰到內存問題(記憶體溢位，等等, 
等等)。在這種情況下，最常見的錯誤是： </p>

<pre>Can't create a new thread (errno 11). If you are not out of available
memory, you can consult the manual for any possible OS dependent bug
</pre>

<p>在你升級到<code>glibc</code>2.0.7-19以後，你可以用動態鏈接(內定)配置<strong>MySQL</strong>，但是在你從原始程式安裝了<code>glibc</code> 
2.0.7-19之前，你<strong>不能</strong>運行<code>configure</code> <code>--with-mysqld-ldflags=-all-static</code>選項！</p>

<p>你可以用<code>rpm -q glibc</code>檢查你有<code>glibc</code>哪個版本。 </p>

<h4><a NAME="Linux-SPARC" HREF="manual_toc.html#Linux-SPARC">4.11.5.4 Linux-SPARC 
注意事項</a></h4>

<p>在一些實現中，<code>readdir_r()</code>被破壞了。其症狀是<code>SHOW 
DATABASES</code>總是返回一個空集合。這可以通過在編譯前從<tt>“config.h”</tt><code>中刪除HAVE_READDIR_R</code>進行更正。 
</p>

<p>有些問題將需要給你的Linux安裝打修補。修補可在<a HREF="http://www.mysql.com/patches/Linux-sparc-2.0.30.diff">http://www.mysql.com/patches/Linux-sparc-2.0.30.diff</a>找到，這個修補是針對Linux分發<tt>“sparclinux-2.0.30.tar.gz”</tt>，它們可從<code>vger.rutgers.edu</code>（一個從來沒有與官方的2.0.30版合並的版本)得到。你也必須安裝LinuxThreads 
0.6或更新。 </p>

<p>感謝<a HREF="mailto:jacques@solucorp.qc.ca">jacques@solucorp.qc.ca</a>提供這個資訊。 
</p>

<h4><a NAME="Linux-Alpha" HREF="manual_toc.html#Linux-Alpha">4.11.5.5 Linux-Alpha注意事項</a></h4>

<p>在Linux-Alpha上的大問題仍然是在這個平台上的<code>glibc</code>的執行緒有一些問題。你應該從得到你能找到的最新<code>glibc</code>版本開始。 
</p>

<p>注意：在你運行任何使用執行緒的程式之前(像<code>mysqld</code>、<code>thr_alarm</code>或<code>thr_lock</code>)，你應該增減共享儲存器的限制(用<code>ulimit</code>)。如果你忘記這樣做，<strong>MySQL</strong>效能測試已知是失敗的！ 
</p>

<p>用下列命令配置<strong>MySQL</strong>： </p>

<pre>shell&gt; CC=gcc CCFLAGS=&quot;-Dalpha_linux_port&quot; \
       CXX=gcc CXXFLAGS=&quot;-O3 -Dalpha_linux_port -felide-constructors -fno-exceptions -fno-rtti&quot; \
       ./configure --prefix=/usr/local/mysql
</pre>

<p>試試編譯<code>mysys/thr_lock</code>和<code>mysys/thr_alarm</code>，測試這些程式的運行！（不用參數調用每一個，如果一切正常，每個應該以<code>test_succeeded</code>結束。）</p>

<p>在安裝<strong>MySQL</strong>以後，在<code>safe_mysqld</code>裡去掉<code>ulimit</code>命令的注釋，並加入選項以增加共享儲存器。 
</p>

<p>注意對<strong>MySQL</strong>來說，Linux-Alpha仍然是一個alpha質量的平台。用最新<code>glibc</code>，你有一個讓它工作的很好機會。 
</p>

<p>如果你用信號方面的問題(<strong>MySQL</strong>出人意料地在高負載下死掉)，你可能找到了一個執行緒和信號有關的OS錯誤。在這種情況下，你可以告訴<strong>MySQL</strong>如下配置以不使用信號： 
</p>

<pre>shell&gt; CFLAGS=-DDONT_USE_THR_ALARM \
       CXXFLAGS=-DDONT_USE_THR_ALARM \
       ./configure ...
</pre>

<p>這不影響<strong>MySQL</strong>性能，但是有副作用，就是你不能<code>用mysqladmin 
kill</code>或<code>mysqladmin shutdown</code>殺死在一個連接上“睡眠”的客戶。相反，當客戶發出下一個命令時，它將死掉。 
</p>

<h4><a NAME="MKLinux" HREF="manual_toc.html#MKLinux">4.11.5.6 MkLinux 注意</a></h4>

<p><strong>MySQL</strong>應該能工作在有最新<code>glibc</code>包的MkLinux上(用<code>glibc</code>2.0.7測試過)。 
</p>

<h4><a NAME="Qube2" HREF="manual_toc.html#Qube2">4.11.5.7 Qube2 Linux注意事項</a></h4>

<p>為了讓<strong>MySQL</strong>在Qube2上工作，(Linux Mips)，你需要最新<code>的glibc</code>庫(<code>glibc-2.0.7-29C2</code>已知可工作)。你也必須使用<code>egcs</code>C++編譯器(<code>egcs-1.0.2-9</code>或更新)。 
</p>

<h3><a NAME="Alpha-DEC-Unix" HREF="manual_toc.html#Alpha-DEC-Unix">4.11.6 Alpha-DEC-Unix 
注意事項</a></h3>

<p>當在Digital UNIX下編譯執行緒程式時，文檔推薦對於<code>cc</code>和<code>cxx</code>使用<code>-pthread</code>選項而且庫<code>文件用-lmach 
-lexc</code>（除了<code>-lpthread</code>外)。你應該像下面這樣運行<code>configure</code>： 
</p>

<pre>shell&gt; CC=&quot;cc -pthread&quot; CXX=&quot;cxx -pthread -O&quot; \
       ./configure --with-named-thread-libs=&quot;-lpthread -lmach -lexc -lc&quot;
</pre>

<p>當編譯<code>mysqld</code>時，你可能看見這樣一些警告： </p>

<pre>mysqld.cc: In function void handle_connections()':
mysqld.cc:626: passing long unsigned int *' as argument 3 of
accept(int,sockadddr *, int *)'
</pre>

<p>你可以安全地忽略這些警告，他們的發生是因為<code>configure</code>只能檢測出錯誤，而不是警告。 
</p>

<p>如果你直接從命令行啟動伺服器，當你退出時，你可能有死掉的問題。（當你退出時，你的重要進程收到一<code>個SIGHUP</code>信號)，如果如此，試著像這樣啟動伺服器： 
</p>

<pre>
shell&gt; nohup  mysqld [options] &amp;
</pre>

<p><code>nohup</code>使得跟隨它的命令忽視從終端發來的任何<code>SIGHUP</code>信號了。另外，通過運行<code>safe_mysqld</code>啟動伺服器，它為你使用<code>nohup</code>調用<code>mysqld</code>。 
</p>

<h3><a NAME="Alpha-DEC-OSF1" HREF="manual_toc.html#Alpha-DEC-OSF1">4.11.7 Alpha-DEC-OSF1注意事項</a></h3>

<p>如果你有編譯問題並安裝了DEC<code>CC</code>和<code>gcc</code>，嘗試這樣運行<code>configure</code>： 
</p>

<pre>shell&gt; CC=cc CFLAGS=-O CXX=gcc CXXFLAGS=-O3 \
       ./configure --prefix=/usr/local/mysql
</pre>

<p>如果你得到<tt>“c_asm.h”</tt>文件的問題，你可以創建並使用一個“啞(dummy)”<tt>“c_asm.h”</tt>文件： 
</p>

<pre>shell&gt; touch include/c_asm.h
shell&gt; CC=gcc CFLAGS=-I./include \
       CXX=gcc CXXFLAGS=-O3 \
       ./configure --prefix=/usr/local/mysql
</pre>

<p>在OSF1 V4.0D和編譯器&quot;DEC C V5.6-071 on Digital UNIX V4.0 (Rev. 878)&quot; 
上，編譯器有了一些奇怪的行為(未定義<code>asm</code>標誌)。<code>/bin/ld</code>好像也被破壞(當鏈接<code>mysqld</code>時，發生<code>_exit 
undefined</code>問題)。在這個系統上，從OSF 4.0C的版本替換了<code>/bin/ld</code>後，我們設法用下列<code>configure</code>命令行編譯<strong>MySQL</strong>，： 
</p>

<pre>shell&gt; CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql 
</pre>

<p>用Digital編譯器“C++ V6.1-029”，下列命令應該工作： </p>

<pre>CC=cc -pthread
CFLAGS=-O4 -ansi_alias -ansi_args -fast -inline speed -speculate all -arch host
CXX=cxx -pthread
CXXFLAGS=-O4 -ansi_alias -ansi_args -fast -inline speed -speculate all -arch host
export CC CFLAGS CXX CXXFLAGS
./configure --prefix=/usr/mysql/mysql --with-low-memory --enable-large-files \
--with-mysqld-ldflags=-all-static --disable-shared --with-named-thread-libs=&quot;-lmach -lexc -lc&quot;
</pre>

<p>在OSF1的某些版本中，<code>alloca()</code>函數被破壞，通過刪除定義<code>'HAVE_ALLOCA'</code><tt>的“config.h”</tt>的行更正它。 
</p>

<p><code>alloca()</code>函數也可能在<code>/usr/include/alloca.h</code>裡面有一個不正確的原型，源於此的警告可以忽略。 
</p>

<p><code>configure</code>將自動地使用下列執行緒庫： <code>--with-named-thread-libs=&quot;-lpthread 
-lmach -lexc -lc&quot;</code>。</p>

<p>當使用<code>gcc</code>時，你也可以試試這樣運行<code>configure</code>： </p>

<pre>
shell&gt; CFLAGS=-D_PTHREAD_USE_D4  CXX=gcc  CXXFLAGS=-O3  ./configure ……</pre>

<p>如果你的信號有問題(<strong>MySQL</strong>出人意料地在高負載下死掉)，你可能找到了一個執行緒和信號有關的OS錯誤。在這種情況下，你可以告訴<strong>MySQL</strong>如下配置以不使用信號： 
</p>

<pre>shell&gt; CFLAGS=-DDONT_USE_THR_ALARM \
       CXXFLAGS=-DDONT_USE_THR_ALARM \
       ./configure ...
</pre>

<p>這不影響<strong>MySQL</strong>性能，但是有負面效應，就是你不能<code>用mysqladmin 
kill</code>或<code>mysqladmin shutdown</code>殺死在一個連接上“睡眠”的客戶。相反，當客戶發出下一個命令時，它將死掉。 
</p>

<h3><a NAME="SGI-Irix" HREF="manual_toc.html#SGI-Irix">4.11.8 SGI-Irix 注意事項</a></h3>

<p>你可能需要在運行<code>configure</code>後且在編譯前去掉在<tt>“config.h”</tt>裡面一些東西的定義(underfine)。 
</p>

<p>在一些Irix實現中，<code>alloca()</code>函數被破壞。如果<code>mysqld</code>伺服器死於一些<code>SELECT</code>語句，把<tt>“config.h”</tt>定義<code>HAVE_ALLOC</code>和<code>HAVE_ALLOCA_H</code>的行刪除即可。如果<code>mysqladmin 
create</code>不工作，把<tt>“config.h”</tt>定義<code>HAVE_READDIR_R</code>的行刪除，你也可能必須刪除<code>HAVE_TERM_H</code>行。 
</p>

<p>SGI推薦你將本頁上的所有修補作為一個整體來安裝：http://support.sgi.com/surfzone/patches/patchset/6.2_indigo.rps.html</p>

<p>最小地，你應該安裝最新的核心卷(rollup)、最新的<code>rld</code>卷和最新的<code>libc</code>卷。 
</p>

<p>很明確，對於pthreads支援，你需要本頁上所有的POSIX修補： </p>

<p>http://support.sgi.com/surfzone/patches/patchset/6.2_posix.rps.html</p>

<p>如果在編譯<tt>“mysql.cc”</tt>時，你得到類似於下面的錯誤: </p>

<pre>&quot;/usr/include/curses.h&quot;, line 82: error(1084): invalid combination of type
</pre>

<p>那麼，在你的<strong>MySQL</strong>原始程式樹的頂級目錄打下列命令： </p>

<pre>shell&gt; extra/replace bool curses_bool &lt; /usr/include/curses.h &gt; include/curses.h
shell&gt; make
</pre>

<p>應該也有安排上的問題報告。如果只有一個執行緒正在運行，事情會變慢的。通過啟動另外一個客戶來避免它，這可以導致此後其他執行緒的執行速度增加2到10倍。這是Irix執行緒難以理解的問題﹔你可能必須臨時準備找出解決方案直到它能被修正。 
</p>

<p>如果你正在用<code>gcc</code>編譯，你可以使用下列<code>configure</code>命令： 
</p>

<pre>shell&gt; CC=gcc CXX=gcc CXXFLAGS=-O3 \
       ./configure --prefix=/usr/local/mysql --with-thread-safe-client --with-named-thread-libs=-lpthread
</pre>

<h3><a NAME="FreeBSD" HREF="manual_toc.html#FreeBSD">4.11.9 FreeBSD 注意事項</a></h3>

<p>對於運行MySQL，FreeBSD 3.x是被推薦的，因為其執行緒包是更加完整。 </p>

<p>最容易因此是比較受喜歡的安裝方法是使用mysql服務者和 mysql客戶的移植，可從<a HREF="http://www.freebsd.org">http://www.freebsd.org</a>得到。</p>

<p>使用這些給你的東西： 

<ul>
  <li>一個全最佳化的工作在你的FreeBSD版本上的<strong>MySQL</strong>。 </li>
  <li>自動配置和構造。 </li>
  <li>啟動腳本安裝在/usr/local/etc/rc.d。</li>
  <li>用pkg_info -L察看哪個文件被安裝的能力，並且如果你在那台機器上不再想要<strong>MySQL</strong>，用pkg_delete完全刪除它們。 
  </li>
</ul>

<p>建議在FreeBSD 2.x版上使用 MIT-pthreads，在版本3和以上版本用原生執行緒。在一些2.2.x的以後版本使用原生執行緒運行是可能的，但是你可能碰到mysqld關掉的問題。 
</p>

<p>確定讓你的名字解析程式安裝正確，否則當連接mysqld時，你可能會經歷解析延時或失敗。 
</p>

<p>保証在<tt>“/etc/hosts”</tt>文件<code>中的localhost</code>入口是正確的(否則你與資料庫連接時將有問題)。<tt>“/etc/hosts”</tt>文件應該以一行開始： 
</p>

<pre>
127.0.0.1  localhost  localhost.your.domain</pre>

<p>如果你注意到<code>configure</code>使用 MIT-pthreads，你應該閱讀MIT-pthreads注意事項，見<a HREF="manual_Installing.html#MIT-pthreads">4.9 MIT-pthreads 注意事項</a>。 </p>

<p>如果你從<code>make install</code>得到一個它不能找到<tt>“/usr/include/pthreads”</tt>的錯誤，<code>configure</code>沒有檢測出你需要 
MIT-pthreads。通過執行這些命令修正它： </p>

<pre>shell&gt; rm config.cache
shell&gt; ./configure --with-mit-threads
</pre>

<p>FreeBSD <code>make</code>的行為與<code>make</code> GNU略有不同。如果你有<code>make</code>相關問題，你應該安裝GNU<code> 
make</code>。 </p>

<p>FreeBSD也已知有一個非常低的內定文件句柄限制。見<a HREF="manual_Problems.html#Not_enough_file_handles">18.11 文件沒找到</a>。去掉在safe_mysqld中的ulimit 
-n 小節的注釋或在/etc/login.conf為mysqld用戶提高限制(並用cap_mkdb 
/etc/login.conf重建它)，如果你不使用內定，也要保証你為此用戶在密碼文件(用法：chpass 
mysqld-user-name ）。</p>

<p><a NAME="IDX82"></a>你用<code>SELECT NOW()</code>返回GMT形式的值而不是你的本地時間，如果有這樣的問題，你必須設定<code>TZ</code>環境變數為你的當前時區的。這應該設置伺服器運行的環境，例如在<code>safe_mysqld</code>或<code>mysql.server</code>裡。 
</p>

<p>為了得到一個安全並且穩定的系統，你應該只僅使用被標記為<code>-STABLE</code>的FreeBSD內核。 
</p>

<h3><a NAME="NetBSD" HREF="manual_toc.html#NetBSD">4.11.10 NetBSD 注意事項</a></h3>

<p>為了NetBSD上編譯，你需要GNU<code> make</code>，否則當<code>make</code>試圖在C++文件上運行<code>lint</code>時，編譯將崩潰。 
</p>

<h3><a NAME="OpenBSD" HREF="manual_toc.html#OpenBSD">4.11.11 OpenBSD 2.5 注意事項</a></h3>

<p>在OpenBSD 2.5上，你可以用下列選項編譯帶原生執行緒的<strong>MySQL</strong>： 
</p>

<pre>
CFLAGS=-pthread  CXXFLAGS=-pthread  ./configure -- with-mit-threads=no</pre>

<h3><a NAME="BSDI" HREF="manual_toc.html#BSDI">4.11.12 BSD/OS 注意事項</a></h3>

<h4><a NAME="BSDI2" HREF="manual_toc.html#BSDI2">4.11.12.1 BSD/OS 2.x 注意事項</a></h4>

<p>如果在編譯<strong>MySQL</strong>時，你得到下列錯誤, 你對虛存的<code>ulimit</code>值是太低了： 
</p>

<pre>item_func.h: In method `Item_func_ge::Item_func_ge(const Item_func_ge &amp;)':
item_func.h:28: virtual memory exhausted
make[2]: *** [item_func.o] Error 1
</pre>

<p>試試使用<code>ulimit -v 80000</code>並再運行<code>make</code>。如果這還不行並且你正在使用<code>bash</code>，試試換到<code>csh</code>或<code>sh</code>﹔一些BSDI用戶報告了與<code>bash</code>和<code>ulimit</code>有關問題。 
</p>

<p>如果你正在使用<code>gcc</code>，你也可能必須為<code>configure</code>使用<code>--with-low-memory</code>標誌才能編<tt>譯“sql_yacc.cc”</tt>。 
</p>

<p><a NAME="IDX85"></a><a NAME="IDX87"></a>你用<code>SELECT NOW()</code>返回GMT形式的值而不是你的本地時間，如果有這樣的問題，你必須設定<code>TZ</code>環境變數為你的當前時區的。這應該為伺服器運行的環境設置，例如在<code>safe_mysqld</code>或<code>mysql.server</code>裡。 
</p>

<h4><a NAME="BSDI3" HREF="manual_toc.html#BSDI3">4.11.12.2 BSD/OS 3.x 注意事項</a></h4>

<p>升級到BSD/OS 3.1。如果那不可能，安裝BSDI patch M300-038。 </p>

<p>在配置<strong>MySQL</strong>時，使用下列命令: </p>

<pre>shell&gt; env CXX=shlicc++ CC=shlicc2 \
       ./configure \
           --prefix=/usr/local/mysql \
           --localstatedir=/var/mysql \
           --without-perl \
           --with-unix-socket-path=/var/mysql/mysql.sock
</pre>

<p>下列也已知可用： </p>

<pre>shell&gt; env CC=gcc CXX=gcc CXXFLAGS=-O3 \
       ./configure \
           --prefix=/usr/local/mysql \
           --with-unix-socket-path=/var/mysql/mysql.sock
</pre>

<p>如果你願意，你可以改變目錄地點，或不指定任何地點而使用內定。 
</p>

<p>如果你在重負再下的性能有問題，試試使用對<code>safe_mysqld</code>使用<code>--skip-thread-priority</code>選項！這將以相同優先級運行所有執行緒﹔在BSDI 
3.1上，這得到較好的性能(至少直到BSDI修正其執行緒調度程式)。 </p>

<p>如果你在編譯時得到<code>virtual memory exhausted</code>錯誤，試試使用<code>ulimit 
-v 80000</code>並再運行<code>make</code>。如果這還不行並且你正在使用<code>bash</code>，試試換到<code>csh</code>或<code>sh</code>﹔一些BSDI用戶報告了與<code>bash</code>和<code>ulimit</code>有關問題。 
</p>

<h4><a NAME="BSDI4" HREF="manual_toc.html#BSDI4">4.11.12.3 BSD/OS 4.x 注意事項</a></h4>

<p>BSDI 4.x有一些執行緒有關的錯誤。如果你想要在這上面使用<strong>MySQL</strong>，你應該安裝所有與執行緒相關的修補，至少應該安裝M400-023。 
</p>

<h3><a NAME="SCO" HREF="manual_toc.html#SCO">4.11.13 SCO 注意事項</a></h3>

<p>當前的移植僅在“sco3.2v5.0.4”和“sco3.2v5.0.5”系統上被測試，在“sco 
3.2v4.2”一個移植也有很大進展。 </p>

<p>此時在OpenServer上推薦的編譯器是gcc 2.95.2，用它你應該能編譯<code>MySQL</code>： 
</p>

<pre>CC=gcc CXX=gcc ./configure ... (options)
</pre>

<ol>
  <li>對於OpenServer 5.0.X，你需要在Skunkware 95上使用GDS(95q4c)，這是必要的，因為在Skunkware 
    97上的GNU<code> gcc</code> 2.7.2 沒有GNU<code> as</code>。你也可以使用<code>egcs</code>1.1.2或更新：<a HREF="http://www.egcs.com/">http://www.egcs.com/</a>。如果你正在使用<code>egcs</code>1.1.2，你必須執行下列命令： 
    <pre>shell&gt; cp -p /usr/include/pthread/stdtypes.h \
/usr/local/lib/gcc-lib/i386-pc-sco3.2v5.0.5/egcs-2.91.66/include/pthread/
</pre>
  </li>
  <li>對該產品和開發系統，你需要GCC 2.5.?的移植。他們在這個SCO UNIX版本上是必需的，你不能只使用GCC 
    Dev系統。 </li>
  <li>你應該得到 FSU Pthreads 包並且首先安裝它，它可在<a HREF="http://www.cs.wustl.edu/~schmidt/ACE_wrappers/FSU-threads.tar.gz">http://www.cs.wustl.edu/~ 
    schmidt/ACE_wrappers/FSU-threads.tar.gz</a>找到。你也可以從<a HREF="ftp://www.mysql.com/pub/mysql/Downloads/SCO/FSU-threads-3.5c.tar.gz">ftp://www.mysql.com/pub/mysql/Downloads/SCO/FSU-threads-3.5c.tar.gz</a>得到一個預編譯的包。</li>
  <li>FSU Pthreads能用帶tcpip的SCO UNIX 4.2編譯，或OpenServer 3.0或Open Desktop 
    3.0(OS 3.0 ODT 3.0)，安裝帶有使用一個GCC 2.5.X ODT的SCO開發系統，或對OS 
    3.0你將需要一個GCC 2.5.？的良好移植。 
    沒有一個良好的移植會有很多問題。對這個產品的移植需要SCO UNIX開發系統，沒有它，你正缺少所需的庫和鏈接器。 
  </li>
  <li>為了在你的系統上構造FSU Pthreads，做下列工作： <ol>
      <li>在<tt>“thread/src”</tt>目錄下運行<code>./configure</code>並且選擇SCO 
        OpenServer選項。這個命令拷貝<tt>“Makefile.SCO5”</tt>到<tt>“Makefile”</tt>。 
      </li>
      <li>運行<code>make</code>。 </li>
      <li>為了在內定<tt>的“/usr/include”</tt>目錄安裝，作為root登錄，然後<code>cd</code> 
        <tt>到“thread/src”</tt>目錄，並運行<code>make install</code>。 </li>
    </ol>
  </li>
  <li>記得在制作<strong>MySQL</strong>時要使用GNU<code> make</code>。 </li>
  <li>在OSR 5.0.5上，你應該使用下列配置命令行： <pre>shell&gt; CC=&quot;gcc -DSCO&quot; CXX=&quot;gcc -DSCO&quot; ./configure
</pre>
    <pre>需要<code>-DSCO</code>幫助配置正確檢測一些執行緒函數。如果你忘記<code>-DSCO</code>，在編譯時，你將得到下列錯誤消息： </pre>
    <pre>my_pthread.c: In function `my_pthread_mutex_init':
my_pthread.c:374: `pthread_mutexattr_default' undeclared (first use this function)

</pre>
  </li>
  <li>如果你不是作為root啟動<code>safe_mysqld</code>，你將可能每進程只有內定的110個打開文件。<code>mysqld</code>將在日誌文件寫下關於此的注解。 
  </li>
  <li>用SCO 3.2 V5.0.5，你應該使用一個FSU Pthreads版本3.5c或更新。下列<code>configure</code>命令應該工作： 
    <pre>shell&gt; CC=&quot;gcc -belf&quot; ./configure --prefix=/usr/local/mysql --disable-shared
</pre>
  </li>
  <li>用SCO 3.2V4.2，你應該使用一個FSU Pthreads版本3.5c或更新。下列<code>configure</code>命令應該工作： 
    <pre>shell&gt; CFLAGS=&quot;-D_XOPEN_XPG4&quot; CXX=gcc CXXFLAGS=&quot;-D_XOPEN_XPG4&quot; \
       ./configure \
           --with-debug --prefix=/usr/local/mysql \
           --with-named-thread-libs=&quot;-lgthreads -lsocket -lgen -lgthreads&quot; \
           --with-named-curses-libs=&quot;-lcurses&quot;
</pre>
    <p>你可能得到一些包括文件的某些問題。在這種情況下，你能在<a HREF="ftp://www.mysql.com/pub/mysql/Downloads/SCO/SCO-3.2v4.2-includes.tar.gz">ftp://www.mysql.com/pub/mysql/Downloads/SCO/SCO-3.2v4.2-includes.tar.gz</a>找到新的SCO特定的包括文件。你應該在你的<strong>MySQL</strong>原始程式樹<tt>的“include”</tt>目錄下打開這個文件。 
    </p>
  </li>
</ol>

<p>SCO開發注意事項： 

<ul>
  <li><strong>MySQL</strong>應該自動地檢測FSU Pthreads並且用<code>-lgthreads 
    -lsocket -lgthreads</code>選項鏈接<code>mysqld</code>。 </li>
  <li>SCO開發庫在FSU Pthreads是重入(reentrant)的。SCO宣稱它的庫函數是重入的，因此他們一定在FSU 
    Pthreads中是重入的。在 OpenServer上的 FSU Pthreads 試圖使用SCO方案制作重入的庫。 
  </li>
  <li>FSU Pthreads(至少在<code>www.mysql.com</code>的版本)鏈接了GNU<code> malloc</code>，如果你甭到內存使用的問題，確定<tt>“gmalloc.o”</tt>被包含在<tt>“libgthreads.a”</tt>和<tt>“libgthreads.so”</tt>中。 
  </li>
  <li>在FSU Pthreads中，下列系統調用是pthreads感知的：<code>read()</code>、<code>write()</code>、<code>getmsg()</code>、<code>connect()</code>、<code>accept()</code>、<code>select()</code>和<code>wait()</code>。 
  </li>
</ul>

<p>如果你想要在SCO上安裝DBI，你必須編輯在DBI-xxx和每個子目錄<tt>下的“Makefiles”</tt>： 
</p>

<pre>OLD:                                  NEW:
CC = cc                               CC = gcc -belf
CCCDLFLAGS = -KPIC -W1,-Bexport       CCCDLFLAGS = -fpic
CCDLFLAGS = -wl,-Bexport              CCDLFLAGS =

LD = ld                               LD = gcc -belf -G -fpic
LDDLFLAGS = -G -L/usr/local/lib       LDDLFLAGS = -L/usr/local/lib
LDFLAGS = -belf -L/usr/local/lib      LDFLAGS = -L/usr/local/lib

LD = ld                               LD = gcc -belf -G -fpic
OPTIMISE = -Od         		      OPTIMISE = -O1

OLD:
CCCFLAGS = -belf -dy -w0 -U M_XENIX -DPERL_SCO5 -I/usr/local/include

NEW:
CCFLAGS = -U M_XENIX -DPERL_SCO5 -I/usr/local/include
</pre>

<p>這時如果他們用<code>icc</code>或<code>cc</code>編譯，Perl動態裝載器(dynaloader)將不裝載<code>DBI</code>模組。 
</p>

<p>當用<code>cc</code>編譯時，Perl工作得最好。 </p>

<h3><a NAME="SCO_Unixware" HREF="manual_toc.html#SCO_Unixware">4.11.14 SCO Unixware 7.0 
注意事項</a></h3>

<p>你必須使用一個最新的<strong>MySQL</strong>版本，至少是3.22.13，因為該版本在Unixware下面解決一些移植性問題。 
</p>

<p>在UnixWare 7.0.1上，我們可用下列<code>configure</code>的命令編譯<strong>MySQL</strong>： 
</p>

<pre>shell&gt; CC=cc CXX=CC ./configure --prefix=/usr/local/mysql
</pre>

<h3><a NAME="IBM-AIX" HREF="manual_toc.html#IBM-AIX">4.11.15 IBM-AIX 注意事項</a></h3>

<p><code>xlC</code>自動檢測從Autoconf丟失，當使用 IBM 
編譯器時，需要如下這樣一個<code>configure</code>命令： </p>

<pre>shell&gt; CC=&quot;xlc_r -ma -O3 -qstrict -DHAVE_INT_8_16_32&quot; \
CXX=&quot;xlC_r -ma -O3 -qstrict -DHAVE_INT_8_16_32&quot; \
./configure
</pre>

<p>如果你正在使用<code>egcs</code>編譯<strong>MySQL</strong>，你<strong>必須</strong>使用<code>-fno-exceptions</code>標誌，因為<code>egcs</code>得異常處理不是對執行緒安全的！（這用<code>egcs</code>1.1被測試過)。在 
AIX 上使用<code>egcs</code>和<code>gcc</code>，我們推薦下列<code>configure</code>行： 
</p>

<pre>shell&gt; CXX=gcc \
       CXXFLAGS=&quot;-felide-constructors -fno-exceptions -fno-rtti&quot; \
       ./configure --prefix=/home/monty --with-debug --with-low-memory
</pre>

<p>如果你用信號問題(<strong>MySQL</strong>出人意料地在高負載下死掉)，你可能發現了與執行緒和信號有關的一個OS錯誤。在這種情況下，你可以用如下配置告訴<strong>MySQL</strong>不使用信號： 
</p>

<pre>shell&gt; CFLAGS=-DDONT_USE_THR_ALARM CXX=gcc \
       CXXFLAGS=&quot;-felide-constructors -fno-exceptions -fno-rtti -DDONT_USE_THR_ALARM&quot; \
       ./configure --prefix=/home/monty --with-debug --with-low-memory
</pre>

<p>這不影響<strong>MySQL</strong>性能，但是有副作用，就是你不能<code>用mysqladmin 
kill</code>或<code>mysqladmin shutdown</code>殺死在一個連接上“睡眠”的客戶。相反，當客戶發出下一個命令時，它將死掉。 
</p>

<p>在 AIX 的一些版本上用libbind.a鏈接使得getservbyname核心傾倒(core dump)，這是AIX的一個bug並且應該被報告到IBM了。 
</p>

<h3><a NAME="HP-UX" HREF="manual_toc.html#HP-UX">4.11.16 HP-UX 注意事項</a></h3>

<p>在 HP-UX 上編譯<strong>MySQL</strong>時，有一些“小”問題。我們推薦您使用<code>gcc</code>而不是HP-UX自己的編譯器，因為<code>gcc</code>產生更好一些的代碼！ 
</p>

<p>我們推薦在HP-UX上使用gcc 2.95，不使用高度最佳化標誌(類似-O6)，因為這在 
HP-UX 上可能不安全。 </p>

<p>注意MIT-pthreads不能用 HP-UX 編譯器編譯，因為它不能編譯<code>.S</code>（匯編器)文件。 
</p>

<p>下列配置行應該工作： </p>

<pre>CFLAGS=&quot;-DHPUX -I/opt/dce/include&quot; CXXFLAGS=&quot;-DHPUX \
-I/opt/dce/include -felide-constructors -fno-exceptions \
-fno-rtti&quot; CXX=gcc ./configure --with-pthread \
--with-named-thread-libs='-ldce' --prefix=/usr/local/mysql --disable-shared
</pre>

<p>如果你正在編譯<code>gcc</code>2.95本身，如果你想要用MIT-pthreads編<strong>譯MySQL</strong>，你不應該用DCE庫(<code>libdce.a</code>或<code>libcma.a</code>)鏈接它。如果你混合DCE和MIT-pthreads包，你將得到一個使得你不能連接的<code>mysqld</code>。當你編譯<code>gcc</code>2.95時，刪除DCE庫！ 
</p>

<h3><a NAME="MaxOSX" HREF="manual_toc.html#MaxOSX">4.11.17 MacOS X 注意事項</a></h3>

<p>順著MacOS X移植的鏈接可以得到能讓<strong>MySQL</strong>載MacOS上工作的資訊，見<a HREF="manual_Introduction.html#Useful_Links">1.8 有用的MySQL相關鏈接</a>。 </p>

<p><strong>MySQL</strong>3.23.7 應該包括所有必要的MacOSX上配置它的修補。然而在配置MySQL前，你必須首先安裝來自<a HREF="http://www.prnet.de/RegEx/mysql.html">MacOSX 的MySql伺服器</a>的pthread 包。 </p>

<p>你可能也想要把一個別名加到你的shell資源文件刈脛便從命令行訪問<code>mysql</code>和<code>mysqladmin</code>。 
</p>

<pre>alias mysql '/usr/local/mysql/bin/mysql'
alias mysqladmin '/usr/local/mysql/libexec/mysqladmin'
</pre>

<h2><a NAME="Win32" HREF="manual_toc.html#Win32">4.12 Win32 注意事項</a></h2>

<p>這節描述在Win32上安裝和使用<strong>MySQL</strong>，這也在<strong>MySQL</strong> 
Win32分發所帶的<tt>“readme”</tt>文件中描述。 </p>

<h3><a NAME="Win32_installation" HREF="manual_toc.html#Win32_installation">4.12.1 在Win32上安裝MySQL</a></h3>

<p>如果你沒有一個註冊的<strong>MySQL</strong>版本，你應該首先下載共享軟件版本，從： 
</p>

<p><a HREF="http://www.mysql.com/mysql_w32.htmy"><strong>MySQL</strong> 3.21.29</a> </p>

<p>如果你準備從一些其他程式連接<strong>MySQL</strong>，你也可能需要<strong>MyODBC</strong>驅動程式。你可在<a HREF="http://www.mysql.com/download.htmy"><strong>MySQL</strong>下載頁</a>找到。 </p>

<p>安裝任何一個分發，在某個空目錄解壓縮它並且運行<code>Setup.exe</code>程式。 
</p>

<p>內定地，<strong>MySQL</strong>-Win32被配置安裝在<tt>“C:\mysql”</tt>。如果你想要在其它地方安裝<strong>MySQL</strong>，在<tt>“C:\mysql”</tt>安裝它，然後將安裝移到你想要的地方。如果你真的移走<strong>MySQL</strong>，你必須通過提供選項給<code>mysqld</code>告訴<code>mysqld</code>那裡的所有一切，使用<code>C:\mysql\bin\mysqld 
--help</code>顯示所有的選項目！例如，如果你移動<strong>MySQL</strong>分發<tt>到“D:\programs\mysql”</tt>，你必須用<code>D:\programs\mysql\bin\mysqld 
--basedir D:\programs\mysql</code>來啟動<code>mysqld。</code></p>

<p>用登記的<strong>MySQL</strong>版本,你也可以創建一個<tt>“C:\my.cnf”</tt>文件來保存用於<strong>MySQL</strong>伺服器的任何內定選項。拷貝文件<tt>“\mysql\my-example.cnf”</tt>到<tt>“C:\my.cnf”</tt>並且編輯它來適用於你的安裝。注意你應該用<code>&quot;/</code>&quot;而不是<code>&quot;\</code>&quot;指定所有的路徑。如果你使用<code>“\</code>”，你需要指定兩次(“\\”)，因為在<strong>MySQL</strong><code>中“\</code>”是轉義字符，見<a HREF="manual_Installing.html#Option_files">4.15.4 選項文件</a>。 </p>

<h3><a NAME="Win95_start" HREF="manual_toc.html#Win95_start">4.12.2 在Win95/Win98上啟動MySQL</a></h3>

<p><strong>MySQL</strong>使用 TCP/IP 
把一個客戶連接到一個伺服器。（這將允許在你的網路上任何機器連接你的<strong>MySQL</strong>伺服器)。因此，你必須在啟動<strong>MySQL</strong>前在你的機器上安裝TCP/IP，你可以在你的Windows 
CDROM上找到TCP/IP 。 </p>

<p>注意：如果你正在使用一個舊的Win95版本(例如OSR2)，很有可能你有一個老的Winsock包！<strong>MySQL</strong>需要Winsock 
2！你可從<a HREF="http://www.microsoft.com">微軟</a>得到最新的Winsock。Win98有新的Winsock 
2庫作為內定，這樣上述不適用於Win98。 </p>

<p>你能使用2個不同的<strong>MySQL</strong>伺服器： </p>

<table BORDER="http://www.microsoft.com" WIDTH="100%" NOSAVE="#101090" class="p3">
  <tr>
    <td><code>mysqld</code> </td>
    <td>用完整調試和自動儲存器分配檢查編譯</td>
  </tr>
  <tr>
    <td><code>mysqld-opt</code> </td>
    <td>對Pentium 處理器最佳化。 </td>
  </tr>
</table>

<p>上面兩個應該在任何 &gt; = i386的Intel處理器上工作&nbsp; 。 </p>

<p>為了啟動<code>mysqld</code>伺服器，你應該啟動一個MSDOS窗口並鍵入： 
</p>

<pre>C:\mysql\bin\mysqld</pre>

<p>這將在一個沒有窗口的背景啟動<code>mysqld</code>。 </p>

<p>你可以這樣殺死<strong>MySQL</strong>伺服器，執行： </p>

<pre>C:\mysql\bin\mysqladmin -u root shutdown</pre>

<p>注意Win95/Win98不支援命名管道的創建。在Win95/Win98上，你只能使用命名管道連接運行在一個NT伺服器上的遠程<strong>MySQL</strong>。 
</p>

<h3><a NAME="NT_start" HREF="manual_toc.html#NT_start">4.12.3 在NT上啟動MySQL</a></h3>

<p>Win95/Win98小節也適用於在NT上的<strong>MySQL</strong>，有下列差別： </p>

<p>為了是<strong>MySQL</strong>用TCP/IP工作，你必須安裝服務包3(service pack 
3)(或更新)！ </p>

<p>對於NT，伺服器名字是<code>mysqld-nt</code>。通常你應該在 NT 上安裝<strong>MySQL</strong>作為一種服務： 
</p>

<pre>
C:\mysql\bin\mysqld-nt --install</pre>

<p>（你可以在 NT 上使用<code>mysqld</code>或<code>mysqld-opt</code>伺服器，但是那些不能作為一種服務啟動或使用命名管道。）</p>

<p>你可以用下列命令啟動和停止<strong>MySQL</strong>服務： </p>

<pre>NET START mysql
NET STOP mysql
</pre>

<p>注意在這種情況下，你不能對<code>mysqld-nt</code>使用任何其他選項! </p>

<p>如果你需要用任何選項啟動<code>mysqld-nt</code>，你也可以作為在NT上的一個獨立程式運行<code>mysqld-nt</code>！如果你在NT上沒有選項啟動<code>mysqld-nt</code>，<code>mysqld-nt</code>嘗試啟動自己作為一種有默認選項的服務。如果你停止了<code>mysqld-nt</code>，你必須用<code>NET 
START mysql</code>啟動它。</p>

<p>服務用<code>MySql</code>名字被安裝，一旦安裝，它必須使用服務控制管理器(SCM)實用程式啟動服務(在控制面板中找到)或使用<code>NET 
START MySQL</code>命令。如果需要任何選項，在你啟動<strong>MySQL</strong>服務前必須作為SCM實用程式的“啟動參數”指定它們。一旦運行，可使用<code>mysqladmin</code>或從SCM實用程式或使用命令<code>NET 
STOP MySQL</code>停止<code>mysqld-nt</code>。如果你使用SCM停止<code>mysqld-nt</code>，SCM有一條關於<code>mysqld 
shutdown normally</code>奇怪的消息，當作為一種服務運行時，<code>mysqld-nt</code>沒有控制台的存取權限，所以沒有消息可以看見。 
</p>

<p>在NT上你可以得到下列服務錯誤消息： </p>

<table BORDER="NT_start" WIDTH="873" NOSAVE="#101090" class="p3">
  <tr>
    <td width="296">Permission Denied （權限拒絕）</td>
    <td width="569">意味著它不能找到<code>mysqld-nt.exe</code> </td>
  </tr>
  <tr>
    <td width="296">Cannot Register （不能登記）</td>
    <td width="569">意味著路徑是不正確的</td>
  </tr>
</table>

<p>如果你作為一種服務安裝<code>mysqld-nt</code>有問題，嘗試用完整的路徑啟動它： 
</p>

<pre>
C:\mysql\bin\mysqld --install</pre>

<p>如果這還不工作，你能通過在註冊表修正路徑使得<code>mysqld-nt</code>正確啟動！ 
</p>

<p>如果你不想作為一種服務啟動<code>mysqld-nt</code>，你可以如下啟動它： 
</p>

<pre>
C:\mysql\bin\mysqld-nt --standalone</pre>

<p>或</p>

<pre>
C:\mysql\bin\mysqld-nt --standalone --debug</pre>

<p>最新的版本在<tt>“C:\mysqld.trace”</tt>給你一個調試蹤跡。 </p>

<h3><a NAME="Win32_running" HREF="manual_toc.html#Win32_running">4.12.4 在 Win32 
上運行 MySQL</a></h3>

<p><strong>MySQL</strong>在所有Win32平台上支援TCP/IP和NT上命名管道。如果客戶安裝了TCP/IP，內定是對NT上的本地連接使用命名管道而對所有其他情形使用TCP/IP，主機名指定使用哪個協議： 
</p>

<table BORDER="Win32_running" WIDTH="100%" NOSAVE="#101090" class="p3">
  <tr>
    <td><strong>主機名</strong> </td>
    <td><strong>協議</strong> </td>
  </tr>
  <tr>
    <td>空 (沒有）</td>
    <td>在NT上，首先嘗試命名管道﹔如果它不工作，使用TCP/IP。在Win95/Win98上，使用TCP/IP。 
    </td>
  </tr>
  <tr>
    <td>. </td>
    <td>命名管道</td>
  </tr>
  <tr>
    <td>localhost</td>
    <td>TCP/IP到當前主機 </td>
  </tr>
  <tr>
    <td>主機名</td>
    <td>TCP/IP </td>
  </tr>
</table>

<p>通過指定命名管道<code>--pipe</code>選項，你可以強制一個<strong>MySQL</strong>客戶使用命名管道。使用<code>--socket</code>選項指定管道的名字。 
</p>

<p>通過執行下列命令，你能測試<strong>MySQL</strong>是否正在工作： </p>

<pre>C:\mysql\bin\mysqlshow
C:\mysql\bin\mysqlshow -u root mysql
C:\mysql\bin\mysqladmin version status proc
C:\mysql\bin\mysql test
</pre>

<p>如果在Win95/Win98上<code>mysqld</code>很慢地回答連接，可能你的DNS有問題。在這種情況中下，用<code>--skip-name-resolve</code>啟動<code>mysqld</code>並且在<strong>MySQL</strong>授權表中僅使用<code>localhost</code>和IP數字。在你連接運行在NT上一個<code>mysqld-nt</code>的<strong>MySQL</strong>伺服器時，使用<code>--pipe</code>指定命名管道使用的參數，你也能避開DNS，對大多數<strong>MySQL</strong>客戶是可行的。 
</p>

<p>有2個版本的<strong>MySQL</strong>命令行工具： </p>

<table BORDER="Win32_running" WIDTH="100%" NOSAVE="#101090" class="p3">
  <tr>
    <td><code>mysql</code> </td>
    <td>用原生Win32編譯，它提供很有有限的文本編輯能力。 </td>
  </tr>
  <tr>
    <td><code>mysqlc</code> </td>
    <td>用Cygnus GNU 編譯器和庫編譯，它提供<code>readline</code>編輯。 </td>
  </tr>
</table>

<p>如果你想使用<code>mysqlc.exe</code>，你必須拷貝<tt>“C:\mysql\lib\cygwinb19.dll”</tt>到<tt>“\windows\system”</tt>（或類似的地方)。 
</p>

<p>在Win32上內定的權限給所有本地用戶以所有資料庫的完全權限。為了使<strong>MySQL</strong>更安全，你應該為每個用戶設置密碼並刪除<code>mysql.user</code>中有<code>Host='localhost'</code>和<code>User=''</code>的行。 
</p>

<p>你也應該為<code>root</code>用戶增加一個密碼：（下列例子通過刪除匿名用戶，允許任何人存取“測試”資料庫）</p>

<pre>C:\mysql\bin\mysql mysql
mysql&gt; DELETE FROM user WHERE Host='localhost' AND User='';
mysql&gt; QUIT
C:\mysql\bin\mysqladmin reload
C:\mysql\bin\mysqladmin -u root password your_password
</pre>

<p>在你設置了密碼以後，如果你想要關掉<code>mysqld</code>伺服器, 
你能使用這個命令做到： </p>

<pre>
mysqladmin -- user=root -- password=your_password  shutdown</pre>

<p>如果你正在使用在windows下的<strong>MySQL</strong>共享軟件版本，上面的命令將以 
<code>parse error near 'SET OPTION password'</code>的錯誤而失敗，這是因為，這是共享軟件版本，它基於MySQL 
3.21，沒有<code>SET PASSWORD</code>命令。 </p>

<p>對共享軟件版本，你能如下設置root用戶密碼： </p>

<pre>C:\mysql\bin\mysql mysql
mysql&gt; UPDATE user SET password=PASSWORD('your password') WHERE user='root';
mysql&gt; QUIT
C:\mysql\bin\mysqladmin reload
</pre>

<p>有註冊的<strong>MySQL</strong>版本，你能很容易地用<code>GRANT</code>和<code>REVOKE</code>命令增加新用戶和更改權限，見<a HREF="manual_Reference.html#GRANT">7.26<code> GRANT</code>和<code>REVOKE</code>句法</a>。對Windows 
的共享軟件版本，必須使用<code>INSERT</code>、<code>UPDATE</code>和<code>DELETE</code>在<code>mysql</code>資料庫中的一個表來管理用戶和他們的權限，見<a HREF="manual_Privilege_system.html#Access_denied">6.13 <code>存取拒絕（Access denied</code>）的錯誤原因</a>。 
</p>

<h3><a NAME="Win32_and_SSH" HREF="manual_toc.html#Win32_and_SSH">4.12.5 用SSH從Win32連接一個遠程MySQL</a></h3>

<p>這是一個關於怎樣用SSH 得到一個安全的連接遠程MySQL伺服器的注意事項(David 
Carlson)。 

<ul>
  <li>在你的windows機器上安裝SSH客戶 - 我使用了一個來自<a HREF="http://www.doc.ic.ac.uk/~ci2/ssh/">http://www.doc.ic.ac.uk/~ci2/ssh/</a>的免費SSH客戶。其他有用的鏈接：<a HREF="http://www.npaci.edu/Security/npaci_security_software.html">http://www.npaci.edu/Security/npaci_security_software.html</a>和<a HREF="http://www.npaci.edu/Security/samples/ssh32_windows/index.html">http://www.npaci.edu/Security/samples/ssh32_windows/index.html</a>. 
  </li>
  <li>啟動SSH。設置主機名字 = 你的MySql伺服器名或IP地址，設置userid=你的用戶名登錄到你的伺服器。</li>
  <li>點擊“local forwords”。設定<code>local port: 3306</code>, <code>host: localhost</code>, 
    <code>remote port: 3306</code> </li>
  <li>保存一切，否則下次你將必須再做一遍。 </li>
  <li>用SSH登錄到你的伺服器。 </li>
  <li>啟動一些ODBC應用程式(例如Access）。</li>
  <li>創造一個新文件並且用ODBC驅動程式鏈接到mySQL，就像你通常做的一樣，除了對伺服器用用戶“localhost”。 
  </li>
</ul>

<p>搞定。它對一個直接的網際網路連接工作得很好。我有些問題，SSH與我的Win95網路和Wingate有衝突 
- 但是那將是張貼在其他軟件公司的用戶組的話題！ </p>

<h3><a NAME="Win32_vs._Unix" HREF="manual_toc.html#Win32_vs._Unix">4.12.6 MySQL-Win32與Unix 
MySQL比較</a></h3>

<p><strong>MySQL</strong>- Win32現在已經証明了自己很穩定。這個版本得<strong>MySQL</strong>有與對應的Unix版本同樣的特徵，除了下面： 

<dl COMPACT="Win32_vs._Unix">
  <dt><strong>Win95和執行緒</strong> </dt>
  <dd>Win95 為每個執行緒的創建損失大約200個字節的內存。因此，如果你進行許多連接，你不應該在Win95運行<code>mysqld</code>很長時間，因為<strong>MySQL</strong>的每個連接都創建一個新執行緒！WinNT和Win98不能容忍這個bug。 
  </dd>
  <dt><strong>阻塞式讀</strong>（blocking read） </dt>
  <dd><strong>MySQL</strong>為每個連接使用一個阻塞式讀取，這意味著： <ul>
      <li>一個連接將不在8個小時後自動被斷開，就像<strong>MySQL</strong>的Unix版本所發生的。 
      </li>
      <li>如果一個連接“掛起”，不殺死<strong>MySQL</strong>就不可能打破它。 
      </li>
      <li><code>mysqladmin kill</code>在一個睡眠的連接上將不工作。 </li>
      <li>只要有睡眠的連接<code>，mysqladmin shutdown</code>不能中途中斷。 </li>
    </ul>
    <p>我們計劃在不久的將來修正它。 </p>
  </dd>
  <dt><strong>UDF函數</strong> </dt>
  <dd>暫時<strong>MySQL</strong>-Win32不支援用戶可定義函數。 </dd>
  <dt><strong><code>DROP DATABASE</code></strong> </dt>
  <dd>你不能拋棄一個正在被某些執行緒使用的資料庫。 </dd>
  <dt><strong>從任務管理器殺死<strong>MySQL</strong></strong></dt>
  <dd>在Windows95上，你不能從任務管理器或用shutdown實用程式殺死<strong>MySQL</strong>。你必須用<code>mysqladmin 
    shutdown</code>關閉它。 </dd>
  <dt><strong>大小寫區分的名字</strong> </dt>
  <dd>文件名在Win32上是忽略大小寫的，因此Win32上的<strong>MySQL</strong>資料庫和表的名字也是忽略大小寫的。唯一的限制是資料庫和表的名字必須在整個一個給定的語句中大小寫是一樣的，因為它用<code>my_table</code>和<code>MY_TABLE</code>都指向同一個表子，下列查詢將不工作： 
    <pre>SELECT * FROM my_table WHERE MY_TABLE.col=1; 
</pre>
  </dd>
  <dt><strong><samp>“ \ ”</samp>目錄字符</strong> </dt>
  <dd>在Win95上的路徑名組成由<samp>“\”</samp>字符分隔，它在<strong>MySQL</strong>中也是轉義字符。如果你正在使用<code>LOAD 
    DATA INFILE</code>或<code>SELECT ... INTO OUTFILE</code>，你必須用兩個<samp>“\”</samp>字符或使用Unix風格的文件名<samp>“/”</samp>字符： 
    <pre>LOAD DATA INFILE &quot;C:\\tmp\\skr.txt&quot; INTO TABLE skr;
SELECT * FROM skr INTO OUTFILE 'C:/tmp/skr.txt';
</pre>
  </dd>
  <dt><strong><code>Can't open named pipe</code>錯誤</strong> </dt>
  <dd>如果你使用NT上的<strong>MySQL</strong>-Win32共享軟件版本，用最新的mysql客戶，你將得到下列錯誤： 
    <pre>error 2017: can't open named pipe to host: . pipe...
</pre>
    <p><a NAME="IDX88"></a>這是因為NT上<strong>MySQL</strong>正式版本內定地使用命名管道。你能通過為新<strong>MySQL</strong>客戶使用<code>--host=localhost</code>選項或創建一個包含下列資訊的文件<tt>“C:\my.cnf”</tt>來避免這個錯誤： 
    </p>
    <pre>[client]
host = localhost
</pre>
  </dd>
  <dt><strong><code>Access denied for user</code>錯誤</strong> </dt>
  <dd>在訪問在同一機器上的一個<strong>MySQL</strong>伺服器時，如果你得到<code>Access 
    denied for user: 'some-user@unknown' to database 'mysql'</code>的錯誤，這意味著<strong>MySQL</strong>不能正確解釋你的主機名。為了修正它，你應該創建一個文件<tt>“\windows\hosts”</tt>，有下列資訊： 
    <pre>
127.0.0.1  localhost</pre>
  </dd>
</dl>

<p>對於可能想要幫助我們做好Win32版本的任何人，這裡有的一些開放的問題： 

<ul>
  <li>制作一個單用戶<code>MYSQL.DLL</code>伺服器。這應該包括一個標準<strong>MySQL</strong>伺服器的一切，除了執行緒創建外。這將使<strong>MySQL</strong>在不需要一個真正的客戶機/伺服器和不需要從其他主機存取伺服器的應用程式時更容易使用。 
  </li>
  <li>為<strong>MySQL</strong>安裝增加一些漂亮的“start”和“shutdown”圖標。 
  </li>
  <li>為<strong>MySQL</strong>啟動選項創建造一個工具管理註冊表條目。註冊表條目的度缺已經被編碼進<code>mysqld.cc</code>，但是它應該重新編碼而更加面向“參數”，該工具應該也能更新<tt>“ 
    \my.cnf”</tt>文件，如果用戶比較喜歡使用它而不是註冊表。 </li>
  <li>當用<code>--install</code>登記<code>mysqld</code>作為一種服務（在 NT 上 )時，如果你也可以在命令行上增加內定選項，它將更好，目前解決辦法是更新<tt>“C:\my.cnf”</tt>文件。 
  </li>
  <li>當你掛起一個運行Win95的筆記電腦時，當筆記電腦被恢復時<code>，mysqld</code>背景執行程式不接受新連接。我們不知道這是否 
    Win95、TCP/IP或<strong>MySQL</strong>的問題。 </li>
  <li>能從任務管理器殺死<code>mysqld</code>將絕對是好事，目前，你必須使用<code>mysqladmin 
    shutdown</code>。</li>
  <li>移植用在 <code>mysql</code>命令行工具<code>的readline</code>到Win32。 </li>
  <li>標準的GUI版本<strong>MySQL</strong>客戶(<code>mysql</code>、<code>mysqlshow</code>、<code>mysqladmin</code>和<code>mysqldump</code>) 
    將更好。 </li>
  <li>如果<tt>在“net.c”</tt>中的套接字“讀”和“寫”函數是可中斷的，那將更好。這將有可能在Win32上用<code>mysqladmin 
    kill</code>殺死打開的執行緒。 </li>
  <li>制作有關哪些Windows程式能工作在<strong>MySQL</strong>-Win32/<strong>MyODBC</strong>和必須做什麼在能讓他們工作的文檔。 
  </li>
  <li><code>mysqld</code>總是在“C”處啟動而不在內定地點，我們想讓<code>mysqld</code>使用當前地點用於排序順序。 
  </li>
  <li>移植<code>sqlclient</code>到Win32(幾乎完成)並加入更多的特徵！ </li>
  <li>把更多的選項加到Mysql Manager。 </li>
  <li>在伺服器和客戶之間改變通訊協議，使用Windows內部通訊而不是套接字和TCP/IP。 
  </li>
  <li>用<code>.DLL</code>實現UDF函數。 </li>
  <li>增加宏以使用由Win32提供的更快的對執行緒安全的增加/減少方法。 </li>
</ul>

<p>其他Win32特定問題在<strong>MySQL</strong>-Win32分發<tt>的“README”</tt>文件中描述。 
</p>

<h2><a NAME="OS_2" HREF="manual_toc.html#OS_2">4.13 OS/2 注意事項</a></h2>

<p><strong>MySQL</strong>使用太多的打開文件。因此，你應該增加類似下面的東西到你的<tt>“CONFIG.SYS”</tt>文件： 
</p>

<pre>SET EMXOPT=-c -n -h1024 </pre>

<p>如果你不這樣做，你將可能碰到下列錯誤： </p>

<pre>File 'xxxx' not found (Errcode: 24) </pre>

<p>當OS/2 Warp 3上使用<strong>MySQL</strong>時，要求FixPack 29或以上。用OS/2 
Wrap 4，要求FixPack 4或以上。這是Pthreads庫的一個要求。<strong>MySQL</strong>必須安裝在支援長文件名的一個分區上，如HPFS、FAT32等等。 
</p>

<p><tt>“INSTALL.CMD”</tt>腳本必須從OS/2'自己的<tt>“CMD.EXE”</tt>運行並且不能工作在替代品如<tt>“4OS2.EXE</tt>”。 
</p>

<p><tt>“scripts/mysql-install-db”</tt>腳本已經被重新命名了：它現在調用<tt>“install.cmd”</tt>並且是一個 
REXX 手跡，將安裝內定的<strong>MySQL</strong>安全配置並為<strong>MySQL</strong>創建WorkPlace 
Shell 圖標。 </p>

<p>動態模組支援通過編譯但沒有充分測試，動態模組應該使用Pthreads運行時刻庫編譯。 
</p>

<pre>gcc -Zdll -Zmt -Zcrtdll=pthrdrtl -I../include -I../regex -I.. \
    -o example udf_example.cc -L../lib -lmysqlclient udf_example.def
mv example.dll example.udf
</pre>

<p><strong>注意：</strong>由於OS/2的限制，UDF模組名字的詞干不能超過8個字符。模組被儲存在<tt>“/mysql2/udf”</tt>目錄﹔<code>safe-mysqld.cmd</code>腳本將把這個目錄放在<code>BEGINLIBPATH</code>環境變數中。當使用UDF模組時，指定的擴展名被忽略--它被假定為<tt>“.udf”</tt>。例如，在 
Unix上，共享模組可能被命名<tt>為“example.so”</tt>並且你可以像這樣從它裝載函數： 
</p>

<pre>CREATE FUNCTION metaphon RETURNS STRING SONAME &quot;example.so&quot;;
</pre>

<pre>正是OS/2，模組將被命名<tt>為“example.udf”</tt>，但是你不指定模組擴展名： </pre>

<pre>CREATE FUNCTION metaphon RETURNS STRING SONAME &quot;example&quot;; </pre>

<h2><a NAME="TcX_binaries" HREF="manual_toc.html#TcX_binaries">4.14 TcX二進制代碼</a></h2>

<p>作為一種服務，TcX提供一套<strong>MySQL</strong>的可執行檔版本，它在TcX或在客戶友好地給與我們訪問他們機器的權限的站點上被編譯。 
</p>

<p>這些分發用<code>scripts/make_binary_distribution</code>產生並且用下列編譯器和選項配置： 

<dl compact>
  <dt>SunOS 4.1.4 2 sun4c with <code>gcc</code> 2.7.2.1 </dt>
  <dd><code>CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql --disable-shared</code> 
  </dd>
  <dt>SunOS 5.5.1 sun4u with <code>egcs</code> 1.0.3a </dt>
  <dd><code>CC=gcc CFLAGS=&quot;-O6 -fomit-frame-pointer&quot; CXX=gcc CXXFLAGS=&quot;-O6 
    -fomit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti&quot; ./configure 
    --prefix=/usr/local/mysql --with-low-memory</code> </dd>
  <dt>SunOS 5.6 sun4u with <code>egcs</code> 2.90.27 </dt>
  <dd><code>CC=gcc CFLAGS=&quot;-O6 -fomit-frame-pointer&quot; CXX=gcc CXXFLAGS=&quot;-O6 
    -fomit-frame-pointer -felide-constructors -fno-exceptions -fno-rtti&quot; ./configure 
    --prefix=/usr/local/mysql --with-low-memory</code> </dd>
  <dt>SunOS 5.6 i86pc with <code>gcc</code> 2.8.1 </dt>
  <dd><code>CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql 
    --with-low-memory</code> </dd>
  <dt>Linux 2.0.33 i386 with <code>pgcc</code> 2.90.29 (<code>egcs</code> 1.0.3a) </dt>
  <dd><code>CFLAGS=&quot;-O6 -mpentium -mstack-align-double -fomit-frame-pointer&quot; CXX=gcc 
    CXXFLAGS=&quot;-O6 -mpentium -mstack-align-double -fomit-frame-pointer 
    -felide-constructors -fno-exceptions -fno-rtti&quot; ./configure --prefix=/usr/local/mysql 
    --enable-assembler --with-mysqld-ldflags=-all-static</code> </dd>
  <dt>SCO 3.2v5.0.4 i386 with <code>gcc</code> 2.7-95q4 </dt>
  <dd><code>CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql</code> </dd>
  <dt>AIX 2 4 with <code>gcc</code> 2.7.2.2 </dt>
  <dd><code>CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql</code> </dd>
  <dt>OSF1 V4.0 564 alpha with <code>gcc</code> 2.8.1 </dt>
  <dd><code>CC=gcc CFLAGS=-O CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql 
    --with-low-memory</code> </dd>
  <dt>Irix 6.3 IP32 with <code>gcc</code> 2.8.0 </dt>
  <dd><code>CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql</code> </dd>
  <dt>BSDI BSD/OS 3.1 i386 with <code>gcc</code> 2.7.2.1 </dt>
  <dd><code>CC=gcc CXX=gcc CXXFLAGS=-O ./configure --prefix=/usr/local/mysql</code> </dd>
  <dt>BSDI BSD/OS 2.1 i386 with <code>gcc</code> 2.7.2 </dt>
  <dd><code>CC=gcc CXX=gcc CXXFLAGS=-O3 ./configure --prefix=/usr/local/mysql</code> </dd>
</dl>

<p>任何有比上述配置更優的選項的人總是能把他們寄給開發者郵件列表中。</p>

<p><strong>MySQL</strong>3.22以前的RPM分發是用戶貢獻的，自3.22開始，一些RPM是TcX 
產生的。 </p>

<h2><a NAME="Post-installation" HREF="manual_toc.html#Post-installation">4.15 
安裝後期的設置和測試</a></h2>

<p>一旦你已經安裝了<strong>MySQL</strong>（從一個二進制代碼或原始碼版本)，你需要初始化授權表，啟動伺服器並且保証伺服器正確運行。你也可以希望安排伺服器在你的系統開機和關機時自動地被啟動和停止。 
</p>

<p>通常，對從原始碼版本的安裝，你像這樣安裝授權表並啟動伺服器： 
</p>

<pre>shell&gt; ./scripts/mysql_install_db
shell&gt; cd mysql_installation_directory
shell&gt; ./bin/safe_mysqld &amp;
</pre>

<p>對可執行檔版本，這樣做： </p>

<pre>shell&gt; cd mysql_installation_directory
shell&gt; ./bin/mysql_install_db
shell&gt; ./bin/safe_mysqld &amp;
</pre>

<p>測試在<strong>MySQL</strong>發行的頂級目錄是最容易進行的。對可執行檔版本，這是你的安裝目錄(典型地類似<tt>“/usr/local/mysql”</tt>)。對原始碼版本，這是你的<strong>MySQL</strong>原始程式樹的主目錄。 
</p>

<p>在本小節和以後的小節中，下列命令中，<code>BINDIR</code>是到程式如<code>mysqladmin</code>和<code>safe_mysqld</code>被安裝地點的路徑。對可執行檔版本，是在分發內<tt>的“bin”</tt>目錄。對原始碼版本，<code>BINDIR</code>可能是<tt>“/usr/local/bin”</tt>，除非在你運行<code>configure</code>時指定了一個<tt>“ 
/usr/local”</tt>以外的安裝目錄。<code>EXECDIR</code>是<code>mysqld</code>伺服器安裝的地點，對可執行檔版本，這與<code>BINDIR</code>一樣。對原始碼版本，<code>EXECDIR</code>可能是<tt>“/usr/local/libexec”</tt>。 
</p>

<p>測試詳細在下面描述： 

<ol>
  <li>如果必要，啟動<code>mysqld</code>伺服器並且建立初始<strong>MySQL</strong>授權表，包含決定用戶如何被允許連接伺服器的權限。這通常用<code>mysql_install_db</code>腳本做： 
    <pre>shell&gt; scripts/mysql_install_db
</pre>
    <p>典型地，<code>mysql_install_db</code>僅在你第一次安裝<strong>MySQL</strong>時需要運行，因此，如果你正在升級現有的安裝，你可以跳過這一步。（然而，<code>mysql_install_db</code>的使用相當安全，並且將不更新已經存在的任何表，因此如果你是不能肯定做什麼，你總是可以運行<code>mysql_install_db</code>。) 
    <code>mysql_install_db</code>在<code>mysql</code>資料庫裡創建6個表(<code>user</code>、<code>db</code>、<code>host</code>、<code>tables_priv</code>、<code>columns_priv</code>和<code>func</code>)，初始權限的描述在<a HREF="manual_Privilege_system.html#Default_privileges">6.10 設置初始MySQL權限</a>給出。簡單地說，這些權限允許<strong>MySQL</strong> 
    <code>root</code>用戶做任何事情，並且允許任何人創建立或使用一個名字以<code>'test'</code>或<code>'test_'</code>開始的資料庫。如果你不設置權限表，當你啟動伺服器時，下列錯誤將在日誌文件出現： 
    <a NAME="IDX89"></a> </p>
    <pre>mysqld: Can't find file: 'host.frm' 
</pre>
    <p>如果你不是通過明顯地執行<code>./bin/safe_mysqld</code>來啟動<strong>MySQL</strong>，上述錯誤可能也發生在<strong>MySQL</strong>可執行檔版本！你可能需要作為<code>root</code>運行<code>mysql_install_db</code>，然而，如果你喜歡， 
    如果用戶能在資料庫目錄讀並且寫文件，你可以作為一個非特權(非--<code>root</code>)用戶運行<strong>MySQL</strong>伺服器。作為一個非特權用戶運行<strong>MySQL</strong>的指令在<a HREF="manual_Problems.html#Changing_MySQL_user">18.8 怎樣作為一個一般用戶運行 
    MySQL</a>中給出。如果你有<code>mysql_install_db</code>的問題，見<a HREF="manual_Installing.html#mysql_install_db">4.15.1 運行<code>mysql_install_db的問題</code></a>。因為<code>mysql_install_db</code>在<strong>MySQL</strong>發行中，還有一些其他方法運行它： 
    <ul>
      <li>你可能想在運行<code>mysql_install_db</code>前編輯它，改變被安裝到授權表中的初始權限。如果你想要在有相同權限的很多機器安裝<strong>MySQL</strong>，這很有用。在這種情況下，你可能應該只需要增加幾個額外的<code>INSERT</code>語句到<code>mysql.user</code>和<code>mysql.db</code>表中！ 
      </li>
      <li>如果你想要在安裝授權表後改變什麼，你可以運行<code>mysql_install_db</code>，然後使用<code>mysql 
        -u root mysql</code>作為<strong>MySQL</strong><code> root</code>用戶連接授權表，發出SQL語句直接修改授權表。 
      </li>
      <li>在已經創建了授權表後，有可能全部再次創建。如果你已經安裝了表但是隨後又想要在編輯<code>mysql_install_db</code>以後再創建，你可能想要這樣做。 
      </li>
    </ul>
    <p>關於這些選項的更多資訊，見<a HREF="manual_Privilege_system.html#Default_privileges">6.10 建立初始MySQL權限</a>。 
    </p>
  </li>
  <li>像這樣啟動<strong>MySQL</strong>伺服器： <pre>shell&gt; cd mysql_installation_directory
shell&gt; bin/safe_mysqld &amp;
</pre>
    <p>如果你啟動伺服器的問題，見<a HREF="manual_Installing.html#Starting_server">4.15.2 
    啟動MySQL伺服器的問題</a>. </p>
  </li>
  <li>使用<code>mysqladmin</code>証實伺服器正在運行。下列命令提供簡單的測試來檢查伺服器啟動和連接的應答： 
    <pre>shell&gt; BINDIR/mysqladmin version 
shell&gt; BINDIR/mysqladmin variables
</pre>
    <pre>從<code>mysqladmin version</code>的輸出根據你的平台和<strong>MySQL</strong>版本略有不同，但是應該類似如下顯示： </pre>
    <pre>shell&gt; BINDIR/mysqladmin version
mysqladmin  Ver 6.3 Distrib 3.22.9-beta, for pc-linux-gnu on i686
TCX Datakonsult AB, by Monty

Server version          3.22.9-beta
Protocol version        10
Connection              Localhost via UNIX socket
TCP port                3306
UNIX socket             /tmp/mysql.sock
Uptime:                 16 sec

Running threads: 1  Questions: 20  Reloads: 2  Open tables: 3
</pre>
    <p>為了感覺你能用<code>BINDIR/mysqladmin</code>做其他事情，用<code>--help</code>選項調用它。 
    </p>
  </li>
  <li>証實你能關掉伺服器： <pre>shell&gt; BINDIR/mysqladmin -u root shutdown
</pre>
  </li>
  <li>証實你能重啟伺服器。使用<code>safe_mysqld</code>或直接調用<code>mysqld</code>進行，例如： 
    <pre>shell&gt; BINDIR/safe_mysqld --log &amp;
</pre>
    <p>如果<code>safe_mysqld</code>失敗，從<strong>MySQL</strong>安裝目錄嘗試運行它(如果你已經不在那裡)。如果還不工作，見<a HREF="manual_Installing.html#Starting_server">4.15.2 啟動MySQL伺服器的問題</a>。 </p>
  </li>
  <li>運行一些簡單的測試証實伺服器正在工作。輸出應該類似於下面所顯示的： 
    <pre>shell&gt; BINDIR/mysqlshow
+-----------+
| Databases |
+-----------+
| mysql     |
+-----------+

shell&gt; BINDIR/mysqlshow mysql
Database: mysql
+--------------+
|    Tables    |
+--------------+
| columns_priv |
| db           |
| func         |
| host         |
| tables_priv  |
| user         |
+--------------+

shell&gt; BINDIR/mysql -e &quot;select host,db,user from db&quot; mysql
+------+--------+------+
| host | db     | user |
+------+--------+------+
| %    | test   |      |
| %    | test_% |      |
+------+--------+------+
</pre>
    <p><tt>在“sql-bench”</tt>目錄(在<strong>MySQL</strong>安裝目錄下)下還有效能測試套件，你能用來比較在不同的平台上<strong>MySQL</strong>表現如何。<tt>“ 
    sql-bench/Results”</tt>目錄包含對不同的資料庫和平台許多運行結果。為了運行所有的測試，執行這些命令： 
    <br>
    </p>
    <pre>shell&gt; cd sql-bench
shell&gt; run-all-tests
</pre>
    <p>如果你沒有<tt>“sql-bench”</tt>目錄，你可能在對可執行檔版本使用一個RPM（原始碼版本的RPM包括效能目錄)。在這種情況下，在你能使用它以前，你必須首先安裝效能套件。從<strong>MySQL</strong> 
    3.22開始，有<tt>名為“mysql-bench-VERSION-i386.rpm”</tt>的效能RPM包，它們包含效能代碼和數據。如果你有原始碼版本，你也可以在<tt>“tests”</tt>子目錄下運行測試。例如，運行<tt>“auto_increment.tst”</tt>，這樣做： 
    </p>
    <pre>shell&gt; BINDIR/mysql -vvf test &lt; ./tests/auto_increment.tst
</pre>
    <p>期望的結果被顯示在<tt>“ ./tests/auto_increment.res”</tt>文件中。 </p>
  </li>
</ol>

<h3><a NAME="mysql_install_db" HREF="manual_toc.html#mysql_install_db">4.15.1 運行<code>mysql_install_db</code>的問題</a></h3>

<p>這節列出在你運行<code>mysql_install_db</code>時，你可能遇見的問題： 

<dl COMPACT="mysql_install_db">
  <dt><strong><code>mysql_install_db</code>不安裝授權表</strong> </dt>
  <dd>在顯示下列消息以後，你可以發現<code>mysql_install_db</code>不能安裝授權表並終止： 
    <pre>starting mysqld daemon with databases from XXXXXX
mysql daemon ended
</pre>
    <p>在這種情況下，你應該很小心地檢驗日誌文件！日誌文件應該位於目錄<tt>“XXXXXX”</tt>，用錯誤消息命名，並且應該指出為什麼<code>mysqld</code>沒啟動。如果你不理解發生的事情，當你使用<code>mysqlbug</code>郵寄一份錯誤報告時，包含日誌文件！見<a HREF="manual_Questions.html#Bug_reports">2.3 怎樣報告錯誤或問題</a>。 </p>
  </dd>
  <dt><strong>已經有一個<code>mysqld</code>背景執行程式在運行</strong> </dt>
  <dd>在這種情況下，你可能根本不必運行<code>mysql_install_db</code>。當你第一次安裝<strong>MySQL</strong>時，你必須只運行<code>mysql_install_db</code>一次。 
  </dd>
  <dt><strong>當一個背景執行程式正在運行時，安裝第二個<code>mysqld</code>背景執行程式不工作</strong> 
  </dt>
  <dd>這只有在當你已經有已存在的<strong>MySQL</strong>安裝但是想要把新安裝放在一個不同的地方時才會發生(例如，為了測試或者也許你簡單地想要同時運行2個安裝)。通常當你試著運行第二個伺服器時，發生的問題是它試圖和舊一個使用同樣的套接字和端口。在這種情況下，你將得到錯誤消息：<code>Can't 
    start server: Bind on TCP/IP port: Address already in use</code>或<code>Can't start 
    server : Bind on unix socket...</code>你能用一個不同的套接字和端口啟動新的伺服器，如下： 
    <a NAME="IDX90"></a> <a NAME="IDX91"></a> <a NAME="IDX92"></a> <a NAME="IDX93"></a> <pre>shell&gt; MYSQL_UNIX_PORT=/tmp/mysqld-new.sock
shell&gt; MYSQL_TCP_PORT=3307
shell&gt; export MYSQL_UNIX_PORT MYSQL_TCP_PORT
shell&gt; scripts/mysql_install_db
shell&gt; bin/safe_mysqld &amp;
</pre>
    <p>在這以後，你應該編輯你的伺服器引導腳本手跡用不同的套接字和端口啟動兩個背景執行程式。例如，它能調用<code>safe_mysqld</code>兩次，但是對每次調用使用不同的<code>--socket</code>、<code>--port</code>和<code>--basedir</code>選項。 
    </p>
  </dd>
  <dt><strong>你沒有<tt>“ /tmp ”</tt>的寫權限</strong> </dt>
  <dd>如果你沒有寫權限在內定地方(在<tt>“/tmp”</tt>裡)創建一個套接字文件，或沒有<tt>在“/tmp”</tt>創建臨時文件的許可，在運行<code>mysql_install_db</code>或當啟動或使用<code>mysqld</code>時，你將得到一個錯誤。你可以如下地指定一個不同的套接字和臨時目錄： 
    <a NAME="IDX94"></a> <a NAME="IDX95"></a> <a NAME="IDX96"></a> <a NAME="IDX97"></a> <pre>shell&gt; TMPDIR=/some_tmp_dir/ 
shell&gt; MYSQL_UNIX_PORT=/some_tmp_dir/mysqld.sock 
shell&gt; export TMPDIR MYSQL_UNIX_PORT
</pre>
    <p><tt>“some_tmp_dir”</tt>應該是你有寫許可的某個目錄的路徑。在這以後，你應該能運行<code>mysql_install_db</code>並且這些命令啟動伺服器： 
    </p>
    <pre>shell&gt; scripts/mysql_install_db
shell&gt; BINDIR/safe_mysqld &amp;
</pre>
  </dd>
  <dt><strong><code>mysqld</code>立刻崩潰</strong> </dt>
  <dd>如果你正在運行RedHat 5.0，有一個比2.0.7-5舊的<code>glibc</code>版本，你應該保証你安裝了<code>glibc</code>所有修補！在<strong>MySQL</strong>郵件檔案中有很多關於它的資訊。郵件檔案的鏈接可在聯機<a HREF="http://www.mysql.com/doc.html"><strong>MySQL</strong>文檔頁</a>得到。也可見<a HREF="manual_Installing.html#Linux">4.11.5 Linux 注意事項(所有Linux版本）</a>。你也可以手工啟動<code>mysqld</code>，使用<code>--skip-grant</code>選項並且增加使用<code>mysql</code>本身的權限資訊： 
    <pre>shell&gt; BINDIR/safe_mysqld --skip-grant &amp;
shell&gt; BINDIR/mysql -u root mysql
</pre>
    <p>從<code>mysql</code>，手工執行在<code>mysql_install_db</code>裡面的SQL命令。保証你隨後運行<code>mysqladmin 
    reload</code>告訴伺服器再裝入授權表。 </p>
  </dd>
</dl>

<h3><a NAME="Starting_server" HREF="manual_toc.html#Starting_server">4.15.2 啟動MySQL伺服器的問題</a></h3>

<p>通常，你用3個方法之一啟動<code>mysqld</code>伺服器： 

<ul>
  <li>通過調用<code>mysql.server</code>。這個腳本主要用於系統啟動和關閉，更全面的描述在<a HREF="manual_Installing.html#Automatic_start">4.15.3 自動啟動和停止MySQL</a>。 </li>
  <li>通過調用<code>safe_mysqld</code>，它試圖為<code>mysqld</code>決定正確的選項並然後用那些選擇運行它。 
  </li>
  <li>通過直接調用<code>mysqld</code>。 </li>
</ul>

<p>無論你使用哪個方法啟動伺服器，如果它沒有正確啟動，檢查日誌文件看你是否能發現為什麼。日誌文件位於數據目錄(對可執行檔版本一般是<tt>“/usr/local/mysql/data”</tt>，對原始碼版本<tt>是“/usr/local/var”</tt>)。用<tt>“host_name.err”</tt>和<tt>“host_name.log”</tt>形式的名字在數據目錄下查找文件，這裡<code>host_name</code>是你伺服器主機的名字，然後檢查這些文件的最後幾行： 
</p>

<pre>shell&gt; tail host_name.err
shell&gt; tail host_name.log
</pre>

<p>當<code>mysqld</code>背景執行程式啟動時，它把目錄改變到數據目錄。這是它期望寫日誌文件和pid(進程ID)文件的地方，和它期望在那兒找到資料庫。 
</p>

<p>數據目錄地點是在分發編譯時定死的。然而，如果<code>mysqld</code>期望它在你的系統上其他某個地方找到數據目錄，它將工作不正常。如果你有不正確路徑的問題，你可使用<code>--help</code>選項調用<code>mysqld</code>，找到<code>mysqld</code>允許什麼選項和內定路徑設置是什麼。你能通過指定正確的路徑作為<code>mysqld</code>命令行參數來覆蓋內定值。（這些選擇也能用於<code>safe_mysqld</code>。）</p>

<p>通常你應該只需要告訴<code>mysqld</code>基本目錄，在它下面安裝<strong>MySQL</strong>。你可以用<code>--basedir</code>選項做到，你也能使用<code>--help</code>檢查改變路徑選項的效果(注意，<code>--help</code><em>必須</em>是<code>mysqld</code>命令的最後選項)。例如： 
</p>

<pre>shell&gt; EXECDIR/mysqld --basedir=/usr/local --help
</pre>

<p>一旦你確定你想要的路徑設置，不用<code>--help</code>選項啟動伺服器。 
</p>

<p>如果你得到下列錯誤，它意味著<code>mysqld</code>正在試圖使用某些其他程式(或其他<code>mysqld</code>伺服器)已經正在使用TCP/IP端口或套接字： 
</p>

<pre>Can't start server: Bind on TCP/IP port: Address already in use
  或
Can't start server : Bind on unix socket...
</pre>

<p>使用<code>ps</code>保証你沒有另外一個<code>mysqld</code>伺服器正在運行。如果你不能發現其他運行的伺服器，你可以嘗試執行命令<code>telnet 
your-host-name tcp-ip-port-number</code>並且按幾次<code>RETURN</code>鍵，如果你沒有得到一個錯誤消息，像<code>telnet: 
Unable to connect to remote host: Connection refused</code>，某個東西正在使用<code>mysqld</code>正在試圖使用的TCP/IP端口，見<a HREF="manual_Installing.html#mysql_install_db">4.15.1 運行<code>mysql_install_db</code>的問題</a>和<a HREF="manual_Common_problems.html#Multiple_servers">19.3 在同一台機器上運行多個MySQL伺服器</a>。 
</p>

<p><code>safe_mysqld</code>腳本被編寫以便能正常地啟動一個從<strong>MySQL</strong>原始程式或二進制代碼版本安裝的伺服器，就算這些在稍微不同的地點安裝伺服器。<code>safe_mysqld</code>希望這些條件之一是真的： 

<ul>
  <li>伺服器和資料庫能在相對<code>safe_mysqld</code>被調用的目錄下找到。<code>safe_mysqld</code>在它的工作目錄下面找<tt>“bin”</tt>和<tt>“data”</tt>目錄(對可執行檔版本)或<tt>“libexec”</tt>和<tt>“var”</tt>目錄(對原始碼版本)。如果你從你的<strong>MySQL</strong>安裝目錄(例如，對可執行檔版本<tt>為“/usr/local/mysql”</tt>)執行<code>safe_mysqld</code>，這個條件應該滿足。</li>
  <li>如果伺服器和資料庫不能在相對其工作目錄找到，<code>safe_mysqld</code>試圖通過絕對路徑找到他們。典型的地點是<tt>“ 
    /usr/local/libexec”</tt>和<tt>“/usr/local/var”</tt>。實際的地點在構造來自分發的<code>safe_mysqld</code>時確定，如果<strong>MySQL</strong>安裝在一個標準的地點，他們應該是正確的。 
  </li>
</ul>

<p>因為<code>safe_mysqld</code>將試圖在相對它自己的工作目錄下找到伺服器和資料庫，你可以在任何地方安裝<strong>MySQL</strong>的可執行檔版本，只要你從<strong>MySQL</strong>安裝目錄啟動<code>safe_mysqld</code>即可： 
</p>

<pre>shell&gt; cd mysql_installation_directory
shell&gt; bin/safe_mysqld &amp;
</pre>

<p>如果<code>safe_mysqld</code>失敗，甚至在從<strong>MySQL</strong>安裝目錄調用時，你可以修改它以便使用到<code>mysqld</code>路徑並且對你的系統的路徑選項是正確的。注意，如果在將來你升級<strong>MySQL</strong>，你的<code>safe_mysqld</code>修改版本將被覆蓋，因此你應該做一個你能重新安裝的編輯過的版本的拷貝。 
</p>

<p>如果<code>mysqld</code>當前正在運行，通過執行這個命令，你能發現它正在使用什麼路徑設置： 
</p>

<pre>shell&gt; mysqladmin variables

或

shell&gt; mysqladmin -h 'your-host-name' variables
</pre>

<p>如果<code>safe_mysqld</code>啟動伺服器但是你不能與它連接，你應該保証你在<tt>“/etc/hosts”</tt>裡面有一個條目，看起來像這樣： 
</p>

<pre>
127.0.0.1  localhost</pre>

<p>這個問題僅發生在沒有一個能工作的執行緒庫的系統上並且對該系統<strong>MySQL</strong>必須配置為使用MIT-pthreads。 
</p>

<h3><a NAME="Automatic_start" HREF="manual_toc.html#Automatic_start">4.15.3 
自動啟動和停止MySQL</a></h3>

<p><code>mysql.server</code>腳本可以被用來啟動或停止伺服器，通過用<code>start</code>或<code>stop</code>參數調用它： 
</p>

<pre>shell&gt; mysql.server start
shell&gt; mysql.server stop
</pre>

<p><code>mysql.server</code>可在<strong>MySQL</strong>安裝目錄下的<tt>“share/mysql”</tt>目錄裡找到，或在<strong>MySQL</strong>原始程式樹的<tt>“support-files”</tt>目錄下找到。 
</p>

<p>在<code>mysql.server</code>啟動伺服器之前，它把目錄改變到<strong>MySQL</strong>安裝目錄，然後調用<code>safe_mysqld</code>。如果你有在一個非標準的地點安裝的可執行檔版本，你可能需要編輯<code>mysql.server</code>。修改它，運行<code>safe_mysqld</code>前，<code>cd</code>到正確的目錄。如果你想要作為一些特定的用戶運行伺服器，你可以改變<code>mysql_daemon_user=root</code>行使用其他用戶，你也能修改<code>mysql.server</code>把其他選項傳給<code>safe_mysqld</code>。 
</p>

<p><code>mysql.server stop</code>通過向伺服器發出一個信號停止它。你可手工執行<code>mysqladmin 
shutdown</code>關閉伺服器。 </p>

<p>當你開始使用<strong>MySQL</strong>作為生產應用時，你可能想要增加這些啟動並且停止命令到在你的<tt>“/etc/rc 
* </tt>文件中適當的地方。注意如果你修改<code>mysql.server</code>，那麼如果某個時候你升級<strong>MySQL</strong>時，你的修改版本將被覆蓋，因此你應該做一個你可重新安裝的編輯過的版本的拷貝。 
</p>

<p>如果你的系統使用<tt>“/etc/rc.local”</tt>啟動外部腳本，你應該添加下列到其中： 
</p>

<pre>/bin/sh -c 'cd /usr/local/mysql ; ./bin/safe_mysqld &amp;' </pre>

<p>你也可以在一個全局<tt>“/etc/my.cnf”</tt>文件中增加<code>mysql.server</code>的選項。一個典型<tt>的“/etc/my.cnf”</tt>文件可能看起來像這樣： 
</p>

<pre>mysqld]
datadir=/usr/local/mysql/var
socket=/tmp/mysqld.sock
port=3306

[mysql.server]
user=mysql
basedir=/usr/local/mysql
</pre>

<pre><code>mysql.server</code>腳本使用下列變數：<code>user</code>、<code>datadir</code>、<code>basedir</code>、<code>bindir</code>和<code>pid-file</code>。 </pre>

<p>見<a HREF="manual_Installing.html#Option_files">4.15.4 選項文件</a>。 </p>

<h3><a NAME="Option_files" HREF="manual_toc.html#Option_files">4.15.4 選項文件</a></h3>

<p><strong>MySQL</strong>3.22 
可以從選項文件中為伺服器和客戶讀取內定啟動選項。 </p>

<p>在Unix上，<strong>MySQL</strong>從下列文件讀取內定選擇： </p>

<p><a NAME="IDX100"></a></p>

<table BORDER="IDX100" WIDTH="873" NOSAVE="#101090" class="p3">
  <tr>
    <td width="289"><strong>文件名</strong> </td>
    <td width="576"><strong>用途</strong> </td>
  </tr>
  <tr>
    <td width="289"><code>/etc/my.cnf</code> </td>
    <td width="576">全局選項</td>
  </tr>
  <tr>
    <td width="289"><code>DATADIR/my.cnf</code> </td>
    <td width="576">伺服器特定的選項目</td>
  </tr>
  <tr>
    <td width="289"><code>~/.my.cnf</code> </td>
    <td width="576">用戶特定的選項</td>
  </tr>
</table>

<p><code>DATADIR</code>是<strong>MySQL</strong>的數據目錄(典型地對二進制安裝<tt>是“/usr/local/mysql/data”</tt>或對原始程式安裝<tt>是“/usr/local/var”</tt>)。注意：這是在配置時間指定的目錄，不是<code>mysqld</code>啟動時用<code>--datadir</code>指定的目錄！(<code>--datadir</code>在伺服器尋找選項文件的地方無效，因為它以前尋找他們，它處理任何命令行參數。）</p>

<p><strong>MySQL</strong>在Win32上從下列文件讀取內定選項： </p>

<table BORDER="IDX100" WIDTH="873" NOSAVE="#101090" class="p3">
  <tr>
    <td width="476"><strong>文件名</strong> </td>
    <td width="389"><strong>用途</strong></td>
  </tr>
  <tr>
    <td width="476"><code>windows-system-directory\my.ini</code> </td>
  </tr>
  <tr>
    <td width="476"><code>C:\my.cnf</code> </td>
    <td width="389">全局選項</td>
  </tr>
  <tr>
    <td width="476"><code>C:\mysql\data\my.cnf</code> </td>
    <td width="389">伺服器特定的選項</td>
  </tr>
</table>

<p>注意，在Win32上你應該用<code>/</code>而不是<code>\</code>指定所有的路徑，如果你使用<code>\</code>，你需要指定兩個，因為在<strong>MySQL</strong>裡面<code>\</code>是轉義字符。 
</p>

<p><a NAME="IDX101"></a><strong>MySQL</strong>試圖以上述所列的順序讀取選項文件。如果存在多個選項文件，在一個後面文件讀取的選項優先於在先前讀取的一個文件中指定的同一個選項，在命令行上指定的選項優先於在任何選項文件指定了的選項。有些選擇能使用環境變數指定，在命令行或在選項文件指定的選項優先於環境變數。 
</p>

<p>下列程式支援選項文件：<code>mysql</code>、<code>mysqladmin</code>、<code>mysqld</code>、<code>mysqldump</code>、<code>mysqlimport</code>、<code>mysql.server</code>、<code>myisamchk</code>和<code>myisampack</code>。 
</p>

<p>你能使用選項文件指定一個程式支援的任意長的選項！用<code>--help</code>選項運行程式可得到的可用選項的表。 
</p>

<p>一個選項文件可以包含下列形式的行： 

<dl COMPACT="IDX101">
  <dt><code>#comment</code> </dt>
  <dd>注釋行以<samp>“#”</samp>或<samp>“;”</samp>開始，空行被忽略。 </dd>
  <dt><code>[group]</code> </dt>
  <dd><code>group</code>是你想為其設置選項的程式或組的名字。在一個組行後，任何<code>option</code>或<code>set-variable</code>行應用於命名的組，直到選擇文件結束或其他組的給出。 
  </dd>
  <dt><code>option</code> </dt>
  <dd>這等價於在命令行上的<code>--option</code>。 </dd>
  <dt><code>option=value</code> </dt>
  <dd>這等價於在命令行上的<code>--option=value</code>。 </dd>
  <dt><code>set-variable = variable=value</code> </dt>
  <dd>這等價於在命令行上的<code>--set-variable variable=value</code>。該語法必須被用來設置一個<code>mysqld</code>變數。 
  </dd>
</dl>

<p><code>client</code>組允許你指定適用於所有<strong>MySQL</strong>客戶的選項(不是<code>mysqld</code>)。這是理想的組來指定你用來與伺服器連接的密碼。（但是保証只是選項文件本身是可讀的和可寫的。）</p>

<p>注意，對域選項和值，所有頭部和尾部空白自動被刪除。你可以在的值串中使用轉義順序<samp>“\b”</samp>、<samp>“\t”</samp>、<samp>“\n”</samp>、<samp>“\r”</samp>、<samp>“\\”</samp>和<samp>“\s”</samp>(<samp>“\s”</samp>==空白)。 
</p>

<p>這是一個典型的全局選項文件： </p>

<pre>[client] 
port=3306 
socket=/tmp/mysql.sock </pre>

<pre>
[mysqld] 
port=3306 
socket=/tmp/mysql.sock 
set-variable = key_buffer=16M 
set-variable = max_allowed_packet=1M 
</pre>

<pre>[mysqldump] 
quick 
</pre>

<p>這是典型的用戶選項文件： </p>

<pre>[client]
# The following password will be sent to all standard MySQL clients
password=my_password

[mysql]
no-auto-rehash
</pre>

<p><a NAME="IDX102"></a>如果你有一個原始碼版本，你將在<tt>“support-files”</tt>目錄下找到一個名<tt>為“my-example.cnf”</tt>樣品配置文件。如果你有可執行檔版本，在<tt>“DIR/share/mysql”</tt>目錄下查找，在此<code>DIR</code>是<strong>MySQL</strong>安裝目錄的路徑(一般是<tt>“/usr/local/mysql”</tt>)。你可以拷貝<tt>“my-example.cnf”</tt>到你的主目錄(重新命名拷貝為<tt>“.my.cnf”</tt>)來試驗。 
</p>

<p>為了告訴一個<strong>MySQL</strong>程式不讀任何選項文件，在命令行上指定<code>--no-defaults</code>作為第一個選項。這<strong>必須</strong>是第一個選項，否則它將無效！如果你想檢查使用哪個選項，你可以給出<code>--print-defaults</code>選項作為第一個選項。 
</p>

<p>如果你想要強制使用一個特定配置文件，你可以使用選項<code>--defaults-file=full-path-to-default-file</code>。如果你這樣做，只有指定的文件將被讀取。 
</p>

<p>開發者注意：選項文件的處理簡單地通過處理所有在任何命令行前參數的匹配選項來實現(即，在適當的組裡的選項)，這對使用多次指定的一個選項的最後實例的程式工作的很好。如果你有這樣一個處理多重指定選項但不讀選項文件的舊程式， 
你只需要增加2行給與它那種能力。檢查任何標準的<strong>MySQL</strong>客戶的原始程式看怎樣做。 
</p>

<h2><a NAME="Upgrade" HREF="manual_toc.html#Upgrade">4.16 升級/降級MySQL時有什麼特別的事情要做？</a></h2>

<p>只要你有<strong>MySQL</strong>同一個的基礎版本，你總可以在同樣的體系結構上的不同版本之間的移動<strong>MySQL</strong>表格(form)和數據文件。當前的基礎版本是3。如果你通過重新編譯<strong>MySQL</strong>改變字符集（也可以改變排序順序)，你必須在所有的表上運行<code>myisamchk 
-r -q</code>，否則你的索引不能正確被排序。 </p>

<p>如果你偏執於或擔心新版本，你總能重新命名的舊<code>mysqld</code>為類似於<code>mysqld</code>-'old-version-number'。那麼如果你的新<code>mysqld</code>做一些意外的事情，你可以簡單地關掉它並重啟你的舊<code>mysqld</code>！ 
</p>

<p>當你做一個升級時，當然你也應該備份你的舊資料庫。有時有點偏執狂是好的！ 
</p>

<p>在升級後，如果你重新編譯客戶程遇到問題，像<code>Commands out of 
sync</code>或意外的核心傾倒，在編譯你的程式時，你可能使用了一個舊的頭文件或庫文件。在這種情況下，你應該檢查你的<tt>“mysql.h”</tt>文件和<tt>“libmysqlclient.a”</tt>庫文件的日期以証實他們來自新的<strong>MySQL</strong>發行。如果不是，請重新編譯你的程式！ 
</p>

<p>如果你有些問題，新的<code>mysqld</code>伺服器不想啟動或你不能沒有密碼連接，檢查你確實沒有來自你的舊安裝的一些舊<tt>的“my.cnf”</tt>文件！你可以用<code>program-name 
--print-defaults</code>檢查。如果這輸出任何非程式名字的任何東西，你有一個活躍<code>my.cnf</code>文件將可以影響一些事情！ 
</p>

<p>無論何時你安裝一個新版本的<strong>MySQL</strong>，重新構造並重新安裝<code>Msql-Mysql-modules</code>分發是一個好主意，特別是在升級<strong>MySQL</strong>後，如果你注意到諸如你的所有<code>DBI</code>腳本傾倒核心症狀。 
</p>

<p><a NAME="IDX103"></a></p>

<h3><a NAME="Upgrading-from-3.22" HREF="manual_toc.html#Upgrading-from-3.22">4.16.1 
從一個3.22版本升級到3.23</a></h3>

<p><strong>MySQL</strong> 3.23支援新<code>MyISAM</code>類型和舊<code>ISAM</code>類型的表。你不必須變換你的舊式表給3.23使用。內定地，所有的新表將用類型<code>MyISAM</code>創建（除非你使用<code>--default-table-type=isam</code>選項啟動<code>mysqld</code>）。你可以用<code>ALTER 
TABLE</code>或Perl腳本<code>mysql_convert_table_format</code>將一個<code>ISAM</code>表轉換成一個<code>MyISA表</code>。 
</p>

<p>3.22和3.21客戶將毫無問題地與一個3.23伺服器一起工作。 </p>

<p>當升級到3.23時，下面列出你必須注意的事情： 

<ul>
  <li><code>INNER</code>和<code>DELAYED</code>現在是保留字。 </li>
  <li><code>FLOAT(X)</code>現在是一個真正的浮點類型。 </li>
  <li>當聲明<code>DECIMAL(length,dec)</code>時，長度參數不再包括一個符號或小數點位置。 
  </li>
  <li>一個<code>TIME</code>字符串必須是下列現有格式之一：<code>[[[DAYS] 
    [H]H:]MM:]SS[.fraction]</code>或<code>[[[[[H]H]H]H]MM]SS[.fraction]</code>。 </li>
  <li><code>現在，LIKE</code>使用<code>'='</code>同樣的字符比較規則比較字符串。如果你要求舊的行為，你可以用<code>CXXFLAGS=-DLIKE_CMP_TOUPPER</code>標誌編以<strong>MySQL</strong>。 
  </li>
  <li><code>REGEXP</code>現在對正常(不是二進制的)字符串是忽略大小寫的。 </li>
  <li>在你檢查/修復表時，對<code>MyISAM</code>表(<code>.MYI</code>)，你應該使用<code>myisamchk</code>，而對ISAM(<code>.ISM</code>)表使用<code>isamchk</code>。 
  </li>
  <li>如果你想要你的<code>mysqldump</code>s在<strong>MySQL</strong>3.22和3.23之間兼容，你應該不使用<code>mysqldump</code>的<code>--opt</code>或<code>--full</code>選項。 
  </li>
  <li>檢查所有對<code>DATE_FORMAT()</code>的調用，保証在在每個格式字符前有一個<samp>“%”</samp>。 
  </li>
  <li><code>mysql_fetch_fields_direct</code>現在是函數(它以前是一個宏)並且它返回一個指向<code>MYSQL_FIELD</code>的指針而不是一個<code>MYSQL_FIELD</code>。 
  </li>
  <li><code>mysql_num_fields()</code>可以不再被用在一個<code>MYSQL*</code>對像上(它現在是一個函數，拿<code>MYSQL_RES*</code>作為一個參數）。相反你現在應該使用<code>mysql_field_count()</code>。 
  </li>
  <li>在<code>MySQL</code>3.22，<code>SELECT DISTINCT ...</code>的輸出幾乎總是被排序的。在3.23上，你必須使用<code>GROUP 
    BY</code>或<code>ORDER BY</code>獲得排序的輸出。 </li>
  <li>如果沒有匹配的行<code>，SUM()</code>現在返回<code>NULL</code>，而不是 0。這是遵照ANSI 
    SQL。 </li>
  <li>新的限制詞：<code>CASE、THEN、WHEN、ELSE和END</code>。 </li>
</ul>

<p><a NAME="IDX104"></a> </p>

<h3><a NAME="Upgrading-from-3.21" HREF="manual_toc.html#Upgrading-from-3.21">4.16.2 
從一個3.21版本升級到3.22</a></h3>

<p>沒有影響相容性的東西在3.21和3.22之間已改變。唯一的缺陷是用<code>DATE</code>類類型創建的新表將使用新方法儲存日期。你不能從一個<code>mysqld</code>舊版本存取這些新字段。 
</p>

<p>在安裝<strong>MySQL</strong>3.22 
以後，你應該啟動新的伺服器並且然後運行<code>mysql_fix_privilege_tables</code>腳本。這將增加你使用<code>GRANT</code>命令所需的新權限。如果你忘記了這個，當你試著使用<code>ALTER 
TABLE</code>, <code>CREATE INDEX</code>或<code>DROP INDEX</code>時，你將得到<code>Access 
denied</code>。如果你的<strong>MySQL</strong>根用戶要求一個密碼，你應該把它作為一個參數給<code>mysql_fix_privilege_tables</code>。 
</p>

<p><code>mysql_real_connect()</code>的C API介面改變了。如果你有一個舊的客戶程式調用該函數，你必須放一個<code>0</code>作為新<code>db</code>參數(或為了快速連接重新編碼發送的<code>db</code>單元的客戶)。你在<code>mysql_real_connect()</code>前也必須調用<code>mysql_init()</code>！做這個改變允許新的<code>mysql_options()</code>函數在<code>MYSQL</code>處理程式結構中保存選項。 
</p>

<h3><a NAME="Upgrading-from-3.20" HREF="manual_toc.html#Upgrading-from-3.20">4.16.3 
從一個3.20版本升級到3.21</a></h3>

<p>如果你正在運行一個比3.20.28舊的版本並且想要換到3.21.x，你需要做下列事情： 
</p>

<p>你能用<code>safe_mysqld --old-protocol</code>啟動<code>mysqld</code>3.21伺服器從3.20分發的客戶使用它。在這種情況下，新客戶函數<code>mysql_errno()</code>將不返回任何伺服器錯誤，而僅僅是<code>CR_UNKNOWN_ERROR</code>(但是它為客戶錯誤服務)並且伺服器使用舊的passwd() 
檢查而非新的一個。 </p>

<p>如果你在<strong>而不是</strong>對<code>mysqld</code>使用<code>--old-protocol</code>選項，你將需要做下列改變： 

<ul>
  <li>所有的客戶代碼必須重新編譯。如果你正在使用ODBC，你必須得到新的<strong>MyODBC</strong> 
    2.x驅動程式。 </li>
  <li>腳本<code>scripts/add_long_password</code>必須運行以便變換在<code>mysql.user</code>表中的<code>Password</code>字段為<code>CHAR(16)</code>。 
  </li>
  <li>所有在<code>mysql.user</code>中的密碼必須被重新賦值(為了得到62位而非31位密碼)。 
  </li>
  <li>表格式沒變化，因此你不必須變換任何表。 </li>
</ul>

<p><strong>MySQL</strong>3.20.28和以上版本可以處理新的<code>user</code>表格式而不影響客戶。如果你有一個比3.20.28早的<strong>MySQL</strong>版本，如果你變換<code>user</code>表，密碼將不再與之工作。因此為了安全，你首先應該升級到至少3.20.28並且然後升級到3.21.x。</p>

<p><a NAME="IDX105"></a>新的客戶代碼可與一個3.20.x 版的<code>mysqld</code>伺服器一起工作，因此如果你遇到3.21.x的問題，你可以使用舊的3.20.x伺服器而無須重新編譯客戶。 
</p>

<p>如果你對<code>mysqld</code>不使用<code>--old-protocol</code>選項，舊的客戶將發出錯誤消息： 
</p>

<pre>ERROR: Protocol mismatch. Server Version = 10 Client Version = 9
</pre>

<p>新的Perl<code> DBI</code>/<code>DBD</code>介面也支援舊的<code>mysqlperl</code>介面。如果你使用<code>mysqlperl</code>，你必須做的唯一改變是改變到<code>connect()</code>函數的參數。新參數是：<code>host</code>、<code>database</code>、<code>user</code>、<code>password</code>（<code>user</code>和<code>password</code>參數改變了位置)。見<a HREF="manual_Clients.html#Perl_DBI_Class">20.5.2 <code>DBI</code>介面</a>。 </p>

<p>下列變化可能影響到舊的應用程式的查詢： 

<ul>
  <li>現在<code>HAVING</code>必須在任何<code>ORDER BY</code>子句前被指定。 </li>
  <li><code>LOCATE()</code>參數被交換了。 </li>
  <li>有一些新的保留字。最著名是<code>DATE</code>、<code>TIME</code>和<code>TIMESTAMP</code>。 
  </li>
</ul>

<h3><a NAME="Upgrading-to-arch" HREF="manual_toc.html#Upgrading-to-arch">4.16.4 
升級到其他體系結構</a></h3>

<p>如果你正在使用<strong>MySQL</strong>3.23，你能在不同的支援同樣浮點格式的體系結構之間拷貝<code>.frm</code>、<code>.MYI</code>和<code>.MYD</code>。(<strong>MySQL</strong>考慮了任何字節交換的問題)。 
</p>

<p><strong>MySQL</strong> <code>ISAM</code>數據<tt>“ *.ISD”</tt>和索引文件<tt>“ 
*.ISM</tt>”文件是依賴於系統結構並在某些情況下依賴於OS。如果你想要移動你的應用程式到有與你當前系統不同的體系結構或OS的其他機器上，你不應該試圖通過簡單地拷貝文件到另外的機器上來移動一個資料庫，相反使用<code>mysqldump</code>。 
</p>

<p>內定地，<code>mysqldump</code>將創建一個滿是SQL語句的文件，然後你可以把文件轉移到其他機器上並且把它作為<code>mysql</code>客戶的輸入。 
</p>

<p>試一試<code>mysqldump --help</code>看可得到什麼選項。如果你正在移動數據到一個更新的<strong>MySQL</strong>版本，你應該用得到的更新的版本使用<code>mysqldump 
--opt</code>得到一個快速、緊湊的倒出(dump)。 </p>

<p>最容易(盡管不是最快)的在2台機器之間移動一個資料庫的方法是在資料庫所在的機器上運行下列命令： 
</p>

<pre>shell&gt; mysqladmin -h 'other hostname' create db_name
shell&gt; mysqldump --opt db_name \
        | mysql -h 'other hostname' db_name
</pre>

<p>如果你想要在一個慢的網路上從一台遠程機器上拷貝一個資料庫，你可以使用： 
</p>

<pre>shell&gt; mysqladmin create db_name 
shell&gt; mysqldump -h 'other hostname' --opt --compress db_name \ 
	| mysql db_name
</pre>

<p>你也可以在一個文件中儲存結果, 
然後把文件轉移到目標機器並且在那裡裝載文件到資料庫。例如，你能像這樣在源機器上傾倒一個資料庫到一個文件： 
</p>

<pre>shell&gt; mysqldump --quick db_name | gzip &gt; db_name.contents.gz 
</pre>

<p>（本例創建的文件被壓縮) 
轉移包含資料庫內容的文件到目標機器，並且在那裡運行這些命令： 
</p>

<pre>shell&gt; mysqladmin create db_name
shell&gt; gunzip &lt; db_name.contents.gz | mysql db_name
</pre>

<p><a NAME="IDX106"></a><a NAME="IDX107"></a>你也可以使用<code>mysqldump</code>和<code>mysqlimport</code>完成資料庫轉移。對大資料庫表，這比簡單地使用<code>mysqldump</code>更快。在下列命令中，<code>DUMPDIR</code>代表你用來儲存來自<code>mysqldump</code>的輸出的目錄的完整的路徑。 
</p>

<p>首先，為輸出文件和傾倒資料庫創建目錄： </p>

<pre>shell&gt; mkdir DUMPDIR
shell&gt; mysqldump --tab=DUMPDIR db_name
</pre>

<p>然後轉移在<code>DUMPDIR</code>目錄下的文件到目標機器的一些相應目錄並且在那裡裝載文件到<strong>MySQL</strong>： 
</p>

<pre>shell&gt; mysqladmin create db_name           # create database
shell&gt; cat DUMPDIR/*.sql | mysql db_name   # create tables in database
shell&gt; mysqlimport db_name DUMPDIR/*.txt   # load data into tables
</pre>

<p>另外，別忘記拷貝<code>mysql</code>資料庫，因為那是授權表(<code>user</code>、<code>db</code>、host)被儲存的地方。你可能必須作為<strong>MySQL</strong> 
<code>root</code>用戶在新機器上運行命令，直到你讓<code>mysql</code>資料庫到位。 
</p>

<p>當你在新機器上導入<code>mysql</code>資料庫後，執行<code>mysqladmin 
flush-privileges</code>以便伺服器再次裝入授權表資訊。 </p>

<p><a NAME="IDX108"></a> </p>

<hr>

<p><a HREF="manual_Introduction.html">第一章</a>, <a href="manual_Licensing_and_Support.html">前一章</a>, <a HREF="manual_Compatibility.html">下一章</a>, <a HREF="manual_Concept_Index.html">最後一章</a>，<a HREF="manual_toc.html">目錄</a>. </p>
</body>
</html>
