<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Chapter 20. MySQL Cluster</title><link rel="stylesheet" href="mysql-html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.69.1"><link rel="start" href="index.html" title="MySQL 5.1 Reference Manual"><link rel="up" href="index.html" title="MySQL 5.1 Reference Manual"><link rel="prev" href="replication.html" title="Chapter 19. Replication"><link rel="next" href="partitioning.html" title="Chapter 21. Partitioning"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter 20. MySQL Cluster</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="replication.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="partitioning.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="mysql-cluster"></a>Chapter 20. MySQL Cluster</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-overview">20.1. MySQL Cluster Overview</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-basics">20.1.1. MySQL Cluster Core Concepts</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-nodes-groups">20.1.2. MySQL Cluster Nodes, Node Groups, Replicas, and Partitions</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-computer">20.2. Simple Multi-Computer How-To</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-hardware-software-network">20.2.1. Hardware, Software, and Networking</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-install">20.2.2. Multi-Computer Installation</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-config">20.2.3. Multi-Computer Configuration</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-initial">20.2.4. Initial Startup</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-load-data-queries">20.2.5. Loading Sample Data and Performing Queries</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-shutdown-restart">20.2.6. Safe Shutdown and Restart</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-configuration">20.3. MySQL Cluster Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-building">20.3.1. Building MySQL Cluster from Source Code</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-installing">20.3.2. Installing the Cluster Software</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-quick">20.3.3. Quick Test Setup of MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-config-file">20.3.4. Configuration File</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-config-params-overview">20.3.5. Overview of Cluster Configuration Parameters</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-config-lcp-params">20.3.6. Configuring Parameters for Local Checkpoints</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-options-variables">20.4. MySQL Cluster Options and Variables</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-option-tables">20.4.1. MySQL Cluster Server Option and Variable Reference</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-mysqld-command-options">20.4.2. MySQL Cluster-Related Command Options for <span><strong class="command">mysqld</strong></span></a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-system-variables">20.4.3. MySQL Cluster System Variables</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-status-variables">20.4.4. MySQL Cluster Status Variables</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-upgrade-downgrade">20.5. Upgrading and Downgrading MySQL Cluster</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-rolling-restart">20.5.1. Performing a Rolling Restart of the Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-upgrade-downgrade-compatibility">20.5.2. MySQL Cluster 5.1 and MySQL Cluster NDB 6.x Upgrade and Downgrade
      Compatibility</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-process-management">20.6. Process Management in MySQL Cluster</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-mysqld-process">20.6.1. MySQL Server Process Usage for MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-ndbd-process">20.6.2. <span><strong class="command">ndbd</strong></span> — The Storage Engine Node Process</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-ndb-mgmd-process">20.6.3. <span><strong class="command">ndb_mgmd</strong></span> — The Management Server Process</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-ndb-mgm-process">20.6.4. <span><strong class="command">ndb_mgm</strong></span> — The Management Client Process</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-command-options">20.6.5. Command Options for MySQL Cluster Processes</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-management">20.7. Management of MySQL Cluster</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-start-phases">20.7.1. Summary of MySQL Cluster Start Phases</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-mgm-client-commands">20.7.2. Commands in the MySQL Cluster Management Client</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-event-reports">20.7.3. Event Reports Generated in MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-logs-ndb-messages">20.7.4. <code class="literal">NDB</code> Log Messages</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-single-user-mode">20.7.5. Single User Mode</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-sql-statements">20.7.6. Quick Reference: MySQL Cluster SQL Statements</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-security">20.8. MySQL Cluster Security Issues</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-security-networking-issues">20.8.1. MySQL Cluster Security and Networking Issues</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-security-mysql-privileges">20.8.2. MySQL Cluster and MySQL Privileges</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-security-mysql-security-procedures">20.8.3. MySQL Cluster and MySQL Security Procedures</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-backup">20.9. On-line Backup of MySQL Cluster</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-backup-concepts">20.9.1. Cluster Backup Concepts</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-backup-using-management-client">20.9.2. Using The Management Client to Create a Backup</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-restore">20.9.3. <span><strong class="command">ndb_restore</strong></span> — Restore a Cluster Backup</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-backup-configuration">20.9.4. Configuration for Cluster Backup</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-backup-troubleshooting">20.9.5. Backup Troubleshooting</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities">20.10. Cluster Utility Programs</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-config">20.10.1. <span><strong class="command">ndb_config</strong></span> — Extract NDB Configuration Information</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-cpcd">20.10.2. <span><strong class="command">ndb_cpcd</strong></span> — Automate Testing for NDB Development</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-delete-all">20.10.3. <span><strong class="command">ndb_delete_all</strong></span> — Delete All Rows from NDB Table</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-desc">20.10.4. <span><strong class="command">ndb_desc</strong></span> — Describe NDB Tables</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-drop-index">20.10.5. <span><strong class="command">ndb_drop_index</strong></span> — Drop Index from NDB Table</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-drop-table">20.10.6. <span><strong class="command">ndb_drop_table</strong></span> — Drop NDB Table</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-error-reporter">20.10.7. <span><strong class="command">ndb_error_reporter</strong></span> — NDB Error-Reporting Utility</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-print-backup-file">20.10.8. <span><strong class="command">ndb_print_backup_file</strong></span> — Print NDB Backup File Contents</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-print-schema-file">20.10.9. <span><strong class="command">ndb_print_schema_file</strong></span> — Print NDB Schema File Contents</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-print-sys-file">20.10.10. <span><strong class="command">ndb_print_sys_file</strong></span> — Print NDB System File Contents</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndbd-redo-log-reader">20.10.11. <span><strong class="command">ndbd_redo_log_reader</strong></span> — Check and Print Content of Cluster Redo Log</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-select-all">20.10.12. <span><strong class="command">ndb_select_all</strong></span> — Print Rows from NDB Table</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-select-count">20.10.13. <span><strong class="command">ndb_select_count</strong></span> — Print Row Counts for NDB Tables</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-show-tables">20.10.14. <span><strong class="command">ndb_show_tables</strong></span> — Display List of NDB Tables</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-size">20.10.15. <span><strong class="command">ndb_size.pl</strong></span> — NDBCLUSTER Size Requirement Estimator</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-waiter">20.10.16. <span><strong class="command">ndb_waiter</strong></span> — Wait for Cluster to Reach a Given Status</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication">20.11. MySQL Cluster Replication</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-abbreviations">20.11.1. Abbreviations and Symbols</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-general">20.11.2. Assumptions and General Requirements</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-issues">20.11.3. Known Issues in MySQL Cluster Replication</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-schema">20.11.4. Cluster Replication Schema and Tables</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-preparation">20.11.5. Preparing the Cluster for Replication</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-starting">20.11.6. Starting Replication (Single Replication Channel)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-two-channels">20.11.7. Using Two Replication Channels</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-failover">20.11.8. Implementing Failover with MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-backups">20.11.9. MySQL Cluster Backups With Replication</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-conflict-resolution">20.11.10. MySQL Cluster Replication Conflict Resolution</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-disk-data">20.12. MySQL Cluster Disk Data Tables</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-disk-data-objects">20.12.1. Disk Data Objects</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-disk-data-storage-requirements">20.12.2. Disk Data Storage Requirements</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-disk-data-parameters">20.12.3. Disk Data Configuration Parameters</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-interconnects">20.13. Using High-Speed Interconnects with MySQL Cluster</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-sci-sockets">20.13.1. Configuring MySQL Cluster to use SCI Sockets</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-interconnects-performance">20.13.2. MySQL Cluster Interconnects and Performance</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations">20.14. Known Limitations of MySQL Cluster</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-syntax">20.14.1. Non-Compliance In SQL Syntax</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-limits">20.14.2. Limits and Differences from Standard MySQL Limits</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-transactions">20.14.3. Limits Relating to Transaction Handling</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-error-handling">20.14.4. Error Handling</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-database-objects">20.14.5. Limits Associated with Database Objects</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-unsupported-missing">20.14.6. Unsupported Or Missing Features</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-performance">20.14.7. Limitations Relating to Performance</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-exclusive-to-cluster">20.14.8. Issues Exclusive to MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-disk-data">20.14.9. Limitations Relating to Disk Data Storage</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-multiple-nodes">20.14.10. Limitations Relating to Multiple Cluster Nodes</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-resolved">20.14.11. Previous MySQL Cluster Issues Resolved in MySQL 5.1</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-roadmap">20.15. MySQL Cluster Development Roadmap</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-changes-5-1">20.15.1. Features Added in MySQL 5.1 Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-changes-5-1-ndb-6-1">20.15.2. Features Added in MySQL Cluster NDB 6.1</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-changes-5-1-ndb-6-2">20.15.3. Features Added in MySQL Cluster NDB 6.2</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-changes-5-1-ndb-6-3">20.15.4. Features Added in MySQL Cluster NDB 6.3</a></span></dt></dl></dd><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-glossary">20.16. MySQL Cluster Glossary</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news">20.17. Changes in MySQL Cluster 6.x</a></span></dt><dd><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-6-3">20.17.1. Changes in MySQL Cluster NDB 6.3</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-6-2">20.17.2. Changes in MySQL Cluster NDB 6.2</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-6-1">20.17.3. Changes in MySQL Cluster NDB 6.1</a></span></dt></dl></dd></dl></div><a class="indexterm" name="id2321443"></a><a class="indexterm" name="id2321452"></a><a class="indexterm" name="id2321464"></a><p>
    This chapter contains information about <em class="firstterm">MySQL
    Cluster</em>, which is a high-availability, high-redundancy
    version of MySQL adapted for the distributed computing environment,
    using the <code class="literal">NDB</code> (also known as
    <code class="literal">NDBCLUSTER</code>) storage engine to enable running
    several MySQL servers in a cluster.
  </p><p>
    This storage engine is available in MySQL 5.1 binary
    releases through MySQL 5.1.23, including RPMs compatible with most
    modern Linux distributions. Beginning with MySQL 5.1.24, standard
    MySQL server binaries built by MySQL no longer provide support for
    the <code class="literal">NDBCLUSTER</code> storage engine. Instead, users of
    MySQL Cluster binaries built by MySQL should upgrade to MySQL
    Cluster NDB 6.2.15 (or a later MySQL Cluster release) which includes
    binary releases for supported platforms, including RPMs that should
    work with most Linux distributions. MySQL Cluster users who build
    from source should be aware that, also beginning with MySQL 5.1.24,
    <code class="literal">NDBCLUSTER</code> sources in the standard MySQL 5.1 tree
    are no longer maintained; these users should upgrade using the MySQL
    Cluster NDB 6.2.15, 6.3.16, or a later MySQL Cluster NDB 6.2 or 6.3
    source release.
  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
      MySQL Cluster NDB 6.1, 6.2, and 6.3 were formerly known as
      “<span class="quote">MySQL Cluster Carrier Grade Edition</span>”. Beginning with
      MySQL Cluster NDB 6.2.15 and MySQL Cluster NDB 6.3.14, this term
      is no longer applied to the MySQL Cluster software — which
      is now known simply as “<span class="quote">MySQL Cluster</span>” — but
      rather to a commercial licensing and support package. You can
      learn more about available options for commerical licensing of
      MySQL Cluster from
      <em class="citetitle"><a href="http://mysql.com/products/database/cluster/features.html" target="_top">MySQL
      Cluster Features</a></em>, on the MySQL web site.
    </p></div><p>
    This chapter contains information about MySQL Cluster in MySQL 5.1
    mainline releases through MySQL 5.1.23, MySQL Cluster NDB 6.2
    releases through 5.1.24-ndb-6.2.16, and MySQL Cluster NDB
    6.3 releases through 5.1.24-ndb-6.3.17. It also contains
    historical information about the MySQL Cluster NDB 6.1 series,
    although this series is no longer in active development.
  </p><a class="indexterm" name="id2321564"></a><p><b>Platforms supported. </b>
      MySQL Cluster is currently available and supported on a number of
      platforms, including Linux, Solaris, Mac OS X, HP-UX, and other
      Unix-style operating systems on a variety of hardware. For exact
      levels of support available for on specific combinations of
      operating system versions, operating system distributions, and
      hardware platforms, please refer to the
      <em class="citetitle"><a href="http://www.mysql.com/support/supportedplatforms/cluster.html" target="_top">Cluster
      Supported Platforms list</a></em>, maintained by the
      MySQL Support Team on the MySQL web site.

      </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
          MySQL Cluster is <span class="emphasis"><em>not</em></span> currently supported
          on Microsoft Windows. We are working to make Cluster available
          on all operating systems supported by MySQL, including
          Windows, and will update the information provided here as this
          work continues.
        </p></div><p>
    </p><p><b>Availability. </b>
      MySQL Cluster NDB 6.2 binary and source packages are available for
      supported platforms from
      <a href="http://dev.mysql.com/downloads/cluster" target="_top">http://dev.mysql.com/downloads/cluster</a>.

      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          Binary releases and RPMs are not available for MySQL Cluster
          NDB 6.2 prior to MySQL Cluster NDB 6.2.15.
        </p></div><p>

      MySQL Cluster NDB 6.3 is currently available only as source.
      Source tarballs for the latest MySQL Cluster NDB 6.3 release can
      be obtained from <a href="ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/" target="_top">ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/</a>.
    </p><p><b>MySQL Cluster versioning. </b>
      Starting with MySQL Cluster NDB 6.1 and 6.2, MySQL Cluster follows
      a somewhat different release pattern from the mainline MySQL 5.1
      Cluster series of releases. Each MySQL Cluster release is
      identified by a two-part version string, which is displayed by
      <code class="literal">SELECT VERSION()</code> in the
      <span><strong class="command">mysql</strong></span> client, as shown here:

</p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysql</code></strong>
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 2
Server version: 5.1.24-ndb-6.2.16-debug Source distribution

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.

mysql&gt; <strong class="userinput"><code>SELECT VERSION();</code></strong>
+-------------------------+
| VERSION()               |
+-------------------------+
| 5.1.24-ndb-6.2.16-debug |
+-------------------------+
1 row in set (0.00 sec)
</pre><p>

      This version string is also displayed in the output from the
      <span><strong class="command">ndb_mgm</strong></span> client's <code class="literal">SHOW</code>
      command:

</p><pre class="programlisting">ndb_mgm&gt; <strong class="userinput"><code>SHOW</code></strong>
Connected to Management Server at: localhost:1186
Cluster Configuration
---------------------
[ndbd(NDB)]     2 node(s)
id=1    @10.0.10.6  (mysql-5.1.24 ndb-6.2.15, Nodegroup: 0, Master)
id=2    @10.0.10.8  (mysql-5.1.24 ndb-6.2.15, Nodegroup: 0)

[ndb_mgmd(MGM)] 1 node(s)
id=3    @10.0.10.2  (mysql-5.1.24 ndb-6.2.15)

[mysqld(API)]   2 node(s)
id=4    @10.0.10.10  (mysql-5.1.24 ndb-6.2.15)
id=5 (not connected, accepting connect from any host)
</pre><p>

      The version string identifies the mainline MySQL version from
      which the MySQL Cluster release was branched and the version of
      the <code class="literal">NDB</code> storage engine used. For example, the
      full version string for MySQL Cluster NDB 6.1.15 (the first MySQL
      Cluster NDB 6.2 binary release, as shown in the preceding
      examples) is <code class="literal">mysql-5.1.24 ndb-6.2.15</code>. From this
      we can determine the following information:

      </p><div class="itemizedlist"><ul type="disc"><li><p>
            The portion of the version string preceding
            <code class="literal">ndb</code> is the MySQL Server base version.
            This means that MySQL Cluster NDB 6.2.15 derives from the
            MySQL 5.1.24, and contains all feature enhancement and
            bugfixes from MySQL 5.1 up to and including MySQL 5.1.24.
          </p></li><li><p>
            The portion of the version string following
            <code class="literal">ndb-</code> represents the version number of the
            <code class="literal">NDB</code> (or <code class="literal">NDBCLUSTER</code>)
            storage engine. MySQL Cluster NDB 6.2.15 uses version 6.2.15
            of the <code class="literal">NDB</code> storage engine.
          </p></li></ul></div><p>
    </p><p><b>MySQL Cluster development source trees. </b>
      MySQL Cluster development trees can also be accessed via
      <a href="https://code.launchpad.net/~mysql/" target="_top">https://code.launchpad.net/~mysql/</a>:

      </p><div class="itemizedlist"><ul type="disc"><li><p>
            <code class="literal"><a href="https://code.launchpad.net/~mysql/mysql-server/mysql-5.1-telco-6.1" target="_top">MySQL
            Cluster NDB 6.1</a></code>
          </p></li><li><p>
            <code class="literal"><a href="https://code.launchpad.net/~mysql/mysql-server/mysql-5.1-telco-6.2" target="_top">MySQL
            Cluster NDB 6.2</a></code>
          </p></li><li><p>
            <code class="literal"><a href="https://code.launchpad.net/~mysql/mysql-server/mysql-5.1-telco-6.2" target="_top">MySQL
            Cluster NDB 6.3</a></code>
          </p></li></ul></div><p>

      The MySQL Cluster development sources maintained at
      <a href="https://code.launchpad.net/~mysql/" target="_top">https://code.launchpad.net/~mysql/</a> are
      GPL-licensed. For information about obtaining MySQL sources using
      Bazaar and building them yourself, see
      <a href="installing.html#installing-source-tree" title="2.9.3. Installing from the Development Source Tree">Section 2.9.3, “Installing from the Development Source Tree”</a>.
    </p><p>
    Currently, MySQL Cluster NDB 6.2 and MySQL Cluster NDB 6.3 are both
    under active development, with the 6.2 series now available in
    source and binary format and 6.3 as source only. MySQL Cluster NDB
    6.4 is beginning to be developed internally and is intended for
    testing purposes. MySQL Cluster NDB 6.1 is no longer in active
    development. For an overview of major features added in MySQL
    Cluster, see <a href="mysql-cluster.html#mysql-cluster-roadmap" title="20.15. MySQL Cluster Development Roadmap">Section 20.15, “MySQL Cluster Development Roadmap”</a>.
  </p><p>
    This chapter represents a work in progress, and its contents are
    subject to revision as MySQL Cluster continues to evolve. Additional
    information regarding MySQL Cluster can be found on the MySQL AB Web
    site at <a href="http://www.mysql.com/products/cluster/" target="_top">http://www.mysql.com/products/cluster/</a>.
  </p><a class="indexterm" name="id2321879"></a><p><b>Additional resources. </b>
      More information may be found in the following places:

      </p><div class="itemizedlist"><ul type="disc"><li><p>
            Answers to some commonly asked questions about Cluster may
            be found in the <a href="faqs.html#faqs-mysql-cluster" title="A.10. MySQL 5.1 FAQ — MySQL Cluster">Section A.10, “MySQL 5.1 FAQ — MySQL Cluster”</a>.
          </p></li><li><p>
            The MySQL Cluster mailing list:
            <a href="http://lists.mysql.com/cluster" target="_top">http://lists.mysql.com/cluster</a>.
          </p></li><li><p>
            The MySQL Cluster Forum:
            <a href="http://forums.mysql.com/list.php?25" target="_top">http://forums.mysql.com/list.php?25</a>.
          </p></li><li><p>
            Many MySQL Cluster users and some of the MySQL Cluster
            developers blog about their experiences with Cluster, and
            make feeds of these available through
            <a href="http://www.planetmysql.org/" target="_top">PlanetMySQL</a>.
          </p></li><li><p>
            If you are new to MySQL Cluster, you may find our Developer
            Zone article
            <em class="citetitle"><a href="http://dev.mysql.com/tech-resources/articles/mysql-cluster-for-two-servers.html" target="_top">
            How to set up a MySQL Cluster for two
            servers</a></em> to be helpful.
          </p></li></ul></div><p>
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-overview"></a>20.1. MySQL Cluster Overview</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-basics">20.1.1. MySQL Cluster Core Concepts</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-nodes-groups">20.1.2. MySQL Cluster Nodes, Node Groups, Replicas, and Partitions</a></span></dt></dl></div><a class="indexterm" name="id2321978"></a><p>
    <em class="firstterm">MySQL Cluster</em> is a technology that enables
    clustering of in-memory databases in a shared-nothing system. The
    shared-nothing architecture allows the system to work with very
    inexpensive hardware, and with a minimum of specific requirements
    for hardware or software.
  </p><p>
    MySQL Cluster is designed not to have any single point of failure.
    For this reason, each component is expected to have its own memory
    and disk, and the use of shared storage mechanisms such as network
    shares, network filesystems, and SANs is not recommended or
    supported.
  </p><p>
    MySQL Cluster integrates the standard MySQL server with an in-memory
    clustered storage engine called <code class="literal">NDB</code>. In our
    documentation, the term <code class="literal">NDB</code> refers to the part of
    the setup that is specific to the storage engine, whereas
    “<span class="quote">MySQL Cluster</span>” refers to the combination of MySQL and
    the <code class="literal">NDB</code> storage engine.
  </p><p>
    A MySQL Cluster consists of a set of computers, each running one or
    more processes which may include a MySQL server, a data node, a
    management server, and (possibly) specialized data access programs.
    The relationship of these components in a cluster is shown here:
  </p><div class="mediaobject"><img src="images/cluster-components-1.png" alt="MySQL Cluster Components"></div><p>
    All these programs work together to form a MySQL Cluster. When data
    is stored in the <code class="literal">NDBCLUSTER</code> storage engine, the
    tables are stored in the data nodes. Such tables are directly
    accessible from all other MySQL servers in the cluster. Thus, in a
    payroll application storing data in a cluster, if one application
    updates the salary of an employee, all other MySQL servers that
    query this data can see this change immediately.
  </p><p>
    The data stored in the data nodes for MySQL Cluster can be mirrored;
    the cluster can handle failures of individual data nodes with no
    other impact than that a small number of transactions are aborted
    due to losing the transaction state. Because transactional
    applications are expected to handle transaction failure, this should
    not be a source of problems.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-basics"></a>20.1.1. MySQL Cluster Core Concepts</h3></div></div></div><a class="indexterm" name="id2322090"></a><a class="indexterm" name="id2322102"></a><a class="indexterm" name="id2322114"></a><a class="indexterm" name="id2322127"></a><a class="indexterm" name="id2322140"></a><a class="indexterm" name="id2322152"></a><a class="indexterm" name="id2322165"></a><a class="indexterm" name="id2322181"></a><a class="indexterm" name="id2322197"></a><a class="indexterm" name="id2322213"></a><a class="indexterm" name="id2322229"></a><a class="indexterm" name="id2322241"></a><a class="indexterm" name="id2322254"></a><a class="indexterm" name="id2322266"></a><a class="indexterm" name="id2322278"></a><p>
      <em class="firstterm"><code class="literal">NDB</code></em> is an in-memory
      storage engine offering high-availability and data-persistence
      features.
    </p><p>
      The <code class="literal">NDB</code> storage engine can be configured with a
      range of failover and load-balancing options, but it is easiest to
      start with the storage engine at the cluster level. MySQL
      Cluster's <code class="literal">NDB</code> storage engine contains a
      complete set of data, dependent only on other data within the
      cluster itself.
    </p><p>
      The cluster portion of MySQL Cluster is currently configured
      independently of the MySQL servers. In a MySQL Cluster, each part
      of the cluster is considered to be a <em class="firstterm">node</em>.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        In many contexts, the term “<span class="quote">node</span>” is used to
        indicate a computer, but when discussing MySQL Cluster it means
        a <span class="emphasis"><em>process</em></span>. It is possible to run any number
        of nodes on a single computer, for which we use the term
        <em class="firstterm">cluster host</em>.
      </p></div><p>
      (However, it should be noted MySQL does not currently support the
      use of multiple data nodes on a single computer in a production
      setting. See
      <a href="mysql-cluster.html#mysql-cluster-limitations-multiple-nodes" title="20.14.10. Limitations Relating to Multiple Cluster Nodes">Section 20.14.10, “Limitations Relating to Multiple Cluster Nodes”</a>.)
    </p><p>
      There are three types of cluster nodes, and in a minimal MySQL
      Cluster configuration, there will be at least three nodes, one of
      each of these types:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          <em class="firstterm">Management node</em> (MGM node): The role of
          this type of node is to manage the other nodes within the
          MySQL Cluster, performing such functions as providing
          configuration data, starting and stopping nodes, running
          backup, and so forth. Because this node type manages the
          configuration of the other nodes, a node of this type should
          be started first, before any other node. An MGM node is
          started with the command <span><strong class="command">ndb_mgmd</strong></span>.
        </p></li><li><p>
          <em class="firstterm">Data node</em>: This type of node stores
          cluster data. There are as many data nodes as there are
          replicas, times the number of fragments. For example, with two
          replicas, each having two fragments, you will need four data
          nodes. It is not necessary to have more than one replica. A
          data node is started with the command <span><strong class="command">ndbd</strong></span>.
        </p></li><li><p>
          <em class="firstterm">SQL node</em>: This is a node that accesses
          the cluster data. In the case of MySQL Cluster, an SQL node is
          a traditional MySQL server that uses the <code class="literal">NDB
          Cluster</code> storage engine. An SQL node is typically
          started with the command <span><strong class="command">mysqld
          --ndbcluster</strong></span> or by using <span><strong class="command">mysqld</strong></span>
          with the <code class="literal">ndbcluster</code> option added to
          <code class="filename">my.cnf</code>.
        </p><p>
          An SQL node is actually just a specialised type of
          <em class="firstterm">API node</em>, which designates any
          application which accesses Cluster data. One example of an API
          node is the <span><strong class="command">ndb_restore</strong></span> utility that is
          used to restore a cluster backup. It is possible to write such
          applications using the <a href="http://dev.mysql.com/doc/ndbapi/en/index.html" target="_top">NDB API</a>.
        </p></li></ul></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        It is not realistic to expect to employ a three-node setup in a
        production environment. Such a configuration provides no
        redundancy; in order to benefit from MySQL Cluster's
        high-availability features, you must use multiple data and SQL
        nodes. The use of multiple management nodes is also highly
        recommended.
      </p></div><p>
      For a brief introduction to the relationships between nodes, node
      groups, replicas, and partitions in MySQL Cluster, see
      <a href="mysql-cluster.html#mysql-cluster-nodes-groups" title="20.1.2. MySQL Cluster Nodes, Node Groups, Replicas, and Partitions">Section 20.1.2, “MySQL Cluster Nodes, Node Groups, Replicas, and Partitions”</a>.
    </p><p>
      Configuration of a cluster involves configuring each individual
      node in the cluster and setting up individual communication links
      between nodes. MySQL Cluster is currently designed with the
      intention that data nodes are homogeneous in terms of processor
      power, memory space, and bandwidth. In addition, to provide a
      single point of configuration, all configuration data for the
      cluster as a whole is located in one configuration file.
    </p><p>
      The management server (MGM node) manages the cluster configuration
      file and the cluster log. Each node in the cluster retrieves the
      configuration data from the management server, and so requires a
      way to determine where the management server resides. When
      interesting events occur in the data nodes, the nodes transfer
      information about these events to the management server, which
      then writes the information to the cluster log.
    </p><p>
      In addition, there can be any number of cluster client processes
      or applications. These are of two types:
    </p><div class="itemizedlist"><ul type="disc"><li><p><b>Standard MySQL clients. </b>
            These are no different for MySQL Cluster than they are for
            standard (non-Cluster) MySQL. In other words, MySQL Cluster
            can be accessed from existing MySQL applications written in
            PHP, Perl, C, C++, Java, Python, Ruby, and so on.
          </p></li><li><p><b>Management clients. </b>
            These clients connect to the management server and provide
            commands for starting and stopping nodes gracefully,
            starting and stopping message tracing (debug versions only),
            showing node versions and status, starting and stopping
            backups, and so on.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-nodes-groups"></a>20.1.2. MySQL Cluster Nodes, Node Groups, Replicas, and Partitions</h3></div></div></div><a class="indexterm" name="id2322546"></a><a class="indexterm" name="id2322558"></a><a class="indexterm" name="id2322571"></a><a class="indexterm" name="id2322583"></a><a class="indexterm" name="id2322592"></a><a class="indexterm" name="id2322601"></a><p>
      This section discusses the manner in which MySQL Cluster divides
      and duplicates data for storage.
    </p><p>
      Central to an understanding of this topic are the following
      concepts, listed here with brief definitions:
    </p><div class="itemizedlist"><ul type="disc"><li><p><b>(Data) Node. </b>
            An <span><strong class="command">ndbd</strong></span> process, which stores a
            <em class="firstterm">replica</em> —that is, a copy of the
            <em class="firstterm">partition</em> (see below) assigned to the
            node group of which the node is a member.
          </p><p>
          Each data node should be located on a separate computer. While
          it is also possible to host multiple <span><strong class="command">ndbd</strong></span>
          processes on a single computer, such a configuration is not
          supported.
        </p><p>
          It is common for the terms “<span class="quote">node</span>” and “<span class="quote">data
          node</span>” to be used interchangeably when referring to an
          <span><strong class="command">ndbd</strong></span> process; where mentioned, management
          (MGM) nodes (<span><strong class="command">ndb_mgmd</strong></span> processes) and SQL
          nodes (<span><strong class="command">mysqld</strong></span> processes) are specified as
          such in this discussion.
        </p></li><li><p><b>Node Group. </b>
            A node group consists of one or more nodes, and stores
            partitions, or sets of <em class="firstterm">replicas</em> (see
            next item).
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            All node groups in a cluster must have the same number of
            nodes.
          </p></div></li><li><p><b>Partition. </b>
            This is a portion of the data stored by the cluster. There
            are as many cluster partitions as nodes participating in the
            cluster. Each node is responsible for keeping at least one
            copy of any partitions assigned to it (that is, at least one
            replica) available to the cluster.
          </p><p>
          A replica belongs entirely to a single node; a node can (and
          usually does) store several replicas.
        </p></li><li><p><b>Replica. </b>
            This is a copy of a cluster partition. Each node in a node
            group stores a replica. Also sometimes known as a
            <em class="firstterm">partition replica</em>. The number of
            replicas is equal to the number of nodes per node group.
          </p></li></ul></div><p>
      The following diagram illustrates a MySQL Cluster with four data
      nodes, arranged in two node groups of two nodes each; nodes 1 and
      2 belong to node group 0, and nodes 3 and 4 belong to node group
      1. Note that only data (<span><strong class="command">ndbd</strong></span>) nodes are shown
      here; although a working cluster requires an
      <span><strong class="command">ndb_mgm</strong></span> process for cluster management and at
      least one SQL node to access the data stored by the cluster, these
      have been omitted in the figure for clarity.
    </p><div class="mediaobject"><img src="images/replicas-groups-1-1.png" alt="A MySQL Cluster, with 2 node groups having 2
        nodes each"></div><p>
      The data stored by the cluster is divided into four partitions,
      numbered 0, 1, 2, and 3. Each partition is stored — in
      multiple copies — on the same node group. Partitions are
      stored on alternate node groups:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          Partition 0 is stored on node group 0; a <em class="firstterm">primary
          replica</em> (primary copy) is stored on node 1, and a
          <em class="firstterm">backup replica</em> (backup copy of the
          partition) is stored on node 2.
        </p></li><li><p>
          Partition 1 is stored on the other node group (node group 1);
          this partition's primary replica is on node 3, and its backup
          replica is on node 4.
        </p></li><li><p>
          Partition 2 is stored on node group 0. However, the placing of
          its two replicas is reversed from that of Partition 0; for
          Partition 2, the primary replica is stored on node 2, and the
          backup on node 1.
        </p></li><li><p>
          Partition 3 is stored on node group 1, and the placement of
          its two replicas are reversed from those of partition 1. That
          is, its primary replica is located on node 4, with the backup
          on node 3.
        </p></li></ul></div><p>
      What this means regarding the continued operation of a MySQL
      Cluster is this: so long as each node group participating in the
      cluster has at least one node operating, the cluster has a
      complete copy of all data and remains viable. This is illustrated
      in the next diagram.
    </p><div class="mediaobject"><img src="images/replicas-groups-1-2.png" alt="Nodes required to keep a 2x2 cluster
        viable"></div><p>
      In this example, where the cluster consists of two node groups of
      two nodes each, any combination of at least one node in node group
      0 and at least one node in node group 1 is sufficient to keep the
      cluster “<span class="quote">alive</span>” (indicated by arrows in the diagram).
      However, if <span class="emphasis"><em>both</em></span> nodes from
      <span class="emphasis"><em>either</em></span> node group fail, the remaining two
      nodes are not sufficient (shown by the arrows marked out with an
      <span class="bold"><strong>X</strong></span>); in either case, the cluster
      has lost an entire partition and so can no longer provide access
      to a complete set of all cluster data.
    </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-multi-computer"></a>20.2. Simple Multi-Computer How-To</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-hardware-software-network">20.2.1. Hardware, Software, and Networking</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-install">20.2.2. Multi-Computer Installation</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-config">20.2.3. Multi-Computer Configuration</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-initial">20.2.4. Initial Startup</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-load-data-queries">20.2.5. Loading Sample Data and Performing Queries</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-multi-shutdown-restart">20.2.6. Safe Shutdown and Restart</a></span></dt></dl></div><a class="indexterm" name="id2322931"></a><a class="indexterm" name="id2322940"></a><a class="indexterm" name="id2322949"></a><a class="indexterm" name="id2322962"></a><a class="indexterm" name="id2322971"></a><p>
    This section is a “<span class="quote">How-To</span>” that describes the basics
    for how to plan, install, configure, and run a MySQL Cluster.
    Whereas the examples in
    <a href="mysql-cluster.html#mysql-cluster-configuration" title="20.3. MySQL Cluster Configuration">Section 20.3, “MySQL Cluster Configuration”</a> provide more in-depth
    information on a variety of clustering options and configuration,
    the result of following the guidelines and procedures outlined here
    should be a usable MySQL Cluster which meets the
    <span class="emphasis"><em>minimum</em></span> requirements for availability and
    safeguarding of data.
  </p><p>
    This section covers hardware and software requirements; networking
    issues; installation of MySQL Cluster; configuration issues;
    starting, stopping, and restarting the cluster; loading of a sample
    database; and performing queries.
  </p><p><b>Basic assumptions. </b>
      This <em class="citetitle">How-To</em> makes the following
      assumptions:
    </p><div class="orderedlist"><ol type="1"><li><p>
        The cluster is to be set up with four nodes, each on a separate
        host, and each with a fixed network address on a typical
        Ethernet network as shown here:
      </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Node</strong></span></td><td><span class="bold"><strong>IP Address</strong></span></td></tr><tr><td>Management (MGM) node</td><td>192.168.0.10</td></tr><tr><td>MySQL server (SQL) node</td><td>192.168.0.20</td></tr><tr><td>Data (NDBD) node "A"</td><td>192.168.0.30</td></tr><tr><td>Data (NDBD) node "B"</td><td>192.168.0.40</td></tr></tbody></table></div><p>
        This may be made clearer in the following diagram:
      </p><div class="mediaobject"><img src="images/multi-comp-1.png" alt="MySQL Cluster Multi-Computer Setup"></div><a class="indexterm" name="id2323146"></a><a class="indexterm" name="id2323158"></a><p>
        In the interest of simplicity (and reliability), this
        <em class="citetitle">How-To</em> uses only numeric IP addresses.
        However, if DNS resolution is available on your network, it is
        possible to use hostnames in lieu of IP addresses in configuring
        Cluster. Alternatively, you can use the
        <code class="filename">/etc/hosts</code> file or your operating
        system's equivalent for providing a means to do host lookup
        if such is available.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          A common problem when trying to use hostnames for Cluster
          nodes arises because of the way in which some operating
          systems (including some Linux distributions) set up the
          system's own hostname in the <code class="filename">/etc/hosts</code>
          during installation. Consider two machines with the hostnames
          <code class="literal">ndb1</code> and <code class="literal">ndb2</code>, both in
          the <code class="literal">cluster</code> network domain. Red Hat Linux
          (including some derivatives such as CentOS and Fedora) places
          the following entries in these machines'
          <code class="filename">/etc/hosts</code> files:

</p><pre class="programlisting">#  ndb1 <code class="filename">/etc/hosts</code>:
127.0.0.1   ndb1.cluster ndb1 localhost.localdomain localhost
</pre><p>

</p><pre class="programlisting">#  ndb2 <code class="filename">/etc/hosts</code>:
127.0.0.1   ndb2.cluster ndb2 localhost.localdomain localhost
</pre><p>

          SUSE Linux (including OpenSUSE) places these entries in the
          machines' <code class="filename">/etc/hosts</code> files:

</p><pre class="programlisting">#  ndb1 <code class="filename">/etc/hosts</code>:
127.0.0.1       localhost
127.0.0.2       ndb1.cluster ndb1
</pre><p>

</p><pre class="programlisting">#  ndb2 <code class="filename">/etc/hosts</code>:
127.0.0.1       localhost
127.0.0.2       ndb2.cluster ndb2
</pre><p>

          In both instances, <code class="literal">ndb1</code> routes
          <code class="literal">ndb1.cluster</code> to a loopback IP address, but
          gets a public IP address from DNS for
          <code class="literal">ndb2.cluster</code>, while <code class="literal">ndb2</code>
          routes <code class="literal">ndb2.cluster</code> to a loopback address
          and obtains a public address for
          <code class="literal">ndb1.cluster</code>. The result is that each data
          node connects to the management server, but cannot tell when
          any other data nodes have connected, and so the data nodes
          appear to hang while starting.
        </p><p>
          You should also be aware that you cannot mix
          <code class="literal">localhost</code> and other hostnames or IP
          addresses in <code class="filename">config.ini</code>. For these
          reasons, the solution in such cases (other than to use IP
          addresses for <span class="emphasis"><em>all</em></span>
          <code class="filename">config.ini</code> <code class="literal">HostName</code>
          entries) is to remove the fully qualified hostnames from
          <code class="filename">/etc/hosts</code> and use these in
          <code class="filename">config.ini</code> for all cluster hosts.
        </p></div></li><li><p>
        Each host in our scenario is an Intel-based desktop PC running a
        common, generic Linux distribution installed to disk in a
        standard configuration, and running no unnecessary services. The
        core OS with standard TCP/IP networking capabilities should be
        sufficient. Also for the sake of simplicity, we also assume that
        the filesystems on all hosts are set up identically. In the
        event that they are not, you will need to adapt these
        instructions accordingly.
      </p></li><li><p>
        Standard 100 Mbps or 1 gigabit Ethernet cards are installed on
        each machine, along with the proper drivers for the cards, and
        that all four hosts are connected via a standard-issue Ethernet
        networking appliance such as a switch. (All machines should use
        network cards with the same throughout. That is, all four
        machines in the cluster should have 100 Mbps cards
        <span class="emphasis"><em>or</em></span> all four machines should have 1 Gbps
        cards.) MySQL Cluster will work in a 100 Mbps network; however,
        gigabit Ethernet will provide better performance.
      </p><p>
        Note that MySQL Cluster is <span class="emphasis"><em>not</em></span> intended for
        use in a network for which throughput is less than 100 Mbps. For
        this reason (among others), attempting to run a MySQL Cluster
        over a public network such as the Internet is not likely to be
        successful, and is not recommended.
      </p></li><li><p>
        For our sample data, we will use the <code class="literal">world</code>
        database which is available for download from the MySQL AB Web
        site. As this database takes up a relatively small amount of
        space, we assume that each machine has 256MB RAM, which should
        be sufficient for running the operating system, host NDB
        process, and (for the data nodes) for storing the database.
      </p></li></ol></div><p>
    Although we refer to a Linux operating system in this How-To, the
    instructions and procedures that we provide here should be easily
    adaptable to other supported operating systems. We also assume that
    you already know how to perform a minimal installation and
    configuration of the operating system with networking capability, or
    that you are able to obtain assistance in this elsewhere if needed.
  </p><p>
    We discuss MySQL Cluster hardware, software, and networking
    requirements in somewhat greater detail in the next section. (See
    <a href="mysql-cluster.html#mysql-cluster-multi-hardware-software-network" title="20.2.1. Hardware, Software, and Networking">Section 20.2.1, “Hardware, Software, and Networking”</a>.)
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-multi-hardware-software-network"></a>20.2.1. Hardware, Software, and Networking</h3></div></div></div><a class="indexterm" name="id2323444"></a><a class="indexterm" name="id2323456"></a><p>
      One of the strengths of MySQL Cluster is that it can be run on
      commodity hardware and has no unusual requirements in this regard,
      other than for large amounts of RAM, due to the fact that all live
      data storage is done in memory. (It is possible to reduce this
      requirement using Disk Data tables — see
      <a href="mysql-cluster.html#mysql-cluster-disk-data" title="20.12. MySQL Cluster Disk Data Tables">Section 20.12, “MySQL Cluster Disk Data Tables”</a>, for more information
      about these.) Naturally, multiple and faster CPUs can enhance
      performance. Memory requirements for other Cluster processes are
      relatively small.
    </p><p>
      The software requirements for Cluster are also modest. Host
      operating systems do not require any unusual modules, services,
      applications, or configuration to support MySQL Cluster. For
      supported operating systems, a standard installation should be
      sufficient. The MySQL software requirements are simple: all that
      is needed is a production release of MySQL
      5.1.24-ndb-6.2.16 or 5.1.24-ndb-6.3.17 to have
      Cluster support. It is not necessary to compile MySQL yourself
      merely to be able to use Cluster. In this
      <em class="citetitle">How-To</em>, we assume that you are using the
      server binary appropriate to your platform, available via the
      MySQL Cluster software downloads page at
      <a href="http://dev.mysql.com/downloads/cluster" target="_top">http://dev.mysql.com/downloads/cluster</a>.
    </p><p>
      For communication between nodes, Cluster supports TCP/IP
      networking in any standard topology, and the minimum expected for
      each host is a standard 100 Mbps Ethernet card, plus a switch,
      hub, or router to provide network connectivity for the cluster as
      a whole. We strongly recommend that a MySQL Cluster be run on its
      own subnet which is not shared with non-Cluster machines for the
      following reasons:
    </p><div class="itemizedlist"><ul type="disc"><li><p><b>Security. </b>
            Communications between Cluster nodes are not encrypted or
            shielded in any way. The only means of protecting
            transmissions within a MySQL Cluster is to run your Cluster
            on a protected network. If you intend to use MySQL Cluster
            for Web applications, the cluster should definitely reside
            behind your firewall and not in your network's
            De-Militarized Zone
            (<a href="http://compnetworking.about.com/cs/networksecurity/g/bldef_dmz.htm" target="_top">DMZ</a>)
            or elsewhere.
          </p><p>
          See
          <a href="mysql-cluster.html#mysql-cluster-security-networking-issues" title="20.8.1. MySQL Cluster Security and Networking Issues">Section 20.8.1, “MySQL Cluster Security and Networking Issues”</a>,
          for more information.
        </p></li><li><p><b>Efficiency. </b>
            Setting up a MySQL Cluster on a private or protected network
            allows the cluster to make exclusive use of bandwidth
            between cluster hosts. Using a separate switch for your
            MySQL Cluster not only helps protect against unauthorized
            access to Cluster data, it also ensures that Cluster nodes
            are shielded from interference caused by transmissions
            between other computers on the network. For enhanced
            reliability, you can use dual switches and dual cards to
            remove the network as a single point of failure; many device
            drivers support failover for such communication links.
          </p></li></ul></div><p>
      It is also possible to use the high-speed Scalable Coherent
      Interface (SCI) with MySQL Cluster, but this is not a requirement.
      See <a href="mysql-cluster.html#mysql-cluster-interconnects" title="20.13. Using High-Speed Interconnects with MySQL Cluster">Section 20.13, “Using High-Speed Interconnects with MySQL Cluster”</a>, for more about
      this protocol and its use with MySQL Cluster.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-multi-install"></a>20.2.2. Multi-Computer Installation</h3></div></div></div><a class="indexterm" name="id2323592"></a><a class="indexterm" name="id2323601"></a><a class="indexterm" name="id2323614"></a><a class="indexterm" name="id2323622"></a><p>
      Each MySQL Cluster host computer running an SQL node must have
      installed on it a MySQL binary. For management nodes and data
      nodes, it is not necessary to install the MySQL server binary, but
      management nodes require the management server daemon
      (<span><strong class="command">ndb_mgmd</strong></span>) and data nodes require the data node
      daemon (<span><strong class="command">ndbd</strong></span>). It is also a good idea to
      install the management client (<span><strong class="command">ndb_mgm</strong></span>) on the
      management server host. This section covers the steps necessary to
      install the correct binaries for each type of Cluster node.
    </p><p>
      MySQL AB provides precompiled binaries that support Cluster, and
      there is generally no need to compile these yourself. However, we
      also include information relating to installing a MySQL Cluster
      after building MySQL from source. For setting up a cluster using
      MySQL's binaries, the first step in the installation process
      for each cluster host is to download the file
      <code class="filename">mysql-5.1.24-ndb-6.2.16-linux-i686-glibc23.tar.gz</code>
      from the <a href="http://dev.mysql.com/downloads/cluster" target="_top">MySQL downloads
      area</a>. We assume that you have placed it in each machine's
      <code class="filename">/var/tmp</code> directory. (If you do require a
      custom binary, see <a href="installing.html#installing-source-tree" title="2.9.3. Installing from the Development Source Tree">Section 2.9.3, “Installing from the Development Source Tree”</a>.)
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        After completing the installation, do not yet start any of the
        binaries. We show you how to do so following the configuration
        of all nodes.
      </p></div><p><b>Data and SQL Node Installation — <code class="filename">.tar.gz</code>
        Binary. </b>
        On each of the machines designated to host data or SQL nodes,
        perform the following steps as the system
        <code class="literal">root</code> user:

        </p><div class="orderedlist"><ol type="1"><li><p>
              Check your <code class="filename">/etc/passwd</code> and
              <code class="filename">/etc/group</code> files (or use whatever
              tools are provided by your operating system for managing
              users and groups) to see whether there is already a
              <code class="literal">mysql</code> group and
              <code class="literal">mysql</code> user on the system. Some OS
              distributions create these as part of the operating system
              installation process. If they are not already present,
              create a new <code class="literal">mysql</code> user group, and then
              add a <code class="literal">mysql</code> user to this group:
            </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>groupadd mysql</code></strong>
shell&gt; <strong class="userinput"><code>useradd -g mysql mysql</code></strong>
</pre><p>
              The syntax for <span><strong class="command">useradd</strong></span> and
              <span><strong class="command">groupadd</strong></span> may differ slightly on
              different versions of Unix, or they may have different
              names such as <span><strong class="command">adduser</strong></span> and
              <span><strong class="command">addgroup</strong></span>.
            </p></li><li><p>
              Change location to the directory containing the downloaded
              file, unpack the archive, and create a symlink to the
              <code class="filename">mysql</code> directory named
              <code class="filename">mysql</code>. Note that the actual file and
              directory names will vary according to the MySQL version
              number.
            </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cd /var/tmp</code></strong>
shell&gt; <strong class="userinput"><code>tar -C /usr/local -xzvf mysql-5.1.24-ndb-6.2.16-linux-i686-glibc23.tar.gz</code></strong>
shell&gt; <strong class="userinput"><code>ln -s /usr/local/mysql-5.1.24-ndb-6.2.16-linux-i686-glibc23.tar.gz /usr/local/mysql</code></strong>
</pre></li><li><p>
              Change location to the <code class="filename">mysql</code>
              directory and run the supplied script for creating the
              system databases:
            </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cd mysql</code></strong>
shell&gt; <strong class="userinput"><code>scripts/mysql_install_db --user=mysql</code></strong>
</pre></li><li><p>
              Set the necessary permissions for the MySQL server and
              data directories:
            </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>chown -R root .</code></strong>
shell&gt; <strong class="userinput"><code>chown -R mysql data</code></strong>
shell&gt; <strong class="userinput"><code>chgrp -R mysql .</code></strong>
</pre><p>
              Note that the data directory on each machine hosting a
              data node is <code class="filename">/usr/local/mysql/data</code>.
              This piece of information is essential when configuring
              the management node. (See
              <a href="mysql-cluster.html#mysql-cluster-multi-config" title="20.2.3. Multi-Computer Configuration">Section 20.2.3, “Multi-Computer Configuration”</a>.)
            </p></li><li><p>
              Copy the MySQL startup script to the appropriate
              directory, make it executable, and set it to start when
              the operating system is booted up:
            </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cp support-files/mysql.server /etc/rc.d/init.d/</code></strong>
shell&gt; <strong class="userinput"><code>chmod +x /etc/rc.d/init.d/mysql.server</code></strong>
shell&gt; <strong class="userinput"><code>chkconfig --add mysql.server</code></strong>
</pre><p>
              (The startup scripts directory may vary depending on your
              operating system and version — for example, in some
              Linux distributions, it is
              <code class="filename">/etc/init.d</code>.)
            </p><p>
              Here we use Red Hat's <span><strong class="command">chkconfig</strong></span> for
              creating links to the startup scripts; use whatever means
              is appropriate for this purpose on your operating system
              and distribution, such as <span><strong class="command">update-rc.d</strong></span>
              on Debian.
            </p></li></ol></div><p>

        Remember that the preceding steps must be performed separately
        on each machine where an SQL node is to reside.
      </p><p><b>SQL node installation — building from source. </b>
        If you compile MySQL with clustering support (for example, by
        using the
        <span><strong class="command">BUILD/compile-<em class="replaceable"><code>platform_name</code></em>-max</strong></span>
        script appropriate to your platform), and perform the default
        installation (using <span><strong class="command">make install</strong></span> as the root
        user), <span><strong class="command">mysqld</strong></span> is placed in
        <code class="filename">/usr/local/mysql/bin</code>. Follow the steps
        given in <a href="installing.html#installing-source" title="2.9. MySQL Installation Using a Source Distribution">Section 2.9, “MySQL Installation Using a Source Distribution”</a> to make
        <span><strong class="command">mysqld</strong></span> ready for use. If you want to run
        multiple SQL nodes, you can use a copy of the same
        <span><strong class="command">mysqld</strong></span> executable and its associated support
        files on several machines. The easiest way to do this is to copy
        the entire <code class="filename">/usr/local/mysql</code> directory and
        all directories and files contained within it to the other SQL
        node host or hosts, then repeat the steps from
        <a href="installing.html#installing-source" title="2.9. MySQL Installation Using a Source Distribution">Section 2.9, “MySQL Installation Using a Source Distribution”</a> on each machine. If you
        configure the build with a non-default
        <code class="option">--prefix</code>, you need to adjust the directory
        accordingly.
      </p><p><b>Data node installation — building from source. </b>
        The only executable required on a data node host is
        <span><strong class="command">ndbd</strong></span> (<span><strong class="command">mysqld</strong></span>, for example,
        does not have to be present on the host machine). By default
        when doing a source build, this file is placed in the directory
        <code class="filename">/usr/local/mysql/libexec</code>. For installing on
        multiple data node hosts, only <span><strong class="command">ndbd</strong></span> need be
        copied to the other host machine or machines. (This assumes that
        all data node hosts use the same architecture and operating
        system; otherwise you may need to compile separately for each
        different platform.) <span><strong class="command">ndbd</strong></span> need not be in any
        particular location on the host's filesystem, as long as the
        location is known.
      </p><p><b>Management node installation — <code class="filename">.tar.gz</code> binary. </b>
        Installation of the management node does not require the
        <span><strong class="command">mysqld</strong></span> binary. Only the binary for the
        management server is required, which can be found in the
        downloaded archive. You most likely want to install the
        management client as well; this can also be found in the
        <code class="filename">.tar.gz</code> archive. Again, we assume that you
        have placed this archive in <code class="filename">/var/tmp</code>.
      </p><p>
      As system <code class="literal">root</code> (that is, after using
      <span><strong class="command">sudo</strong></span>, <span><strong class="command">su root</strong></span>, or your
      system's equivalent for temporarily assuming the system
      administrator account's privileges), perform the following steps
      to install <span><strong class="command">ndb_mgmd</strong></span> and
      <span><strong class="command">ndb_mgm</strong></span> on the Cluster management node host:

      </p><div class="orderedlist"><ol type="1"><li><p>
            Change location to the <code class="filename">/var/tmp</code>
            directory, and extract the <span><strong class="command">ndb_mgm</strong></span> and
            <span><strong class="command">ndb_mgmd</strong></span> from the archive into a suitable
            directory such as <code class="filename">/usr/local/bin</code>:
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cd /var/tmp</code></strong>
shell&gt; <strong class="userinput"><code>tar -zxvf mysql-5.1.24-ndb-6.2.16-linux-i686-glibc23.tar.gz</code></strong>
shell&gt; <strong class="userinput"><code>cd mysql-5.1.24-ndb-6.2.16-linux-i686-glibc23</code></strong>
shell&gt; <strong class="userinput"><code>cp /bin/ndb_mgm* /usr/local/bin</code></strong>
</pre><p>
            (You can safely delete the directory created by unpacking
            the downloaded archive, and the files it contains, from
            <code class="filename">/var/tmp</code> once
            <span><strong class="command">ndb_mgm</strong></span> and <span><strong class="command">ndb_mgmd</strong></span>
            have been copied to the executables directory.)
          </p></li><li><p>
            Change location to the directory into which you copied the
            files, and then make both of them executable:
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cd /usr/local/bin</code></strong>
shell&gt; <strong class="userinput"><code>chmod +x ndb_mgm*</code></strong>
</pre></li></ol></div><p>
    </p><p><b>Management node installation — building from source. </b>
        When building from source and running the default <span><strong class="command">make
        install</strong></span>, the management server binary
        (<span><strong class="command">ndb_mgmd</strong></span>) is placed in
        <code class="filename">/usr/local/mysql/libexec</code>, while the
        management client binary (<span><strong class="command">ndb_mgm</strong></span>) can be
        found in <code class="filename">/usr/local/mysql/bin</code>. Only
        <span><strong class="command">ndb_mgmd</strong></span> is required to be present on a
        management node host; however, it is also a good idea to have
        <span><strong class="command">ndb_mgm</strong></span> present on the same host machine.
        Neither of these executables requires a specific location on the
        host machine's filesystem.
      </p><p>
      In <a href="mysql-cluster.html#mysql-cluster-multi-config" title="20.2.3. Multi-Computer Configuration">Section 20.2.3, “Multi-Computer Configuration”</a>, we create
      configuration files for all of the nodes in our example Cluster.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-multi-config"></a>20.2.3. Multi-Computer Configuration</h3></div></div></div><a class="indexterm" name="id2324394"></a><a class="indexterm" name="id2324406"></a><a class="indexterm" name="id2324418"></a><p>
      For our four-node, four-host MySQL Cluster, it is necessary to
      write four configuration files, one per node host.
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          Each data node or SQL node requires a
          <code class="filename">my.cnf</code> file that provides two pieces of
          information: a <em class="firstterm">connectstring</em> that tells
          the node where to find the MGM node, and a line telling the
          MySQL server on this host (the machine hosting the data node)
          to run in NDB mode.
        </p><p>
          For more information on connectstrings, see
          <a href="mysql-cluster.html#mysql-cluster-connectstring" title="20.3.4.2. The Cluster Connectstring">Section 20.3.4.2, “The Cluster Connectstring”</a>.
        </p></li><li><p>
          The management node needs a <code class="filename">config.ini</code>
          file telling it how many replicas to maintain, how much memory
          to allocate for data and indexes on each data node, where to
          find the data nodes, where to save data to disk on each data
          node, and where to find any SQL nodes.
        </p></li></ul></div><p>
      <span class="bold"><strong>Configuring the Storage and SQL
      Nodes</strong></span>
    </p><p>
      The <code class="filename">my.cnf</code> file needed for the data nodes is
      fairly simple. The configuration file should be located in the
      <code class="filename">/etc</code> directory and can be edited using any
      text editor. (Create the file if it does not exist.) For example:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>vi /etc/my.cnf</code></strong>
</pre><p>
      We show <span><strong class="command">vi</strong></span> being used here to create the file,
      but any text editor should work just as well.
    </p><p>
      For each data node and SQL node in our example setup,
      <code class="filename">my.cnf</code> should look like this:
    </p><pre class="programlisting"># Options for mysqld process:
[mysqld]                        
ndbcluster                      # run NDB storage engine
ndb-connectstring=192.168.0.10  # location of management server

# Options for ndbd process:
[mysql_cluster]                 
ndb-connectstring=192.168.0.10  # location of management server
</pre><p>
      After entering the preceding information, save this file and exit
      the text editor. Do this for the machines hosting data node
      “<span class="quote">A</span>”, data node “<span class="quote">B</span>”, and the SQL node.
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        Once you have started a <span><strong class="command">mysqld</strong></span> process with
        the <code class="literal">ndbcluster</code> and
        <code class="literal">ndb-connectstring</code> parameters in the
        <code class="literal">[mysqld]</code> in the <code class="filename">my.cnf</code>
        file as shown previously, you cannot execute any <code class="literal">CREATE
        TABLE</code> or <code class="literal">ALTER TABLE</code> statements
        without having actually started the cluster. Otherwise, these
        statements will fail with an error. <span class="emphasis"><em>This is by
        design</em></span>.
      </p></div><p><b>Configuring the management node. </b>
        The first step in configuring the MGM node is to create the
        directory in which the configuration file can be found and then
        to create the file itself. For example (running as
        <code class="literal">root</code>):
      </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mkdir /var/lib/mysql-cluster</code></strong>
shell&gt; <strong class="userinput"><code>cd /var/lib/mysql-cluster</code></strong>
shell&gt; <strong class="userinput"><code>vi config.ini</code></strong>
</pre><p>
      For our representative setup, the <code class="filename">config.ini</code>
      file should read as follows:
    </p><pre class="programlisting"># Options affecting ndbd processes on all data nodes:
[ndbd default]    
NoOfReplicas=2    # Number of replicas
DataMemory=80M    # How much memory to allocate for data storage
IndexMemory=18M   # How much memory to allocate for index storage
                  # For DataMemory and IndexMemory, we have used the
                  # default values. Since the "world" database takes up
                  # only about 500KB, this should be more than enough for
                  # this example Cluster setup.

# TCP/IP options:
[tcp default]     
portnumber=2202   # This the default; however, you can use any port that is free 
                  # for all the hosts in the cluster
                  # Note: It is recommended that you do not specify the port 
                  # number at all and allow the default value to be used instead

# Management process options:
[ndb_mgmd]                      
hostname=192.168.0.10           # Hostname or IP address of MGM node
datadir=/var/lib/mysql-cluster  # Directory for MGM node log files

# Options for data node "A":
[ndbd]                          
                                # (one [ndbd] section per data node)
hostname=192.168.0.30           # Hostname or IP address
datadir=/usr/local/mysql/data   # Directory for this data node's data files

# Options for data node "B":
[ndbd]                          
hostname=192.168.0.40           # Hostname or IP address
datadir=/usr/local/mysql/data   # Directory for this data node's data files

# SQL node options:
[mysqld]                        
hostname=192.168.0.20           # Hostname or IP address
                                # (additional mysqld connections can be
                                # specified for this node for various
                                # purposes such as running ndb_restore)
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        The <code class="literal">world</code> database can be downloaded from
        <a href="http://dev.mysql.com/doc/" target="_top">http://dev.mysql.com/doc/</a>, where it can be found listed
        under “<span class="quote">Examples</span>”.
      </p></div><p>
      After all the configuration files have been created and these
      minimal options have been specified, you are ready to proceed with
      starting the cluster and verifying that all processes are running.
      We discuss how this is done in
      <a href="mysql-cluster.html#mysql-cluster-multi-initial" title="20.2.4. Initial Startup">Section 20.2.4, “Initial Startup”</a>.
    </p><p>
      For more detailed information about the available MySQL Cluster
      configuration parameters and their uses, see
      <a href="mysql-cluster.html#mysql-cluster-config-file" title="20.3.4. Configuration File">Section 20.3.4, “Configuration File”</a>, and
      <a href="mysql-cluster.html#mysql-cluster-configuration" title="20.3. MySQL Cluster Configuration">Section 20.3, “MySQL Cluster Configuration”</a>. For configuration
      of MySQL Cluster as relates to making backups, see
      <a href="mysql-cluster.html#mysql-cluster-backup-configuration" title="20.9.4. Configuration for Cluster Backup">Section 20.9.4, “Configuration for Cluster Backup”</a>.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        The default port for Cluster management nodes is 1186; the
        default port for data nodes is 2202. However, the cluster can
        automatically allocate ports for data nodes from those that are
        already free.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-multi-initial"></a>20.2.4. Initial Startup</h3></div></div></div><a class="indexterm" name="id2324750"></a><p>
      Starting the cluster is not very difficult after it has been
      configured. Each cluster node process must be started separately,
      and on the host where it resides. The management node should be
      started first, followed by the data nodes, and then finally by any
      SQL nodes:
    </p><div class="orderedlist"><ol type="1"><li><p>
          On the management host, issue the following command from the
          system shell to start the management node process:

</p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgmd -f /var/lib/mysql-cluster/config.ini</code></strong>
</pre><p>
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            <span><strong class="command">ndb_mgmd</strong></span> must be told where to find its
            configuration file, using the <code class="option">-f</code> or
            <code class="option">--config-file</code> option. (See
            <a href="mysql-cluster.html#mysql-cluster-ndb-mgmd-process" title="20.6.3. ndb_mgmd — The Management Server Process">Section 20.6.3, “<span><strong class="command">ndb_mgmd</strong></span> — The Management Server Process”</a>, for
            details.)
          </p><p>
            For additional options which can be used with
            <span><strong class="command">ndb_mgmd</strong></span>, see
            <a href="mysql-cluster.html#mysql-cluster-command-options" title="20.6.5. Command Options for MySQL Cluster Processes">Section 20.6.5, “Command Options for MySQL Cluster Processes”</a>.
          </p></div></li><li><p>
          On each of the data node hosts, run this command to start the
          <span><strong class="command">ndbd</strong></span> process:
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndbd</code></strong>
</pre></li><li><p>
          If you used RPM files to install MySQL on the cluster host
          where the SQL node is to reside, you can (and should) use the
          supplied startup script to start the MySQL server process on
          the SQL node.
        </p></li></ol></div><a class="indexterm" name="id2324871"></a><a class="indexterm" name="id2324884"></a><p>
      If all has gone well, and the cluster has been set up correctly,
      the cluster should now be operational. You can test this by
      invoking the <span><strong class="command">ndb_mgm</strong></span> management node client.
      The output should look like that shown here, although you might
      see some slight differences in the output depending upon the exact
      version of MySQL that you are using:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgm</code></strong>
-- NDB Cluster -- Management Client --
ndb_mgm&gt; <strong class="userinput"><code>SHOW</code></strong>
Connected to Management Server at: localhost:1186
Cluster Configuration
---------------------
[ndbd(NDB)]     2 node(s)
id=2    @192.168.0.30  (Version: 5.1.24-ndb-6.2.16, Nodegroup: 0, Master)
id=3    @192.168.0.40  (Version: 5.1.24-ndb-6.2.16, Nodegroup: 0)

[ndb_mgmd(MGM)] 1 node(s)
id=1    @192.168.0.10  (Version: 5.1.24-ndb-6.2.16)

[mysqld(SQL)]   1 node(s)
id=4   (Version: 5.1.24-ndb-6.2.16)
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        The SQL node is referenced here as
        <code class="literal">[mysqld(API)]</code>. This is perfectly normal, and
        reflects the fact that the <span><strong class="command">mysqld</strong></span> process is
        acting as a cluster API node.
      </p></div><p>
      You should now be ready to work with databases, tables, and data
      in MySQL Cluster. See
      <a href="mysql-cluster.html#mysql-cluster-multi-load-data-queries" title="20.2.5. Loading Sample Data and Performing Queries">Section 20.2.5, “Loading Sample Data and Performing Queries”</a>, for a
      brief discussion.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-multi-load-data-queries"></a>20.2.5. Loading Sample Data and Performing Queries</h3></div></div></div><a class="indexterm" name="id2324965"></a><a class="indexterm" name="id2324977"></a><p>
      Working with data in MySQL Cluster is not much different from
      doing so in MySQL without Cluster. There are two points to keep in
      mind:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          For a table to be replicated in the cluster, it must use the
          <code class="literal">NDBCLUSTER</code> storage engine. To specify this,
          use the <code class="option">ENGINE=NDB</code> or
          <code class="option">ENGINE=NDBCLUSTER</code> table option. You can add
          this option when creating the table:
        </p><pre class="programlisting">CREATE TABLE <em class="replaceable"><code>tbl_name</code></em> (<em class="replaceable"><code>col_name</code></em> <em class="replaceable"><code>column_definitions</code></em>) ENGINE=NDBCLUSTER;
</pre><p>
          Alternatively, for an existing table that uses a different
          storage engine, use <code class="literal">ALTER TABLE</code> to change
          the table to use <code class="literal">NDBCLUSTER</code>:
        </p><pre class="programlisting">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> ENGINE=NDBCLUSTER;
</pre></li><li><p>
          Each <code class="literal">NDB</code> table <span class="emphasis"><em>must</em></span>
          have a primary key. If no primary key is defined by the user
          when a table is created, the <code class="literal">NDBCLUSTER</code>
          storage engine automatically generates a hidden one.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            This hidden key takes up space just as does any other table
            index. It is not uncommon to encounter problems due to
            insufficient memory for accommodating these automatically
            created indexes.)
          </p></div></li></ul></div><p>
      If you are importing tables from an existing database using the
      output of <span><strong class="command">mysqldump</strong></span>, you can open the SQL
      script in a text editor and add the <code class="literal">ENGINE</code>
      option to any table creation statements, or replace any existing
      <code class="literal">ENGINE</code> (or <code class="literal">TYPE</code>) options.
      Suppose that you have the <code class="literal">world</code> sample database
      on another MySQL server that does not support MySQL Cluster, and
      you want to export the <code class="literal">City</code> table:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysqldump --add-drop-table world City &gt; city_table.sql</code></strong>
</pre><p>
      The resulting <code class="filename">city_table.sql</code> file will
      contain this table creation statement (and the
      <code class="literal">INSERT</code> statements necessary to import the table
      data):
    </p><pre class="programlisting">DROP TABLE IF EXISTS `City`;
CREATE TABLE `City` (
  `ID` int(11) NOT NULL auto_increment,
  `Name` char(35) NOT NULL default '',
  `CountryCode` char(3) NOT NULL default '',
  `District` char(20) NOT NULL default '',
  `Population` int(11) NOT NULL default '0',
  PRIMARY KEY  (`ID`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;

INSERT INTO `City` VALUES (1,'Kabul','AFG','Kabol',1780000);
INSERT INTO `City` VALUES (2,'Qandahar','AFG','Qandahar',237500);
INSERT INTO `City` VALUES (3,'Herat','AFG','Herat',186800);
<em class="replaceable"><code>(remaining INSERT statements omitted)</code></em>
</pre><p>
      You need to make sure that MySQL uses the <code class="literal">NDB</code>
      storage engine for this table. There are two ways that this can be
      accomplished. One of these is to modify the table definition
      <span class="emphasis"><em>before</em></span> importing it into the Cluster
      database. Using the <code class="literal">City</code> table as an example,
      modify the <code class="literal">ENGINE</code> option of the definition as
      follows:
    </p><pre class="programlisting">DROP TABLE IF EXISTS `City`;
CREATE TABLE `City` (
  `ID` int(11) NOT NULL auto_increment,
  `Name` char(35) NOT NULL default '',
  `CountryCode` char(3) NOT NULL default '',
  `District` char(20) NOT NULL default '',
  `Population` int(11) NOT NULL default '0',
  PRIMARY KEY  (`ID`)
) <span class="bold"><strong>ENGINE=NDBCLUSTER</strong></span> DEFAULT CHARSET=latin1;

INSERT INTO `City` VALUES (1,'Kabul','AFG','Kabol',1780000);
INSERT INTO `City` VALUES (2,'Qandahar','AFG','Qandahar',237500);
INSERT INTO `City` VALUES (3,'Herat','AFG','Herat',186800);
<em class="replaceable"><code>(remaining INSERT statements omitted)</code></em>
</pre><p>
      This must be done for the definition of each table that is to be
      part of the clustered database. The easiest way to accomplish this
      is to do a search-and-replace on the file that contains the
      definitions and replace all instances of
      <code class="literal">TYPE=<em class="replaceable"><code>engine_name</code></em></code> or
      <code class="literal">ENGINE=<em class="replaceable"><code>engine_name</code></em></code>
      with <code class="literal">ENGINE=NDBCLUSTER</code>. If you do not want to
      modify the file, you can use the unmodified file to create the
      tables, and then use <code class="literal">ALTER TABLE</code> to change
      their storage engine. The particulars are given later in this
      section.
    </p><p>
      Assuming that you have already created a database named
      <code class="literal">world</code> on the SQL node of the cluster, you can
      then use the <span><strong class="command">mysql</strong></span> command-line client to read
      <code class="filename">city_table.sql</code>, and create and populate the
      corresponding table in the usual manner:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysql world &lt; city_table.sql</code></strong>
</pre><p>
      It is very important to keep in mind that the preceding command
      must be executed on the host where the SQL node is running (in
      this case, on the machine with the IP address
      <code class="literal">192.168.0.20</code>).
    </p><p>
      To create a copy of the entire <code class="literal">world</code> database
      on the SQL node, use <span><strong class="command">mysqldump</strong></span> on the
      non-cluster server to export the database to a file named
      <code class="filename">world.sql</code>; for example, in the
      <code class="filename">/tmp</code> directory. Then modify the table
      definitions as just described and import the file into the SQL
      node of the cluster like this:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysql world &lt; /tmp/world.sql</code></strong>
</pre><p>
      If you save the file to a different location, adjust the preceding
      instructions accordingly.
    </p><p>
      Running <code class="literal">SELECT</code> queries on the SQL node is no
      different from running them on any other instance of a MySQL
      server. To run queries from the command line, you first need to
      log in to the MySQL Monitor in the usual way (specify the
      <code class="literal">root</code> password at the <code class="literal">Enter
      password:</code> prompt):
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysql -u root -p</code></strong>
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 1 to server version: 5.1.24-ndb-6.2.16

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.

mysql&gt;
</pre><p>
      We simply use the MySQL server's <code class="literal">root</code>
      account and assume that you have followed the standard security
      precautions for installing a MySQL server, including setting a
      strong <code class="literal">root</code> password. For more information, see
      <a href="installing.html#default-privileges" title="2.10.3. Securing the Initial MySQL Accounts">Section 2.10.3, “Securing the Initial MySQL Accounts”</a>.
    </p><p>
      It is worth taking into account that Cluster nodes do
      <span class="emphasis"><em>not</em></span> make use of the MySQL privilege system
      when accessing one another. Setting or changing MySQL user
      accounts (including the <code class="literal">root</code> account) effects
      only applications that access the SQL node, not interaction
      between nodes. See
      <a href="mysql-cluster.html#mysql-cluster-security-mysql-privileges" title="20.8.2. MySQL Cluster and MySQL Privileges">Section 20.8.2, “MySQL Cluster and MySQL Privileges”</a>, for
      more information.
    </p><p>
      If you did not modify the <code class="literal">ENGINE</code> clauses in the
      table definitions prior to importing the SQL script, you should
      run the following statements at this point:
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>USE world;</code></strong>
mysql&gt; <strong class="userinput"><code>ALTER TABLE City ENGINE=NDBCLUSTER;</code></strong>
mysql&gt; <strong class="userinput"><code>ALTER TABLE Country ENGINE=NDBCLUSTER;</code></strong>
mysql&gt; <strong class="userinput"><code>ALTER TABLE CountryLanguage ENGINE=NDBCLUSTER;</code></strong>
</pre><p>
      Selecting a database and running a <span><strong class="command">SELECT</strong></span> query
      against a table in that database is also accomplished in the usual
      manner, as is exiting the MySQL Monitor:
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>USE world;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT Name, Population FROM City ORDER BY Population DESC LIMIT 5;</code></strong>
+-----------+------------+
| Name      | Population |
+-----------+------------+
| Bombay    |   10500000 |
| Seoul     |    9981619 |
| São Paulo |    9968485 |
| Shanghai  |    9696300 |
| Jakarta   |    9604900 |
+-----------+------------+
5 rows in set (0.34 sec)

mysql&gt; <strong class="userinput"><code>\q</code></strong>
Bye

shell&gt;
</pre><p>
      Applications that use MySQL can employ standard APIs to access
      <code class="literal">NDB</code> tables. It is important to remember that
      your application must access the SQL node, and not the management
      or data nodes. This brief example shows how we might execute the
      <code class="literal">SELECT</code> statement just shown by using the PHP
      5.X <code class="literal">mysqli</code> extension running on a Web server
      elsewhere on the network:
    </p><pre class="programlisting">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;meta http-equiv="Content-Type"
        content="text/html; charset=iso-8859-1"&gt;
  &lt;title&gt;SIMPLE mysqli SELECT&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;?php
  # connect to SQL node:
  $link = new mysqli('192.168.0.20', 'root', '<em class="replaceable"><code>root_password</code></em>', 'world');
  # parameters for mysqli constructor are:
  #   host, user, password, database

  if( mysqli_connect_errno() )
    die("Connect failed: " . mysqli_connect_error());

  $query = "SELECT Name, Population
            FROM City
            ORDER BY Population DESC
            LIMIT 5";

  # if no errors...
  if( $result = $link-&gt;query($query) )
  {
?&gt;
&lt;table border="1" width="40%" cellpadding="4" cellspacing ="1"&gt;
  &lt;tbody&gt;
  &lt;tr&gt;
    &lt;th width="10%"&gt;City&lt;/th&gt;
    &lt;th&gt;Population&lt;/th&gt;
  &lt;/tr&gt;
&lt;?
    # then display the results...
    while($row = $result-&gt;fetch_object())
      printf(&lt;tr&gt;\n  &lt;td align=\"center\"&gt;%s&lt;/td&gt;&lt;td&gt;%d&lt;/td&gt;\n&lt;/tr&gt;\n",
              $row-&gt;Name, $row-&gt;Population);
?&gt;
  &lt;/tbody
&lt;/table&gt;
&lt;?
  # ...and verify the number of rows that were retrieved
    printf("&lt;p&gt;Affected rows: %d&lt;/p&gt;\n", $link-&gt;affected_rows);
  }
  else
    # otherwise, tell us what went wrong
    echo mysqli_error();

  # free the result set and the mysqli connection object
  $result-&gt;close();
  $link-&gt;close();
?&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre><p>
      We assume that the process running on the Web server can reach the
      IP address of the SQL node.
    </p><p>
      In a similar fashion, you can use the MySQL C API, Perl-DBI,
      Python-mysql, or MySQL AB's own Connectors to perform the tasks of
      data definition and manipulation just as you would normally with
      MySQL.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-multi-shutdown-restart"></a>20.2.6. Safe Shutdown and Restart</h3></div></div></div><a class="indexterm" name="id2325578"></a><a class="indexterm" name="id2325590"></a><p>
      To shut down the cluster, enter the following command in a shell
      on the machine hosting the management node:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgm -e shutdown</code></strong>
</pre><p>
      The <code class="option">-e</code> option here is used to pass a command to
      the <span><strong class="command">ndb_mgm</strong></span> client from the shell. (See
      <a href="mysql-cluster.html#mysql-cluster-command-options" title="20.6.5. Command Options for MySQL Cluster Processes">Section 20.6.5, “Command Options for MySQL Cluster Processes”</a>, for more
      information about this option.) The command causes the
      <span><strong class="command">ndb_mgm</strong></span>, <span><strong class="command">ndb_mgmd</strong></span>, and any
      <span><strong class="command">ndbd</strong></span> processes to terminate gracefully. Any SQL
      nodes can be terminated using <span><strong class="command">mysqladmin
      shutdown</strong></span> and other means.
    </p><p>
      To restart the cluster, run these commands:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          On the management host (<code class="literal">192.168.0.10</code> in our
          example setup):
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgmd -f /var/lib/mysql-cluster/config.ini</code></strong>
</pre></li><li><p>
          On each of the data node hosts
          (<code class="literal">192.168.0.30</code> and
          <code class="literal">192.168.0.40</code>):
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndbd</code></strong>
</pre></li><li><p>
          On the SQL host (<code class="literal">192.168.0.20</code>):
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysqld_safe &amp;</code></strong>
</pre></li></ul></div><p>
      In a production setting, it is usually not desirable to shut down
      the cluster completely. In many cases, even when making
      configuration changes, or performing upgrades to the cluster
      hardware or software (or both), which require shutting down
      individual host machines, it is possible to do so without shutting
      down the cluster as a whole by performing a <em class="firstterm">rolling
      restart</em> of the cluster. For more information about
      doing this, see <a href="mysql-cluster.html#mysql-cluster-rolling-restart" title="20.5.1. Performing a Rolling Restart of the Cluster">Section 20.5.1, “Performing a Rolling Restart of the Cluster”</a>.
    </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-configuration"></a>20.3. MySQL Cluster Configuration</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-building">20.3.1. Building MySQL Cluster from Source Code</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-installing">20.3.2. Installing the Cluster Software</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-quick">20.3.3. Quick Test Setup of MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-config-file">20.3.4. Configuration File</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-config-params-overview">20.3.5. Overview of Cluster Configuration Parameters</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-config-lcp-params">20.3.6. Configuring Parameters for Local Checkpoints</a></span></dt></dl></div><a class="indexterm" name="id2325774"></a><a class="indexterm" name="id2325783"></a><p>
    A MySQL server that is part of a MySQL Cluster differs in only one
    respect from a normal (non-clustered) MySQL server, in that it
    employs the <code class="literal">NDBCLUSTER</code> storage engine. This
    engine is also referred to simply as <code class="literal">NDB</code>, and the
    two forms of the name are synonymous.
  </p><p>
    To avoid unnecessary allocation of resources, the server is
    configured by default with the <code class="literal">NDB</code> storage engine
    disabled. To enable <code class="literal">NDB</code>, you must modify the
    server's <code class="filename">my.cnf</code> configuration file, or start
    the server with the <code class="option">--ndbcluster</code> option.
  </p><p>
    For more information about <code class="option">--ndbcluster</code> and other
    MySQL server options specific to MySQL Cluster, see
    <a href="mysql-cluster.html#mysql-cluster-mysqld-command-options" title="20.4.2. MySQL Cluster-Related Command Options for mysqld">Section 20.4.2, “MySQL Cluster-Related Command Options for <span><strong class="command">mysqld</strong></span>”</a>.
  </p><p>
    The MySQL server is a part of the cluster, so it also must know how
    to access an MGM node to obtain the cluster configuration data. The
    default behavior is to look for the MGM node on
    <code class="literal">localhost</code>. However, should you need to specify
    that its location is elsewhere, this can be done in
    <code class="filename">my.cnf</code> or on the MySQL server command line.
    Before the <code class="literal">NDB</code> storage engine can be used, at
    least one MGM node must be operational, as well as any desired data
    nodes.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-building"></a>20.3.1. Building MySQL Cluster from Source Code</h3></div></div></div><a class="indexterm" name="id2325884"></a><p>
      <code class="literal">NDB</code>, the Cluster storage engine, is available
      in binary distributions for Linux, Mac OS X, and Solaris. We are
      working to make Cluster run on all operating systems supported by
      MySQL, including Windows.
    </p><p>
      If you choose to build from a source tarball or one of the MySQL
      Cluster public development trees, be sure to use the
      <code class="option">--with-ndbcluster</code> option when running
      <span><strong class="command">configure</strong></span>. You can also use the
      <span><strong class="command">BUILD/compile-pentium-max</strong></span> build script. Note
      that this script includes OpenSSL, so you must either have or
      obtain OpenSSL to build successfully, or else modify
      <span><strong class="command">compile-pentium-max</strong></span> to exclude this
      requirement. Of course, you can also just follow the standard
      instructions for compiling your own binaries, and then perform the
      usual tests and installation procedure. See
      <a href="installing.html#installing-source-tree" title="2.9.3. Installing from the Development Source Tree">Section 2.9.3, “Installing from the Development Source Tree”</a>.
    </p><p>
      <span><strong class="command">BUILD/compile-pentium-max</strong></span> also includes
      OpenSSL, so you must either have or obtain OpenSSL to build
      successfully, or else modify
      <span><strong class="command">compile-pentium-max</strong></span> to exclude this
      requirement. Of course, you can also just follow the standard
      instructions for compiling your own binaries, and then perform the
      usual tests and installation procedure. See
      <a href="installing.html#installing-source-tree" title="2.9.3. Installing from the Development Source Tree">Section 2.9.3, “Installing from the Development Source Tree”</a>.
    </p><p>
      You should also note that <span><strong class="command">compile-pentium-max</strong></span>
      installs MySQL to the directory
      <code class="filename">/usr/local/mysql</code>, placing all MySQL Cluster
      executables, scripts, databases, and support files in
      subdirectories under this directory. If this is not what you
      desire, be sure to modify the script accordingly.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-installing"></a>20.3.2. Installing the Cluster Software</h3></div></div></div><a class="indexterm" name="id2325990"></a><a class="indexterm" name="id2325999"></a><p>
      In the next few sections, we assume that you are already familiar
      with installing MySQL, and here we cover only the differences
      between configuring MySQL Cluster and configuring MySQL without
      clustering. (See <a href="installing.html" title="Chapter 2. Installing and Upgrading MySQL">Chapter 2, <i>Installing and Upgrading MySQL</i></a>, if you require more
      information about the latter.)
    </p><p>
      You will find Cluster configuration easiest if you have already
      have all management and data nodes running first; this is likely
      to be the most time-consuming part of the configuration. Editing
      the <code class="filename">my.cnf</code> file is fairly straightforward,
      and this section will cover only any differences from configuring
      MySQL without clustering.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-quick"></a>20.3.3. Quick Test Setup of MySQL Cluster</h3></div></div></div><a class="indexterm" name="id2326043"></a><a class="indexterm" name="id2326056"></a><a class="indexterm" name="id2326068"></a><p>
      To familiarize you with the basics, we will describe the simplest
      possible configuration for a functional MySQL Cluster. After this,
      you should be able to design your desired setup from the
      information provided in the other relevant sections of this
      chapter.
    </p><p>
      First, you need to create a configuration directory such as
      <code class="filename">/var/lib/mysql-cluster</code>, by executing the
      following command as the system <code class="literal">root</code> user:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mkdir /var/lib/mysql-cluster</code></strong>
</pre><p>
      In this directory, create a file named
      <code class="filename">config.ini</code> that contains the following
      information. Substitute appropriate values for
      <code class="literal">HostName</code> and <code class="literal">DataDir</code> as
      necessary for your system.
    </p><pre class="programlisting"># file "config.ini" - showing minimal setup consisting of 1 data node,
# 1 management server, and 3 MySQL servers.
# The empty default sections are not required, and are shown only for
# the sake of completeness.
# Data nodes must provide a hostname but MySQL Servers are not required
# to do so.
# If you don't know the hostname for your machine, use localhost.
# The DataDir parameter also has a default value, but it is recommended to
# set it explicitly.
# Note: [db], [api], and [mgm] are aliases for [ndbd], [mysqld], and [ndb_mgmd],
# respectively. [db] is deprecated and should not be used in new installations.

[ndbd default]
NoOfReplicas= 1

[mysqld  default]
[ndb_mgmd default]
[tcp default]

[ndb_mgmd]
HostName= myhost.example.com

[ndbd]
HostName= myhost.example.com
DataDir= /var/lib/mysql-cluster

[mysqld]
[mysqld]
[mysqld]
</pre><p>
      You can now start the <span><strong class="command">ndb_mgmd</strong></span> management
      server. By default, it attempts to read the
      <code class="filename">config.ini</code> file in its current working
      directory, so change location into the directory where the file is
      located and then invoke <span><strong class="command">ndb_mgmd</strong></span>:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cd /var/lib/mysql-cluster</code></strong>
shell&gt; <strong class="userinput"><code>ndb_mgmd</code></strong>
</pre><p>
      Then start a single data node by running <span><strong class="command">ndbd</strong></span>:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndbd</code></strong>
</pre><p>
      For command-line options which can be used when starting
      <span><strong class="command">ndbd</strong></span>, see
      <a href="mysql-cluster.html#mysql-cluster-command-options" title="20.6.5. Command Options for MySQL Cluster Processes">Section 20.6.5, “Command Options for MySQL Cluster Processes”</a>.
    </p><p>
      By default, <span><strong class="command">ndbd</strong></span> looks for the management
      server at <code class="literal">localhost</code> on port 1186.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        If you have installed MySQL from a binary tarball, you will need
        to specify the path of the <span><strong class="command">ndb_mgmd</strong></span> and
        <span><strong class="command">ndbd</strong></span> servers explicitly. (Normally, these
        will be found in <code class="filename">/usr/local/mysql/bin</code>.)
      </p></div><p>
      Finally, change location to the MySQL data directory (usually
      <code class="filename">/var/lib/mysql</code> or
      <code class="filename">/usr/local/mysql/data</code>), and make sure that
      the <code class="filename">my.cnf</code> file contains the option necessary
      to enable the NDB storage engine:
    </p><pre class="programlisting">[mysqld]
ndbcluster
</pre><p>
      You can now start the MySQL server as usual:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysqld_safe --user=mysql &amp;</code></strong>
</pre><p>
      Wait a moment to make sure the MySQL server is running properly.
      If you see the notice <code class="literal">mysql ended</code>, check the
      server's <code class="filename">.err</code> file to find out what went
      wrong.
    </p><p>
      If all has gone well so far, you now can start using the cluster.
      Connect to the server and verify that the
      <code class="literal">NDBCLUSTER</code> storage engine is enabled:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysql</code></strong>
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 1 to server version: 5.1.28

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.

mysql&gt; <strong class="userinput"><code>SHOW ENGINES\G</code></strong>
...
*************************** 12. row ***************************
Engine: NDBCLUSTER
Support: YES
Comment: Clustered, fault-tolerant, memory-based tables
*************************** 13. row ***************************
Engine: NDB
Support: YES
Comment: Alias for NDBCLUSTER
...
</pre><p>
      The row numbers shown in the preceding example output may be
      different from those shown on your system, depending upon how your
      server is configured.
    </p><p>
      Try to create an <code class="literal">NDBCLUSTER</code> table:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysql</code></strong>
mysql&gt; <strong class="userinput"><code>USE test;</code></strong>
Database changed

mysql&gt; <strong class="userinput"><code>CREATE TABLE ctest (i INT) ENGINE=NDBCLUSTER;</code></strong>
Query OK, 0 rows affected (0.09 sec)

mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE ctest \G</code></strong>
*************************** 1. row ***************************
       Table: ctest
Create Table: CREATE TABLE `ctest` (
  `i` int(11) default NULL
) ENGINE=ndbcluster DEFAULT CHARSET=latin1
1 row in set (0.00 sec)
</pre><p>
      To check that your nodes were set up properly, start the
      management client:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgm</code></strong>
</pre><a class="indexterm" name="id2326424"></a><p>
      Use the <span><strong class="command">SHOW</strong></span> command from within the management
      client to obtain a report on the cluster's status:
    </p><pre class="programlisting">ndb_mgm&gt; <strong class="userinput"><code>SHOW</code></strong>
Cluster Configuration
---------------------
[ndbd(NDB)]     1 node(s)
id=2    @127.0.0.1  (Version: 3.5.3, Nodegroup: 0, Master)

[ndb_mgmd(MGM)] 1 node(s)
id=1    @127.0.0.1  (Version: 3.5.3)

[mysqld(API)]   3 node(s)
id=3    @127.0.0.1  (Version: 3.5.3)
id=4 (not connected, accepting connect from any host)
id=5 (not connected, accepting connect from any host)
</pre><p>
      At this point, you have successfully set up a working MySQL
      Cluster. You can now store data in the cluster by using any table
      created with <code class="literal">ENGINE=NDBCLUSTER</code> or its alias
      <code class="literal">ENGINE=NDB</code>.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-config-file"></a>20.3.4. Configuration File</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-config-example">20.3.4.1. Basic Example Configuration</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-connectstring">20.3.4.2. The Cluster Connectstring</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-computer-definition">20.3.4.3. Defining Cluster Computers</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-mgm-definition">20.3.4.4. Defining the Management Server</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-ndbd-definition">20.3.4.5. Defining Data Nodes</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-api-definition">20.3.4.6. Defining SQL and Other API Nodes</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-tcp-definition">20.3.4.7. Cluster TCP/IP Connections</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-tcp-definition-direct">20.3.4.8. TCP/IP Connections Using Direct Connections</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-shm-definition">20.3.4.9. Shared-Memory Connections</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-sci-definition">20.3.4.10. SCI Transport Connections</a></span></dt></dl></div><a class="indexterm" name="id2326487"></a><a class="indexterm" name="id2326500"></a><a class="indexterm" name="id2326512"></a><p>
      Configuring MySQL Cluster requires working with two files:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          <code class="filename">my.cnf</code>: Specifies options for all MySQL
          Cluster executables. This file, with which you should be
          familiar with from previous work with MySQL, must be
          accessible by each executable running in the cluster.
        </p></li><li><p>
          <code class="filename">config.ini</code>: This file is read only by the
          MySQL Cluster management server, which then distributes the
          information contained therein to all processes participating
          in the cluster. <code class="filename">config.ini</code> contains a
          description of each node involved in the cluster. This
          includes configuration parameters for data nodes and
          configuration parameters for connections between all nodes in
          the cluster. For a quick reference to the sections that can
          appear in this file, and what sorts of configuration
          parameters may be placed in each section, see
          <a href="mysql-cluster.html#mysql-cluster-config-ini-sections">Sections of
          the <code class="filename">config.ini</code> File</a>.
        </p></li></ul></div><p>
      We are continuously making improvements in Cluster configuration
      and attempting to simplify this process. Although we strive to
      maintain backward compatibility, there may be times when introduce
      an incompatible change. In such cases we will try to let Cluster
      users know in advance if a change is not backward compatible. If
      you find such a change and we have not documented it, please
      report it in the MySQL bugs database using the instructions given
      in <a href="introduction.html#bug-reports" title="1.7. How to Report Bugs or Problems">Section 1.7, “How to Report Bugs or Problems”</a>.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-config-example"></a>20.3.4.1. Basic Example Configuration</h4></div></div></div><a class="indexterm" name="id2326598"></a><a class="indexterm" name="id2326611"></a><a class="indexterm" name="id2326623"></a><p>
        To support MySQL Cluster, you will need to update
        <code class="filename">my.cnf</code> as shown in the following example.
        Note that the options shown here should not be confused with
        those that are used in <code class="filename">config.ini</code> files.
        You may also specify these parameters on the command line when
        invoking the executables.
      </p><pre class="programlisting"># my.cnf
# example additions to my.cnf for MySQL Cluster
# (valid in MySQL 5.1)

# enable ndbcluster storage engine, and provide connectstring for
# management server host (default port is 1186)
[mysqld]
ndbcluster
ndb-connectstring=ndb_mgmd.mysql.com


# provide connectstring for management server host (default port: 1186)
[ndbd]
connect-string=ndb_mgmd.mysql.com

# provide connectstring for management server host (default port: 1186)
[ndb_mgm]
connect-string=ndb_mgmd.mysql.com

# provide location of cluster configuration file
[ndb_mgmd]
config-file=/etc/config.ini
</pre><p>
        (For more information on connectstrings, see
        <a href="mysql-cluster.html#mysql-cluster-connectstring" title="20.3.4.2. The Cluster Connectstring">Section 20.3.4.2, “The Cluster Connectstring”</a>.)
      </p><pre class="programlisting"># my.cnf
# example additions to my.cnf for MySQL Cluster
# (will work on all versions)

# enable ndbcluster storage engine, and provide connectstring for management
# server host to the default port 1186
[mysqld]
ndbcluster
ndb-connectstring=ndb_mgmd.mysql.com:1186
</pre><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
          Once you have started a <span><strong class="command">mysqld</strong></span> process with
          the <code class="literal">ndbcluster</code> and
          <code class="literal">ndb-connectstring</code> parameters in the
          <code class="literal">[mysqld]</code> in the <code class="filename">my.cnf</code>
          file as shown previously, you cannot execute any
          <code class="literal">CREATE TABLE</code> or <code class="literal">ALTER
          TABLE</code> statements without having actually started the
          cluster. Otherwise, these statements will fail with an error.
          <span class="emphasis"><em>This is by design</em></span>.
        </p></div><p>
        You may also use a separate <code class="literal">[mysql_cluster]</code>
        section in the cluster <code class="filename">my.cnf</code> file for
        settings to be read and used by all executables:
      </p><pre class="programlisting"># cluster-specific settings
[mysql_cluster]
ndb-connectstring=ndb_mgmd.mysql.com:1186
</pre><p>
        For additional <code class="literal">NDB</code> variables that can be set
        in the <code class="filename">my.cnf</code> file, see
        <a href="server-administration.html#server-system-variables" title="5.1.3. System Variables">Section 5.1.3, “System Variables”</a>.
      </p><p>
        The configuration file is named <code class="filename">config.ini</code>
        by default. It is read by <span><strong class="command">ndb_mgmd</strong></span> at startup
        and can be placed anywhere. Its location and name are specified
        by using
        <code class="option">--config-file=<em class="replaceable"><code>path_name</code></em></code>
        on the <span><strong class="command">ndb_mgmd</strong></span> command line. If the
        configuration file is not specified, <span><strong class="command">ndb_mgmd</strong></span>
        by default tries to read a file named
        <code class="filename">config.ini</code> located in the current working
        directory.
      </p><p>
        Currently, the configuration file is in INI format, which
        consists of sections preceded by section headings (surrounded by
        square brackets), followed by the appropriate parameter names
        and values. One deviation from the standard INI format is that
        the parameter name and value can be separated by a colon
        (“<span class="quote"><code class="literal">:</code></span>”) as well as the equals sign
        (“<span class="quote"><code class="literal">=</code></span>”); however, the equals sign
        is preferred. Another deviation is that sections are not
        uniquely identified by section name. Instead, unique sections
        (such as two different nodes of the same type) are identified by
        a unique ID specified as a parameter within the section.
      </p><p>
        Default values are defined for most parameters, and can also be
        specified in <code class="filename">config.ini</code>. To create a
        default value section, simply add the word
        <code class="literal">default</code> to the section name. For example, an
        <code class="literal">[ndbd]</code> section contains parameters that apply
        to a particular data node, whereas an <code class="literal">[ndbd
        default]</code> section contains parameters that apply to all
        data nodes. Suppose that all data nodes should use the same data
        memory size. To configure them all, create an <code class="literal">[ndbd
        default]</code> section that contains a
        <code class="literal">DataMemory</code> line to specify the data memory
        size.
      </p><p>
        At a minimum, the configuration file must define the computers
        and nodes involved in the cluster and on which computers these
        nodes are located. An example of a simple configuration file for
        a cluster consisting of one management server, two data nodes
        and two MySQL servers is shown here:
      </p><pre class="programlisting"># file "config.ini" - 2 data nodes and 2 SQL nodes
# This file is placed in the startup directory of ndb_mgmd (the
# management server)
# The first MySQL Server can be started from any host. The second
# can be started only on the host mysqld_5.mysql.com

[ndbd default]
NoOfReplicas= 2
DataDir= /var/lib/mysql-cluster

[ndb_mgmd]
Hostname= ndb_mgmd.mysql.com
DataDir= /var/lib/mysql-cluster

[ndbd]
HostName= ndbd_2.mysql.com

[ndbd]
HostName= ndbd_3.mysql.com

[mysqld]
[mysqld]
HostName= mysqld_5.mysql.com
</pre><p>
        Each node has its own section in the
        <code class="filename">config.ini</code> file. For example, this cluster
        has two data nodes, so the preceding configuration file contains
        two <code class="literal">[ndbd]</code> sections defining these nodes.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          Do not place comments on the same line as a section heading in
          the <code class="filename">config.ini</code> file; this causes the
          management server not to start because it cannot parse the
          configuration file in such cases.
        </p></div><p><a name="mysql-cluster-config-ini-sections"></a>
        <span class="bold"><strong>Sections of the
        <code class="filename">config.ini</code> File</strong></span>
      </p><p>
        There are six different sections that you can use in the
        <code class="filename">config.ini</code> configuration file, as described
        in the following list:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            <code class="literal">[computer]</code>: Defines cluster hosts. This
            is not required to configure a viable MySQL Cluster, but be
            may used as a convenience when setting up a large cluster.
            See <a href="mysql-cluster.html#mysql-cluster-computer-definition" title="20.3.4.3. Defining Cluster Computers">Section 20.3.4.3, “Defining Cluster Computers”</a>, for
            more information.
          </p></li><li><p>
            <code class="literal">[ndbd]</code>: Defines a cluster data node
            (<span><strong class="command">ndbd</strong></span> process). See
            <a href="mysql-cluster.html#mysql-cluster-ndbd-definition" title="20.3.4.5. Defining Data Nodes">Section 20.3.4.5, “Defining Data Nodes”</a>, for
            details.
          </p></li><li><p>
            <code class="literal">[mysqld]</code>: Defines the cluster's MySQL
            server nodes (also called SQL or API nodes). For a
            discussion of SQL node configuration, see
            <a href="mysql-cluster.html#mysql-cluster-api-definition" title="20.3.4.6. Defining SQL and Other API Nodes">Section 20.3.4.6, “Defining SQL and Other API Nodes”</a>.
          </p></li><li><p>
            <code class="literal">[mgm]</code> or <code class="literal">[ndb_mgmd]</code>:
            Defines a cluster management server (MGM) node. For
            information concerning the configuration of MGM nodes, see
            <a href="mysql-cluster.html#mysql-cluster-mgm-definition" title="20.3.4.4. Defining the Management Server">Section 20.3.4.4, “Defining the Management Server”</a>.
          </p></li><li><p>
            <code class="literal">[tcp]</code>: Defines a TCP/IP connection
            between cluster nodes, with TCP/IP being the default
            connection protocol. Normally, <code class="literal">[tcp]</code> or
            <code class="literal">[tcp default]</code> sections are not required
            to set up a MySQL Cluster, as the cluster handles this
            automatically; however, it may be necessary in some
            situations to override the defaults provided by the cluster.
            See <a href="mysql-cluster.html#mysql-cluster-tcp-definition" title="20.3.4.7. Cluster TCP/IP Connections">Section 20.3.4.7, “Cluster TCP/IP Connections”</a>, for
            information about available TCP/IP configuration parameters
            and how to use them. (You may also find
            <a href="mysql-cluster.html#mysql-cluster-tcp-definition-direct" title="20.3.4.8. TCP/IP Connections Using Direct Connections">Section 20.3.4.8, “TCP/IP Connections Using Direct Connections”</a> to be
            of interest in some cases.)
          </p></li><li><p>
            <code class="literal">[shm]</code>: Defines shared-memory connections
            between nodes. In MySQL 5.1, it is enabled by
            default, but should still be considered experimental. For a
            discussion of SHM interconnects, see
            <a href="mysql-cluster.html#mysql-cluster-shm-definition" title="20.3.4.9. Shared-Memory Connections">Section 20.3.4.9, “Shared-Memory Connections”</a>.
          </p></li><li><p>
            <code class="literal">[sci]</code>:Defines <em class="firstterm">Scalable
            Coherent Interface</em> connections between cluster
            data nodes. Such connections require software which, while
            freely available, is not part of the MySQL Cluster
            distribution, as well as specialised hardware. See
            <a href="mysql-cluster.html#mysql-cluster-sci-definition" title="20.3.4.10. SCI Transport Connections">Section 20.3.4.10, “SCI Transport Connections”</a> for detailed
            information about SCI interconnects.
          </p></li></ul></div><p>
        You can define <code class="literal">default</code> values for each
        section. All Cluster parameter names are case-insensitive, which
        differs from parameters specified in <code class="filename">my.cnf</code>
        or <code class="filename">my.ini</code> files.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-connectstring"></a>20.3.4.2. The Cluster Connectstring</h4></div></div></div><a class="indexterm" name="id2327157"></a><a class="indexterm" name="id2327170"></a><p>
        With the exception of the MySQL Cluster management server
        (<span><strong class="command">ndb_mgmd</strong></span>), each node that is part of a MySQL
        Cluster requires a <em class="firstterm">connectstring</em> that
        points to the management server's location. This connectstring
        is used in establishing a connection to the management server as
        well as in performing other tasks depending on the node's role
        in the cluster. The syntax for a connectstring is as follows:
      </p><pre class="programlisting">&lt;connectstring&gt; :=
    [&lt;nodeid-specification&gt;,]&lt;host-specification&gt;[,&lt;host-specification&gt;]

&lt;nodeid-specification&gt; := <em class="replaceable"><code>node_id</code></em>

&lt;host-specification&gt; := <em class="replaceable"><code>host_name</code></em>[:<em class="replaceable"><code>port_num</code></em>]
</pre><p>
        <code class="literal">node_id</code> is an integer larger than 1 which
        identifies a node in <code class="filename">config.ini</code>.
        <em class="replaceable"><code>host_name</code></em> is a string representing a
        valid Internet host name or IP address.
        <em class="replaceable"><code>port_num</code></em> is an integer referring to a
        TCP/IP port number.
      </p><pre class="programlisting">example 1 (long):    "nodeid=2,myhost1:1100,myhost2:1100,192.168.0.3:1200"
example 2 (short):   "myhost1"
</pre><p>
        All nodes will use <code class="literal">localhost:1186</code> as the
        default connectstring value if none is provided. If
        <em class="replaceable"><code>port_num</code></em> is omitted from the
        connectstring, the default port is 1186. This port should always
        be available on the network because it has been assigned by IANA
        for this purpose (see
        <a href="http://www.iana.org/assignments/port-numbers" target="_top">http://www.iana.org/assignments/port-numbers</a> for
        details).
      </p><p>
        By listing multiple
        <code class="literal">&lt;host-specification&gt;</code> values, it is
        possible to designate several redundant management servers. A
        cluster node will attempt to contact successive management
        servers on each host in the order specified, until a successful
        connection has been established.
      </p><p>
        There are a number of different ways to specify the
        connectstring:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            Each executable has its own command-line option which
            enables specifying the management server at startup. (See
            the documentation for the respective executable.)
          </p></li><li><p>
            It is also possible to set the connectstring for all nodes
            in the cluster at once by placing it in a
            <code class="literal">[mysql_cluster]</code> section in the management
            server's <code class="filename">my.cnf</code> file.
          </p></li><li><p>
            For backward compatibility, two other options are available,
            using the same syntax:
          </p><div class="orderedlist"><ol type="1"><li><p>
                Set the <code class="envar">NDB_CONNECTSTRING</code> environment
                variable to contain the connectstring.
              </p></li><li><p>
                Write the connectstring for each executable into a text
                file named <code class="filename">Ndb.cfg</code> and place this
                file in the executable's startup directory.
              </p></li></ol></div><p>
            However, these are now deprecated and should not be used for
            new installations.
          </p></li></ul></div><p>
        The recommended method for specifying the connectstring is to
        set it on the command line or in the <code class="filename">my.cnf</code>
        file for each executable.
      </p><p>
        The maximum length of a connectstring is 1024 characters.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-computer-definition"></a>20.3.4.3. Defining Cluster Computers</h4></div></div></div><a class="indexterm" name="id2327384"></a><a class="indexterm" name="id2327396"></a><p>
        The <code class="literal">[computer]</code> section has no real
        significance other than serving as a way to avoid the need of
        defining host names for each node in the system. All parameters
        mentioned here are required.
      </p><div class="itemizedlist"><ul type="disc"><li><p><a name="id-computer-definition"></a>
            <code class="literal">Id</code>
          </p><p>
            This is an integer value, used to refer to the host computer
            elsewhere in the configuration file. This is not the same as
            the node ID.
          </p></li><li><p><a name="hostname-computer-definition"></a>
            <code class="literal">HostName</code>
          </p><p>
            This is the computer's hostname or IP address.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-mgm-definition"></a>20.3.4.4. Defining the Management Server</h4></div></div></div><a class="indexterm" name="id2327470"></a><a class="indexterm" name="id2327482"></a><p>
        The <code class="literal">[ndb_mgmd]</code> section is used to configure
        the behavior of the management server. <code class="literal">[mgm]</code>
        can be used as an alias; the two section names are equivalent.
        All parameters in the following list are optional and assume
        their default values if omitted.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          If neither the <code class="literal">ExecuteOnComputer</code> nor the
          <code class="literal">HostName</code> parameter is present, the default
          value <code class="literal">localhost</code> will be assumed for both.
        </p></div><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2327541"></a><p><a name="mysql-cluster-param-mgm-definition-id"></a>
            <code class="literal">Id</code>
          </p><p>
            Each node in the cluster has a unique identity, which is
            represented by an integer value in the range 1 to 63
            inclusive. This ID is used by all internal cluster messages
            for addressing the node.
          </p></li><li><a class="indexterm" name="id2327570"></a><p><a name="mysql-cluster-param-mgm-definition-executeoncomputer"></a>
            <code class="literal">ExecuteOnComputer</code>
          </p><p>
            This refers to the <code class="literal">Id</code> set for one of the
            computers defined in a <code class="literal">[computer]</code> section
            of the <code class="filename">config.ini</code> file.
          </p></li><li><a class="indexterm" name="id2327615"></a><p><a name="mysql-cluster-param-mgm-definition-portnumber"></a>
            <code class="literal">PortNumber</code>
          </p><p>
            This is the port number on which the management server
            listens for configuration requests and management commands.
          </p></li><li><a class="indexterm" name="id2327643"></a><p><a name="mysql-cluster-param-mgm-definition-hostname"></a>
            <code class="literal">HostName</code>
          </p><p>
            Specifying this parameter defines the hostname of the
            computer on which the management node is to reside. To
            specify a hostname other than <code class="literal">localhost</code>,
            either this parameter or
            <code class="literal">ExecuteOnComputer</code> is required.
          </p></li><li><a class="indexterm" name="id2327684"></a><p><a name="mysql-cluster-param-mgm-definition-logdestination"></a>
            <code class="literal">LogDestination</code>
          </p><p>
            This parameter specifies where to send cluster logging
            information. There are three options in this regard —
            <code class="literal">CONSOLE</code>, <code class="literal">SYSLOG</code>, and
            <code class="literal">FILE</code> — with <code class="literal">FILE</code>
            being the default:
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                <code class="literal">CONSOLE</code> outputs the log to
                <code class="literal">stdout</code>:
              </p><pre class="programlisting">CONSOLE
</pre></li><li><p>
                <code class="literal">SYSLOG</code> sends the log to a
                <code class="literal">syslog</code> facility, possible values
                being one of <code class="literal">auth</code>,
                <code class="literal">authpriv</code>, <code class="literal">cron</code>,
                <code class="literal">daemon</code>, <code class="literal">ftp</code>,
                <code class="literal">kern</code>, <code class="literal">lpr</code>,
                <code class="literal">mail</code>, <code class="literal">news</code>,
                <code class="literal">syslog</code>, <code class="literal">user</code>,
                <code class="literal">uucp</code>, <code class="literal">local0</code>,
                <code class="literal">local1</code>, <code class="literal">local2</code>,
                <code class="literal">local3</code>, <code class="literal">local4</code>,
                <code class="literal">local5</code>, <code class="literal">local6</code>, or
                <code class="literal">local7</code>.
              </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                  Not every facility is necessarily supported by every
                  operating system.
                </p></div><pre class="programlisting">SYSLOG:facility=syslog
</pre></li><li><p>
                <code class="literal">FILE</code> pipes the cluster log output to
                a regular file on the same machine. The following values
                can be specified:
              </p><div class="itemizedlist"><ul type="square"><li><p>
                    <code class="literal">filename</code>: The name of the log
                    file.
                  </p></li><li><p>
                    <code class="literal">maxsize</code>: The maximum size (in
                    bytes) to which the file can grow before logging
                    rolls over to a new file. When this occurs, the old
                    log file is renamed by appending
                    <em class="replaceable"><code>.N</code></em> to the filename, where
                    <em class="replaceable"><code>N</code></em> is the next number not
                    yet used with this name.
                  </p></li><li><p>
                    <code class="literal">maxfiles</code>: The maximum number of
                    log files.
                  </p></li></ul></div><pre class="programlisting">FILE:filename=cluster.log,maxsize=1000000,maxfiles=6
</pre><p>
                The default value for the <code class="literal">FILE</code>
                parameter is
                <code class="literal">FILE:filename=ndb_<em class="replaceable"><code>node_id</code></em>_cluster.log,maxsize=1000000,maxfiles=6</code>,
                where <em class="replaceable"><code>node_id</code></em> is the ID of
                the node.
              </p></li></ul></div><p>
            It is possible to specify multiple log destinations
            separated by semicolons as shown here:
          </p><pre class="programlisting">CONSOLE;SYSLOG:facility=local0;FILE:filename=/var/log/mgmd
</pre></li><li><a class="indexterm" name="id2328020"></a><p><a name="mysql-cluster-param-mgm-definition-arbitrationrank"></a>
            <code class="literal">ArbitrationRank</code>
          </p><p>
            This parameter is used to define which nodes can act as
            arbitrators. Only management nodes and SQL nodes can be
            arbitrators. <code class="literal">ArbitrationRank</code> can take one
            of the following values:
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                <code class="literal">0</code>: The node will never be used as an
                arbitrator.
              </p></li><li><p>
                <code class="literal">1</code>: The node has high priority; that
                is, it will be preferred as an arbitrator over
                low-priority nodes.
              </p></li><li><p>
                <code class="literal">2</code>: Indicates a low-priority node
                which be used as an arbitrator only if a node with a
                higher priority is not available for that purpose.
              </p></li></ul></div><p>
            Normally, the management server should be configured as an
            arbitrator by setting its <code class="literal">ArbitrationRank</code>
            to 1 (the default value) and that of all SQL nodes to 0.
          </p><p>
            Beginning with MySQL 5.1.16 and MySQL Cluster NDB 6.1.3, it
            is possible to disable arbitration completely by setting
            <code class="literal">ArbitrationRank</code> to 0 on all management
            and SQL nodes.
          </p></li><li><a class="indexterm" name="id2328119"></a><p><a name="mysql-cluster-param-mgm-definition-arbitrationdelay"></a>
            <code class="literal">ArbitrationDelay</code>
          </p><p>
            An integer value which causes the management server's
            responses to arbitration requests to be delayed by that
            number of milliseconds. By default, this value is 0; it is
            normally not necessary to change it.
          </p></li><li><a class="indexterm" name="id2328148"></a><p><a name="mysql-cluster-param-mgm-definition-datadir"></a>
            <code class="literal">DataDir</code>
          </p><p>
            This specifies the directory where output files from the
            management server will be placed. These files include
            cluster log files, process output files, and the daemon's
            process ID (PID) file. (For log files, this location can be
            overridden by setting the <code class="literal">FILE</code> parameter
            for <code class="literal">LogDestination</code> as discussed
            previously in this section.)
          </p><p>
            The default value for this parameter is the directory in
            which <span><strong class="command">ndb_mgmd</strong></span> is located.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-ndbd-definition"></a>20.3.4.5. Defining Data Nodes</h4></div></div></div><a class="indexterm" name="id2328208"></a><a class="indexterm" name="id2328221"></a><p>
        The <code class="literal">[ndbd]</code> and<code class="literal">[ndbd
        default]</code>sections are used to configure the behavior of
        the cluster's data nodes. There are many parameters which
        control buffer sizes, pool sizes, timeouts, and so forth. The
        only mandatory parameters are:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            Either <code class="literal">ExecuteOnComputer</code> or
            <code class="literal">HostName</code>, which must be defined in the
            local <code class="literal">[ndbd]</code> section.
          </p></li><li><p>
            The parameter <code class="literal">NoOfReplicas</code>, which must be
            defined in the<code class="literal">[ndbd default]</code>section, as
            it is common to all Cluster data nodes.
          </p></li></ul></div><p>
        Most data node parameters are set in the <code class="literal">[ndbd
        default]</code> section. Only those parameters explicitly
        stated as being able to set local values are allowed to be
        changed in the <code class="literal">[ndbd]</code> section. Where present,
        <code class="literal">HostName</code>, <code class="literal">Id</code> and
        <code class="literal">ExecuteOnComputer</code> <span class="emphasis"><em>must</em></span>
        be defined in the local <code class="literal">[ndbd]</code> section, and
        not in any other section of <code class="filename">config.ini</code>. In
        other words, settings for these parameters are specific to one
        data node.
      </p><p>
        For those parameters affecting memory usage or buffer sizes, it
        is possible to use <code class="literal">K</code>, <code class="literal">M</code>,
        or <code class="literal">G</code> as a suffix to indicate units of 1024,
        1024×1024, or 1024×1024×1024. (For example,
        <code class="literal">100K</code> means 100 × 1024 = 102400.)
        Parameter names and values are currently case-sensitive.
      </p><p><b>Identifying data nodes. </b>
          The <code class="literal">Id</code> value (that is, the data node
          identifier) can be allocated on the command line when the node
          is started or in the configuration file.
        </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2328403"></a><p><a name="mysql-cluster-param-ndbd-definition-id"></a>
            <code class="literal">Id</code>
          </p><p>
            This is the node ID used as the address of the node for all
            cluster internal messages. For data nodes, this is an
            integer in the range 1 to 49 inclusive. Each node in the
            cluster must have a unique identity.
          </p></li><li><a class="indexterm" name="id2328431"></a><p><a name="mysql-cluster-param-ndbd-definition-executeoncomputer"></a>
            <code class="literal">ExecuteOnComputer</code>
          </p><p>
            This refers to the <code class="literal">Id</code> set for one of the
            computers defined in a <code class="literal">[computer]</code>
            section.
          </p></li><li><a class="indexterm" name="id2328471"></a><p><a name="mysql-cluster-param-ndbd-definition-hostname"></a>
            <code class="literal">HostName</code>
          </p><p>
            Specifying this parameter defines the hostname of the
            computer on which the data node is to reside. To specify a
            hostname other than <code class="literal">localhost</code>, either
            this parameter or <code class="literal">ExecuteOnComputer</code> is
            required.
          </p></li><li><a class="indexterm" name="id2328511"></a><p><a name="mysql-cluster-param-ndbd-definition-serverport"></a>
            <code class="literal">ServerPort</code>
            (<span class="emphasis"><em>OBSOLETE</em></span>)
          </p><p>
            Each node in the cluster uses a port to connect to other
            nodes. This port is used also for non-TCP transporters in
            the connection setup phase. The default port is allocated
            dynamically in such a way as to ensure that no two nodes on
            the same computer receive the same port number, so it should
            not normally be necessary to specify a value for this
            parameter.
          </p></li><li><p><a name="mysql-cluster-param-ndbd-definition-tcpbind-inaddr-any"></a>
            <code class="literal">TcpBind_INADDR_ANY</code>
          </p><p>
            Setting this parameter to <code class="literal">TRUE</code> or
            <code class="literal">1</code> binds <code class="literal">IP_ADDR_ANY</code> so
            that connections can be made from anywhere (for
            autogenerated connections). The default is
            <code class="literal">FALSE</code> (<code class="literal">0</code>).
          </p><p>
            This parameter was added in MySQL Cluster NDB 6.2.0.
          </p></li><li><a class="indexterm" name="id2328598"></a><p><a name="mysql-cluster-param-ndbd-definition-noofreplicas"></a>
            <code class="literal">NoOfReplicas</code>
          </p><p>
            This global parameter can be set only in the <code class="literal">[ndbd
            default]</code> section, and defines the number of
            replicas for each table stored in the cluster. This
            parameter also specifies the size of node groups. A node
            group is a set of nodes all storing the same information.
          </p><p>
            Node groups are formed implicitly. The first node group is
            formed by the set of data nodes with the lowest node IDs,
            the next node group by the set of the next lowest node
            identities, and so on. By way of example, assume that we
            have 4 data nodes and that <code class="literal">NoOfReplicas</code>
            is set to 2. The four data nodes have node IDs 2, 3, 4 and
            5. Then the first node group is formed from nodes 2 and 3,
            and the second node group by nodes 4 and 5. It is important
            to configure the cluster in such a manner that nodes in the
            same node groups are not placed on the same computer because
            a single hardware failure would cause the entire cluster to
            fail.
          </p><p>
            If no node IDs are provided, the order of the data nodes
            will be the determining factor for the node group. Whether
            or not explicit assignments are made, they can be viewed in
            the output of the management client's
            <code class="literal">SHOW</code> statement.
          </p><p>
            There is no default value for
            <code class="literal">NoOfReplicas</code>; the maximum possible value
            is 4. Currently, only the values 1 and 2 are actually
            supported (see <a href="http://bugs.mysql.com/18621" target="_top">Bug#18621</a>).
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              Setting <code class="literal">NoOfReplicas</code> to 1 means that
              there is only a single copy of all Cluster data; in this
              case, the loss of a single data node causes the cluster to
              fail because there are no additional copies of the data
              stored by that node.
            </p></div><p>
            The value for this parameter must divide evenly into the
            number of data nodes in the cluster. For example, if there
            are two data nodes, then <code class="literal">NoOfReplicas</code>
            must be equal to either 1 or 2, since 2/3 and 2/4 both yield
            fractional values; if there are four data nodes, then
            <code class="literal">NoOfReplicas</code> must be equal to 1, 2, or 4.
          </p></li><li><a class="indexterm" name="id2328711"></a><p><a name="mysql-cluster-param-ndbd-definition-datadir"></a>
            <code class="literal">DataDir</code>
          </p><p>
            This parameter specifies the directory where trace files,
            log files, pid files and error logs are placed.
          </p></li><li><a class="indexterm" name="id2328739"></a><p><a name="mysql-cluster-param-ndbd-definition-filesystempath"></a>
            <code class="literal">FileSystemPath</code>
          </p><p>
            This parameter specifies the directory where all files
            created for metadata, REDO logs, UNDO logs (for Disk Data
            tables) and data files are placed. The default is the
            directory specified by <code class="literal">DataDir</code>.
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              This directory must exist before the
              <span><strong class="command">ndbd</strong></span> process is initiated.
            </p></div><p>
            The recommended directory hierarchy for MySQL Cluster
            includes <code class="filename">/var/lib/mysql-cluster</code>, under
            which a directory for the node's filesystem is created. The
            name of this subdirectory contains the node ID. For example,
            if the node ID is 2, this subdirectory is named
            <code class="filename">ndb_2_fs</code>.
          </p></li><li><a class="indexterm" name="id2328805"></a><p><a name="mysql-cluster-param-ndbd-definition-backupdatadir"></a>
            <code class="literal">BackupDataDir</code>
          </p><p>
            This parameter specifies the directory in which backups are
            placed. If omitted, the default backup location is the
            directory named <code class="filename">BACKUP</code> under the
            location specified by the <code class="literal">FileSystemPath</code>
            parameter. (See above.)
          </p></li></ul></div><p><a name="mysql-cluster-data-memory-index-memory-string-memory"></a>
        <span class="bold"><strong>Data Memory, Index Memory, and String
        Memory</strong></span>
      </p><p>
        <code class="literal">DataMemory</code> and <code class="literal">IndexMemory</code>
        are <code class="literal">[ndbd]</code> parameters specifying the size of
        memory segments used to store the actual records and their
        indexes. In setting values for these, it is important to
        understand how <code class="literal">DataMemory</code> and
        <code class="literal">IndexMemory</code> are used, as they usually need to
        be updated to reflect actual usage by the cluster:
      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2328897"></a><p><a name="mysql-cluster-param-ndbd-definition-datamemory"></a>
            <code class="literal">DataMemory</code>
          </p><p>
            This parameter defines the amount of space (in bytes)
            available for storing database records. The entire amount
            specified by this value is allocated in memory, so it is
            extremely important that the machine has sufficient physical
            memory to accommodate it.
          </p><p>
            The memory allocated by <code class="literal">DataMemory</code> is
            used to store both the actual records and indexes. There is
            a 16-byte overhead on each record; an additional amount for
            each record is incurred because it is stored in a 32KB page
            with 128 byte page overhead (see below). There is also a
            small amount wasted per page due to the fact that each
            record is stored in only one page.
          </p><p>
            For variable-size table attributes in MySQL 5.1, the data is
            stored on separate datapages, allocated from
            <code class="literal">DataMemory</code>. Variable-length records use a
            fixed-size part with an extra overhead of 4 bytes to
            reference the variable-size part. The variable-size part has
            2 bytes overhead plus 2 bytes per attribute.
          </p><p>
            The maximum record size is currently 8052 bytes.
          </p><p>
            The memory space defined by <code class="literal">DataMemory</code> is
            also used to store ordered indexes, which use about 10 bytes
            per record. Each table row is represented in the ordered
            index. A common error among users is to assume that all
            indexes are stored in the memory allocated by
            <code class="literal">IndexMemory</code>, but this is not the case:
            Only primary key and unique hash indexes use this memory;
            ordered indexes use the memory allocated by
            <code class="literal">DataMemory</code>. However, creating a primary
            key or unique hash index also creates an ordered index on
            the same keys, unless you specify <code class="literal">USING
            HASH</code> in the index creation statement. This can be
            verified by running <span><strong class="command">ndb_desc -d
            <em class="replaceable"><code>db_name</code></em>
            <em class="replaceable"><code>table_name</code></em></strong></span> in the
            management client.
          </p><p>
            The memory space allocated by <code class="literal">DataMemory</code>
            consists of 32KB pages, which are allocated to table
            fragments. Each table is normally partitioned into the same
            number of fragments as there are data nodes in the cluster.
            Thus, for each node, there are the same number of fragments
            as are set in <code class="literal">NoOfReplicas</code>.
          </p><p>
            In addition, due to the way in which new pages are allocated
            when the capacity of the current page is exhausted, there is
            an additional overhead of approximately 18.75%. When more
            <code class="literal">DataMemory</code> is required, more than one new
            page is allocated, according to the following formula:

</p><pre class="programlisting">number of new pages = FLOOR(number of current pages × 0.1875) + 1
</pre><p>

            For example, if 15 pages are currently allocated to a given
            table and an insert to this table requires additional
            storage space, the number of new pages allocated to the
            table is <code class="literal">FLOOR(15 × 0.1875) + 1 =
            FLOOR(2.8125) + 1 = 2 + 1 =
            3</code>. Now 15 + 3 = 18 memory pages are
            allocated to the table. When the last of these 18 pages
            becomes full, <code class="literal">FLOOR(18 × 0.1875) + 1
            = FLOOR(3.3750) + 1 = 3 + 1 =
            4</code> new pages are allocated, so the total number of
            pages allocated to the table is now 22.
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              The “<span class="quote">18.75% + 1</span>” overhead is no longer
              required beginning with MySQL Cluster NDB 6.2.3 and MySQL
              Cluster NDB 6.3.0.
            </p></div><p>
            Once a page has been allocated, it is currently not possible
            to return it to the pool of free pages, except by deleting
            the table. (This also means that
            <code class="literal">DataMemory</code> pages, once allocated to a
            given table, cannot be used by other tables.) Performing a
            node recovery also compresses the partition because all
            records are inserted into empty partitions from other live
            nodes.
          </p><p>
            The <code class="literal">DataMemory</code> memory space also contains
            UNDO information: For each update, a copy of the unaltered
            record is allocated in the <code class="literal">DataMemory</code>.
            There is also a reference to each copy in the ordered table
            indexes. Unique hash indexes are updated only when the
            unique index columns are updated, in which case a new entry
            in the index table is inserted and the old entry is deleted
            upon commit. For this reason, it is also necessary to
            allocate enough memory to handle the largest transactions
            performed by applications using the cluster. In any case,
            performing a few large transactions holds no advantage over
            using many smaller ones, for the following reasons:
          </p><a class="indexterm" name="id2329099"></a><div class="itemizedlist"><ul type="circle"><li><p>
                Large transactions are not any faster than smaller ones
              </p></li><li><p>
                Large transactions increase the number of operations
                that are lost and must be repeated in event of
                transaction failure
              </p></li><li><p>
                Large transactions use more memory
              </p></li></ul></div><p>
            The default value for <code class="literal">DataMemory</code> is 80MB;
            the minimum is 1MB. There is no maximum size, but in reality
            the maximum size has to be adapted so that the process does
            not start swapping when the limit is reached. This limit is
            determined by the amount of physical RAM available on the
            machine and by the amount of memory that the operating
            system may commit to any one process. 32-bit operating
            systems are generally limited to 2–4GB per process;
            64-bit operating systems can use more. For large databases,
            it may be preferable to use a 64-bit operating system for
            this reason.
          </p></li><li><a class="indexterm" name="id2329160"></a><p><a name="mysql-cluster-param-ndbd-definition-indexmemory"></a>
            <code class="literal">IndexMemory</code>
          </p><p>
            This parameter controls the amount of storage used for hash
            indexes in MySQL Cluster. Hash indexes are always used for
            primary key indexes, unique indexes, and unique constraints.
            Note that when defining a primary key and a unique index,
            two indexes will be created, one of which is a hash index
            used for all tuple accesses as well as lock handling. It is
            also used to enforce unique constraints.
          </p><p>
            The size of the hash index is 25 bytes per record, plus the
            size of the primary key. For primary keys larger than 32
            bytes another 8 bytes is added.
          </p><p>
            The default value for <code class="literal">IndexMemory</code> is
            18MB. The minimum is 1MB.
          </p></li><li><a class="indexterm" name="id2329206"></a><p><a name="mysql-cluster-param-ndbd-definition-stringmemory"></a>
            <code class="literal">StringMemory</code>
          </p><p>
            This parameter determines how much memory is allocated for
            strings such as table names, and is specified in an
            <code class="literal">[ndbd]</code> or <code class="literal">[ndbd
            default]</code> section of the
            <code class="filename">config.ini</code> file. A value between
            <code class="literal">0</code> and <code class="literal">100</code> inclusive is
            interpreted as a percent of the maximum default value, which
            is calculated based on a number of factors including the
            number of tables, maximum table name size, maximum size of
            <code class="filename">.FRM</code> files,
            <code class="literal">MaxNoOfTriggers</code>, maximum column name
            size, and maximum default column value. In general it is
            safe to assume that the maximum default value is
            approximately 5 MB for a MySQL Cluster having 1000 tables.
          </p><p>
            A value greater than <code class="literal">100</code> is interpreted
            as a number of bytes.
          </p><p>
            The default value is <code class="literal">5</code> — that is, 5
            percent of the default maximum, or roughly 5 KB. (Note that
            this is a change from previous versions of MySQL Cluster.)
          </p><p>
            Under most circumstances, the default value should be
            sufficient, but when you have a great many Cluster tables
            (1000 or more), it is possible to get Error 773
            <span class="errortext">Out of string memory, please modify StringMemory
            config parameter: Permanent error: Schema error</span>,
            in which case you should increase this value.
            <code class="literal">25</code> (25 percent) is not excessive, and
            should prevent this error from recurring in all but the most
            extreme conditions.
          </p></li></ul></div><p>
        The following example illustrates how memory is used for a
        table. Consider this table definition:
      </p><pre class="programlisting">CREATE TABLE example (
  a INT NOT NULL,
  b INT NOT NULL,
  c INT NOT NULL,
  PRIMARY KEY(a),
  UNIQUE(b)
) ENGINE=NDBCLUSTER;
</pre><p>
        For each record, there are 12 bytes of data plus 12 bytes
        overhead. Having no nullable columns saves 4 bytes of overhead.
        In addition, we have two ordered indexes on columns
        <code class="literal">a</code> and <code class="literal">b</code> consuming roughly
        10 bytes each per record. There is a primary key hash index on
        the base table using roughly 29 bytes per record. The unique
        constraint is implemented by a separate table with
        <code class="literal">b</code> as primary key and <code class="literal">a</code> as
        a column. This other table consumes an additional 29 bytes of
        index memory per record in the <code class="literal">example</code> table
        as well 8 bytes of record data plus 12 bytes of overhead.
      </p><p>
        Thus, for one million records, we need 58MB for index memory to
        handle the hash indexes for the primary key and the unique
        constraint. We also need 64MB for the records of the base table
        and the unique index table, plus the two ordered index tables.
      </p><p>
        You can see that hash indexes takes up a fair amount of memory
        space; however, they provide very fast access to the data in
        return. They are also used in MySQL Cluster to handle uniqueness
        constraints.
      </p><p>
        Currently, the only partitioning algorithm is hashing and
        ordered indexes are local to each node. Thus, ordered indexes
        cannot be used to handle uniqueness constraints in the general
        case.
      </p><p>
        An important point for both <code class="literal">IndexMemory</code> and
        <code class="literal">DataMemory</code> is that the total database size is
        the sum of all data memory and all index memory for each node
        group. Each node group is used to store replicated information,
        so if there are four nodes with two replicas, there will be two
        node groups. Thus, the total data memory available is 2 ×
        <code class="literal">DataMemory</code> for each data node.
      </p><p>
        It is highly recommended that <code class="literal">DataMemory</code> and
        <code class="literal">IndexMemory</code> be set to the same values for all
        nodes. Data distribution is even over all nodes in the cluster,
        so the maximum amount of space available for any node can be no
        greater than that of the smallest node in the cluster.
      </p><p>
        <code class="literal">DataMemory</code> and <code class="literal">IndexMemory</code>
        can be changed, but decreasing either of these can be risky;
        doing so can easily lead to a node or even an entire MySQL
        Cluster that is unable to restart due to there being
        insufficient memory space. Increasing these values should be
        acceptable, but it is recommended that such upgrades are
        performed in the same manner as a software upgrade, beginning
        with an update of the configuration file, and then restarting
        the management server followed by restarting each data node in
        turn.
      </p><p>
        Updates do not increase the amount of index memory used. Inserts
        take effect immediately; however, rows are not actually deleted
        until the transaction is committed.
      </p><p><b>Transaction parameters. </b>
          The next three <code class="literal">[ndbd]</code> parameters that we
          discuss are important because they affect the number of
          parallel transactions and the sizes of transactions that can
          be handled by the system.
          <code class="literal">MaxNoOfConcurrentTransactions</code> sets the
          number of parallel transactions possible in a node.
          <code class="literal">MaxNoOfConcurrentOperations</code> sets the number
          of records that can be in update phase or locked
          simultaneously.
        </p><p>
        Both of these parameters (especially
        <code class="literal">MaxNoOfConcurrentOperations</code>) are likely
        targets for users setting specific values and not using the
        default value. The default value is set for systems using small
        transactions, to ensure that these do not use excessive memory.
      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2329501"></a><p><a name="mysql-cluster-param-ndbd-definition-maxnoofconcurrenttransactions"></a>
            <code class="literal">MaxNoOfConcurrentTransactions</code>
          </p><p>
            Each cluster data node requires a transaction record for
            each active transaction in the cluster. The task of
            coordinating transactions is distributed among all of the
            data nodes. The total number of transaction records in the
            cluster is the number of transactions in any given node
            times the number of nodes in the cluster.
          </p><p>
            Transaction records are allocated to individual MySQL
            servers. Each connection to a MySQL server requires at least
            one transaction record, plus an additional transaction
            object per table accessed by that connection. This means
            that a reasonable minimum for this parameter is

</p><pre class="programlisting">MaxNoOfConcurrentTransactions = 
    (maximum number of tables accessed in any single transaction + 1)
    * number of cluster SQL nodes
</pre><p>

            For example, suppose that there are 4 SQL nodes using the
            cluster. A single join involving 5 tables requires 6
            transaction records; if there are 5 such joins in a
            transaction, then 5 * 6 = 30 transaction records are
            required for this transaction, per MySQL server, or 30 * 4 =
            120 transaction records total.
          </p><p>
            This parameter must be set to the same value for all cluster
            data nodes. This is due to the fact that, when a data node
            fails, the oldest surviving node re-creates the transaction
            state of all transactions that were ongoing in the failed
            node.
          </p><p>
            Changing the value of
            <code class="literal">MaxNoOfConcurrentTransactions</code> requires a
            complete shutdown and restart of the cluster.
          </p><p>
            The default value is 4096.
          </p></li><li><a class="indexterm" name="id2329571"></a><p><a name="mysql-cluster-param-ndbd-definition-maxnoofconcurrentoperations"></a>
            <code class="literal">MaxNoOfConcurrentOperations</code>
          </p><p>
            It is a good idea to adjust the value of this parameter
            according to the size and number of transactions. When
            performing transactions of only a few operations each and
            not involving a great many records, there is no need to set
            this parameter very high. When performing large transactions
            involving many records need to set this parameter higher.
          </p><p>
            Records are kept for each transaction updating cluster data,
            both in the transaction coordinator and in the nodes where
            the actual updates are performed. These records contain
            state information needed to find UNDO records for rollback,
            lock queues, and other purposes.
          </p><p>
            This parameter should be set to the number of records to be
            updated simultaneously in transactions, divided by the
            number of cluster data nodes. For example, in a cluster
            which has four data nodes and which is expected to handle
            1,000,000 concurrent updates using transactions, you should
            set this value to 1000000 / 4 = 250000.
          </p><p>
            Read queries which set locks also cause operation records to
            be created. Some extra space is allocated within individual
            nodes to accommodate cases where the distribution is not
            perfect over the nodes.
          </p><p>
            When queries make use of the unique hash index, there are
            actually two operation records used per record in the
            transaction. The first record represents the read in the
            index table and the second handles the operation on the base
            table.
          </p><p>
            The default value is 32768.
          </p><p>
            This parameter actually handles two values that can be
            configured separately. The first of these specifies how many
            operation records are to be placed with the transaction
            coordinator. The second part specifies how many operation
            records are to be local to the database.
          </p><p>
            A very large transaction performed on an eight-node cluster
            requires as many operation records in the transaction
            coordinator as there are reads, updates, and deletes
            involved in the transaction. However, the operation records
            of the are spread over all eight nodes. Thus, if it is
            necessary to configure the system for one very large
            transaction, it is a good idea to configure the two parts
            separately. <code class="literal">MaxNoOfConcurrentOperations</code>
            will always be used to calculate the number of operation
            records in the transaction coordinator portion of the node.
          </p><p>
            It is also important to have an idea of the memory
            requirements for operation records. These consume about 1KB
            per record.
          </p></li><li><a class="indexterm" name="id2329655"></a><p><a name="mysql-cluster-param-ndbd-definition-maxnooflocaloperations"></a>
            <code class="literal">MaxNoOfLocalOperations</code>
          </p><p>
            By default, this parameter is calculated as 1.1 ×
            <code class="literal">MaxNoOfConcurrentOperations</code>. This fits
            systems with many simultaneous transactions, none of them
            being very large. If there is a need to handle one very
            large transaction at a time and there are many nodes, it is
            a good idea to override the default value by explicitly
            specifying this parameter.
          </p></li></ul></div><p><b>Transaction temporary storage. </b>
          The next set of <code class="literal">[ndbd]</code> parameters is used
          to determine temporary storage when executing a statement that
          is part of a Cluster transaction. All records are released
          when the statement is completed and the cluster is waiting for
          the commit or rollback.
        </p><p>
        The default values for these parameters are adequate for most
        situations. However, users with a need to support transactions
        involving large numbers of rows or operations may need to
        increase these values to enable better parallelism in the
        system, whereas users whose applications require relatively
        small transactions can decrease the values to save memory.
      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2329724"></a><p><a name="mysql-cluster-param-ndbd-definition-maxnoofconcurrentindexoperations"></a>
            <code class="literal">MaxNoOfConcurrentIndexOperations</code>
          </p><p>
            For queries using a unique hash index, another temporary set
            of operation records is used during a query's execution
            phase. This parameter sets the size of that pool of records.
            Thus, this record is allocated only while executing a part
            of a query. As soon as this part has been executed, the
            record is released. The state needed to handle aborts and
            commits is handled by the normal operation records, where
            the pool size is set by the parameter
            <code class="literal">MaxNoOfConcurrentOperations</code>.
          </p><p>
            The default value of this parameter is 8192. Only in rare
            cases of extremely high parallelism using unique hash
            indexes should it be necessary to increase this value. Using
            a smaller value is possible and can save memory if the DBA
            is certain that a high degree of parallelism is not required
            for the cluster.
          </p></li><li><a class="indexterm" name="id2329768"></a><p><a name="mysql-cluster-param-ndbd-definition-maxnooffiredtriggers"></a>
            <code class="literal">MaxNoOfFiredTriggers</code>
          </p><p>
            The default value of <code class="literal">MaxNoOfFiredTriggers</code>
            is 4000, which is sufficient for most situations. In some
            cases it can even be decreased if the DBA feels certain the
            need for parallelism in the cluster is not high.
          </p><p>
            A record is created when an operation is performed that
            affects a unique hash index. Inserting or deleting a record
            in a table with unique hash indexes or updating a column
            that is part of a unique hash index fires an insert or a
            delete in the index table. The resulting record is used to
            represent this index table operation while waiting for the
            original operation that fired it to complete. This operation
            is short-lived but can still require a large number of
            records in its pool for situations with many parallel write
            operations on a base table containing a set of unique hash
            indexes.
          </p></li><li><a class="indexterm" name="id2329813"></a><p><a name="mysql-cluster-param-ndbd-definition-transactionbuffermemory"></a>
            <code class="literal">TransactionBufferMemory</code>
          </p><p>
            The memory affected by this parameter is used for tracking
            operations fired when updating index tables and reading
            unique indexes. This memory is used to store the key and
            column information for these operations. It is only very
            rarely that the value for this parameter needs to be altered
            from the default.
          </p><p>
            The default value for
            <code class="literal">TransactionBufferMemory</code> is 1MB.
          </p><p>
            Normal read and write operations use a similar buffer, whose
            usage is even more short-lived. The compile-time parameter
            <code class="literal">ZATTRBUF_FILESIZE</code> (found in
            <code class="filename">ndb/src/kernel/blocks/Dbtc/Dbtc.hpp</code>)
            set to 4000 × 128 bytes (500KB). A similar buffer for
            key information, <code class="literal">ZDATABUF_FILESIZE</code> (also
            in <code class="filename">Dbtc.hpp</code>) contains 4000 × 16 =
            62.5KB of buffer space. <code class="literal">Dbtc</code> is the
            module that handles transaction coordination.
          </p></li></ul></div><p><b>Scans and buffering. </b>
          There are additional <code class="literal">[ndbd]</code> parameters in
          the <code class="literal">Dblqh</code> module (in
          <code class="filename">ndb/src/kernel/blocks/Dblqh/Dblqh.hpp</code>)
          that affect reads and updates. These include
          <code class="literal">ZATTRINBUF_FILESIZE</code>, set by default to
          10000 × 128 bytes (1250KB) and
          <code class="literal">ZDATABUF_FILE_SIZE</code>, set by default to
          10000*16 bytes (roughly 156KB) of buffer space. To date, there
          have been neither any reports from users nor any results from
          our own extensive tests suggesting that either of these
          compile-time limits should be increased.
        </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2329940"></a><p><a name="mysql-cluster-param-ndbd-definition-maxnoofconcurrentscans"></a>
            <code class="literal">MaxNoOfConcurrentScans</code>
          </p><p>
            This parameter is used to control the number of parallel
            scans that can be performed in the cluster. Each transaction
            coordinator can handle the number of parallel scans defined
            for this parameter. Each scan query is performed by scanning
            all partitions in parallel. Each partition scan uses a scan
            record in the node where the partition is located, the
            number of records being the value of this parameter times
            the number of nodes. The cluster should be able to sustain
            <code class="literal">MaxNoOfConcurrentScans</code> scans concurrently
            from all nodes in the cluster.
          </p><p>
            Scans are actually performed in two cases. The first of
            these cases occurs when no hash or ordered indexes exists to
            handle the query, in which case the query is executed by
            performing a full table scan. The second case is encountered
            when there is no hash index to support the query but there
            is an ordered index. Using the ordered index means executing
            a parallel range scan. The order is kept on the local
            partitions only, so it is necessary to perform the index
            scan on all partitions.
          </p><p>
            The default value of
            <code class="literal">MaxNoOfConcurrentScans</code> is 256. The
            maximum value is 500.
          </p></li><li><a class="indexterm" name="id2330002"></a><p><a name="mysql-cluster-param-ndbd-definition-maxnooflocalscans"></a>
            <code class="literal">MaxNoOfLocalScans</code>
          </p><p>
            Specifies the number of local scan records if many scans are
            not fully parallelized. If the number of local scan records
            is not provided, it is calculated as the product of
            <code class="literal">MaxNoOfConcurrentScans</code> and the number of
            data nodes in the system. The minimum value is 32.
          </p></li><li><a class="indexterm" name="id2330038"></a><p><a name="mysql-cluster-param-ndbd-definition-batchsizeperlocalscan"></a>
            <code class="literal">BatchSizePerLocalScan</code>
          </p><p>
            This parameter is used to calculate the number of lock
            records used to handle concurrent scan operations.
          </p><p>
            The default value is 64; this value has a strong connection
            to the <code class="literal">ScanBatchSize</code> defined in the SQL
            nodes.
          </p></li><li><a class="indexterm" name="id2330076"></a><p><a name="mysql-cluster-param-ndbd-definition-longmessagebuffer"></a>
            <code class="literal">LongMessageBuffer</code>
          </p><p>
            This is an internal buffer used for passing messages within
            individual nodes and between nodes. Although it is highly
            unlikely that this would need to be changed, it is
            configurable. By default, it is set to 1MB.
          </p></li></ul></div><p><a name="mysql-cluster-memory-allocation"></a>
        <span class="bold"><strong>Memory Allocation</strong></span>
      </p><p><a name="mysql-cluster-param-ndbd-definition-maxallocate"></a>
        <code class="literal">MaxAllocate</code>
      </p><p>
        This is the maximum size of the memory unit to use when
        allocating memory for tables. In cases where
        <code class="literal">NDB</code> gives <span class="errortext">Out of
        memory</span> errors, but it is evident by examining the
        cluster logs or the output of <code class="literal">DUMP 1000</code> (see
        <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-dump-command-1000.html" target="_top"><code class="literal">DUMP 1000</code></a>) that all
        available memory has not yet been used, you can increase the
        value of this parameter (or <code class="literal">MaxNoOfTables</code>, or
        both) in order to cause <code class="literal">NDB</code> to make
        sufficient memory available.
      </p><p>
        This parameter was introduced in MySQL 5.1.20, MySQL Cluster NDB
        6.1.12 and MySQL MySQL Cluster NDB 6.2.3.
      </p><p><b>Logging and checkpointing. </b>
          These <code class="literal">[ndbd]</code> parameters control log and
          checkpoint behavior.
        </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2330196"></a><p><a name="mysql-cluster-param-ndbd-definition-nooffragmentlogfiles"></a>
            <code class="literal">NoOfFragmentLogFiles</code>
          </p><p>
            This parameter sets the number of REDO log files for the
            node, and thus the amount of space allocated to REDO
            logging. Because the REDO log files are organized in a ring,
            it is extremely important that the first and last log files
            in the set (sometimes referred to as the “<span class="quote">head</span>”
            and “<span class="quote">tail</span>” log files, respectively) do not
            meet. When these approach one another too closely, the node
            begins aborting all transactions encompassing updates due to
            a lack of room for new log records.
          </p><p>
            A <code class="literal">REDO</code> log record is not removed until
            three local checkpoints have been completed since that log
            record was inserted. Checkpointing frequency is determined
            by its own set of configuration parameters discussed
            elsewhere in this chapter.
          </p><p>
            How these parameters interact and proposals for how to
            configure them are discussed in
            <a href="mysql-cluster.html#mysql-cluster-config-lcp-params" title="20.3.6. Configuring Parameters for Local Checkpoints">Section 20.3.6, “Configuring Parameters for Local Checkpoints”</a>.
          </p><p>
            The default parameter value is 16, which by default means 16
            sets of 4 16MB files for a total of 1024MB. Beginning with
            MySQL Cluster NDB 6.1.1, the size of the individual log
            files is configurable using the
            <code class="literal">FragmentLogFileSize</code> parameter; more
            information about this parameter can be found
            <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-fragmentlogfilesize">here</a>.
            In scenarios requiring a great many updates, the value for
            <code class="literal">NoOfFragmentLogFiles</code> may need to be set
            as high as 300 or even higher to provide sufficient space
            for REDO logs.
          </p><p>
            If the checkpointing is slow and there are so many writes to
            the database that the log files are full and the log tail
            cannot be cut without jeopardizing recovery, all updating
            transactions are aborted with internal error code 410
            (<code class="literal">Out of log file space temporarily</code>). This
            condition prevails until a checkpoint has completed and the
            log tail can be moved forward.
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              This parameter cannot be changed “<span class="quote">on the
              fly</span>”; you must restart the node using
              <code class="option">--initial</code>. If you wish to change this
              value for all data nodes in a running cluster, you can do
              so via a rolling node restart (using
              <code class="option">--initial</code> when starting each data node).
            </p></div></li><li><a class="indexterm" name="id2330315"></a><p><a name="mysql-cluster-param-ndbd-definition-fragmentlogfilesize"></a>
            <code class="literal">FragmentLogFileSize</code>
          </p><p>
            Setting this parameter allows you to control directly the
            size of redo log files. This can be useful in situations
            when MySQL Cluster is operating under a high load and it is
            unable to close fragment log files quickly enough before
            attemtping to open new ones (only 2 fragment log files can
            be open at one time); increasing the size of the fragment
            log files gives the cluster more time before having to open
            each new fragment log file. The default value for this
            parameter is 16M. <code class="literal">FragmentLogFileSize</code> was
            added in MySQL MySQL Cluster NDB 6.1.11.
          </p><p>
            For more information about fragment log files, see the
            description of the
            <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-nooffragmentlogfiles">NoOfFragmentLogFiles
            parameter</a>.
          </p></li><li><a class="indexterm" name="id2330364"></a><p><a name="mysql-cluster-param-ndbd-definition-maxnoofopenfiles"></a>
            <code class="literal">MaxNoOfOpenFiles</code>
          </p><p>
            This parameter sets a ceiling on how many internal threads
            to allocate for open files. <span class="emphasis"><em>Any situation
            requiring a change in this parameter should be reported as a
            bug</em></span>.
          </p><p>
            The default value is 40.
          </p></li><li><a class="indexterm" name="id2330406"></a><p><a name="mysql-cluster-param-ndbd-definition-initialnoofopenfiles"></a>
            <code class="literal">InitialNoOfOpenFiles</code>
          </p><p>
            This parameter sets the initial number of internal threads
            to allocate for open files.
          </p><p>
            The default value is 27.
          </p></li><li><a class="indexterm" name="id2330438"></a><p><a name="mysql-cluster-param-ndbd-definition-maxnoofsavedmessages"></a>
            <code class="literal">MaxNoOfSavedMessages</code>
          </p><p>
            This parameter sets the maximum number of trace files that
            are kept before overwriting old ones. Trace files are
            generated when, for whatever reason, the node crashes.
          </p><p>
            The default is 25 trace files.
          </p></li></ul></div><p><b>Metadata objects. </b>
          The next set of <code class="literal">[ndbd]</code> parameters defines
          pool sizes for metadata objects, used to define the maximum
          number of attributes, tables, indexes, and trigger objects
          used by indexes, events, and replication between clusters.
          Note that these act merely as “<span class="quote">suggestions</span>” to
          the cluster, and any that are not specified revert to the
          default values shown.
        </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2330499"></a><p><a name="mysql-cluster-param-ndbd-definition-maxnoofattributes"></a>
            <code class="literal">MaxNoOfAttributes</code>
          </p><p>
            Defines the number of attributes that can be defined in the
            cluster.
          </p><p>
            The default value is 1000, with the minimum possible value
            being 32. The maximum is 4294967039. Each attribute consumes
            around 200 bytes of storage per node due to the fact that
            all metadata is fully replicated on the servers.
          </p><p>
            When setting <code class="literal">MaxNoOfAttributes</code>, it is
            important to prepare in advance for any <code class="literal">ALTER
            TABLE</code> statements that you might want to perform in
            the future. This is due to the fact, during the execution of
            <code class="literal">ALTER TABLE</code> on a Cluster table, 3 times
            the number of attributes as in the original table are used.
            For example, if a table requires 100 attributes, and you
            want to be able to alter it later, you need to set the value
            of <code class="literal">MaxNoOfAttributes</code> to 300. Assuming
            that you can create all desired tables without any problems,
            a good rule of thumb is to add two times the number of
            attributes in the largest table to
            <code class="literal">MaxNoOfAttributes</code> to be sure. You should
            also verify that this number is sufficient by trying an
            actual <code class="literal">ALTER TABLE</code> after configuring the
            parameter. If this is not successful, increase
            <code class="literal">MaxNoOfAttributes</code> by another multiple of
            the original value and test it again.
          </p></li><li><a class="indexterm" name="id2330586"></a><p><a name="mysql-cluster-param-ndbd-definition-maxnooftables"></a>
            <code class="literal">MaxNoOfTables</code>
          </p><p>
            A table object is allocated for each table, unique hash
            index, and ordered index. This parameter sets the maximum
            number of table objects for the cluster as a whole.
          </p><p>
            For each attribute that has a <code class="literal">BLOB</code> data
            type an extra table is used to store most of the
            <code class="literal">BLOB</code> data. These tables also must be
            taken into account when defining the total number of tables.
          </p><p>
            The default value of this parameter is 128. The minimum is 8
            and the maximum is 1600. Each table object consumes
            approximately 20KB per node.
          </p></li><li><a class="indexterm" name="id2330636"></a><p><a name="mysql-cluster-param-ndbd-definition-maxnooforderedindexes"></a>
            <code class="literal">MaxNoOfOrderedIndexes</code>
          </p><p>
            For each ordered index in the cluster, an object is
            allocated describing what is being indexed and its storage
            segments. By default, each index so defined also defines an
            ordered index. Each unique index and primary key has both an
            ordered index and a hash index.
          </p><p>
            The default value of this parameter is 128. Each object
            consumes approximately 10KB of data per node.
          </p></li><li><a class="indexterm" name="id2330671"></a><p><a name="mysql-cluster-param-ndbd-definition-maxnoofuniquehashindexes"></a>
            <code class="literal">MaxNoOfUniqueHashIndexes</code>
          </p><p>
            For each unique index that is not a primary key, a special
            table is allocated that maps the unique key to the primary
            key of the indexed table. By default, an ordered index is
            also defined for each unique index. To prevent this, you
            must specify the <code class="literal">USING HASH</code> option when
            defining the unique index.
          </p><p>
            The default value is 64. Each index consumes approximately
            15KB per node.
          </p></li><li><a class="indexterm" name="id2330711"></a><p><a name="mysql-cluster-param-ndbd-definition-maxnooftriggers"></a>
            <code class="literal">MaxNoOfTriggers</code>
          </p><p>
            Internal update, insert, and delete triggers are allocated
            for each unique hash index. (This means that three triggers
            are created for each unique hash index.) However, an
            <span class="emphasis"><em>ordered</em></span> index requires only a single
            trigger object. Backups also use three trigger objects for
            each normal table in the cluster.
          </p><p>
            Replication between clusters also makes use of internal
            triggers.
          </p><p>
            This parameter sets the maximum number of trigger objects in
            the cluster.
          </p><p>
            The default value is 768.
          </p></li><li><a class="indexterm" name="id2330757"></a><p><a name="mysql-cluster-param-ndbd-definition-maxnoofindexes"></a>
            <code class="literal">MaxNoOfIndexes</code>
          </p><p>
            This parameter is deprecated in MySQL 5.1; you
            should use <code class="literal">MaxNoOfOrderedIndexes</code> and
            <code class="literal">MaxNoOfUniqueHashIndexes</code> instead.
          </p><p>
            This parameter is used only by unique hash indexes. There
            needs to be one record in this pool for each unique hash
            index defined in the cluster.
          </p><p>
            The default value of this parameter is 128.
          </p></li></ul></div><p><b>Boolean parameters. </b>
          The behavior of data nodes is also affected by a set of
          <code class="literal">[ndbd]</code> parameters taking on boolean values.
          These parameters can each be specified as
          <code class="literal">TRUE</code> by setting them equal to
          <code class="literal">1</code> or <code class="literal">Y</code>, and as
          <code class="literal">FALSE</code> by setting them equal to
          <code class="literal">0</code> or <code class="literal">N</code>.
        </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2330864"></a><p><a name="mysql-cluster-param-ndbd-definition-lockpagesinmainmemory"></a>
            <code class="literal">LockPagesInMainMemory</code>
          </p><p>
            For a number of operating systems, including Solaris and
            Linux, it is possible to lock a process into memory and so
            avoid any swapping to disk. This can be used to help
            guarantee the cluster's real-time characteristics.
          </p><p>
            Beginning with MySQL 5.1.15 and MySQL Cluster NDB 6.1.1,
            this parameter takes one of the integer values
            <code class="literal">0</code>, <code class="literal">1</code>, or
            <code class="literal">2</code>, which act as follows:
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                <code class="literal">0</code>: Disables locking. This is the
                default value.
              </p></li><li><p>
                <code class="literal">1</code>: Performs the lock after allocating
                memory for the process.
              </p></li><li><p>
                <code class="literal">2</code>: Performs the lock before memory
                for the process is allocated.
              </p></li></ul></div><p>
            Previously, this parameter was a Boolean.
            <code class="literal">0</code> or <code class="literal">false</code> was the
            default setting, and disabled locking. <code class="literal">1</code>
            or <code class="literal">true</code> enabled locking of the process
            after its memory was allocated.

            </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
                Beginning with MySQL 5.1.15 and MySQL Cluster NDB 6.1.1,
                it is no longer possible to use <code class="literal">true</code>
                or <code class="literal">false</code> for the value of this
                parameter; when upgrading from a previous version, you
                must change the value to <code class="literal">0</code>,
                <code class="literal">1</code>, or <code class="literal">2</code>.
              </p></div><p>
          </p></li><li><a class="indexterm" name="id2331022"></a><p><a name="mysql-cluster-param-ndbd-definition-stoponerror"></a>
            <code class="literal">StopOnError</code>
          </p><p>
            This parameter specifies whether an <span><strong class="command">ndbd</strong></span>
            process should exit or perform an automatic restart when an
            error condition is encountered.
          </p><p>
            This feature is enabled by default.
          </p></li><li><a class="indexterm" name="id2331060"></a><p><a name="mysql-cluster-param-ndbd-definition-diskless"></a>
            <code class="literal">Diskless</code>
          </p><p>
            It is possible to specify MySQL Cluster tables as
            <em class="firstterm">diskless</em>, meaning that tables are not
            checkpointed to disk and that no logging occurs. Such tables
            exist only in main memory. A consequence of using diskless
            tables is that neither the tables nor the records in those
            tables survive a crash. However, when operating in diskless
            mode, it is possible to run <span><strong class="command">ndbd</strong></span> on a
            diskless computer.
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              This feature causes the <span class="emphasis"><em>entire</em></span>
              cluster to operate in diskless mode.
            </p></div><p>
            When this feature is enabled, Cluster online backup is
            disabled. In addition, a partial start of the cluster is not
            possible.
          </p><p>
            <code class="literal">Diskless</code> is disabled by default.
          </p></li><li><a class="indexterm" name="id2331126"></a><p><a name="mysql-cluster-param-ndbd-definition-odirect"></a>
            <code class="literal">ODirect</code>
          </p><p>
            Enabling this parameter causes <code class="literal">NDB</code> to
            attempt using <code class="literal">O_DIRECT</code> writes for LCP,
            backups, and redo logs, often lowering
            <span><strong class="command">kswapd</strong></span> and CPU usage.
          </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
              When using MySQL Cluster Linux, <code class="literal">ODirect</code>
              should be enabled for 2.6 or newer kernels.
            </p></div><p>
            This parameter was added in the following releases:

            </p><div class="itemizedlist"><ul type="circle"><li><p>
                  MySQL 5.1.20
                </p></li><li><p>
                  MySQL Cluster NDB 6.1.11
                </p></li><li><p>
                  MySQL Cluster NDB 6.2.3
                </p></li><li><p>
                  MySQL Cluster NDB 6.3.0
                </p></li></ul></div><p>
          </p><p>
            <code class="literal">ODirect</code> is disabled by default.
          </p></li><li><a class="indexterm" name="id2331230"></a><p><a name="mysql-cluster-param-ndbd-definition-restartonerrorinsert"></a>
            <code class="literal">RestartOnErrorInsert</code>
          </p><p>
            This feature is accessible only when building the debug
            version where it is possible to insert errors in the
            execution of individual blocks of code as part of testing.
          </p><p>
            This feature is disabled by default.
          </p></li><li><a class="indexterm" name="id2331262"></a><p><a name="mysql-cluster-param-ndbd-definition-compressedbackup"></a>
            <code class="literal">CompressedBackup</code>
          </p><p>
            Setting this parameter to <code class="literal">1</code> causes backup
            files to be compressed. The compression used is equivalent
            to <span><strong class="command">gzip --fast</strong></span>, and can save 50% or more
            of the space required on the data node to store uncompressed
            backup files. Compressed backups can be enabled for
            individual data nodes, or for all data nodes (by setting
            this parameter in the <code class="literal">[ndbd default]</code>
            section of the <code class="filename">config.ini</code> file).
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              You cannot restore a compressed backup to a cluster
              running a MySQL version that does not support this
              feature.
            </p></div><p>
            The default value is <code class="literal">0</code> (disabled).
          </p><p>
            This parameter was introduced in MySQL Cluster NDB 6.3.7.
          </p></li><li><a class="indexterm" name="id2331338"></a><p><a name="mysql-cluster-param-ndbd-definition-compressedlcp"></a>
            <code class="literal">CompressedLCP</code>
          </p><p>
            Setting this parameter to <code class="literal">1</code> causes local
            checkpoint files to be compressed. The compression used is
            equivalent to <span><strong class="command">gzip --fast</strong></span>, and can save
            50% or more of the space required on the data node to store
            uncompressed checkpoint files. Compressed LCPs can be
            enabled for individual data nodes, or for all data nodes (by
            setting this parameter in the <code class="literal">[ndbd
            default]</code> section of the
            <code class="filename">config.ini</code> file).
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              You cannot restore a compressed local checkpoint to a
              cluster running a MySQL version that does not support this
              feature.
            </p></div><p>
            The default value is <code class="literal">0</code> (disabled).
          </p><p>
            This parameter was introduced in MySQL Cluster NDB 6.3.7.
          </p></li></ul></div><p><a name="mysql-cluster-timeouts-intervals-disk-paging"></a>
        <span class="bold"><strong>Controlling Timeouts, Intervals, and Disk
        Paging</strong></span>
      </p><p>
        There are a number of <code class="literal">[ndbd]</code> parameters
        specifying timeouts and intervals between various actions in
        Cluster data nodes. Most of the timeout values are specified in
        milliseconds. Any exceptions to this are mentioned where
        applicable.
      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2331440"></a><p><a name="mysql-cluster-param-ndbd-definition-timebetweenwatchdogcheck"></a>
            <code class="literal">TimeBetweenWatchDogCheck</code>
          </p><p>
            To prevent the main thread from getting stuck in an endless
            loop at some point, a “<span class="quote">watchdog</span>” thread checks
            the main thread. This parameter specifies the number of
            milliseconds between checks. If the process remains in the
            same state after three checks, the watchdog thread
            terminates it.
          </p><p>
            This parameter can easily be changed for purposes of
            experimentation or to adapt to local conditions. It can be
            specified on a per-node basis although there seems to be
            little reason for doing so.
          </p><p>
            The default timeout is 6000 milliseconds (6 seconds).
          </p></li><li><a class="indexterm" name="id2331483"></a><p><a name="mysql-cluster-param-ndbd-definition-timebetweenwatchdogcheckinitial"></a>
            <code class="literal">TimeBetweenWatchDogCheckInitial</code>
          </p><p>
            This is similar to the
            <code class="literal">TimeBetweenWatchDogCheck</code> parameter,
            except that
            <code class="literal">TimeBetweenWatchDogCheckInitial</code> controls
            the amount of time that passes between execution checks
            inside a database node in the early start phases during
            which memory is allocated.
          </p><p>
            The default timeout is 6000 milliseconds (6 seconds).
          </p><p>
            This parameter was added in MySQL 5.1.20.
          </p></li><li><a class="indexterm" name="id2331533"></a><p><a name="mysql-cluster-param-ndbd-definition-startpartialtimeout"></a>
            <code class="literal">StartPartialTimeout</code>
          </p><p>
            This parameter specifies how long the Cluster waits for all
            data nodes to come up before the cluster initialization
            routine is invoked. This timeout is used to avoid a partial
            Cluster startup whenever possible.
          </p><p>
            The default value is 30000 milliseconds (30 seconds). 0
            disables the timeout, in which case the cluster may start
            only if all nodes are available.
          </p></li><li><a class="indexterm" name="id2331567"></a><p><a name="mysql-cluster-param-ndbd-definition-startpartitionedtimeout"></a>
            <code class="literal">StartPartitionedTimeout</code>
          </p><p>
            If the cluster is ready to start after waiting for
            <code class="literal">StartPartialTimeout</code> milliseconds but is
            still possibly in a partitioned state, the cluster waits
            until this timeout has also passed.
          </p><p>
            The default timeout is 60000 milliseconds (60 seconds).
          </p></li><li><a class="indexterm" name="id2331606"></a><p><a name="mysql-cluster-param-ndbd-definition-startfailuretimeout"></a>
            <code class="literal">StartFailureTimeout</code>
          </p><p>
            If a data node has not completed its startup sequence within
            the time specified by this parameter, the node startup
            fails. Setting this parameter to 0 (the default value) means
            that no data node timeout is applied.
          </p><p>
            For nonzero values, this parameter is measured in
            milliseconds. For data nodes containing extremely large
            amounts of data, this parameter should be increased. For
            example, in the case of a data node containing several
            gigabytes of data, a period as long as 10–15 minutes
            (that is, 600000 to 1000000 milliseconds) might be required
            to perform a node restart.
          </p></li><li><a class="indexterm" name="id2331646"></a><p><a name="mysql-cluster-param-ndbd-definition-heartbeatintervaldbdb"></a>
            <code class="literal">HeartbeatIntervalDbDb</code>
          </p><p>
            One of the primary methods of discovering failed nodes is by
            the use of heartbeats. This parameter states how often
            heartbeat signals are sent and how often to expect to
            receive them. After missing three heartbeat intervals in a
            row, the node is declared dead. Thus, the maximum time for
            discovering a failure through the heartbeat mechanism is
            four times the heartbeat interval.
          </p><p>
            The default heartbeat interval is 1500 milliseconds (1.5
            seconds). This parameter must not be changed drastically and
            should not vary widely between nodes. If one node uses 5000
            milliseconds and the node watching it uses 1000
            milliseconds, obviously the node will be declared dead very
            quickly. This parameter can be changed during an online
            software upgrade, but only in small increments.
          </p></li><li><a class="indexterm" name="id2331688"></a><p><a name="mysql-cluster-param-ndbd-definition-heartbeatintervaldbapi"></a>
            <code class="literal">HeartbeatIntervalDbApi</code>
          </p><p>
            Each data node sends heartbeat signals to each MySQL server
            (SQL node) to ensure that it remains in contact. If a MySQL
            server fails to send a heartbeat in time it is declared
            “<span class="quote">dead,</span>” in which case all ongoing transactions
            are completed and all resources released. The SQL node
            cannot reconnect until all activities initiated by the
            previous MySQL instance have been completed. The
            three-heartbeat criteria for this determination are the same
            as described for <code class="literal">HeartbeatIntervalDbDb</code>.
          </p><p>
            The default interval is 1500 milliseconds (1.5 seconds).
            This interval can vary between individual data nodes because
            each data node watches the MySQL servers connected to it,
            independently of all other data nodes.
          </p></li><li><a class="indexterm" name="id2331735"></a><p><a name="mysql-cluster-param-ndbd-definition-timebetweenlocalcheckpoints"></a>
            <code class="literal">TimeBetweenLocalCheckpoints</code>
          </p><p>
            This parameter is an exception in that it does not specify a
            time to wait before starting a new local checkpoint; rather,
            it is used to ensure that local checkpoints are not
            performed in a cluster where relatively few updates are
            taking place. In most clusters with high update rates, it is
            likely that a new local checkpoint is started immediately
            after the previous one has been completed.
          </p><p>
            The size of all write operations executed since the start of
            the previous local checkpoints is added. This parameter is
            also exceptional in that it is specified as the base-2
            logarithm of the number of 4-byte words, so that the default
            value 20 means 4MB (4 ×
            2<sup>20</sup>) of write operations, 21
            would mean 8MB, and so on up to a maximum value of 31, which
            equates to 8GB of write operations.
          </p><p>
            All the write operations in the cluster are added together.
            Setting <code class="literal">TimeBetweenLocalCheckpoints</code> to 6
            or less means that local checkpoints will be executed
            continuously without pause, independent of the cluster's
            workload.
          </p></li><li><a class="indexterm" name="id2331792"></a><p><a name="mysql-cluster-param-ndbd-definition-timebetweenglobalcheckpoints"></a>
            <code class="literal">TimeBetweenGlobalCheckpoints</code>
          </p><p>
            When a transaction is committed, it is committed in main
            memory in all nodes on which the data is mirrored. However,
            transaction log records are not flushed to disk as part of
            the commit. The reasoning behind this behavior is that
            having the transaction safely committed on at least two
            autonomous host machines should meet reasonable standards
            for durability.
          </p><p>
            It is also important to ensure that even the worst of cases
            — a complete crash of the cluster — is handled
            properly. To guarantee that this happens, all transactions
            taking place within a given interval are put into a global
            checkpoint, which can be thought of as a set of committed
            transactions that has been flushed to disk. In other words,
            as part of the commit process, a transaction is placed in a
            global checkpoint group. Later, this group's log records are
            flushed to disk, and then the entire group of transactions
            is safely committed to disk on all computers in the cluster.
          </p><p>
            This parameter defines the interval between global
            checkpoints. The default is 2000 milliseconds.
          </p></li><li><a class="indexterm" name="id2331841"></a><p><a name="mysql-cluster-param-ndbd-definition-timebetweenepochs"></a>
            <code class="literal">TimeBetweenEpochs</code>
          </p><p>
            This parameter defines the interval between synchronisation
            epochs for MySQL Cluster Replication. The default value is
            100 milliseconds.
          </p><p>
            <code class="literal">TimeBetweenEpochs</code> is part of the
            implementation of “<span class="quote">micro-GCPs</span>”, which can be
            used to improve the performance of MySQL Cluster
            Replication. This parameter was introduced in MySQL Cluster
            NDB 6.2.5 and MySQL Cluster NDB 6.3.2.
          </p></li><li><a class="indexterm" name="id2331884"></a><p><a name="mysql-cluster-param-ndbd-definition-timebetweenepochstimeout"></a>
            <code class="literal">TimeBetweenEpochsTimeout</code>
          </p><p>
            This parameter defines a timeout for synchronisation epochs
            for MySQL Cluster Replication. If a node fails to
            participate in a global checkpoint within the time
            determined by this parameter, the node is shut down. The
            default value is 4000 milliseconds.
          </p><p>
            <code class="literal">TimeBetweenEpochsTimeout</code> is part of the
            implementation of “<span class="quote">micro-GCPs</span>”, which can be
            used to improve the performance of MySQL Cluster
            Replication. This parameter was introduced in MySQL-MySQL
            Cluster NDB 6.2.7 and MySQL Cluster NDB 6.3.4.
          </p></li><li><a class="indexterm" name="id2331929"></a><p><a name="mysql-cluster-param-ndbd-definition-maxbufferedepochs"></a>
            <code class="literal">MaxBufferedEpochs</code>
          </p><p>
            The number of unprocessed epochs by which a subscribing node
            can lag behind. Exceeding this number causes a lagging
            subscriber to be disconnected.
          </p><p>
            The default value of 100 is sufficient for most normal
            operations. If a subscribing node does lag enough to cause
            disconnections, it is usually due to network or scheduling
            issues with regard to processes or threads. (In rare
            circumstances, the problem may be due to a bug in the
            <code class="literal">NDB</code> client.) It may be desirable to set
            the value lower than the default when epochs are longer.
          </p><p>
            Disconnection prevents client issues from affecting the data
            node service, running out of memory to buffer data, and
            eventually shutting down. Instead, only the client is
            affected as a result of the disconnect (by, for example gap
            events in the binlog), forcing the client to reconnect or
            restart the process.
          </p></li><li><a class="indexterm" name="id2331977"></a><p><a name="mysql-cluster-param-ndbd-definition-timebetweeninactivetransactionabortcheck"></a>
            <code class="literal">TimeBetweenInactiveTransactionAbortCheck</code>
          </p><p>
            Timeout handling is performed by checking a timer on each
            transaction once for every interval specified by this
            parameter. Thus, if this parameter is set to 1000
            milliseconds, every transaction will be checked for timing
            out once per second.
          </p><p>
            The default value is 1000 milliseconds (1 second).
          </p></li><li><a class="indexterm" name="id2332011"></a><p><a name="mysql-cluster-param-ndbd-definition-transactioninactivetimeout"></a>
            <code class="literal">TransactionInactiveTimeout</code>
          </p><p>
            This parameter states the maximum time that is permitted to
            lapse between operations in the same transaction before the
            transaction is aborted.
          </p><p>
            The default for this parameter is zero (no timeout). For a
            real-time database that needs to ensure that no transaction
            keeps locks for too long, this parameter should be set to a
            relatively small value. The unit is milliseconds.
          </p></li><li><a class="indexterm" name="id2332046"></a><p><a name="mysql-cluster-param-ndbd-definition-transactiondeadlockdetectiontimeout"></a>
            <code class="literal">TransactionDeadlockDetectionTimeout</code>
          </p><p>
            When a node executes a query involving a transaction, the
            node waits for the other nodes in the cluster to respond
            before continuing. A failure to respond can occur for any of
            the following reasons:
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                The node is “<span class="quote">dead</span>”
              </p></li><li><p>
                The operation has entered a lock queue
              </p></li><li><p>
                The node requested to perform the action could be
                heavily overloaded.
              </p></li></ul></div><p>
            This timeout parameter states how long the transaction
            coordinator waits for query execution by another node before
            aborting the transaction, and is important for both node
            failure handling and deadlock detection. In MySQL 5.1.10 and
            earlier versions, setting it too high could cause
            undesirable behavior in situations involving deadlocks and
            node failure. Beginning with MySQL 5.1.11, active
            transactions occurring during node failures are actively
            aborted by the Cluster Transaction Coordinator, and so high
            settings are no longer an issue with this parameter.
          </p><p>
            The default timeout value is 1200 milliseconds (1.2
            seconds).
          </p></li><li><a class="indexterm" name="id2332123"></a><p><a name="mysql-cluster-param-ndbd-definition-disksyncsize"></a>
            <code class="literal">DiskSyncSize</code>
          </p><p>
            This is the maximum number of bytes to store before flushing
            data to a local checkpoint file. This is done in order to
            prevent write buffering, which can impede performance
            significantly. This parameter is <span class="emphasis"><em>not</em></span>
            intended to take the place of
            <code class="literal">TimeBetweenLocalCheckpoints</code>.
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              When <code class="literal">ODirect</code> is enabled, it is not
              necessary to set <code class="literal">DiskSyncSize</code>; in fact,
              in such cases its value is simply ignored.
            </p></div><p>
            The default value is 4M (4 megabytes).
          </p><p>
            This parameter was added in MySQL 5.1.12.
          </p></li><li><a class="indexterm" name="id2332190"></a><p><a name="mysql-cluster-param-ndbd-definition-diskcheckpointspeed"></a>
            <code class="literal">DiskCheckpointSpeed</code>
          </p><p>
            The amount of data,in bytes per second, that is sent to disk
            during a local checkpoint.
          </p><p>
            The default value is 10M (10 megabytes per second).
          </p><p>
            This parameter was added in MySQL 5.1.12.
          </p></li><li><a class="indexterm" name="id2332225"></a><p><a name="mysql-cluster-param-ndbd-definition-diskcheckpointspeedinrestart"></a>
            <code class="literal">DiskCheckpointSpeedInRestart</code>
          </p><p>
            The amount of data,in bytes per second, that is sent to disk
            during a local checkpoint as part of a restart operation.
          </p><p>
            The default value is 100M (100 megabytes per second).
          </p><p>
            This parameter was added in MySQL 5.1.12.
          </p></li><li><a class="indexterm" name="id2332262"></a><p><a name="mysql-cluster-param-ndbd-definition-noofdiskpagestodiskafterrestarttup"></a>
            <code class="literal">NoOfDiskPagesToDiskAfterRestartTUP</code>
          </p><p>
            When executing a local checkpoint, the algorithm flushes all
            data pages to disk. Merely doing so as quickly as possible
            without any moderation is likely to impose excessive loads
            on processors, networks, and disks. To control the write
            speed, this parameter specifies how many pages per 100
            milliseconds are to be written. In this context, a
            “<span class="quote">page</span>” is defined as 8KB. This parameter is
            specified in units of 80KB per second, so setting
            <code class="literal">NoOfDiskPagesToDiskAfterRestartTUP</code> to a
            value of <code class="literal">20</code> entails writing 1.6MB in data
            pages to disk each second during a local checkpoint. This
            value includes the writing of UNDO log records for data
            pages. That is, this parameter handles the limitation of
            writes from data memory. (See the entry for
            <code class="literal">IndexMemory</code> for information about index
            pages.)
          </p><p>
            In short, this parameter specifies how quickly to execute
            local checkpoints. It operates in conjunction with
            <code class="literal">NoOfFragmentLogFiles</code>,
            <code class="literal">DataMemory</code>, and
            <code class="literal">IndexMemory</code>.
          </p><p>
            For more information about the interaction between these
            parameters and possible strategies for choosing appropriate
            values for them, see
            <a href="mysql-cluster.html#mysql-cluster-config-lcp-params" title="20.3.6. Configuring Parameters for Local Checkpoints">Section 20.3.6, “Configuring Parameters for Local Checkpoints”</a>.
          </p><p>
            The default value is 40 (3.2MB of data pages per second).
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              This parameter is deprecated as of MySQL 5.1.6. For MySQL
              5.1.12 and later versions, use
              <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-diskcheckpointspeed">DiskCheckpointSpeed</a>
              and
              <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-disksyncsize">DiskSyncSize</a>
              instead.
            </p></div></li><li><a class="indexterm" name="id2332375"></a><p><a name="mysql-cluster-param-ndbd-definition-noofdiskpagestodiskafterrestartacc"></a>
            <code class="literal">NoOfDiskPagesToDiskAfterRestartACC</code>
          </p><p>
            This parameter uses the same units as
            <code class="literal">NoOfDiskPagesToDiskAfterRestartTUP</code> and
            acts in a similar fashion, but limits the speed of writing
            index pages from index memory.
          </p><p>
            The default value of this parameter is 20 (1.6MB of index
            memory pages per second).
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              This parameter is deprecated as of MySQL 5.1.6. For MySQL
              5.1.12 and later versions, use
              <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-diskcheckpointspeed">DiskCheckpointSpeed</a>
              and
              <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-disksyncsize">DiskSyncSize</a>.
            </p></div></li><li><a class="indexterm" name="id2332435"></a><p><a name="mysql-cluster-param-ndbd-definition-noofdiskpagestodiskduringrestarttup"></a>
            <code class="literal">NoOfDiskPagesToDiskDuringRestartTUP</code>
          </p><p>
            This parameter is used in a fashion similar to
            <code class="literal">NoOfDiskPagesToDiskAfterRestartTUP</code> and
            <code class="literal">NoOfDiskPagesToDiskAfterRestartACC</code>, only
            it does so with regard to local checkpoints executed in the
            node when a node is restarting. A local checkpoint is always
            performed as part of all node restarts. During a node
            restart it is possible to write to disk at a higher speed
            than at other times, because fewer activities are being
            performed in the node.
          </p><p>
            This parameter covers pages written from data memory.
          </p><p>
            The default value is 40 (3.2MB per second).
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              This parameter is deprecated as of MySQL 5.1.6. For MySQL
              5.1.12 and later versions, use
              <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-diskcheckpointspeedinrestart">DiskCheckpointSpeedInRestart</a>
              and
              <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-disksyncsize">DiskSyncSize</a>.
            </p></div></li><li><a class="indexterm" name="id2332507"></a><p><a name="mysql-cluster-param-ndbd-definition-noofdiskpagestodiskduringrestartacc"></a>
            <code class="literal">NoOfDiskPagesToDiskDuringRestartACC</code>
          </p><p>
            Controls the number of index memory pages that can be
            written to disk during the local checkpoint phase of a node
            restart.
          </p><p>
            As with
            <code class="literal">NoOfDiskPagesToDiskAfterRestartTUP</code> and
            <code class="literal">NoOfDiskPagesToDiskAfterRestartACC</code>,
            values for this parameter are expressed in terms of 8KB
            pages written per 100 milliseconds (80KB/second).
          </p><p>
            The default value is 20 (1.6MB per second).
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              This parameter is deprecated as of MySQL 5.1.6. For MySQL
              5.1.12 and later versions, use
              <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-diskcheckpointspeedinrestart">DiskCheckpointSpeedInRestart</a>
              and
              <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-disksyncsize">DiskSyncSize</a>.
            </p></div></li><li><a class="indexterm" name="id2332577"></a><p><a name="mysql-cluster-param-ndbd-definition-arbitrationtimeout"></a>
            <code class="literal">ArbitrationTimeout</code>
          </p><p>
            This parameter specifies how long data nodes wait for a
            response from the arbitrator to an arbitration message. If
            this is exceeded, the network is assumed to have split.
          </p><p>
            The default value is 1000 milliseconds (1 second).
          </p></li></ul></div><p><b>Buffering and logging. </b>
          Several <code class="literal">[ndbd]</code> configuration parameters
          enable the advanced user to have more control over the
          resources used by node processes and to adjust various buffer
          sizes at need.
        </p><p>
        These buffers are used as front ends to the file system when
        writing log records to disk. If the node is running in diskless
        mode, these parameters can be set to their minimum values
        without penalty due to the fact that disk writes are
        “<span class="quote">faked</span>” by the <code class="literal">NDB</code> storage
        engine's filesystem abstraction layer.
      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2332648"></a><p><a name="mysql-cluster-param-ndbd-definition-undoindexbuffer"></a>
            <code class="literal">UndoIndexBuffer</code>
          </p><p>
            The UNDO index buffer, whose size is set by this parameter,
            is used during local checkpoints. The <code class="literal">NDB</code>
            storage engine uses a recovery scheme based on checkpoint
            consistency in conjunction with an operational REDO log. To
            produce a consistent checkpoint without blocking the entire
            system for writes, UNDO logging is done while performing the
            local checkpoint. UNDO logging is activated on a single
            table fragment at a time. This optimization is possible
            because tables are stored entirely in main memory.
          </p><p>
            The UNDO index buffer is used for the updates on the primary
            key hash index. Inserts and deletes rearrange the hash
            index; the NDB storage engine writes UNDO log records that
            map all physical changes to an index page so that they can
            be undone at system restart. It also logs all active insert
            operations for each fragment at the start of a local
            checkpoint.
          </p><p>
            Reads and updates set lock bits and update a header in the
            hash index entry. These changes are handled by the
            page-writing algorithm to ensure that these operations need
            no UNDO logging.
          </p><p>
            This buffer is 2MB by default. The minimum value is 1MB,
            which is sufficient for most applications. For applications
            doing extremely large or numerous inserts and deletes
            together with large transactions and large primary keys, it
            may be necessary to increase the size of this buffer. If
            this buffer is too small, the NDB storage engine issues
            internal error code 677 (<code class="literal">Index UNDO buffers
            overloaded</code>).
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              It is not safe to decrease the value of this parameter
              during a rolling restart.
            </p></div></li><li><a class="indexterm" name="id2332720"></a><p><a name="mysql-cluster-param-ndbd-definition-undodatabuffer"></a>
            <code class="literal">UndoDataBuffer</code>
          </p><p>
            This parameter sets the size of the UNDO data buffer, which
            performs a function similar to that of the UNDO index
            buffer, except the UNDO data buffer is used with regard to
            data memory rather than index memory. This buffer is used
            during the local checkpoint phase of a fragment for inserts,
            deletes, and updates.
          </p><p>
            Because UNDO log entries tend to grow larger as more
            operations are logged, this buffer is also larger than its
            index memory counterpart, with a default value of 16MB.
          </p><p>
            This amount of memory may be unnecessarily large for some
            applications. In such cases, it is possible to decrease this
            size to a minimum of 1MB.
          </p><p>
            It is rarely necessary to increase the size of this buffer.
            If there is such a need, it is a good idea to check whether
            the disks can actually handle the load caused by database
            update activity. A lack of sufficient disk space cannot be
            overcome by increasing the size of this buffer.
          </p><p>
            If this buffer is too small and gets congested, the NDB
            storage engine issues internal error code 891
            (<span class="errortext">Data UNDO buffers overloaded</span>).
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              It is not safe to decrease the value of this parameter
              during a rolling restart.
            </p></div></li><li><a class="indexterm" name="id2332782"></a><p><a name="mysql-cluster-param-ndbd-definition-redobuffer"></a>
            <code class="literal">RedoBuffer</code>
          </p><p>
            All update activities also need to be logged. The REDO log
            makes it possible to replay these updates whenever the
            system is restarted. The NDB recovery algorithm uses a
            “<span class="quote">fuzzy</span>” checkpoint of the data together with
            the UNDO log, and then applies the REDO log to play back all
            changes up to the restoration point.
          </p><p>
            <code class="literal">RedoBuffer</code> sets the size of the buffer in
            which the REDO log is written, and is 8MB by default. The
            minimum value is 1MB.
          </p><p>
            If this buffer is too small, the NDB storage engine issues
            error code 1221 (<code class="literal">REDO log buffers
            overloaded</code>).
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              It is not safe to decrease the value of this parameter
              during a rolling restart.
            </p></div></li></ul></div><p><b>Controlling log messages. </b>
          In managing the cluster, it is very important to be able to
          control the number of log messages sent for various event
          types to <code class="literal">stdout</code>. For each event category,
          there are 16 possible event levels (numbered 0 through 15).
          Setting event reporting for a given event category to level 15
          means all event reports in that category are sent to
          <code class="literal">stdout</code>; setting it to 0 means that there
          will be no event reports made in that category.
        </p><p>
        By default, only the startup message is sent to
        <code class="literal">stdout</code>, with the remaining event reporting
        level defaults being set to 0. The reason for this is that these
        messages are also sent to the management server's cluster log.
      </p><p>
        An analogous set of levels can be set for the management client
        to determine which event levels to record in the cluster log.
      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2332892"></a><p><a name="mysql-cluster-param-ndbd-definition-loglevelstartup"></a>
            <code class="literal">LogLevelStartup</code>
          </p><p>
            The reporting level for events generated during startup of
            the process.
          </p><p>
            The default level is 1.
          </p></li><li><a class="indexterm" name="id2332923"></a><p><a name="mysql-cluster-param-ndbd-definition-loglevelshutdown"></a>
            <code class="literal">LogLevelShutdown</code>
          </p><p>
            The reporting level for events generated as part of graceful
            shutdown of a node.
          </p><p>
            The default level is 0.
          </p></li><li><a class="indexterm" name="id2332955"></a><p><a name="mysql-cluster-param-ndbd-definition-loglevelstatistic"></a>
            <code class="literal">LogLevelStatistic</code>
          </p><p>
            The reporting level for statistical events such as number of
            primary key reads, number of updates, number of inserts,
            information relating to buffer usage, and so on.
          </p><p>
            The default level is 0.
          </p></li><li><a class="indexterm" name="id2332988"></a><p><a name="mysql-cluster-param-ndbd-definition-loglevelcheckpoint"></a>
            <code class="literal">LogLevelCheckpoint</code>
          </p><p>
            The reporting level for events generated by local and global
            checkpoints.
          </p><p>
            The default level is 0.
          </p></li><li><a class="indexterm" name="id2333020"></a><p><a name="mysql-cluster-param-ndbd-definition-loglevelnoderestart"></a>
            <code class="literal">LogLevelNodeRestart</code>
          </p><p>
            The reporting level for events generated during node
            restart.
          </p><p>
            The default level is 0.
          </p></li><li><a class="indexterm" name="id2333051"></a><p><a name="mysql-cluster-param-ndbd-definition-loglevelconnection"></a>
            <code class="literal">LogLevelConnection</code>
          </p><p>
            The reporting level for events generated by connections
            between cluster nodes.
          </p><p>
            The default level is 0.
          </p></li><li><a class="indexterm" name="id2333083"></a><p><a name="mysql-cluster-param-ndbd-definition-loglevelerror"></a>
            <code class="literal">LogLevelError</code>
          </p><p>
            The reporting level for events generated by errors and
            warnings by the cluster as a whole. These errors do not
            cause any node failure but are still considered worth
            reporting.
          </p><p>
            The default level is 0.
          </p></li><li><a class="indexterm" name="id2333116"></a><p><a name="mysql-cluster-param-ndbd-definition-loglevelcongestion"></a>
            <code class="literal">LogLevelCongestion</code>
          </p><p>
            The reporting level for events generated by congestion.
            These errors do not cause node failure but are still
            considered worth reporting.
          </p><p>
            The default level is 0.
          </p></li><li><a class="indexterm" name="id2333148"></a><p><a name="mysql-cluster-param-ndbd-definition-loglevelinfo"></a>
            <code class="literal">LogLevelInfo</code>
          </p><p>
            The reporting level for events generated for information
            about the general state of the cluster.
          </p><p>
            The default level is 0.
          </p></li><li><a class="indexterm" name="id2333180"></a><p><a name="mysql-cluster-param-ndbd-definition-memreportfrequency"></a>
            <code class="literal">MemReportFrequency</code>
          </p><p>
            This parameter controls how often data node memory usage
            reports are recorded in the cluster log; it is an integer
            value representing the number of seconds between reports.
          </p><p>
            Each data node's data memory and index memory usage is
            logged as both a percentage and a number of 32 KB pages of
            the <code class="literal">DataMemory</code> and
            <code class="literal">IndexMemory</code>, respectively, set in the
            <code class="filename">config.ini</code> file. For example, if
            <code class="literal">DataMemory</code> is equal to 100 MB, and a
            given data node is using 50 MB for data memory storage, the
            corresponding line in the cluster log might look like this:
          </p><pre class="programlisting">2006-12-24 01:18:16 [MgmSrvr] INFO -- Node 2: Data usage is 50%(1280 32K pages of total 2560)
</pre><p>
            <code class="literal">MemReportFrequency</code> is not a required
            parameter. If used, it can be set for all cluster data nodes
            in the <code class="literal">[ndbd default]</code> section of
            <code class="filename">config.ini</code>, and can also be set or
            overridden for individual data nodes in the corresponding
            <code class="literal">[ndbd]</code> sections of the configuration
            file. The minimum value — which is also the default
            value — is 0, in which case memory reports are logged
            only when memory usage reaches certain percentages (80%,
            90%, and 100%), as mentioned in the discussion of statistics
            events in <a href="mysql-cluster.html#mysql-cluster-log-events" title="20.7.3.2. Log Events">Section 20.7.3.2, “Log Events”</a>.
          </p><p>
            This parameter was added in MySQL Cluster 5.1.16 and MySQL
            Cluster NDB 6.1.0.
          </p></li></ul></div><p><b>Backup parameters. </b>
          The <code class="literal">[ndbd]</code> parameters discussed in this
          section define memory buffers set aside for execution of
          online backups.
        </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2333312"></a><p><a name="mysql-cluster-param-ndbd-definition-backupdatabuffersize"></a>
            <code class="literal">BackupDataBufferSize</code>
          </p><p>
            In creating a backup, there are two buffers used for sending
            data to the disk. The backup data buffer is used to fill in
            data recorded by scanning a node's tables. Once this buffer
            has been filled to the level specified as
            <code class="literal">BackupWriteSize</code> (see below), the pages
            are sent to disk. While flushing data to disk, the backup
            process can continue filling this buffer until it runs out
            of space. When this happens, the backup process pauses the
            scan and waits until some disk writes have completed freed
            up memory so that scanning may continue.
          </p><p>
            The default value is 2MB.
          </p></li><li><a class="indexterm" name="id2333354"></a><p><a name="mysql-cluster-param-ndbd-definition-backuplogbuffersize"></a>
            <code class="literal">BackupLogBufferSize</code>
          </p><p>
            The backup log buffer fulfills a role similar to that played
            by the backup data buffer, except that it is used for
            generating a log of all table writes made during execution
            of the backup. The same principles apply for writing these
            pages as with the backup data buffer, except that when there
            is no more space in the backup log buffer, the backup fails.
            For that reason, the size of the backup log buffer must be
            large enough to handle the load caused by write activities
            while the backup is being made. See
            <a href="mysql-cluster.html#mysql-cluster-backup-configuration" title="20.9.4. Configuration for Cluster Backup">Section 20.9.4, “Configuration for Cluster Backup”</a>.
          </p><p>
            The default value for this parameter should be sufficient
            for most applications. In fact, it is more likely for a
            backup failure to be caused by insufficient disk write speed
            than it is for the backup log buffer to become full. If the
            disk subsystem is not configured for the write load caused
            by applications, the cluster is unlikely to be able to
            perform the desired operations.
          </p><p>
            It is preferable to configure cluster nodes in such a manner
            that the processor becomes the bottleneck rather than the
            disks or the network connections.
          </p><p>
            The default value is 2MB.
          </p></li><li><a class="indexterm" name="id2333407"></a><p><a name="mysql-cluster-param-ndbd-definition-backupmemory"></a>
            <code class="literal">BackupMemory</code>
          </p><p>
            This parameter is simply the sum of
            <code class="literal">BackupDataBufferSize</code> and
            <code class="literal">BackupLogBufferSize</code>.
          </p><p>
            The default value is 2MB + 2MB = 4MB.
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              If <code class="literal">BackupDataBufferSize</code> and
              <code class="literal">BackupLogBufferSize</code> taken together
              exceed 4MB, then this parameter must be set explicitly in
              the <code class="filename">config.ini</code> file to their sum.
            </p></div></li><li><a class="indexterm" name="id2333476"></a><p><a name="mysql-cluster-param-ndbd-definition-backupreportfrequency"></a>
            This parameter controls how often backup status reports are
            issued in the management client during a backup, as well as
            how often such reports are written to the cluster log
            (provided cluster event logging is configured to allow it
            — see
            <a href="mysql-cluster.html#mysql-cluster-logging-and-checkpointing">Section 20.3.4.5, “Defining Data Nodes”</a>).
            <code class="literal">BackupReportFrequency</code> represents the time
            in seconds between backup status reports.
          </p><p>
            The default value is 0.
          </p><p>
            This parameter was added in MySQL Cluster NDB 6.2.3.
          </p></li><li><a class="indexterm" name="id2333518"></a><p><a name="mysql-cluster-param-ndbd-definition-backupwritesize"></a>
            <code class="literal">BackupWriteSize</code>
          </p><p>
            This parameter specifies the default size of messages
            written to disk by the backup log and backup data buffers.
          </p><p>
            The default value is 32KB.
          </p></li><li><a class="indexterm" name="id2333550"></a><p><a name="mysql-cluster-param-ndbd-definition-backupmaxwritesize"></a>
            <code class="literal">BackupMaxWriteSize</code>
          </p><p>
            This parameter specifies the maximum size of messages
            written to disk by the backup log and backup data buffers.
          </p><p>
            The default value is 256KB.
          </p></li></ul></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
          When specifying these parameters, the following relationships
          must hold true. Otherwise, the data node will be unable to
          start:

          </p><div class="itemizedlist"><ul type="disc"><li><p>
                <code class="literal">BackupDataBufferSize &gt;= BackupWriteSize
                + 188KB</code>
              </p></li><li><p>
                <code class="literal">BackupLogBufferSize &gt;= BackupWriteSize
                + 16KB</code>
              </p></li><li><p>
                <code class="literal">BackupMaxWriteSize &gt;=
                BackupWriteSize</code>
              </p></li></ul></div><p>
        </p></div><p><a name="mysql-cluster-realtime-performance-parameters"></a>
        <span class="bold"><strong>Realtime Performance Parameters</strong></span>
      </p><p>
        The <code class="literal">[ndbd]</code> parameters discussed in this
        section are used in scheduling and locking of threads to
        specific CPUs on multiprocessor data node hosts. They were
        introduced in MySQL Cluster NDB 6.3.4.
      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2333659"></a><p><a name="mysql-cluster-param-ndbd-definition-lockexecutethreadtocpu"></a>
            <code class="literal">LockExecuteThreadToCPU</code>
          </p><p>
            This parameter specifies the ID of the CPU assigned to
            handle the <code class="literal">NDBCLUSTER</code> execution thread.
          </p><p>
            The value of this parameter is an integer in the range 0 to
            65535 (inclusive). The default is 65535.
          </p></li><li><a class="indexterm" name="id2333698"></a><p><a name="mysql-cluster-param-ndbd-definition-lockmaintthreadstocpu"></a>
            <code class="literal">LockMaintThreadsToCPU</code>
          </p><p>
            This parameter specifies the ID of the CPU assigned to
            handle <code class="literal">NDBCLUSTER</code> maintenance threads.
          </p><p>
            The value of this parameter is an integer in the range 0 to
            65535 (inclusive). The default is 65535.
          </p></li><li><a class="indexterm" name="id2333736"></a><p><a name="mysql-cluster-param-ndbd-definition-realtimescheduler"></a>
            <code class="literal">RealtimeScheduler</code>
          </p><p>
            Setting this parameter to 1 enables real-time scheduling of
            <code class="literal">NDBCLUSTER</code> threads.
          </p><p>
            The default is 0 (scheduling disabled).
          </p></li><li><a class="indexterm" name="id2333774"></a><p><a name="mysql-cluster-param-ndbd-definition-schedulerexecutiontimer"></a>
            <code class="literal">SchedulerExecutionTimer</code>
          </p><p>
            This parameter specifies the time in microseconds for
            threads to be executed in the scheduler before being sent.
          </p><p>
            The default is 50 μsec.
          </p></li><li><a class="indexterm" name="id2333806"></a><p><a name="mysql-cluster-param-ndbd-definition-schedulerspintimer"></a>
            <code class="literal">SchedulerSpinTimer</code>
          </p><p>
            This parameter specifies the time in microseconds for
            threads to be executed in the scheduler before sleeping.
          </p><p>
            The default value is 0.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-api-definition"></a>20.3.4.6. Defining SQL and Other API Nodes</h4></div></div></div><a class="indexterm" name="id2333846"></a><a class="indexterm" name="id2333858"></a><a class="indexterm" name="id2333871"></a><p>
        The <code class="literal">[mysqld]</code> and <code class="literal">[api]</code>
        sections in the <code class="filename">config.ini</code> file define the
        behavior of the MySQL servers (SQL nodes) and other applications
        (API nodes) used to access cluster data. None of the parameters
        shown is required. If no computer or host name is provided, any
        host can use this SQL or API node.
      </p><p>
        Generally speaking, a <code class="literal">[mysqld]</code> section is
        used to indicate a MySQL server providing an SQL interface to
        the cluster, and an <code class="literal">[api]</code> section is used for
        applications other than <span><strong class="command">mysqld</strong></span> processes
        accessing cluster data, but the two designations are actually
        synonomous; you can, for instance, list parameters for a MySQL
        server acting as an SQL node in an <code class="literal">[api]</code>
        section.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          For a discussion of MySQL server options for MySQL Cluster,
          see <a href="mysql-cluster.html#mysql-cluster-mysqld-command-options" title="20.4.2. MySQL Cluster-Related Command Options for mysqld">Section 20.4.2, “MySQL Cluster-Related Command Options for <span><strong class="command">mysqld</strong></span>”</a>;
          for information about MySQL server system variables relating
          to MySQL Cluster, see
          <a href="mysql-cluster.html#mysql-cluster-system-variables" title="20.4.3. MySQL Cluster System Variables">Section 20.4.3, “MySQL Cluster System Variables”</a>.
        </p></div><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2333959"></a><p><a name="mysql-cluster-param-api-definition-id"></a>
            <code class="literal">Id</code>
          </p><p>
            The <code class="literal">Id</code> value is used to identify the node
            in all cluster internal messages. It must be an integer in
            the range 1 to 63 inclusive, and must be unique among all
            node IDs within the cluster.
          </p></li><li><a class="indexterm" name="id2333993"></a><p><a name="mysql-cluster-param-api-definition-executeoncomputer"></a>
            <code class="literal">ExecuteOnComputer</code>
          </p><p>
            This refers to the <code class="literal">Id</code> set for one of the
            computers (hosts) defined in a <code class="literal">[computer]</code>
            section of the configuration file.
          </p></li><li><a class="indexterm" name="id2334033"></a><p><a name="mysql-cluster-param-api-definition-hostname"></a>
            <code class="literal">HostName</code>
          </p><p>
            Specifying this parameter defines the hostname of the
            computer on which the SQL node (API node) is to reside. To
            specify a hostname, either this parameter or
            <code class="literal">ExecuteOnComputer</code> is required.
          </p><p>
            If no <code class="literal">HostName</code> or
            <code class="literal">ExecuteOnComputer</code> is specified in a given
            <code class="literal">[mysql]</code> or <code class="literal">[api]</code>
            section of the <code class="filename">config.ini</code> file, then an
            SQL or API node may connect using the corresponding
            “<span class="quote">slot</span>” from any host which can establish a
            network connection to the management server host machine.
            <span class="emphasis"><em>This differs from the default behavior for data
            nodes, where <code class="literal">localhost</code> is assumed for
            <code class="literal">HostName</code> unless otherwise
            specified</em></span>.
          </p></li><li><a class="indexterm" name="id2334123"></a><p><a name="mysql-cluster-param-api-definition-arbitrationrank"></a>
            <code class="literal">ArbitrationRank</code>
          </p><p>
            This parameter defines which nodes can act as arbitrators.
            Both MGM nodes and SQL nodes can be arbitrators. A value of
            0 means that the given node is never used as an arbitrator,
            a value of 1 gives the node high priority as an arbitrator,
            and a value of 2 gives it low priority. A normal
            configuration uses the management server as arbitrator,
            setting its <code class="literal">ArbitrationRank</code> to 1 (the
            default) and those for all SQL nodes to 0.
          </p><p>
            Beginning with MySQL 5.1.16 and MySQL Cluster NDB 6.1.3, it
            is possible to disable arbitration completely by setting
            <code class="literal">ArbitrationRank</code> to 0 on all management
            and SQL nodes.
          </p></li><li><a class="indexterm" name="id2334171"></a><p><a name="mysql-cluster-param-api-definition-arbitrationdelay"></a>
            <code class="literal">ArbitrationDelay</code>
          </p><p>
            Setting this parameter to any other value than 0 (the
            default) means that responses by the arbitrator to
            arbitration requests will be delayed by the stated number of
            milliseconds. It is usually not necessary to change this
            value.
          </p></li><li><a class="indexterm" name="id2334201"></a><p><a name="mysql-cluster-param-api-definition-batchbytesize"></a>
            <code class="literal">BatchByteSize</code>
          </p><p>
            For queries that are translated into full table scans or
            range scans on indexes, it is important for best performance
            to fetch records in properly sized batches. It is possible
            to set the proper size both in terms of number of records
            (<code class="literal">BatchSize</code>) and in terms of bytes
            (<code class="literal">BatchByteSize</code>). The actual batch size is
            limited by both parameters.
          </p><p>
            The speed at which queries are performed can vary by more
            than 40% depending upon how this parameter is set. In future
            releases, MySQL Server will make educated guesses on how to
            set parameters relating to batch size, based on the query
            type.
          </p><p>
            This parameter is measured in bytes and by default is equal
            to 32KB.
          </p></li><li><a class="indexterm" name="id2334260"></a><p><a name="mysql-cluster-param-api-definition-batchsize"></a>
            <code class="literal">BatchSize</code>
          </p><p>
            This parameter is measured in number of records and is by
            default set to 64. The maximum size is 992.
          </p></li><li><a class="indexterm" name="id2334288"></a><p><a name="mysql-cluster-param-api-definition-maxscanbatchsize"></a>
            <code class="literal">MaxScanBatchSize</code>
          </p><p>
            The batch size is the size of each batch sent from each data
            node. Most scans are performed in parallel to protect the
            MySQL Server from receiving too much data from many nodes in
            parallel; this parameter sets a limit to the total batch
            size over all nodes.
          </p><p>
            The default value of this parameter is set to 256KB. Its
            maximum size is 16MB.
          </p></li></ul></div><p>
        You can obtain some information from a MySQL server running as a
        Cluster SQL node using <code class="literal">SHOW STATUS</code> in the
        <code class="literal">mysql</code> client, as shown here:
      </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW STATUS LIKE 'ndb%';</code></strong>
+-----------------------------+---------------+
| Variable_name               | Value         |
+-----------------------------+---------------+
| Ndb_cluster_node_id         | 5             | 
| Ndb_config_from_host        | 192.168.0.112 | 
| Ndb_config_from_port        | 1186          | 
| Ndb_number_of_storage_nodes | 4             | 
+-----------------------------+---------------+
4 rows in set (0.02 sec)
</pre><p>
        For information about these Cluster system status variables, see
        <a href="server-administration.html#server-status-variables" title="5.1.6. Status Variables">Section 5.1.6, “Status Variables”</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-tcp-definition"></a>20.3.4.7. Cluster TCP/IP Connections</h4></div></div></div><p>
        TCP/IP is the default transport mechanism for establishing
        connections in MySQL Cluster. It is normally not necessary to
        define connections because Cluster automatically set ups a
        connection between each of the data nodes, between each data
        node and all MySQL server nodes, and between each data node and
        the management server. (For one exception to this rule, see
        <a href="mysql-cluster.html#mysql-cluster-tcp-definition-direct" title="20.3.4.8. TCP/IP Connections Using Direct Connections">Section 20.3.4.8, “TCP/IP Connections Using Direct Connections”</a>.)
        <code class="literal">[tcp]</code> sections in the
        <code class="filename">config.ini</code> file explicitly define TCP/IP
        connections between nodes in the cluster.
      </p><p>
        It is necessary to define a connection only to override the
        default connection parameters. In that case, it is necessary to
        define at least <code class="literal">NodeId1</code>,
        <code class="literal">NodeId2</code>, and the parameters to change.
      </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
          Any <code class="literal">[tcp]</code> sections in the
          <code class="filename">config.ini</code> file should be listed last,
          following any other sections in the file. This is not required
          for a <code class="literal">[tcp default]</code> section. This is a
          known issue with the way in which the
          <code class="filename">config.ini</code> file is read by the cluster
          management server.
        </p></div><p>
        It is also possible to change the default values for these
        parameters by setting them in the <code class="literal">[tcp
        default]</code> section.
      </p><div class="itemizedlist"><ul type="disc"><li><p><a name="mysql-cluster-param-tcp-definition-nodeid"></a>
            <code class="literal">NodeId1</code>, <code class="literal">NodeId2</code>
          </p><p>
            To identify a connection between two nodes it is necessary
            to provide their node IDs in the <code class="literal">[tcp]</code>
            section of the configuration file. These are the same unique
            <code class="literal">Id</code> values for each of these nodes as
            described in <a href="mysql-cluster.html#mysql-cluster-api-definition" title="20.3.4.6. Defining SQL and Other API Nodes">Section 20.3.4.6, “Defining SQL and Other API Nodes”</a>.
          </p></li><li><a class="indexterm" name="id2334501"></a><p><a name="mysql-cluster-param-tcp-definition-sendbuffermemory"></a>
            <code class="literal">SendBufferMemory</code>
          </p><p>
            TCP transporters use a buffer to store all messages before
            performing the send call to the operating system. When this
            buffer reaches 64KB its contents are sent; these are also
            sent when a round of messages have been executed. To handle
            temporary overload situations it is also possible to define
            a bigger send buffer.
          </p><p>
            The default size of the send buffer is 256 KB; 2MB is
            recommended in most situations in which it is necessary to
            set this parameter. The minimum size is 64 KB; the
            theoretical maximum is 4 GB.
          </p></li><li><a class="indexterm" name="id2334536"></a><p><a name="mysql-cluster-param-tcp-definition-sendsignalid"></a>
            <code class="literal">SendSignalId</code>
          </p><p>
            To be able to retrace a distributed message datagram, it is
            necessary to identify each message. When this parameter is
            set to <code class="literal">Y</code>, message IDs are transported
            over the network. This feature is disabled by default in
            production builds, and enabled in <code class="literal">-debug</code>
            builds.
          </p></li><li><a class="indexterm" name="id2334578"></a><p><a name="mysql-cluster-param-tcp-definition-checksum"></a>
            <code class="literal">Checksum</code>
          </p><p>
            This parameter is a boolean parameter (enabled by setting it
            to <code class="literal">Y</code> or <code class="literal">1</code>, disabled by
            setting it to <code class="literal">N</code> or <code class="literal">0</code>).
            It is disabled by default. When it is enabled, checksums for
            all messages are calculated before they placed in the send
            buffer. This feature ensures that messages are not corrupted
            while waiting in the send buffer, or by the transport
            mechanism.
          </p></li><li><a class="indexterm" name="id2334631"></a><p><a name="mysql-cluster-param-tcp-definition-portnumber"></a>
            <code class="literal">PortNumber</code>
            (<span class="emphasis"><em>OBSOLETE</em></span>)
          </p><p>
            This formerly specified the port number to be used for
            listening for connections from other nodes. This parameter
            should no longer be used.
          </p></li><li><a class="indexterm" name="id2334664"></a><p><a name="mysql-cluster-param-tcp-definition-receivebuffermemory"></a>
            <code class="literal">ReceiveBufferMemory</code>
          </p><p>
            Specifies the size of the buffer used when receiving data
            from the TCP/IP socket.
          </p><p>
            The default value of this parameter from its of 64 KB; 1M is
            recommended in most situations where the size of the receive
            buffer needs to be set. The minimum possible value is 16K;
            the theoretical maximum is 4G.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-tcp-definition-direct"></a>20.3.4.8. TCP/IP Connections Using Direct Connections</h4></div></div></div><a class="indexterm" name="id2334705"></a><a class="indexterm" name="id2334718"></a><a class="indexterm" name="id2334734"></a><p>
        Setting up a cluster using direct connections between data nodes
        requires specifying explicitly the crossover IP addresses of the
        data nodes so connected in the <code class="literal">[tcp]</code> section
        of the cluster <code class="filename">config.ini</code> file.
      </p><p>
        In the following example, we envision a cluster with at least
        four hosts, one each for a management server, an SQL node, and
        two data nodes. The cluster as a whole resides on the
        <code class="literal">172.23.72.*</code> subnet of a LAN. In addition to
        the usual network connections, the two data nodes are connected
        directly using a standard crossover cable, and communicate with
        one another directly using IP addresses in the
        <code class="literal">1.1.0.*</code> address range as shown:
      </p><pre class="programlisting"># Management Server
[ndb_mgmd]
Id=1
HostName=172.23.72.20

# SQL Node
[mysqld]
Id=2
HostName=172.23.72.21

# Data Nodes
[ndbd]
Id=3
HostName=172.23.72.22

[ndbd]
Id=4
HostName=172.23.72.23

# TCP/IP Connections
[tcp]
NodeId1=3
NodeId2=4
HostName1=1.1.0.1
HostName2=1.1.0.2
</pre><p>
        The <code class="literal">HostName<em class="replaceable"><code>N</code></em></code>
        parameter, where <em class="replaceable"><code>N</code></em> is an integer, is
        used only when specifying direct TCP/IP connections.
      </p><p>
        The use of direct connections between data nodes can improve the
        cluster's overall efficiency by allowing the data nodes to
        bypass an Ethernet device such as a switch, hub, or router, thus
        cutting down on the cluster's latency. It is important to note
        that to take the best advantage of direct connections in this
        fashion with more than two data nodes, you must have a direct
        connection between each data node and every other data node in
        the same node group.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-shm-definition"></a>20.3.4.9. Shared-Memory Connections</h4></div></div></div><a class="indexterm" name="id2334823"></a><a class="indexterm" name="id2334835"></a><a class="indexterm" name="id2334848"></a><a class="indexterm" name="id2334860"></a><p>
        MySQL Cluster attempts to use the shared memory transporter and
        configure it automatically where possible.
        <code class="literal">[shm]</code> sections in the
        <code class="filename">config.ini</code> file explicitly define
        shared-memory connections between nodes in the cluster. When
        explicitly defining shared memory as the connection method, it
        is necessary to define at least <code class="literal">NodeId1</code>,
        <code class="literal">NodeId2</code> and <code class="literal">ShmKey</code>. All
        other parameters have default values that should work well in
        most cases.
      </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
          <span class="emphasis"><em>SHM functionality is considered experimental
          only</em></span>. It is not officially supported in any MySQL
          release series up to and including 5.1. This
          means that you must determine for yourself or by using our
          free resources (forums, mailing lists) whether it can be made
          to work correctly in your specific case.
        </p></div><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2334930"></a><a class="indexterm" name="id2334939"></a><p><a name="mysql-cluster-param-shm-definition-nodeids"></a>
            <code class="literal">NodeId1</code>, <code class="literal">NodeId2</code>
          </p><p>
            To identify a connection between two nodes it is necessary
            to provide node identifiers for each of them, as
            <code class="literal">NodeId1</code> and <code class="literal">NodeId2</code>.
          </p></li><li><a class="indexterm" name="id2334988"></a><p><a name="mysql-cluster-param-shm-definition-shmkey"></a>
            <code class="literal">ShmKey</code>
          </p><p>
            When setting up shared memory segments, a node ID, expressed
            as an integer, is used to identify uniquely the shared
            memory segment to use for the communication. There is no
            default value.
          </p></li><li><a class="indexterm" name="id2335017"></a><p><a name="mysql-cluster-param-shm-definition-shmsize"></a>
            <code class="literal">ShmSize</code>
          </p><p>
            Each SHM connection has a shared memory segment where
            messages between nodes are placed by the sender and read by
            the reader. The size of this segment is defined by
            <code class="literal">ShmSize</code>. The default value is 1MB.
          </p></li><li><a class="indexterm" name="id2335052"></a><p><a name="mysql-cluster-param-shm-definition-sendsignalid"></a>
            <code class="literal">SendSignalId</code>
          </p><p>
            To retrace the path of a distributed message, it is
            necessary to provide each message with a unique identifier.
            Setting this parameter to <code class="literal">Y</code> causes these
            message IDs to be transported over the network as well. This
            feature is disabled by default in production builds, and
            enabled in <code class="literal">-debug</code> builds.
          </p></li><li><a class="indexterm" name="id2335094"></a><p><a name="mysql-cluster-param-shm-definition-checksum"></a>
            <code class="literal">Checksum</code>
          </p><p>
            This parameter is a boolean
            (<code class="literal">Y</code>/<code class="literal">N</code>) parameter which
            is disabled by default. When it is enabled, checksums for
            all messages are calculated before being placed in the send
            buffer.
          </p><p>
            This feature prevents messages from being corrupted while
            waiting in the send buffer. It also serves as a check
            against data being corrupted during transport.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-sci-definition"></a>20.3.4.10. SCI Transport Connections</h4></div></div></div><a class="indexterm" name="id2335147"></a><a class="indexterm" name="id2335159"></a><a class="indexterm" name="id2335172"></a><a class="indexterm" name="id2335184"></a><p>
        <code class="literal">[sci]</code> sections in the
        <code class="filename">config.ini</code> file explicitly define SCI
        (Scalable Coherent Interface) connections between cluster nodes.
        Using SCI transporters in MySQL Cluster is supported only when
        the MySQL binaries are built using
        <code class="option">--with-ndb-sci=<em class="replaceable"><code>/your/path/to/SCI</code></em></code>.
        The <em class="replaceable"><code>path</code></em> should point to a directory
        that contains at a minimum <code class="filename">lib</code> and
        <code class="filename">include</code> directories containing SISCI
        libraries and header files. (See
        <a href="mysql-cluster.html#mysql-cluster-interconnects" title="20.13. Using High-Speed Interconnects with MySQL Cluster">Section 20.13, “Using High-Speed Interconnects with MySQL Cluster”</a> for more
        information about SCI.)
      </p><p>
        In addition, SCI requires specialized hardware.
      </p><p>
        It is strongly recommended to use SCI Transporters only for
        communication between <span><strong class="command">ndbd</strong></span> processes. Note
        also that using SCI Transporters means that the
        <span><strong class="command">ndbd</strong></span> processes never sleep. For this reason,
        SCI Transporters should be used only on machines having at least
        two CPUs dedicated for use by <span><strong class="command">ndbd</strong></span> processes.
        There should be at least one CPU per <span><strong class="command">ndbd</strong></span>
        process, with at least one CPU left in reserve to handle
        operating system activities.
      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2335284"></a><a class="indexterm" name="id2335293"></a><p><a name="mysql-cluster-param-sci-definition-nodeids"></a>
            <code class="literal">NodeId1</code>, <code class="literal">NodeId2</code>
          </p><p>
            To identify a connection between two nodes it is necessary
            to provide node identifiers for each of them, as
            <code class="literal">NodeId1</code> and <code class="literal">NodeId2</code>.
          </p></li><li><a class="indexterm" name="id2335343"></a><p><a name="mysql-cluster-param-sci-definition-host1sciid0"></a>
            <code class="literal">Host1SciId0</code>
          </p><p>
            This identifies the SCI node ID on the first Cluster node
            (identified by <code class="literal">NodeId1</code>).
          </p></li><li><p><a name="mysql-cluster-param-sci-definition-host1sciid1"></a>
            <code class="literal">Host1SciId1</code>
          </p><p>
            It is possible to set up SCI Transporters for failover
            between two SCI cards which then should use separate
            networks between the nodes. This identifies the node ID and
            the second SCI card to be used on the first node.
          </p></li><li><p><a name="mysql-cluster-param-sci-definition-host2sciid0"></a>
            <code class="literal">Host2SciId0</code>
          </p><p>
            This identifies the SCI node ID on the second Cluster node
            (identified by <code class="literal">NodeId2</code>).
          </p></li><li><p><a name="mysql-cluster-param-sci-definition-host2sciid1"></a>
            <code class="literal">Host2SciId1</code>
          </p><p>
            When using two SCI cards to provide failover, this parameter
            identifies the second SCI card to be used on the second
            node.
          </p></li><li><a class="indexterm" name="id2335441"></a><p><a name="mysql-cluster-param-sci-definition-sharedbuffersize"></a>
            <code class="literal">SharedBufferSize</code>
          </p><p>
            Each SCI transporter has a shared memory segment used for
            communication between the two nodes. Setting the size of
            this segment to the default value of 1MB should be
            sufficient for most applications. Using a smaller value can
            lead to problems when performing many parallel inserts; if
            the shared buffer is too small, this can also result in a
            crash of the <span><strong class="command">ndbd</strong></span> process.
          </p></li><li><a class="indexterm" name="id2335478"></a><p><a name="mysql-cluster-param-sci-definition-sendlimit"></a>
            <code class="literal">SendLimit</code>
          </p><p>
            A small buffer in front of the SCI media stores messages
            before transmitting them over the SCI network. By default,
            this is set to 8KB. Our benchmarks show that performance is
            best at 64KB but 16KB reaches within a few percent of this,
            and there was little if any advantage to increasing it
            beyond 8KB.
          </p></li><li><a class="indexterm" name="id2335508"></a><p><a name="mysql-cluster-param-sci-definition-sendsignalid"></a>
            <code class="literal">SendSignalId</code>
          </p><p>
            To trace a distributed message it is necessary to identify
            each message uniquely. When this parameter is set to
            <code class="literal">Y</code>, message IDs are transported over the
            network. This feature is disabled by default in production
            builds, and enabled in <code class="literal">-debug</code> builds.
          </p></li><li><a class="indexterm" name="id2335549"></a><p><a name="mysql-cluster-param-sci-definition-checksum"></a>
            <code class="literal">Checksum</code>
          </p><p>
            This parameter is a boolean value, and is disabled by
            default. When <code class="literal">Checksum</code> is enabled,
            checksums are calculated for all messages before they are
            placed in the send buffer. This feature prevents messages
            from being corrupted while waiting in the send buffer. It
            also serves as a check against data being corrupted during
            transport.
          </p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-config-params-overview"></a>20.3.5. Overview of Cluster Configuration Parameters</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-config-params-ndbd">20.3.5.1. Data Node Configuration Parameters</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-config-params-mgm">20.3.5.2. Management Node Configuration Parameters</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-config-params-api">20.3.5.3. SQL Node and API Node Configuration Parameters</a></span></dt></dl></div><a class="indexterm" name="id2335604"></a><a class="indexterm" name="id2335617"></a><p>
      The next three sections provide summary tables of MySQL Cluster
      configuration parameters used in the
      <code class="filename">config.ini</code> file to govern the cluster's
      functioning. Each table lists the parameters for one of the
      Cluster node process types (<span><strong class="command">ndbd</strong></span>,
      <span><strong class="command">ndb_mgmd</strong></span>, and <span><strong class="command">mysqld</strong></span>), and
      includes the parameter's type as well as its default, minimum, and
      maximum values as applicable.
    </p><p>
      It is also stated what type of restart is required (node restart
      or system restart) — and whether the restart must be done
      with <code class="option">--initial</code> — to change the value of a
      given configuration parameter. This information is provided in
      each table's <span class="bold"><strong>Restart Type</strong></span> column,
      which contains one of the values shown in this list:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          <code class="literal">N</code>: Node Restart
        </p></li><li><p>
          <code class="literal">IN</code>: Initial Node Restart
        </p></li><li><p>
          <code class="literal">S</code>: System Restart
        </p></li><li><p>
          <code class="literal">IS</code>: Initial System Restart
        </p></li></ul></div><p>
      When performing a node restart or an initial node restart, all of
      the cluster's data nodes must be restarted in turn (also referred
      to as a <em class="firstterm">rolling restart</em>). It is possible to
      update cluster configuration parameters marked
      <code class="literal">N</code> or <code class="literal">IN</code> online — that
      is, without shutting down the cluster — in this fashion. An
      initial node restart requires restarting each
      <span><strong class="command">ndbd</strong></span> process with the
      <code class="option">--initial</code> option.
    </p><p>
      A system restart requires a complete shutdown and restart of the
      entire cluster. An initial system restart requires taking a backup
      of the cluster, wiping the cluster filesystem after shutdown, and
      then restoring from the backup following the restart.
    </p><p>
      In any cluster restart, all of the cluster's management servers
      must be restarted in order for them to read the updated
      configuration parameter values.
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        Values for numeric cluster parameters can generally be increased
        without any problems, although it is advisable to do so
        progressively, making such adjustments in relatively small
        increments. However, decreasing the values of such parameters
        — particularly those relating to memory usage and disk
        space — is not to be undertaken lightly, and it is
        recommended that you do so only following careful planning and
        testing. In addition, it is the generally the case that
        parameters relating to memory and disk usage which can be raised
        using a simple node restart require an initial node restart to
        be lowered.
      </p></div><p>
      Because some of these parameters can be used for configuring more
      than one type of cluster node, they may appear in more than one of
      the tables.
    </p><p>
      (Note that <code class="literal">4294967039</code> — which often
      appears as a maximum value in these tables — is equal to
      <code class="literal">2<sup>32</sup> –
      2<sup>8</sup> – 1</code>.)
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-config-params-ndbd"></a>20.3.5.1. Data Node Configuration Parameters</h4></div></div></div><a class="indexterm" name="id2335832"></a><a class="indexterm" name="id2335845"></a><a class="indexterm" name="id2335854"></a><p>
        The following table provides information about parameters used
        in the <code class="literal">[ndbd]</code> or <code class="literal">[ndbd
        default]</code> sections of a <code class="filename">config.ini</code>
        file for configuring MySQL Cluster data nodes. For detailed
        descriptions and other additional information about each of
        these parameters, see
        <a href="mysql-cluster.html#mysql-cluster-ndbd-definition" title="20.3.4.5. Defining Data Nodes">Section 20.3.4.5, “Defining Data Nodes”</a>.
      </p><p>
        <span class="emphasis"><em><span class="bold"><strong>Restart Type</strong></span> Column
        Values</em></span>
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            <code class="literal">N</code>: Node Restart
          </p></li><li><p>
            <code class="literal">IN</code>: Initial Node Restart
          </p></li><li><p>
            <code class="literal">S</code>: System Restart
          </p></li><li><p>
            <code class="literal">IS</code>: Initial System Restart
          </p></li></ul></div><p>
        See <a href="mysql-cluster.html#mysql-cluster-config-params-overview" title="20.3.5. Overview of Cluster Configuration Parameters">Section 20.3.5, “Overview of Cluster Configuration Parameters”</a>, for
        additional explanations of these abbreviations.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Parameter Name</strong></span></td><td><span class="bold"><strong>Type/Units</strong></span></td><td><span class="bold"><strong>Default Value</strong></span></td><td><span class="bold"><strong>Minimum Value</strong></span></td><td><span class="bold"><strong>Maximum Value</strong></span></td><td><span class="bold"><strong>Restart Type</strong></span></td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-arbitrationtimeout">ArbitrationTimeout</a></code></td><td>milliseconds</td><td>3000</td><td>10</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-backupdatabuffersize">BackupDataBufferSize</a></code></td><td>bytes</td><td>2M</td><td>0</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-backupdatadir">BackupDataDir</a></code></td><td>string</td><td><code class="filename"><code class="literal">FileSystemPath</code>/BACKUP</code></td><td>N/A</td><td>N/A</td><td>IN</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-backuplogbuffersize">BackupLogBufferSize</a></code></td><td>bytes</td><td>2M</td><td>0</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-backupmemory">BackupMemory</a></code></td><td>bytes</td><td>4M</td><td>0</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-backupreportfrequency">BackupReportFrequency</a></code>
                (Added in MySQL Cluster NDB 6.2.3)</td><td>seconds</td><td>0</td><td>0</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-backupwritesize">BackupWriteSize</a></code></td><td>bytes</td><td>32K</td><td>2K</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-backupmaxwritesize">BackupMaxWriteSize</a></code></td><td>bytes</td><td>256K</td><td>2K</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-batchsizeperlocalscan">BatchSizePerLocalScan</a></code></td><td>integer</td><td>64</td><td>1</td><td>992</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-compressedbackup">CompressedBackup</a></code>
                (Added in MySQL Cluster NDB 6.3.7)</td><td>boolean</td><td>0</td><td>0</td><td>1</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-compressedlcp">CompressedLCP</a></code>
                (Added in MySQL Cluster NDB 6.3.7)</td><td>boolean</td><td>0</td><td>0</td><td>1</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-datadir">DataDir</a></code></td><td>string</td><td><code class="filename">/var/lib/mysql-cluster</code></td><td>N/A</td><td>N/A</td><td>IN</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-datamemory">DataMemory</a></code></td><td>bytes</td><td>80M</td><td>1M</td><td>1024G (subject to available system RAM and size of
                <code class="literal">IndexMemory</code>)</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-diskcheckpointspeed">DiskCheckpointSpeed</a></code>
                (added in MySQL 5.1.12)</td><td>integer (number of bytes per second)</td><td>10M</td><td>1M</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-diskcheckpointspeedinrestart">DiskCheckpointSpeedInRestart</a></code>
                (added in MySQL 5.1.12)</td><td>integer (number of bytes per second)</td><td>100M</td><td>1M</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-diskless">Diskless</a></code></td><td>true|false (<code class="literal">1</code>|<code class="literal">0</code>)</td><td>0</td><td>0</td><td>1</td><td>IS</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-disk-data-diskpagebuffermemory">DiskPageBufferMemory</a></code>
                (added in MySQL 5.1.6)</td><td>bytes</td><td>64M</td><td>4M</td><td>1024G</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-disksyncsize">DiskSyncSize</a></code>
                (added in MySQL 5.1.12)</td><td>integer (number of bytes)</td><td>4M</td><td>32K</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-executeoncomputer">ExecuteOnComputer</a></code></td><td>integer</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-filesystempath">FileSystemPath</a></code>
                (Added in MySQL-MySQL Cluster NDB 6.1.11)</td><td>string</td><td>value specified for <code class="literal">DataDir</code></td><td>N/A</td><td>N/A</td><td>IN</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-fragmentlogfilesize">FragmentLogFileSize</a></code></td><td>integer</td><td>16M</td><td>4M</td><td>1G</td><td>IN</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-heartbeatintervaldbapi">HeartbeatIntervalDbApi</a></code></td><td>milliseconds</td><td>1500</td><td>100</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-heartbeatintervaldbdb">HeartbeatIntervalDbDb</a></code></td><td>milliseconds</td><td>1500</td><td>10</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-hostname">HostName</a></code></td><td>string</td><td><code class="literal">localhost</code></td><td>N/A</td><td>N/A</td><td>S</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-id">Id</a></code></td><td>integer</td><td><span class="emphasis"><em>None</em></span></td><td>1</td><td>49</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-indexmemory">IndexMemory</a></code></td><td>bytes</td><td>18M</td><td>1M</td><td>1024G (subject to available system RAM and size of
                <code class="literal">DataMemory</code>)</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-initialnoofopenfiles">InitialNoOfOpenFiles</a></code></td><td>integer</td><td>27</td><td>20</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-lockexecutethreadtocpu">LockExecuteThreadToCPU</a></code>
                (Added in MySQL-MySQL Cluster NDB 6.3.4)</td><td>integer</td><td>65535</td><td>0</td><td>65535</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-lockmaintthreadstocpu">LockMaintThreadsToCPU</a></code>
                (Added in MySQL-MySQL Cluster NDB 6.3.4)</td><td>integer</td><td>65535</td><td>0</td><td>65535</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-lockpagesinmainmemory">LockPagesInMainMemory</a></code></td><td><span class="emphasis"><em>As of MySQL 5.1.15 and MySQL Cluster NDB 6.1.1</em></span>:
                integer; <span class="emphasis"><em>previously</em></span>: true|false
                (<code class="literal">1</code>|<code class="literal">0</code>)</td><td>0</td><td>0</td><td>1</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-loglevelcheckpoint">LogLevelCheckpoint</a></code></td><td>integer</td><td>0</td><td>0</td><td>15</td><td>IN</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-loglevelcongestion">LogLevelCongestion</a></code></td><td>integer</td><td>0</td><td>0</td><td>15</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-loglevelconnection">LogLevelConnection</a></code></td><td>integer</td><td>0</td><td>0</td><td>15</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-loglevelerror">LogLevelError</a></code></td><td>integer</td><td>0</td><td>0</td><td>15</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-loglevelinfo">LogLevelInfo</a></code></td><td>integer</td><td>0</td><td>0</td><td>15</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-loglevelnoderestart">LogLevelNodeRestart</a></code></td><td>integer</td><td>0</td><td>0</td><td>15</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-loglevelshutdown">LogLevelShutdown</a></code></td><td>integer</td><td>0</td><td>0</td><td>15</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-loglevelstartup">LogLevelStartup</a></code></td><td>integer</td><td>1</td><td>0</td><td>15</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-loglevelstatistic">LogLevelStatistic</a></code></td><td>integer</td><td>0</td><td>0</td><td>15</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-longmessagebuffer">LongMessageBuffer</a></code></td><td>bytes</td><td>1M</td><td>512K</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxallocate">MaxAllocate</a></code>
                (Added in MySQL Cluster NDB 6.1.12 and MySQL MySQL
                Cluster NDB 6.2.3)</td><td>integer</td><td>32M</td><td>1M</td><td>1G</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxbufferedepochs">MaxBufferedEpochs</a></code>
                (Added in MySQL Cluster NDB 6.2.14)</td><td>integer</td><td>100</td><td>0</td><td>100000</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxnoofattributes">MaxNoOfAttributes</a></code></td><td>integer</td><td>1000</td><td>32</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxnoofconcurrentindexoperations">MaxNoOfConcurrentIndexOperations</a></code></td><td>integer</td><td>8K</td><td>0</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxnoofconcurrentoperations">MaxNoOfConcurrentOperations</a></code></td><td>integer</td><td>32768</td><td>32</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxnoofconcurrentscans">MaxNoOfConcurrentScans</a></code></td><td>integer</td><td>256</td><td>2</td><td>500</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxnoofconcurrenttransactions">MaxNoOfConcurrentTransactions</a></code></td><td>integer</td><td>4096</td><td>32</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxnooffiredtriggers">MaxNoOfFiredTriggers</a></code></td><td>integer</td><td>4000</td><td>0</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxnoofindexes">MaxNoOfIndexes</a></code>
                (<span class="emphasis"><em>DEPRECATED</em></span> — use
                <code class="literal">MaxNoOfOrderedIndexes</code> or
                <code class="literal">MaxNoOfUniqueHashIndexes</code> instead)</td><td>integer</td><td>128</td><td>0</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxnooflocaloperations">MaxNoOfLocalOperations</a></code></td><td>integer</td><td><code class="literal">UNDEFINED</code></td><td>32</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxnooflocalscans">MaxNoOfLocalScans</a></code></td><td>integer</td><td><code class="literal">UNDEFINED</code> (see
                <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxnooflocalscans">description</a>)</td><td>32</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxnoofopenfiles">MaxNoOfOpenFiles</a></code></td><td>integer</td><td>40</td><td>20</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxnooforderedindexes">MaxNoOfOrderedIndexes</a></code></td><td>integer</td><td>128</td><td>0</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxnoofsavedmessages">MaxNoOfSavedMessages</a></code></td><td>integer</td><td>25</td><td>0</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxnooftables">MaxNoOfTables</a></code></td><td>integer</td><td>128</td><td>8</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxnooftriggers">MaxNoOfTriggers</a></code></td><td>integer</td><td>768</td><td>0</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxnoofuniquehashindexes">MaxNoOfUniqueHashIndexes</a></code></td><td>integer</td><td>64</td><td>0</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-memreportfrequency">MemReportFrequency</a></code>
                (Added in MySQL 5.1.16 and MySQL Cluster NDB 6.1.0)</td><td>integer (seconds)</td><td>0</td><td>0</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-noofdiskpagestodiskafterrestartacc">NoOfDiskPagesToDiskAfterRestartACC</a></code>
                (<span class="emphasis"><em>DEPRECATED</em></span> as of MySQL 5.1.6)</td><td>integer (number of 8KB pages per 100 milliseconds)</td><td>20 (= 20 * 80KB = 1.6MB/second)</td><td>1</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-noofdiskpagestodiskafterrestarttup">NoOfDiskPagesToDiskAfterRestartTUP</a></code>
                (<span class="emphasis"><em>DEPRECATED</em></span> as of MySQL 5.1.6)</td><td>integer (number of 8KB pages per 100 milliseconds)</td><td>40 (= 40 * 80KB = 3.2MB/second)</td><td>1</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-noofdiskpagestodiskduringrestartacc">NoOfDiskPagesToDiskDuringRestartACC</a></code>
                (<span class="emphasis"><em>DEPRECATED</em></span> as of MySQL 5.1.6)</td><td>integer (number of 8KB pages per 100 milliseconds)</td><td>20 (= 20 * 80KB = 1.6MB/second)</td><td>1</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-noofdiskpagestodiskduringrestarttup">NoOfDiskPagesToDiskDuringRestartTUP</a></code>
                (<span class="emphasis"><em>DEPRECATED</em></span> as of MySQL 5.1.6)</td><td>integer (number of 8KB pages per 100 milliseconds)</td><td>40 (= 40 * 80KB = 3.2MB/second)</td><td>1</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-nooffragmentlogfiles">NoOfFragmentLogFiles</a></code></td><td>integer</td><td>16</td><td>3</td><td>4294967039</td><td>IN</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-noofreplicas">NoOfReplicas</a></code></td><td>integer</td><td><span class="emphasis"><em>None</em></span></td><td>1</td><td>4 (theoretical); 2 (supported)</td><td>IS</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-odirect">ODirect</a></code></td><td>boolean</td><td>0</td><td>0</td><td>1</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-realtimescheduler">RealTimeScheduler</a></code>
                (Added in MySQL Cluster NDB 6.3.4)</td><td>boolean</td><td>0</td><td>0</td><td>1</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-redobuffer">RedoBuffer</a></code></td><td>bytes</td><td>8M</td><td>1M</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-restartonerrorinsert">RestartOnErrorInsert</a></code>
                (<span class="emphasis"><em>DEBUG BUILDS ONLY</em></span>)</td><td>true|false (<code class="literal">1</code>|<code class="literal">0</code>)</td><td>0</td><td>0</td><td>1</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-schedulerexecutiontimer">SchedulerExecutionTimer</a></code>
                (added in MySQL Cluster NDB 6.3.4)</td><td>μseconds (integer)</td><td>50</td><td>0</td><td>11000</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-schedulerspintimer">SchedulerSpinTimer</a></code>
                (added in MySQL Cluster NDB 6.3.4)</td><td>μseconds (integer)</td><td>0</td><td>0</td><td>500</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-serverport">ServerPort</a></code>
                (<span class="emphasis"><em>OBSOLETE</em></span>)</td><td>integer</td><td>1186</td><td>0</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-disk-data-sharedglobalmemory">SharedGlobalmemory</a></code>
                (added in MySQL 5.1.6)</td><td>bytes</td><td>20M</td><td>0</td><td>65536G</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-startfailuretimeout">StartFailureTimeout</a></code></td><td>milliseconds</td><td>0</td><td>0</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-startpartialtimeout">StartPartialTimeout</a></code></td><td>milliseconds</td><td>30000</td><td>0</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-startpartitionedtimeout">StartPartitionedTimeout</a></code></td><td>milliseconds</td><td>60000</td><td>0</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-stoponerror">StopOnError</a></code></td><td>true|false (<code class="literal">1</code>|<code class="literal">0</code>)</td><td>1</td><td>0</td><td>1</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-stringmemory">StringMemory</a></code></td><td>integer or percentage (see
                <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-stringmemory">description</a>
                for details)</td><td>0</td><td>0</td><td>4294967039</td><td>S</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-tcpbind-inaddr-any">TcpBind_INADDR_ANY</a></code>
                (Added in MySQL Cluster NDB 6.2.0)</td><td>true|false (<code class="literal">1</code>|<code class="literal">0</code>)</td><td>1</td><td>0</td><td>0</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-timebetweenepochs">TimeBetweenEpochs</a></code>
                (Added in MySQL Cluster NDB 6.2.5 and MySQL Cluster NDB
                6.3.2)</td><td>milliseconds</td><td>100</td><td>0</td><td>32000</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-timebetweenepochstimeout">TimeBetweenEpochsTimeout</a></code>
                (Added in MySQL Cluster NDB 6.2.7 and MySQL Cluster NDB
                6.3.4)</td><td>milliseconds</td><td>4000</td><td>0</td><td>32000</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-timebetweenglobalcheckpoints">TimeBetweenGlobalCheckpoints</a></code></td><td>milliseconds</td><td>2000</td><td>10</td><td>32000</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-timebetweeninactivetransactionabortcheck">TimeBetweenInactiveTransactionAbortCheck</a></code></td><td>milliseconds</td><td>1000</td><td>1000</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-timebetweenlocalcheckpoints">TimeBetweenLocalCheckpoints</a></code></td><td>integer (number of 4-byte words as a base-2 logarithm)</td><td>20 (= <code class="literal">4 * 2<sup>20</sup></code> = 4MB write
                operations)</td><td>0</td><td>31</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-timebetweenwatchdogcheck">TimeBetweenWatchDogCheck</a></code></td><td>milliseconds</td><td>6000</td><td>70</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-timebetweenwatchdogcheckinitial">TimeBetweenWatchDogCheckInitial</a></code>
                (added in MySQL 5.1.20)</td><td>milliseconds</td><td>6000</td><td>70</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-transactionbuffermemory">TransactionBufferMemory</a></code></td><td>bytes</td><td>1M</td><td>1K</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-transactiondeadlockdetectiontimeout">TransactionDeadlockDetectionTimeout</a></code></td><td>milliseconds</td><td>1200</td><td>50</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-transactioninactivetimeout">TransactionInactiveTimeout</a></code></td><td>milliseconds</td><td>0</td><td>0</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-undodatabuffer">UndoDataBuffer</a></code>
                (<span class="emphasis"><em>OBSOLETE</em></span>)</td><td>bytes</td><td>16M</td><td>1M</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-undoindexbuffer">UndoIndexBuffer</a></code>
                (<span class="emphasis"><em>OBSOLETE</em></span>)</td><td>bytes</td><td>2M</td><td>1M</td><td>4294967039</td><td>N</td></tr></tbody></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-config-params-mgm"></a>20.3.5.2. Management Node Configuration Parameters</h4></div></div></div><a class="indexterm" name="id2338989"></a><a class="indexterm" name="id2339002"></a><a class="indexterm" name="id2339011"></a><p>
        The following table provides information about parameters used
        in the <code class="literal">[ndb_mgmd]</code> or <code class="literal">[mgm]</code>
        sections of a <code class="filename">config.ini</code> file for
        configuring MySQL Cluster management nodes. For detailed
        descriptions and other additional information about each of
        these parameters, see
        <a href="mysql-cluster.html#mysql-cluster-mgm-definition" title="20.3.4.4. Defining the Management Server">Section 20.3.4.4, “Defining the Management Server”</a>.
      </p><p>
        <span class="emphasis"><em><span class="bold"><strong>Restart Type</strong></span> Column
        Values</em></span>
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            <code class="literal">N</code>: Node Restart
          </p></li><li><p>
            <code class="literal">IN</code>: Initial Node Restart
          </p></li><li><p>
            <code class="literal">S</code>: System Restart
          </p></li><li><p>
            <code class="literal">IS</code>: Initial System Restart
          </p></li></ul></div><p>
        See <a href="mysql-cluster.html#mysql-cluster-config-params-overview" title="20.3.5. Overview of Cluster Configuration Parameters">Section 20.3.5, “Overview of Cluster Configuration Parameters”</a>, for
        additional explanations of these abbreviations.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Parameter Name</strong></span></td><td><span class="bold"><strong>Type/Units</strong></span></td><td><span class="bold"><strong>Default Value</strong></span></td><td><span class="bold"><strong>Minimum Value</strong></span></td><td><span class="bold"><strong>Maximum Value</strong></span></td><td><span class="bold"><strong>Restart Type</strong></span></td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-mgm-definition-arbitrationdelay">ArbitrationDelay</a></code></td><td>milliseconds</td><td>0</td><td>0</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-mgm-definition-arbitrationrank">ArbitrationRank</a></code></td><td>integer</td><td>1</td><td>0</td><td>2</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-mgm-definition-datadir">DataDir</a></code></td><td>string</td><td><code class="filename">./</code> (<span><strong class="command">ndb_mgmd</strong></span> directory)</td><td>N/A</td><td>N/A</td><td>IN</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-mgm-definition-executeoncomputer">ExecuteOnComputer</a></code></td><td>integer</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-mgm-definition-hostname">HostName</a></code></td><td>string</td><td><code class="literal">localhost</code></td><td>N/A</td><td>N/A</td><td>IN</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-mgm-definition-id">Id</a></code></td><td>integer</td><td><span class="emphasis"><em>None</em></span></td><td>1</td><td>63</td><td>IN</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-mgm-definition-logdestination">LogDestination</a></code></td><td><code class="literal">CONSOLE</code>, <code class="literal">SYSLOG</code>, or
                <code class="literal">FILE</code></td><td><code class="literal">FILE</code> (see
                <a href="mysql-cluster.html#mysql-cluster-mgm-definition" title="20.3.4.4. Defining the Management Server">Section 20.3.4.4, “Defining the Management Server”</a>)</td><td>N/A</td><td>N/A</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-mgm-definition-portnumber">PortNumber</a></code></td><td>integer</td><td>1186</td><td>1</td><td>65535</td><td>S</td></tr></tbody></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-config-params-api"></a>20.3.5.3. SQL Node and API Node Configuration Parameters</h4></div></div></div><a class="indexterm" name="id2339485"></a><a class="indexterm" name="id2339497"></a><a class="indexterm" name="id2339506"></a><p>
        The following table provides information about parameters used
        in the <code class="literal">[SQL]</code> and <code class="literal">[api]</code>
        sections of a <code class="filename">config.ini</code> file for
        configuring MySQL Cluster SQL nodes and API nodes. For detailed
        descriptions and other additional information about each of
        these parameters, see
        <a href="mysql-cluster.html#mysql-cluster-api-definition" title="20.3.4.6. Defining SQL and Other API Nodes">Section 20.3.4.6, “Defining SQL and Other API Nodes”</a>.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          For a discussion of MySQL server options for MySQL Cluster,
          see <a href="mysql-cluster.html#mysql-cluster-mysqld-command-options" title="20.4.2. MySQL Cluster-Related Command Options for mysqld">Section 20.4.2, “MySQL Cluster-Related Command Options for <span><strong class="command">mysqld</strong></span>”</a>;
          for information about MySQL server system variables relating
          to MySQL Cluster, see
          <a href="mysql-cluster.html#mysql-cluster-system-variables" title="20.4.3. MySQL Cluster System Variables">Section 20.4.3, “MySQL Cluster System Variables”</a>.
        </p></div><p>
        <span class="emphasis"><em><span class="bold"><strong>Restart Type</strong></span> Column
        Values</em></span>
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            <code class="literal">N</code>: Node Restart
          </p></li><li><p>
            <code class="literal">IN</code>: Initial Node Restart
          </p></li><li><p>
            <code class="literal">S</code>: System Restart
          </p></li><li><p>
            <code class="literal">IS</code>: Initial System Restart
          </p></li></ul></div><p>
        See <a href="mysql-cluster.html#mysql-cluster-config-params-overview" title="20.3.5. Overview of Cluster Configuration Parameters">Section 20.3.5, “Overview of Cluster Configuration Parameters”</a>, for
        additional explanations of these abbreviations.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Parameter Name</strong></span></td><td><span class="bold"><strong>Type/Units</strong></span></td><td><span class="bold"><strong>Default Value</strong></span></td><td><span class="bold"><strong>Minimum Value</strong></span></td><td><span class="bold"><strong>Maximum Value</strong></span></td><td><span class="bold"><strong>Restart Type</strong></span></td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-api-definition-arbitrationdelay">ArbitrationDelay</a></code></td><td>milliseconds</td><td>0</td><td>0</td><td>4294967039</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-api-definition-arbitrationrank">ArbitrationRank</a></code></td><td>integer</td><td>0</td><td>0</td><td>2</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-api-definition-batchbytesize">BatchByteSize</a></code></td><td>bytes</td><td>32K</td><td>1K</td><td>1M</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-api-definition-batchsize">BatchSize</a></code></td><td>integer</td><td>64</td><td>1</td><td>992</td><td>N</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-api-definition-executeoncomputer">ExecuteOnComputer</a></code></td><td>integer</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-api-definition-hostname">HostName</a></code></td><td>string</td><td><span class="emphasis"><em>none</em></span></td><td>N/A</td><td>N/A</td><td>IN</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-api-definition-id">Id</a></code></td><td>integer</td><td><span class="emphasis"><em>None</em></span></td><td>1</td><td>63</td><td>IN</td></tr><tr><td><code class="literal"><a href="mysql-cluster.html#mysql-cluster-param-api-definition-maxscanbatchsize">MaxScanBatchSize</a></code></td><td>bytes</td><td>256K</td><td>32K</td><td>16M</td><td>N</td></tr></tbody></table></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-config-lcp-params"></a>20.3.6. Configuring Parameters for Local Checkpoints</h3></div></div></div><a class="indexterm" name="id2339961"></a><a class="indexterm" name="id2339970"></a><a class="indexterm" name="id2339979"></a><a class="indexterm" name="id2339992"></a><a class="indexterm" name="id2340004"></a><a class="indexterm" name="id2340017"></a><a class="indexterm" name="id2340026"></a><p>
      The parameters discussed in
      <a href="mysql-cluster.html#mysql-cluster-logging-and-checkpointing">Logging
      and Checkpointing</a> and in
      <a href="mysql-cluster.html#mysql-cluster-data-memory-index-memory-string-memory">Data
      Memory, Index Memory, and String Memory</a> that are used to
      configure local checkpoints for a MySQL Cluster do not exist in
      isolation, but rather are very much interdepedent on each other.
      In this section, we illustrate how these parameters —
      including <code class="literal">DataMemory</code>,
      <code class="literal">IndexMemory</code>,
      <code class="literal">NoOfDiskPagesToDiskAfterRestartTUP</code>,
      <code class="literal">NoOfDiskPagesToDiskAfterRestartACC</code>, and
      <code class="literal">NoOfFragmentLogFiles</code> — relate to one
      another in a working Cluster.
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        The parameters
        <code class="literal">NoOfDiskPagesToDiskAfterRestartTUP</code> and
        <code class="literal">NoOfDiskPagesToDiskAfterRestartACC</code> were
        deprecated in MySQL 5.1.6. From MySQL 5.1.6 through 5.1.11, disk
        writes during LCPs took place at the maximum speed possible.
        Beginning with MySQL 5.1.12, the speed and throughput for LCPs
        are controlled using the parameters
        <code class="literal">DiskSyncSize</code>,
        <code class="literal">DiskCheckpointSpeed</code>, and
        <code class="literal">DiskCheckpointSpeedInRestart</code>. See
        <a href="mysql-cluster.html#mysql-cluster-ndbd-definition" title="20.3.4.5. Defining Data Nodes">Section 20.3.4.5, “Defining Data Nodes”</a>.
      </p></div><p>
      In this example, we assume that our application performs the
      following numbers of types of operations per hour:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          50000 selects
        </p></li><li><p>
          15000 inserts
        </p></li><li><p>
          15000 updates
        </p></li><li><p>
          15000 deletes
        </p></li></ul></div><p>
      We also make the following assumptions about the data used in the
      application:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          We are working with a single table having 40 columns.
        </p></li><li><p>
          Each column can hold up to 32 bytes of data.
        </p></li><li><p>
          A typical <code class="literal">UPDATE</code> run by the application
          affects the values of 5 columns.
        </p></li><li><p>
          No <code class="literal">NULL</code> values are inserted by the
          application.
        </p></li></ul></div><p>
      A good starting point is to determine the amount of time that
      should elapse between local checkpoints (LCPs). It worth noting
      that, in the event of a system restart, it takes 40-60 percent of
      this interval to execute the REDO log — for example, if the
      time between LCPs is 5 minutes (300 seconds), then it should take
      2 to 3 minutes (120 to 180 seconds) for the REDO log to be read.
    </p><p>
      The maximum amount of data per node can be assumed to be the size
      of the <code class="literal">DataMemory</code> parameter. In this example,
      we assume that this is 2 GB. The
      <code class="literal">NoOfDiskPagesToDiskAfterRestartTUP</code> parameter
      represents the amount of data to be checkpointed per unit time
      — however, this parameter is actually expressed as the
      number of 8K memory pages to be checkpointed per 100 milliseconds.
      2 GB per 300 seconds is approximately 6.8 MB per second, or 700 KB
      per 100 milliseconds, which works out to roughly 85 pages per 100
      milliseconds.
    </p><p>
      Similarly, we can calculate
      <code class="literal">NoOfDiskPagesToDiskAfterRestartACC</code> in terms of
      the time for local checkpoints and the amount of memory required
      for indexes — that is, the <code class="literal">IndexMemory</code>.
      Assuming that we allow 512 MB for indexes, this works out to
      approximately 20 8-KB pages per 100 milliseconds for this
      parameter.
    </p><p>
      Next, we need to determine the number of REDO log files required
      — that is, fragment log files — the corresponding
      parameter being <code class="literal">NoOfFragmentLogFiles</code>. We need
      to make sure that there are sufficient REDO log files for keeping
      records for at least 3 local checkpoints. In a production setting,
      there are always uncertainties — for instance, we cannot be
      sure that disks always operate at top speed or with maximum
      throughput. For this reason, it is best to err on the side of
      caution, so we double our requirement and calculate a number of
      fragment log files which should be enough to keep records covering
      6 local checkpoints.
    </p><p>
      It is also important to remember that the disk also handles writes
      to the REDO log, so if you find that the amount of data being
      written to disk as detemined by the values of
      <code class="literal">NoOfDiskPagesToDiskAfterRestartACC</code> and
      <code class="literal">NoOfDiskPagesToDiskAfterRestartTUP</code> is
      approaching the amount of disk bandwidth available, you may wish
      to increase the time between local checkpoints.
    </p><p>
      Given 5 minutes (300 seconds) per local checkpoint, this means
      that we need to support writing log records at maximum speed for 6
      * 300 = 1800 seconds. The size of a REDO log record is 72 bytes
      plus 4 bytes per updated column value plus the maximum size of the
      updated column, and there is one REDO log record for each table
      record updated in a transaction, on each node where the data
      reside. Using the numbers of operations set out previously in this
      section, we derive the following:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          50000 select operations per hour yields 0 log records (and
          thus 0 bytes), since <code class="literal">SELECT</code> statements are
          not recorded in the REDO log.
        </p></li><li><p>
          15000 <code class="literal">DELETE</code> statements per hour is
          approximately 5 delete operations per second. (Since we wish
          to be conservative in our estimate, we round up here and in
          the following calculations.) No columns are updated by
          deletes, so these statements consume only 5 operations * 72
          bytes per operation = 360 bytes per second.
        </p></li><li><p>
          15000 <code class="literal">UPDATE</code> statements per hour is roughly
          the same as 5 updates per second. Each update uses 72 bytes,
          plus 4 bytes per column * 5 columns updated, plus 32 bytes per
          column * 5 columns — this works out to 72 + 20 + 160 =
          252 bytes per operation, and multiplying this by 5 operation
          per second yields 1260 bytes per second.
        </p></li><li><p>
          15000 <code class="literal">INSERT</code> statements per hour is
          equivalent to 5 insert operations per second. Each insert
          requires REDO log space of 72 bytes, plus 4 bytes per record *
          40 columns, plus 32 bytes per column * 40 columns, which is 72
          + 160 + 1280 = 1512 bytes per operation. This times 5
          operations per second yields 7560 bytes per second.
        </p></li></ul></div><p>
      So the total number of REDO log bytes being written per second is
      approximately 0 + 360 + 1260 + 7560 = 9180 bytes. Multiplied by
      1800 seconds, this yields 16524000 bytes required for REDO
      logging, or approximately 15.75 MB. The unit used for
      <code class="literal">NoOfFragmentLogFiles</code> represents a set of 4
      16-MB log files — that is, 64 MB. Thus, the minimum value
      (3) for this parameter is sufficient for the scenario envisioned
      in this example, since 3 times 64 = 192 MB, or about 12 times what
      is required; the default value of 8 (or 512 MB) is more than ample
      in this case.
    </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-options-variables"></a>20.4. MySQL Cluster Options and Variables</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-option-tables">20.4.1. MySQL Cluster Server Option and Variable Reference</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-mysqld-command-options">20.4.2. MySQL Cluster-Related Command Options for <span><strong class="command">mysqld</strong></span></a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-system-variables">20.4.3. MySQL Cluster System Variables</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-status-variables">20.4.4. MySQL Cluster Status Variables</a></span></dt></dl></div><p>
    This section provides information about MySQL server options, server
    and status variables that are specific to MySQL Cluster. For general
    information on using these, and for other options and variables not
    specific to MySQL Cluster, see <a href="server-administration.html#mysqld-server" title="5.1. The MySQL Server">Section 5.1, “The MySQL Server”</a>.
  </p><p>
    For MySQL Cluster configuration parameters used in the cluster
    configuration file (usually named <code class="filename">config.ini</code>),
    see <a href="mysql-cluster.html#mysql-cluster-configuration" title="20.3. MySQL Cluster Configuration">Section 20.3, “MySQL Cluster Configuration”</a>.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-option-tables"></a>20.4.1. MySQL Cluster Server Option and Variable Reference</h3></div></div></div><p>
      The following table provides a list of the command-line options,
      server and status variables applicable within
      <code class="literal">mysqld</code> when it is running as an SQL node in a
      MySQL Cluster. For a table showing <span class="emphasis"><em>all</em></span>
      command-line options, server and status variables available for
      use with <span><strong class="command">mysqld</strong></span>, see
      <a href="server-administration.html#mysqld-option-tables" title="5.1.1. Option and Variable Reference">Section 5.1.1, “Option and Variable Reference”</a>.
    </p><div class="informaltable"><table border="1"><colgroup><col><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"><col align="center"></colgroup><thead><tr><th><span class="bold"><strong>Name</strong></span></th><th align="center"><span class="bold"><strong>Cmd-Line</strong></span></th><th align="center"><span class="bold"><strong>Option file</strong></span></th><th align="center"><span class="bold"><strong>System Var</strong></span></th><th align="center"><span class="bold"><strong>Status Var</strong></span></th><th align="center"><span class="bold"><strong>Var Scope</strong></span></th><th align="center"><span class="bold"><strong>Dynamic</strong></span></th></tr></thead><tbody><tr><td><a href="mysql-cluster.html#option_mysqld_Handler_discover">Handler_discover</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_have_ndbcluster">have_ndbcluster</a></td><td align="center"> </td><td align="center"> </td><td align="center"> Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndb_autoincrement_prefetch_sz">ndb_autoincrement_prefetch_sz</a></td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> </td><td align="center">Both</td><td align="center"> Yes</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndb_cache_check_time">ndb_cache_check_time</a></td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> </td><td align="center">Global</td><td align="center"> Yes</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndbcluster">ndbcluster</a></td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> </td><td align="center">Both</td><td align="center"> Yes</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndb-cluster-connection-pool">ndb-cluster-connection-pool</a></td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> </td><td align="center"> Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_Ndb_cluster_node_id">Ndb_cluster_node_id</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_Ndb_config_from_host">Ndb_config_from_host</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_Ndb_config_from_port">Ndb_config_from_port</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_Ndb_conflict_fn_max">Ndb_conflict_fn_max</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_Ndb_conflict_fn_old">Ndb_conflict_fn_old</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndb-connectstring">ndb-connectstring</a></td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_Ndb_execute_count">ndb_execute_count</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> Yes</td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndb_extra_logging">ndb_extra_logging</a></td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> </td><td align="center">Global</td><td align="center"> Yes</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndb_force_send">ndb_force_send</a></td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> </td><td align="center">Both</td><td align="center"> Yes</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndb_index_stat_cache_entries">ndb_index_stat_cache_entries</a></td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndb_index_stat_enable">ndb_index_stat_enable</a></td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndb_index_stat_update_freq">ndb_index_stat_update_freq</a></td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="mysql-cluster.html#mysql-cluster-replication-schema" title="20.11.4. Cluster Replication Schema and Tables">ndb_log_orig</a></td><td align="center"> </td><td align="center"> </td><td align="center"> Yes</td><td align="center"> </td><td align="center">Global</td><td align="center">No</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndb_log_update_as_write">ndb_log_update_as_write</a></td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> </td><td align="center">Global</td><td align="center"> Yes</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndb_log_updated_only">ndb_log_updated_only</a></td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> </td><td align="center">Global</td><td align="center"> Yes</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_Ndb_number_of_data_nodes">Ndb_number_of_data_nodes</a></td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> Yes</td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndb_optimized_node_selection">ndb_optimized_node_selection</a></td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndb_report_thresh_binlog_epoch_slip">ndb_report_thresh_binlog_epoch_slip</a></td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndb_report_thresh_binlog_mem_usage">ndb_report_thresh_binlog_mem_usage</a></td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndb_use_copying_alter_table">ndb_use_copying_alter_table</a></td><td align="center"> </td><td align="center"> </td><td align="center"> Yes</td><td align="center"> </td><td align="center">Both</td><td align="center">No</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndb_use_exact_count">ndb_use_exact_count</a></td><td align="center"> </td><td align="center"> </td><td align="center"> Yes</td><td align="center"> </td><td align="center">Both</td><td align="center"> Yes</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndb_use_transactions">ndb_use_transactions</a></td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_ndb_wait_connected">ndb_wait_connected</a></td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> </td><td align="center"> </td><td align="center">No</td></tr><tr><td><a href="mysql-cluster.html#option_mysqld_skip-ndbcluster">skip-ndbcluster</a></td><td align="center"> Yes</td><td align="center"> Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center"> </td></tr><tr><td><a href="mysql-cluster.html#mysql-cluster-replication-starting" title="20.11.6. Starting Replication (Single Replication Channel)">slave-allow-batching</a></td><td align="center"> Yes</td><td align="center"> </td><td align="center"> </td><td align="center"> </td><td align="center">Global</td><td align="center"> Yes</td></tr><tr><td> - <span class="emphasis"><em>Variable</em></span>: slave_allow_batching</td><td align="center"> </td><td align="center"> </td><td align="center"> Yes</td><td align="center"> </td><td align="center">Global</td><td align="center"> Yes</td></tr></tbody></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-mysqld-command-options"></a>20.4.2. MySQL Cluster-Related Command Options for <span><strong class="command">mysqld</strong></span></h3></div></div></div><a class="indexterm" name="id2341443"></a><a class="indexterm" name="id2341456"></a><a class="indexterm" name="id2341468"></a><a class="indexterm" name="id2341481"></a><a class="indexterm" name="id2341493"></a><p>
      This section provides descriptions of <span><strong class="command">mysqld</strong></span>
      server options relating to MySQL Cluster. For information about
      <span><strong class="command">mysqld</strong></span> options not specific to MySQL Cluster,
      and for general information about the use of options with
      <span><strong class="command">mysqld</strong></span>, see <a href="server-administration.html#server-options" title="5.1.2. Command Options">Section 5.1.2, “Command Options”</a>.
    </p><p>
      For information about command-line options used with other MySQL
      Cluster processes (<span><strong class="command">ndbd</strong></span>,
      <span><strong class="command">ndb_mgmd</strong></span>, and <span><strong class="command">ndb_mgm</strong></span>), see
      <a href="mysql-cluster.html#mysql-cluster-command-options" title="20.6.5. Command Options for MySQL Cluster Processes">Section 20.6.5, “Command Options for MySQL Cluster Processes”</a>. For information
      about command-line options used with <code class="literal">NDB</code>
      utility programs (such as <span><strong class="command">ndb_desc</strong></span>,
      <span><strong class="command">ndb_size.pl</strong></span>, and
      <span><strong class="command">ndb_show_tables</strong></span>), see
      <a href="mysql-cluster.html#mysql-cluster-utilities" title="20.10. Cluster Utility Programs">Section 20.10, “Cluster Utility Programs”</a>.
    </p><div class="itemizedlist"><ul type="disc"><li><p><a name="option_mysqld_ndb-cluster-connection-pool"></a>
          <a class="indexterm" name="id2341598"></a>

          <a class="indexterm" name="id2341611"></a>

          <code class="option">--ndb-cluster-connection-pool=<em class="replaceable"><code>#</code></em></code>
        </p><p>
          By setting this option to a value greater than 1 (the
          default), a <span><strong class="command">mysqld</strong></span> process can use multiple
          connections to the cluster, effectively mimicking several SQL
          nodes. Each connection requires its own
          <code class="literal">[api]</code> or <code class="literal">[mysqld]</code>
          section in the cluster configuration
          (<code class="filename">config.ini</code>) file, and counts against the
          maximum number of API connections supported by the cluster.
          For example, suppose that you have 2 cluster host computers,
          each running an SQL node whose <span><strong class="command">mysqld</strong></span>
          process was started with
          <code class="option">--ndb-cluster-connection-pool=4</code>; this means
          that the cluster must have 8 API slots available for these
          connections (instead of 2). All of these connections are set
          up when the SQL node connects to the cluster, and are
          allocated to threads in a round-robin fashion.
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
            This option is useful only when running
            <span><strong class="command">mysqld</strong></span> on host machines having multiple
            CPUs, multiple cores, or both. For best results, the value
            should be smaller than the total number of cores available
            on the host machine. Setting it to a value greater than this
            is likely to degrade performance severely.
          </p></div><p>
          Beginning with MySQL Cluster NDB 6.2.16 and MySQL Cluster NDB
          6.3.13, the value used for this option is available as a
          global status variable. (<a href="http://bugs.mysql.com/35573" target="_top">Bug#35573</a>)
        </p></li><li><p><a name="option_mysqld_ndb-connectstring"></a>
          <a class="indexterm" name="id2341708"></a>

          <a class="indexterm" name="id2341720"></a>

          <code class="option">--ndb-connectstring=<em class="replaceable"><code>connect_string</code></em></code>
        </p><p>
          When using the <code class="literal">NDBCLUSTER</code> storage engine,
          this option specifies the management server that distributes
          cluster configuration data.
        </p></li><li><p><a name="option_mysqld_ndbcluster"></a>
          <a class="indexterm" name="id2341758"></a>

          <a class="indexterm" name="id2341770"></a>

          <code class="option">--ndbcluster</code>
        </p><p>
          The <code class="literal">NDB</code> (or <code class="literal">NDBCLUSTER</code>)
          storage engine is necessary for using MySQL Cluster. If a
          <span><strong class="command">mysqld</strong></span> binary includes support for the
          <code class="literal">NDB</code> storage engine, the engine is disabled
          by default. Use the <code class="option">--ndbcluster</code> option to
          enable it. Use <code class="option">--skip-ndbcluster</code> to
          explicitly disable the engine.
        </p></li><li><p><a name="option_mysqld_skip-ndbcluster"></a>
          <a class="indexterm" name="id2341831"></a>

          <a class="indexterm" name="id2341844"></a>

          <code class="option">--skip-ndbcluster</code>
        </p><p>
          Disable the <code class="literal">NDB</code> storage engine. This is the
          default for binaries that were built with
          <code class="literal">NDB</code> storage engine support; the server
          allocates memory and other resources for this storage engine
          only if the <code class="option">--ndbcluster</code> option is given
          explicitly. See <a href="mysql-cluster.html#mysql-cluster-quick" title="20.3.3. Quick Test Setup of MySQL Cluster">Section 20.3.3, “Quick Test Setup of MySQL Cluster”</a>, for an
          example of usage.
        </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-system-variables"></a>20.4.3. MySQL Cluster System Variables</h3></div></div></div><p>
      This section provides detailed information about MySQL server
      system variables that are specific to MySQL Cluster and the
      <code class="literal">NDB</code> storage engine. For system variables not
      specific to MySQL Cluster, see
      <a href="server-administration.html#server-system-variables" title="5.1.3. System Variables">Section 5.1.3, “System Variables”</a>. For general information
      on using system variables, see
      <a href="server-administration.html#using-system-variables" title="5.1.5. Using System Variables">Section 5.1.5, “Using System Variables”</a>.
    </p><div class="itemizedlist"><ul type="disc"><li><p><a name="option_mysqld_have_ndbcluster"></a>
          <code class="literal">have_ndbcluster</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">have_ndbcluster</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>No</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td>boolean</td></tr></tbody></table></td></tr></tbody></table></div><p>
          <code class="literal">YES</code> if <span><strong class="command">mysqld</strong></span> supports
          <code class="literal">NDB</code> tables. <code class="literal">DISABLED</code> if
          <code class="option">--skip-ndbcluster</code> is used.
        </p></li><li><p><a name="option_mysqld_multi_range_count"></a>
          <code class="literal">multi_range_count</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td> Yes, <code class="literal">multi_range_count</code></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">multi_range_count</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Both</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td> Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td>numeric</td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">256</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td>1-4294967295</td></tr></tbody></table></td></tr></tbody></table></div><p>
          The maximum number of ranges to send to a table handler at
          once during range selects. The default value is 256. Sending
          multiple ranges to a handler at once can improve the
          performance of certain selects dramatically. This is
          especially true for the <code class="literal">NDB</code> table handler,
          which needs to send the range requests to all nodes. Sending a
          batch of those requests at once reduces communication costs
          significantly.
        </p><p>
          This variable is deprecated in MySQL 5.1, and is no longer
          supported in MySQL 6.0, in which arbitrarily long lists of
          ranges can be processed.
        </p></li><li><p><a name="option_mysqld_ndb_autoincrement_prefetch_sz"></a>
          <code class="literal">ndb_autoincrement_prefetch_sz</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td> Yes, <code class="literal">ndb_autoincrement_prefetch_sz</code></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">ndb_autoincrement_prefetch_sz</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Both</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td> Yes</td></tr><tr><td><span class="bold"><strong>Value Set (&lt;= 5.1.22)</strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td>numeric</td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">32</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td>1-256</td></tr></tbody></table></td></tr><tr><td><span class="bold"><strong>Value Set (&gt;= 5.1.23)</strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td>numeric</td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">1</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td>1-256</td></tr></tbody></table></td></tr></tbody></table></div><p>
          Determines the probability of gaps in an autoincremented
          column. Set it to <code class="literal">1</code> to minimize this.
          Setting it to a high value for optimization — makes
          inserts faster, but decreases the likelihood that consecutive
          autoincrement numbers will be used in a batch of inserts.
          Default value: <code class="literal">32</code>. Minimum value:
          <code class="literal">1</code>.
        </p><p>
          Beginning with MySQL Cluster NDB 6.2.10, MySQL Cluster NDB
          6.3.7, and MySQL 5.1.23, this variable affects the number of
          <code class="literal">AUTO_INCREMENT</code> IDs that are fetched between
          statements only. Within a statement, at least 32 IDs are now
          obtained at a time. The default value for
          <code class="literal">ndb_autoincrement_prefetch_sz</code> is now
          <code class="literal">1</code>, to increase the speed of statements
          inserting single rows. (<a href="http://bugs.mysql.com/31956" target="_top">Bug#31956</a>)
        </p></li><li><p><a name="option_mysqld_ndb_cache_check_time"></a>
          <code class="literal">ndb_cache_check_time</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td> Yes, <code class="literal">ndb_cache_check_time</code></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">ndb_cache_check_time</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td> Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td>numeric</td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          The number of milliseconds that elapse between checks of MySQL
          Cluster SQL nodes by the MySQL query cache. Setting this to 0
          (the default and minimum value) means that the query cache
          checks for validation on every query.
        </p><p>
          The recommended maximum value for this variable is 1000, which
          means that the check is performed once per second. A larger
          value means that the check is performed and possibly
          invalidated due to updates on different SQL nodes less often.
          It is generally not desirable to set this to a value greater
          than 2000.
        </p></li><li><p><a name="option_mysqld_ndb_extra_logging"></a>
          <code class="literal">ndb_extra_logging</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Version Introduced</strong></span></td><td>5.1.6</td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">ndb_extra_logging</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Global</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td> Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td>numeric</td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          This variable can be used to enable recording in the MySQL
          error log of information specific to the
          <code class="literal">NDB</code> storage engine. It is normally of
          interest only when debugging <code class="literal">NDB</code> storage
          engine code.
        </p><p>
          The default value is 0, which means that the only
          <code class="literal">NDB</code>-specific information written to the
          MySQL error log relates to transaction handling. If the value
          is greater than 0 but less than 10, <code class="literal">NDB</code>
          table schema and connection events are also logged, as well as
          whether or not conflict resolution is in use, and other
          <code class="literal">NDB</code> errors and information. If the value is
          set to 10 or more, information about <code class="literal">NDB</code>
          internals, such as the progress of data distribution among
          cluster nodes, is also written to the MySQL error log.
        </p><p>
          This variable was added in MySQL 5.1.6.
        </p></li><li><p><a name="option_mysqld_ndb_force_send"></a>
          <code class="literal">ndb_force_send</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td> Yes, <code class="literal">ndb_force_send</code></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">ndb_force_send</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Both</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td> Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td>boolean</td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">TRUE</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          Forces sending of buffers to <code class="literal">NDB</code>
          immediately, without waiting for other threads. Defaults to
          <code class="literal">ON</code>.
        </p></li><li><p><a name="option_mysqld_ndb_index_stat_cache_entries"></a>
          <code class="literal">ndb_index_stat_cache_entries</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td>numeric</td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">32</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td>0-4294967295</td></tr></tbody></table></td></tr></tbody></table></div><p>
          Sets the granularity of the statistics by determining the
          number of starting and ending keys to store in the statistics
          memory cache. Zero means no caching takes place; in this case,
          the data nodes are always queried directly. Default value:
          <code class="literal">32</code>.
        </p></li><li><p><a name="option_mysqld_ndb_index_stat_enable"></a>
          <code class="literal">ndb_index_stat_enable</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td>boolean</td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">ON</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          Use <code class="literal">NDB</code> index statistics in query
          optimization. Defaults to <code class="literal">ON</code>.
        </p></li><li><p><a name="option_mysqld_ndb_index_stat_update_freq"></a>
          <code class="literal">ndb_index_stat_update_freq</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td>numeric</td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">20</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td>0-4294967295</td></tr></tbody></table></td></tr></tbody></table></div><p>
          How often to query data nodes instead of the statistics cache.
          For example, a value of <code class="literal">20</code> (the default)
          means to direct every 20<sup>th</sup> query to
          the data nodes.
        </p></li><li><p><a name="option_mysqld_ndb_optimized_node_selection"></a>
          <code class="literal">ndb_optimized_node_selection</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td>boolean</td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">ON</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          Causes an SQL node to use a data node on the same host machine
          as transaction coordinator. Enabled by default. Set to
          <code class="literal">0</code> or <code class="literal">OFF</code> to disable, in
          which case the SQL node uses each data node in the cluster in
          succession. When this option is disabled, or if there is no
          data node process running on the same host as the SQL node,
          the SQL node attempts to use a given data node 8 times before
          proceeding to the next one.
        </p><p>
          Begiunning with MySQL Cluster NDB 6.3.4, this option takes one
          of the integer values <code class="literal">0</code>,
          <code class="literal">1</code>, <code class="literal">2</code>, or
          <code class="literal">3</code>, with <code class="literal">1</code> being the
          default. These values affect node selection as follows:

          </p><div class="itemizedlist"><ul type="circle"><li><p>
                <code class="literal">0</code>: Each data node is employed as the
                transaction coordinator 8 times before the SQL node
                proceeds to the next data node. (This is the same
                behavior as caused by setting this option to
                <code class="literal">0</code> or <code class="literal">OFF</code> in
                previous MySQL versions.)
              </p></li><li><p>
                <code class="literal">1</code>: If a data node process is running
                on the the same host as the SQL node, this data node is
                used as the transaction coordinator. (This is the same
                behavior as caused by setting this option to
                <code class="literal">1</code> or <code class="literal">ON</code> in
                previous MySQL versions.)
              </p></li><li><p>
                <code class="literal">2</code>: The SQL node follows the same
                behavior as if this option had been set to
                <code class="literal">1</code>; however, the setting is global.
              </p></li><li><p>
                <code class="literal">3</code>: The data node housing the cluster
                partition accessed by the first statement of a given
                transaction is used as the transaction coordinator for
                the entire transaction. This is effective only if the
                first statement of the transaction accesses no more than
                one cluster partition; otherwise, the SQL node reverts
                to the round-robin behavior seen when this option is set
                to <code class="literal">0</code>.
              </p></li></ul></div><p>

          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              Beginning with MySQL Cluster NDB 6.3.4, it is no longer
              possible to set
              <code class="option">--ndb_optimized_node_selection</code> to
              <code class="literal">ON</code> or <code class="literal">OFF</code>;
              attempting to do so causes <span><strong class="command">mysqld</strong></span> to
              abort with an error.
            </p></div><p>
        </p></li><li><p><a name="option_mysqld_ndb_report_thresh_binlog_epoch_slip"></a>
          <code class="literal">ndb_report_thresh_binlog_epoch_slip</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td>numeric</td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">3</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td>0-256</td></tr></tbody></table></td></tr></tbody></table></div><p>
          This is a threshold on the number of epochs to be behind
          before reporting binlog status. For example, a value of
          <code class="literal">3</code> (the default) means that if the
          difference between which epoch has been received from the
          storage nodes and which epoch has been applied to the binlog
          is 3 or more, a status message will be sent to the cluster
          log.
        </p></li><li><p><a name="option_mysqld_ndb_report_thresh_binlog_mem_usage"></a>
          <code class="literal">ndb_report_thresh_binlog_mem_usage</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td>numeric</td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">10</code></td></tr><tr><td><span class="bold"><strong>Range</strong></span></td><td>0-10</td></tr></tbody></table></td></tr></tbody></table></div><p>
          This is a threshold on the percentage of free memory remaining
          before reporting binlog status. For example, a value of
          <code class="literal">10</code> (the default) means that if the amount
          of available memory for receiving binlog data from the data
          nodes falls below 10%, a status message will be sent to the
          cluster log.
        </p></li><li><p><a name="option_mysqld_ndb_use_copying_alter_table"></a>
          <code class="literal">ndb_use_copying_alter_table</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Version Introduced</strong></span></td><td>5.1.12</td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">ndb_use_copying_alter_table</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Both</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>No</td></tr></tbody></table></div><p>
          Forces <code class="literal">NDB</code> to use copying of tables in the
          event of problems with online <code class="literal">ALTER TABLE</code>
          operations. The default value is <code class="literal">OFF</code>.
        </p><p>
          This variable was added in MySQL 5.1.12.
        </p></li><li><p><a name="option_mysqld_ndb_use_exact_count"></a>
          <code class="literal">ndb_use_exact_count</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">ndb_use_exact_count</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td>Both</td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td> Yes</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td>boolean</td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">ON</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          Forces <code class="literal">NDB</code> to use a count of records during
          <code class="literal">SELECT COUNT(*)</code> query planning to speed up
          this type of query. The default value is
          <code class="literal">ON</code>. For faster queries overall, disable
          this feature by setting the value of
          <code class="literal">ndb_use_exact_count</code> to
          <code class="literal">OFF</code>.
        </p></li><li><p><a name="option_mysqld_ndb_use_transactions"></a>
          <code class="literal">ndb_use_transactions</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td>boolean</td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">ON</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          You can disable <code class="literal">NDB</code> transaction support by
          setting this variable's values to <code class="literal">OFF</code> (not
          recommended). The default is <code class="literal">ON</code>.
        </p></li><li><p><a name="option_mysqld_ndb_wait_connected"></a>
          <code class="literal">ndb_wait_connected</code>
        </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Version Introduced</strong></span></td><td>5.1.16-ndb-6.2.0</td></tr><tr><td><span class="bold"><strong>Option Sets Variable</strong></span></td><td> Yes, <code class="literal">ndb_wait_connected</code></td></tr><tr><td><span class="bold"><strong>Variable Name</strong></span></td><td><code class="literal">ndb_wait_connected</code></td></tr><tr><td><span class="bold"><strong>Variable Scope</strong></span></td><td> </td></tr><tr><td><span class="bold"><strong>Dynamic Variable</strong></span></td><td>No</td></tr><tr><td><span class="bold"><strong>Value Set </strong></span></td><td><table width="100%" border="0"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Type</strong></span></td><td>numeric</td></tr><tr><td><span class="bold"><strong>Default</strong></span></td><td><code class="literal">0</code></td></tr></tbody></table></td></tr></tbody></table></div><p>
          This variable can be used to cause the MySQL server to wait a
          given period of time for connections to MySQL Cluster
          management and data nodes to be established before accepting
          MySQL client connections. The time is specified in seconds.
          The default value is <code class="literal">0</code>.
        </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-status-variables"></a>20.4.4. MySQL Cluster Status Variables</h3></div></div></div><p>
      This section provides detailed information about MySQL server
      status variables that relate to MySQL Cluster and the
      <code class="literal">NDB</code> storage engine. For status variables not
      specific to MySQL Cluster, and for general information on using
      status variables, see <a href="server-administration.html#server-status-variables" title="5.1.6. Status Variables">Section 5.1.6, “Status Variables”</a>.
    </p><div class="itemizedlist"><ul type="disc"><li><p><a name="option_mysqld_Handler_discover"></a>
          <code class="literal">Handler_discover</code>
        </p><p>
          The MySQL server can ask the <code class="literal">NDBCLUSTER</code>
          storage engine if it knows about a table with a given name.
          This is called discovery. <code class="literal">Handler_discover</code>
          indicates the number of times that tables have been discovered
          via this mechanism.
        </p></li><li><p><a name="option_mysqld_Ndb_cluster_node_id"></a>
          <code class="literal">Ndb_cluster_node_id</code>
        </p><p>
          If the server is acting as a MySQL Cluster node, then the
          value of this variable its node ID in the cluster.
        </p><p>
          If the server is not part of a MySQL Cluster, then the value
          of this variable is 0.
        </p></li><li><p><a name="option_mysqld_Ndb_config_from_host"></a>
          <code class="literal">Ndb_config_from_host</code>
        </p><p>
          If the server is part of a MySQL Cluster, the value of this
          variable is the hostname or IP address of the Cluster
          management server from which it gets its configuration data.
        </p><p>
          If the server is not part of a MySQL Cluster, then the value
          of this variable is an empty string.
        </p><p>
          Prior to MySQL 5.1.12, this variable was named
          <code class="literal">Ndb_connected_host</code>.
        </p></li><li><p><a name="option_mysqld_Ndb_config_from_port"></a>
          <code class="literal">Ndb_config_from_port</code>
        </p><p>
          If the server is part of a MySQL Cluster, the value of this
          variable is the number of the port through which it is
          connected to the Cluster management server from which it gets
          its configuration data.
        </p><p>
          If the server is not part of a MySQL Cluster, then the value
          of this variable is 0.
        </p><p>
          Prior to MySQL 5.1.12, this variable was named
          <code class="literal">Ndb_connected_port</code>.
        </p></li><li><p><a name="option_mysqld_Ndb_execute_count"></a>
          <code class="literal">Ndb_execute_count</code>
        </p><p>
          Provides the number of round trips to the
          <code class="literal">NDB</code> kernel made by operations. Added in
          MySQL Cluster NDB 6.3.6.
        </p></li><li><p><a name="option_mysqld_Ndb_number_of_data_nodes"></a>
          <code class="literal">Ndb_number_of_data_nodes</code>
        </p><p>
          If the server is part of a MySQL Cluster, the value of this
          variable is the number of data nodes in the cluster.
        </p><p>
          If the server is not part of a MySQL Cluster, then the value
          of this variable is 0.
        </p><p>
          Prior to MySQL 5.1.12, this variable was named
          <code class="literal">Ndb_number_of_storage_nodes</code>.
        </p></li><li><p><a name="option_mysqld_Slave_heartbeat_period"></a>
          <code class="literal">Slave_heartbeat_period</code>
        </p><p>
          Shows the replication heartbeat interval (in seconds) on a
          replication slave.
        </p><p>
          This variable was added in MySQL Cluster NDB 6.3.4.
        </p></li><li><p><a name="option_mysqld_Slave_received_heartbeats"></a>
          <code class="literal">Slave_received_heartbeats</code>
        </p><p>
          This counter increments with each replication heartbeat
          received by a replication slave since the last time that the
          slave was restarted or reset, or a <code class="literal">CHANGE
          MASTER</code> statement was issued.
        </p><p>
          This variable was added in MySQL Cluster NDB 6.3.4.
        </p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-upgrade-downgrade"></a>20.5. Upgrading and Downgrading MySQL Cluster</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-rolling-restart">20.5.1. Performing a Rolling Restart of the Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-upgrade-downgrade-compatibility">20.5.2. MySQL Cluster 5.1 and MySQL Cluster NDB 6.x Upgrade and Downgrade
      Compatibility</a></span></dt></dl></div><a class="indexterm" name="id2344272"></a><a class="indexterm" name="id2344284"></a><a class="indexterm" name="id2344297"></a><p>
    This portion of the MySQL Cluster chapter covers upgrading and
    downgrading a MySQL Cluster from one MySQL release to another. It
    discusses different types of Cluster upgrades and downgrades, and
    provides a Cluster upgrade/downgrade compatibility matrix (see
    <a href="mysql-cluster.html#mysql-cluster-upgrade-downgrade-compatibility" title="20.5.2. MySQL Cluster 5.1 and MySQL Cluster NDB 6.x Upgrade and Downgrade
      Compatibility">Section 20.5.2, “MySQL Cluster 5.1 and MySQL Cluster NDB 6.x Upgrade and Downgrade
      Compatibility”</a>).
    You are expected already to be familiar with installing and
    configuring a MySQL Cluster prior to attempting an upgrade or
    downgrade. See <a href="mysql-cluster.html#mysql-cluster-configuration" title="20.3. MySQL Cluster Configuration">Section 20.3, “MySQL Cluster Configuration”</a>.
  </p><p>
    For information about upgrading or downgrading between MySQL Cluster
    NDB releases, or between MySQL Cluster NDB releases and mainline
    MySQL releases, see the changelogs relating to MySQL Cluster NDB.
  </p><p>
    This section remains in development, and continues to be updated and
    expanded.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-rolling-restart"></a>20.5.1. Performing a Rolling Restart of the Cluster</h3></div></div></div><a class="indexterm" name="id2344343"></a><a class="indexterm" name="id2344356"></a><a class="indexterm" name="id2344365"></a><a class="indexterm" name="id2344377"></a><a class="indexterm" name="id2344390"></a><p>
      This section discusses how to perform a <em class="firstterm">rolling
      restart</em> of a MySQL Cluster installation, so called
      because it involves stopping and starting (or restarting) each
      node in turn, so that the cluster itself remains operational. This
      is often done as part of a <em class="firstterm">rolling upgrade</em>
      or <em class="firstterm">rolling downgrade</em>, where high
      availability of the cluster is mandatory and no downtime of the
      cluster as a whole is permissible. Where we refer to upgrades, the
      information provided here also generally applies to downgrades as
      well.
    </p><p>
      There are a number of reasons why a rolling restart might be
      desirable:
    </p><div class="itemizedlist"><ul type="disc"><li><p><b>Cluster configuration change. </b><a class="indexterm" name="id2344440"></a>
            To make a change in the cluster's configuration, such as
            adding an SQL node to the cluster, or setting a
            configuration parameter to a new value.
          </p></li><li><p><b>Cluster software upgrade/downgrade. </b>
            To upgrade the cluster to a newer version of the MySQL
            Cluster software (or to downgrade it to an older version).
            This is usually referred to as a “<span class="quote">rolling
            upgrade</span>” (or “<span class="quote">rolling downgrade</span>”, when
            reverting to an older version of MySQL Cluster).
          </p></li><li><p><b>Change on node host. </b>
            To make changes in the hardware or operating system on which
            one or more cluster nodes are running
          </p></li><li><p><b>Cluster reset. </b><a class="indexterm" name="id2344504"></a>
            To reset the cluster because it has reached an undesirable
            state
          </p></li><li><p><b>Freeing of resources. </b><a class="indexterm" name="id2344531"></a>
            To allow memory allocated to a table by successive
            <code class="literal">INSERT</code> and <code class="literal">DELETE</code>
            operations to be freed for re-use by other Cluster tables
          </p></li></ul></div><p>
      The process for performing a rolling restart may be generalised as
      follows:
    </p><div class="orderedlist"><ol type="1"><li><p>
          Stop all cluster management nodes (<span><strong class="command">ndb_mgmd</strong></span>
          processes), reconfigure them, then restart them
        </p></li><li><p>
          Stop, reconfigure, then restart each cluster data node
          (<span><strong class="command">ndbd</strong></span> process) in turn
        </p></li><li><p>
          Stop, reconfigure, then restart each cluster SQL node
          (<span><strong class="command">mysqld</strong></span> process) in turn
        </p></li></ol></div><p>
      The specifics for implementing a particular rolling upgrade depend
      upon the actual changes being made. A more detailed view of the
      process is presented here:
    </p><div class="mediaobject"><img src="images/rolling-restarts.png" alt="MySQL Cluster Rolling Restarts (By
        Type)"></div><p>
      In the previous diagram, <span class="bold"><strong>Stop</strong></span> and
      <span class="bold"><strong>Start</strong></span> steps indicate that the
      process must be stopped completely using a shell command (such as
      <span><strong class="command">kill</strong></span> on most Unix systems) or the management
      client <code class="literal">STOP</code> command, then started again from a
      system shell by invoking the <span><strong class="command">ndbd</strong></span> or
      <span><strong class="command">ndb_mgmd</strong></span> executable as appropriate.
      <span class="bold"><strong>Restart</strong></span> indicates the process may
      be restarted using the <span><strong class="command">ndb_mgm</strong></span> management
      client <code class="literal">RESTART</code> command.
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        When performing an upgrade or downgrade of the cluster software,
        you <span class="emphasis"><em>must</em></span> upgrade or downgrade the
        management nodes <span class="emphasis"><em>first</em></span>, then the data
        nodes, and finally the SQL nodes. Doing so in any other order
        may leave the cluster in an unusable state.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-upgrade-downgrade-compatibility"></a>20.5.2. MySQL Cluster 5.1 and MySQL Cluster NDB 6.x Upgrade and Downgrade
      Compatibility</h3></div></div></div><a class="indexterm" name="id2344727"></a><a class="indexterm" name="id2344739"></a><a class="indexterm" name="id2344752"></a><a class="indexterm" name="id2344764"></a><p>
      This section provides information about MySQL Cluster software and
      table file compatibility between MySQL 5.1 and MySQL
      Cluster NDB 6.x releases with regard to performing upgrades and
      downgrades.
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        Only compatibility between MySQL versions with regard to
        <code class="literal">NDBCLUSTER</code> is taken into account in this
        section, and there are likely other issues to be considered.
        <span class="emphasis"><em>As with any other MySQL software upgrade or downgrade,
        you are strongly encouraged to review the relevant portions of
        the MySQL Manual for the MySQL versions from which and to which
        you intend to migrate, before attempting an upgrade or downgrade
        of the MySQL Cluster software</em></span>. See
        <a href="installing.html#upgrade" title="2.11. Upgrading MySQL">Section 2.11, “Upgrading MySQL”</a>.
      </p></div><p>
      The following table shows Cluster upgrade and downgrade
      compatibility between different releases of MySQL
      5.1:
    </p><div class="mediaobject"><img src="images/mysql-cluster-upgrade-downgrade-5-1.png" alt="MySQL Cluster upgrade/downgrade compatibility,
        MySQL 5.1"></div><p><b>Notes — MySQL 5.1. </b>
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              MySQL 5.1.3 was the first public release in this series.
            </p></li><li><p>
              Direct upgrades or downgrades between MySQL Cluster 5.0
              and 5.1 are not supported; you must dump all
              <code class="literal">NDBCLUSTER</code> tables using
              <span><strong class="command">mysqldump</strong></span>, install the new version of
              the software, and then reload the tables from the dump.
            </p></li><li><p>
              You cannot downgrade a MySQL 5.1.6 or later Cluster using
              Disk Data tables to MySQL 5.1.5 or earlier unless you
              convert all such tables to in-memory Cluster tables first.
            </p></li><li><p>
              MySQL 5.1.8, MySQL 5.1.10, and MySQL 5.1.13 were not
              released.
            </p></li><li><p>
              Online cluster upgrades and downgrades between MySQL
              5.1.11 (or an earlier version) and 5.1.12 (or a later
              version) are not possible due to major changes in the
              cluster filesystem. In such cases, you must perform a
              backup or dump, upgrade (or downgrade) the software, start
              each data node with <code class="option">--initial</code>, and then
              restore from the backup or dump. You can use
              <code class="literal">NDB</code> backup/restore or
              <span><strong class="command">mysqldump</strong></span> for this purpose.
            </p></li><li><p>
              Online downgrades from MySQL 5.1.14 or later to versions
              previous to 5.1.14 are not supported due to incompatible
              changes in the cluster system tables.
            </p></li><li><p>
              Online upgrades from MySQL 5.1.17 and earlier to 5.1.18
              and later are not supported for clusters using replication
              due to incompatible changes in the
              <code class="literal">mysql.ndb_apply_status</code> table. However,
              it should not be necessary to shut down the cluster
              entirely, if you follow this modified rolling restart
              procedure:

              </p><div class="orderedlist"><ol type="1"><li><p>
                    Stop the management server, update the
                    <code class="literal">ndb_mgmd</code> binary, then start it
                    again. For multiple management servers, repeat this
                    step for each management server in turn.
                  </p></li><li><p>
                    For each data node in turn: Stop the data node,
                    replace the <code class="literal">ndbd</code> binary with the
                    new version, then restart the data node. It is not
                    necessary to use <code class="literal">--initial</code> when
                    restarting any of the data nodes.
                  </p></li><li><p>
                    Stop <span class="emphasis"><em>all</em></span> SQL nodes. Replace the
                    <span><strong class="command">mysqld</strong></span> binary with the new
                    version for all SQL nodes, then restart them. It is
                    not necessary to start them one at a time, but they
                    must all be shut down at the same time before
                    starting any of them again using the 5.1.18 (or
                    later) <span><strong class="command">mysqld</strong></span>. Otherwise —
                    due to the fact that
                    <code class="literal">mysql.ndb_apply_status</code> uses the
                    <code class="literal">NDB</code> storage engine and is thus
                    shared between all SQL nodes — there may be
                    conflicts between MySQL servers using the old and
                    new versions of the table.
                  </p></li></ol></div><p>

              You can find more information about the changes to
              <code class="literal">ndb_apply_status</code> in
              <a href="mysql-cluster.html#mysql-cluster-replication-schema" title="20.11.4. Cluster Replication Schema and Tables">Section 20.11.4, “Cluster Replication Schema and Tables”</a>.
            </p></li><li><p><a name="mysql-cluster-upgrade-downgrade-compatibility-online-add-drop-column"></a>
              The internal specifications for columns in
              <code class="literal">NDB</code> tables changed in MySQL 5.1.18 to
              allow compatibility with future MySQL Cluster releases
              that are expected to implement online adding and dropping
              of columns. This change is not backwards compatible with
              earlier MySQL versions.
            </p><p>
              In order to make tables created in MySQL 5.1.17 and
              earlier compatible with online adding and dropping of
              columns when this features becomes available, it is
              necessary force MySQL 5.1.18 and later to convert the
              tables to the new format by following this procedure:

              </p><div class="orderedlist"><ol type="1"><li><p>
                    Upgrade the MySQL Cluster software on all data,
                    management, and SQL nodes
                  </p></li><li><p>
                    Back up all <code class="literal">NDB</code> tables
                  </p></li><li><p>
                    Shut down the cluster (all data, management, and SQL
                    nodes)
                  </p></li><li><p>
                    Restart the cluster, starting all data nodes with
                    the <code class="option">--initial</code> option (to clear and
                    rebuild the data node filesystems)
                  </p></li><li><p>
                    Restore the tables from backup
                  </p></li></ol></div><p>
            </p><p>
              This is not necessary for <code class="literal">NDB</code> tables
              created in MySQL 5.1.18 and later; such tables will
              automatically be compatible with online adding and
              dropping of columns (as implemented beginning with MySQL
              Cluster NDB 6.2.5 and MySQL Cluster NDB 6.3.2).
            </p><p>
              In order to minimise possible later difficulties, it is
              strongly advised that the procedure outlined above be
              followed as soon as possible after to upgrading from MySQL
              5.1.17 or earlier to MySQL 5.1.18 or later.
            </p><p>
              Information about how this change effects users of MySQL
              Cluster NDB 6.x is provided later in this section.
            </p></li><li><p>
              MySQL Cluster is not supported in standard MySQL 5.1
              releases, beginning with MySQL 5.1.25. If you are using
              MySQL Cluster in a standard MySQL 5.1 release, you should
              upgrade to the most recent MySQL Cluster NDB 6.2 or 6.3
              release.
            </p></li></ul></div><p>
      </p><p>
      The following table shows Cluster upgrade and downgrade
      compatibility between different releases of MySQL Cluster NDB 6.x:
    </p><div class="mediaobject"><img src="images/mysql-cluster-upgrade-downgrade-6-x.png" alt="MySQL Cluster upgrade/downgrade compatibility,
        MySQL Cluster NDB 6.x"></div><p><b>Notes — MySQL Cluster NDB 6.x. </b>
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              MySQL Cluster NDB 6.1 is no longer in production; if you
              are still using a MySQL Cluster NDB 6.1 release, you
              should upgrade to the most recent MySQL Cluster NDB 6.2 or
              6.3 as soon as possible.
            </p></li><li><p>
              It is not possible to upgrade from MySQL Cluster NDB 6.1.2
              (or an older 6.1 release) directly to 6.1.4 or a newer NDB
              6.1 release, or to downgrade from 6.1.4 (or a newer 6.1
              release) directly to 6.1.2 or an older NDB 6.1 release; in
              either case, you must upgrade or downgrade to MySQL
              Cluster NDB 6.1.3 first.
            </p></li><li><p>
              It is not possible to perform an online downgrade from
              MySQL Cluster NDB 6.1.8 (or a newer 6.1 release) to MySQL
              Cluster NDB 6.1.7 (or an older 6.1 release).
            </p></li><li><p>
              MySQL Cluster NDB 6.1.6 and 6.1.18 were not released.
            </p></li><li><p>
              It is not possible to perform an online upgrade or
              downgrade between MySQL Cluster NDB 6.2 and any previous
              release series (including mainline MySQL 5.1 and MySQL
              Cluster NDB 6.1); it is necessary to perform a dump and
              reload. However, it should be possible to perform online
              upgrades or downgrades between any MySQL Cluster NDB 6.2
              release and any MySQL Cluster NDB 6.3 release up to and
              including 6.3.7.
            </p></li><li><p><a name="mysql-cluster-upgrade-downgrade-compatibility-online-add-drop-column-6-x"></a>
              The internal specifications for columns in
              <code class="literal">NDB</code> tables changed in MySQL Cluster NDB
              6.1.17 and 6.2.1 to allow compatibility with future MySQL
              Cluster releases that are expected to implement online
              adding and dropping of columns. This change is not
              backwards compatible with earlier MySQL or MySQL Cluster
              NDB 6.x versions.
            </p><p>
              In order to make tables created in earlier versions
              compatible with online adding and dropping of columns in
              later versions, it is necessary to force MySQL Cluster to
              convert the tables to the new format by following this
              procedure following an upgrade:

              </p><div class="orderedlist"><ol type="1"><li><p>
                    Upgrade the MySQL Cluster software on all data,
                    management, and SQL nodes
                  </p></li><li><p>
                    Back up all <code class="literal">NDB</code> tables
                  </p></li><li><p>
                    Shut down the cluster (all data, management, and SQL
                    nodes)
                  </p></li><li><p>
                    Restart the cluster, starting all data nodes with
                    the <code class="option">--initial</code> option (to clear and
                    rebuild the data node filesystems)
                  </p></li><li><p>
                    Restore the tables from backup
                  </p></li></ol></div><p>
            </p><p>
              In order to minimise possible later difficulties, it is
              strongly advised that the procedure outlined above be
              followed as soon as possible after to upgrading between
              the versions indicated. The procedure is
              <span class="emphasis"><em>not</em></span> necessary for
              <code class="literal">NDBCLUSTER</code> tables created in any of the
              following versions:

              </p><div class="itemizedlist"><ul type="circle"><li><p>
                    MySQL Cluster NDB 6.1.8 or a later MySQL Cluster NDB
                    6.1 release
                  </p></li><li><p>
                    MySQL Cluster 6.2.1 or a later MySQL Cluster NDB 6.2
                    release
                  </p></li><li><p>
                    Any MySQL Cluster NDB 6.3 release
                  </p></li></ul></div><p>

              Tables created in the listed versions (or later ones, as
              indicated) are already compatible with online adding and
              dropping of columns (as implemented beginning with MySQL
              Cluster NDB 6.2.5 and MySQL Cluster NDB 6.3.2).
            </p></li><li><p>
              Online downgrades between MySQL Cluster NDB 6.3.8 and
              earlier releases are not supported.
            </p></li></ul></div><p>
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-process-management"></a>20.6. Process Management in MySQL Cluster</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-mysqld-process">20.6.1. MySQL Server Process Usage for MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-ndbd-process">20.6.2. <span><strong class="command">ndbd</strong></span> — The Storage Engine Node Process</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-ndb-mgmd-process">20.6.3. <span><strong class="command">ndb_mgmd</strong></span> — The Management Server Process</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-ndb-mgm-process">20.6.4. <span><strong class="command">ndb_mgm</strong></span> — The Management Client Process</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-command-options">20.6.5. Command Options for MySQL Cluster Processes</a></span></dt></dl></div><a class="indexterm" name="id2345387"></a><a class="indexterm" name="id2345399"></a><a class="indexterm" name="id2345408"></a><a class="indexterm" name="id2345417"></a><p>
    Understanding how to manage MySQL Cluster requires a knowledge of
    four essential processes. In the next few sections of this chapter,
    we cover the roles played by these processes in a cluster, how to
    use them, and what startup options are available for each of them:
  </p><div class="itemizedlist"><ul type="disc"><li><p>
        <a href="mysql-cluster.html#mysql-cluster-mysqld-process" title="20.6.1. MySQL Server Process Usage for MySQL Cluster">Section 20.6.1, “MySQL Server Process Usage for MySQL Cluster”</a>
      </p></li><li><p>
        <a href="mysql-cluster.html#mysql-cluster-ndbd-process" title="20.6.2. ndbd — The Storage Engine Node Process">Section 20.6.2, “<span><strong class="command">ndbd</strong></span> — The Storage Engine Node Process”</a>
      </p></li><li><p>
        <a href="mysql-cluster.html#mysql-cluster-ndb-mgmd-process" title="20.6.3. ndb_mgmd — The Management Server Process">Section 20.6.3, “<span><strong class="command">ndb_mgmd</strong></span> — The Management Server Process”</a>
      </p></li><li><p>
        <a href="mysql-cluster.html#mysql-cluster-ndb-mgm-process" title="20.6.4. ndb_mgm — The Management Client Process">Section 20.6.4, “<span><strong class="command">ndb_mgm</strong></span> — The Management Client Process”</a>
      </p></li></ul></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-mysqld-process"></a>20.6.1. MySQL Server Process Usage for MySQL Cluster</h3></div></div></div><a class="indexterm" name="id2345487"></a><a class="indexterm" name="id2345500"></a><a class="indexterm" name="id2345512"></a><a class="indexterm" name="id2345525"></a><a class="indexterm" name="id2345534"></a><p>
      <span><strong class="command">mysqld</strong></span> is the traditional MySQL server process.
      To be used with MySQL Cluster, <span><strong class="command">mysqld</strong></span> needs to
      be built with support for the <code class="literal">NDBCLUSTER</code>
      storage engine, as it is in the precompiled binaries available
      from <a href="http://dev.mysql.com/downloads/" target="_top">http://dev.mysql.com/downloads/</a>. If you build MySQL from
      source, you must invoke <span><strong class="command">configure</strong></span> with the
      <code class="option">--with-ndbcluster</code> option to enable <code class="literal">NDB
      Cluster</code> storage engine support.
    </p><p>
      If the <span><strong class="command">mysqld</strong></span> binary has been built with
      Cluster support, the <code class="literal">NDBCLUSTER</code> storage engine
      is still disabled by default. You can use either of two possible
      options to enable this engine:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          Use <code class="option">--ndbcluster</code> as a startup option on the
          command line when starting <span><strong class="command">mysqld</strong></span>.
        </p></li><li><p>
          Insert a line containing <code class="literal">ndbcluster</code> in the
          <code class="literal">[mysqld]</code> section of your
          <code class="filename">my.cnf</code> file.
        </p></li></ul></div><p>
      An easy way to verify that your server is running with the
      <code class="literal">NDBCLUSTER</code> storage engine enabled is to issue
      the <code class="literal">SHOW ENGINES</code> statement in the MySQL Monitor
      (<span><strong class="command">mysql</strong></span>). You should see the value
      <code class="literal">YES</code> as the <code class="literal">Support</code> value in
      the row for <code class="literal">NDBCLUSTER</code>. If you see
      <code class="literal">NO</code> in this row or if there is no such row
      displayed in the output, you are not running an
      <code class="literal">NDB</code>-enabled version of MySQL. If you see
      <code class="literal">DISABLED</code> in this row, you need to enable it in
      either one of the two ways just described.
    </p><a class="indexterm" name="id2345711"></a><a class="indexterm" name="id2345723"></a><a class="indexterm" name="id2345732"></a><p>
      To read cluster configuration data, the MySQL server requires at a
      minimum three pieces of information:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          The MySQL server's own cluster node ID
        </p></li><li><p>
          The hostname or IP address for the management server (MGM
          node)
        </p></li><li><p>
          The number of the TCP/IP port on which it can connect to the
          management server
        </p></li></ul></div><p>
      Node IDs can be allocated dynamically, so it is not strictly
      necessary to specify them explicitly.
    </p><p>
      The <span><strong class="command">mysqld</strong></span> parameter
      <code class="literal">ndb-connectstring</code> is used to specify the
      connectstring either on the command line when starting
      <span><strong class="command">mysqld</strong></span> or in <code class="filename">my.cnf</code>. The
      connectstring contains the hostname or IP address where the
      management server can be found, as well as the TCP/IP port it
      uses.
    </p><p>
      In the following example, <code class="literal">ndb_mgmd.mysql.com</code> is
      the host where the management server resides, and the management
      server listens for cluster messages on port 1186:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>mysqld --ndbcluster --ndb-connectstring=ndb_mgmd.mysql.com:1186</code></strong>
</pre><p>
      See <a href="mysql-cluster.html#mysql-cluster-connectstring" title="20.3.4.2. The Cluster Connectstring">Section 20.3.4.2, “The Cluster Connectstring”</a>, for more
      information on connectstrings.
    </p><p>
      Given this information, the MySQL server will be a full
      participant in the cluster. (We often refer to a
      <span><strong class="command">mysqld</strong></span> process running in this manner as an SQL
      node.) It will be fully aware of all cluster data nodes as well as
      their status, and will establish connections to all data nodes. In
      this case, it is able to use any data node as a transaction
      coordinator and to read and update node data.
    </p><p>
      You can see in the <span><strong class="command">mysql</strong></span> client whether a MySQL
      server is connected to the cluster using <code class="literal">SHOW
      PROCESSLIST</code>. If the MySQL server is connected to the
      cluster, and you have the <code class="literal">PROCESS</code> privilege,
      then the first row of the output is as shown here:
    </p><pre class="programlisting">mysql&gt; SHOW PROCESSLIST \G
*************************** 1. row ***************************
     Id: 1
   User: system user
   Host:
     db:
Command: Daemon
   Time: 1
  State: Waiting for event from ndbcluster
   Info: NULL
</pre><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        To participate in a MySQL Cluster, the <span><strong class="command">mysqld</strong></span>
        process must be started with <span class="emphasis"><em>both</em></span> the
        options <code class="option">--ndbcluster</code> and
        <code class="option">--ndb-connectstring</code> (or their equivalents in
        <code class="filename">my.cnf</code>). If <span><strong class="command">mysqld</strong></span> is
        started with only the <code class="option">--ndbcluster</code> option, or
        if it is unable to contact the cluster, it is not possible to
        work with <code class="literal">NDB</code> tables, <span class="emphasis"><em>nor is it
        possible to create any new tables regardless of storage
        engine</em></span>. The latter restriction is a safety measure
        intended to prevent the creation of tables having the same names
        as <code class="literal">NDB</code> tables while the SQL node is not
        connected to the cluster. If you wish to create tables using a
        different storage engine while the <span><strong class="command">mysqld</strong></span>
        process is not participating in a MySQL Cluster, you must
        restart the server <span class="emphasis"><em>without</em></span> the
        <code class="option">--ndbcluster</code> option.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-ndbd-process"></a>20.6.2. <span><strong class="command">ndbd</strong></span> — The Storage Engine Node Process</h3></div></div></div><p>
          <span><strong class="command">ndbd</strong></span> is the process that is used to handle
          all the data in tables using the NDB Cluster storage engine.
          This is the process that empowers a data node to accomplish
          distributed transaction handling, node recovery, checkpointing
          to disk, online backup, and related tasks.
        </p><p>
          In a MySQL Cluster, a set of <span><strong class="command">ndbd</strong></span> processes
          cooperate in handling data. These processes can execute on the
          same computer (host) or on different computers. The
          correspondences between data nodes and Cluster hosts is
          completely configurable.
        </p><a class="indexterm" name="id2346000"></a><a class="indexterm" name="id2346012"></a><p>
          <span><strong class="command">ndbd</strong></span> generates a set of log files which are
          placed in the directory specified by
          <code class="literal">DataDir</code> in the
          <code class="filename">config.ini</code> configuration file.
        </p><p>
          These log files are listed below.
          <em class="replaceable"><code>node_id</code></em> is the node's unique
          identifier. Note that <em class="replaceable"><code>node_id</code></em>
          represents the node's unique identifier. For example,
          <code class="filename">ndb_2_error.log</code> is the error log
          generated by the data node whose node ID is
          <code class="literal">2</code>.
        </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2346072"></a><a class="indexterm" name="id2346084"></a><p>
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_error.log</code>
              is a file containing records of all crashes which the
              referenced <span><strong class="command">ndbd</strong></span> process has
              encountered. Each record in this file contains a brief
              error string and a reference to a trace file for this
              crash. A typical entry in this file might appear as shown
              here:
            </p><pre class="programlisting">Date/Time: Saturday 30 July 2004 - 00:20:01
Type of error: error
Message: Internal program error (failed ndbrequire)
Fault ID: 2341
Problem data: DbtupFixAlloc.cpp
Object of reference: DBTUP (Line: 173)
ProgramName: NDB Kernel
ProcessID: 14909
TraceFile: ndb_2_trace.log.2
***EOM***
</pre><p>
              Listings of possible <span><strong class="command">ndbd</strong></span> exit codes
              and messages generated when a data node process shuts down
              prematurely can be found in
              <a href="http://dev.mysql.com/doc/ndbapi/en/ndbd-error-messages.html" target="_top"><code class="literal">ndbd</code> Error Messages</a>.
            </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
                <span class="emphasis"><em>The last entry in the error log file is not
                necessarily the newest one</em></span> (nor is it likely
                to be). Entries in the error log are
                <span class="emphasis"><em>not</em></span> listed in chronological order;
                rather, they correspond to the order of the trace files
                as determined in the
                <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_trace.log.next</code>
                file (see below). Error log entries are thus overwritten
                in a cyclical and not sequential fashion.
              </p></div></li><li><a class="indexterm" name="id2346172"></a><a class="indexterm" name="id2346185"></a><p>
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_trace.log.<em class="replaceable"><code>trace_id</code></em></code>
              is a trace file describing exactly what happened just
              before the error occurred. This information is useful for
              analysis by the MySQL Cluster development team.
            </p><p>
              It is possible to configure the number of these trace
              files that will be created before old files are
              overwritten. <em class="replaceable"><code>trace_id</code></em> is a
              number which is incremented for each successive trace
              file.
            </p></li><li><p>
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_trace.log.next</code>
              is the file that keeps track of the next trace file number
              to be assigned.
            </p></li><li><p>
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_out.log</code>
              is a file containing any data output by the
              <span><strong class="command">ndbd</strong></span> process. This file is created only
              if <span><strong class="command">ndbd</strong></span> is started as a daemon, which
              is the default behavior.
            </p></li><li><p>
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>.pid</code>
              is a file containing the process ID of the
              <span><strong class="command">ndbd</strong></span> process when started as a daemon.
              It also functions as a lock file to avoid the starting of
              nodes with the same identifier.
            </p></li><li><p>
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_signal.log</code>
              is a file used only in debug versions of
              <span><strong class="command">ndbd</strong></span>, where it is possible to trace all
              incoming, outgoing, and internal messages with their data
              in the <span><strong class="command">ndbd</strong></span> process.
            </p></li></ul></div><p>
          It is recommended not to use a directory mounted through NFS
          because in some environments this can cause problems whereby
          the lock on the <code class="filename">.pid</code> file remains in
          effect even after the process has terminated.
        </p><p>
          To start <span><strong class="command">ndbd</strong></span>, it may also be necessary to
          specify the hostname of the management server and the port on
          which it is listening. Optionally, one may also specify the
          node ID that the process is to use.
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndbd --connect-string="nodeid=2;host=ndb_mgmd.mysql.com:1186"</code></strong>
</pre><p>
          See <a href="mysql-cluster.html#mysql-cluster-connectstring" title="20.3.4.2. The Cluster Connectstring">Section 20.3.4.2, “The Cluster Connectstring”</a>, for
          additional information about this issue.
          <a href="mysql-cluster.html#mysql-cluster-command-options" title="20.6.5. Command Options for MySQL Cluster Processes">Section 20.6.5, “Command Options for MySQL Cluster Processes”</a>, describes
          other options for <span><strong class="command">ndbd</strong></span>.
        </p><p>
          When <span><strong class="command">ndbd</strong></span> starts, it actually initiates two
          processes. The first of these is called the “<span class="quote">angel
          process</span>”; its only job is to discover when the
          execution process has been completed, and then to restart the
          <span><strong class="command">ndbd</strong></span> process if it is configured to do so.
          Thus, if you attempt to kill <span><strong class="command">ndbd</strong></span> via the
          Unix <span><strong class="command">kill</strong></span> command, it is necessary to kill
          both processes, beginning with the angel process. The
          preferred method of terminating an <span><strong class="command">ndbd</strong></span>
          process is to use the management client and stop the process
          from there.
        </p><p>
          The execution process uses one thread for reading, writing,
          and scanning data, as well as all other activities. This
          thread is implemented asynchronously so that it can easily
          handle thousands of concurrent activites. In addition, a
          watch-dog thread supervises the execution thread to make sure
          that it does not hang in an endless loop. A pool of threads
          handles file I/O, with each thread able to handle one open
          file. Threads can also be used for transporter connections by
          the transporters in the <span><strong class="command">ndbd</strong></span> process. In a
          multi-processor system performing a large number of operations
          (including updates), the <span><strong class="command">ndbd</strong></span> process can
          consume up to 2 CPUs if permitted to do so.
        </p><p>
          For a machine with many CPUs it is possible to use several
          <span><strong class="command">ndbd</strong></span> processes which belong to different
          node groups; however, such a configuration is still considered
          experimental and is not supported for MySQL 5.1
          in a production setting. See
          <a href="mysql-cluster.html#mysql-cluster-limitations" title="20.14. Known Limitations of MySQL Cluster">Section 20.14, “Known Limitations of MySQL Cluster”</a>.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-ndb-mgmd-process"></a>20.6.3. <span><strong class="command">ndb_mgmd</strong></span> — The Management Server Process</h3></div></div></div><p>
          The management server is the process that reads the cluster
          configuration file and distributes this information to all
          nodes in the cluster that request it. It also maintains a log
          of cluster activities. Management clients can connect to the
          management server and check the cluster's status.
        </p><p>
          It is not strictly necessary to specify a connectstring when
          starting the management server. However, if you are using more
          than one management server, a connectstring should be provided
          and each node in the cluster should specify its node ID
          explicitly.
        </p><p>
          See <a href="mysql-cluster.html#mysql-cluster-connectstring" title="20.3.4.2. The Cluster Connectstring">Section 20.3.4.2, “The Cluster Connectstring”</a>, for
          information about using connectstrings.
          <a href="mysql-cluster.html#mysql-cluster-command-options" title="20.6.5. Command Options for MySQL Cluster Processes">Section 20.6.5, “Command Options for MySQL Cluster Processes”</a>, describes
          other options for <span><strong class="command">ndb_mgmd</strong></span>.
        </p><p>
          The following files are created or used by
          <span><strong class="command">ndb_mgmd</strong></span> in its starting directory, and are
          placed in the <code class="literal">DataDir</code> as specified in the
          <code class="filename">config.ini</code> configuration file. In the
          list that follows, <em class="replaceable"><code>node_id</code></em> is the
          unique node identifier.
        </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2346536"></a><a class="indexterm" name="id2346548"></a><a class="indexterm" name="id2346558"></a><p>
              <code class="filename">config.ini</code> is the configuration file
              for the cluster as a whole. This file is created by the
              user and read by the management server.
              <a href="mysql-cluster.html#mysql-cluster-configuration" title="20.3. MySQL Cluster Configuration">Section 20.3, “MySQL Cluster Configuration”</a>, discusses
              how to set up this file.
            </p></li><li><p>
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_cluster.log</code>
              is the cluster events log file. Examples of such events
              include checkpoint startup and completion, node startup
              events, node failures, and levels of memory usage. A
              complete listing of cluster events with descriptions may
              be found in <a href="mysql-cluster.html#mysql-cluster-management" title="20.7. Management of MySQL Cluster">Section 20.7, “Management of MySQL Cluster”</a>.
            </p><p>
              When the size of the cluster log reaches one million
              bytes, the file is renamed to
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_cluster.log.<em class="replaceable"><code>seq_id</code></em></code>,
              where <em class="replaceable"><code>seq_id</code></em> is the sequence
              number of the cluster log file. (For example: If files
              with the sequence numbers 1, 2, and 3 already exist, the
              next log file is named using the number
              <code class="literal">4</code>.)
            </p></li><li><p>
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_out.log</code>
              is the file used for <code class="literal">stdout</code> and
              <code class="literal">stderr</code> when running the management
              server as a daemon.
            </p></li><li><p>
              <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>.pid</code>
              is the process ID file used when running the management
              server as a daemon.
            </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-ndb-mgm-process"></a>20.6.4. <span><strong class="command">ndb_mgm</strong></span> — The Management Client Process</h3></div></div></div><p>
          The <span><strong class="command">ndb_mgm</strong></span> management client process is
          actually not needed to run the cluster. Its value lies in
          providing a set of commands for checking the cluster's status,
          starting backups, and performing other administrative
          functions. The management client accesses the management
          server using a C API. Advanced users can also employ this API
          for programming dedicated management processes to perform
          tasks similar to those performed by
          <span><strong class="command">ndb_mgm</strong></span>.
        </p><p>
          To start the management client, it is necessary to supply the
          hostname and port number of the management server:
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgm [<em class="replaceable"><code>host_name</code></em> [<em class="replaceable"><code>port_num</code></em>]]</code></strong>
</pre><p>
          For example:
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgm ndb_mgmd.mysql.com 1186</code></strong>
</pre><p>
          The default hostname and port number are
          <code class="literal">localhost</code> and 1186, respectively.
        </p><p>
          Additional information about using <span><strong class="command">ndb_mgm</strong></span>
          can be found in
          <a href="mysql-cluster.html#mysql-cluster-ndb-mgm-command-options" title="20.6.5.3. Command Options for ndb_mgm">Section 20.6.5.3, “Command Options for <span><strong class="command">ndb_mgm</strong></span>”</a>, and
          <a href="mysql-cluster.html#mysql-cluster-mgm-client-commands" title="20.7.2. Commands in the MySQL Cluster Management Client">Section 20.7.2, “Commands in the MySQL Cluster Management Client”</a>.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-command-options"></a>20.6.5. Command Options for MySQL Cluster Processes</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-ndbd-command-options">20.6.5.1. Command Options for <span><strong class="command">ndbd</strong></span></a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-ndb-mgmd-command-options">20.6.5.2. Command Options for <span><strong class="command">ndb_mgmd</strong></span></a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-ndb-mgm-command-options">20.6.5.3. Command Options for <span><strong class="command">ndb_mgm</strong></span></a></span></dt></dl></div><a class="indexterm" name="id2346791"></a><a class="indexterm" name="id2346803"></a><a class="indexterm" name="id2346815"></a><a class="indexterm" name="id2346824"></a><a class="indexterm" name="id2346837"></a><a class="indexterm" name="id2346849"></a><p>
      All MySQL Cluster executables (except for
      <span><strong class="command">mysqld</strong></span>) take the options described in this
      section. Users of earlier MySQL Cluster versions should note that
      some of these options have been changed to make them consistent
      with one another as well as with <span><strong class="command">mysqld</strong></span>. You
      can use the <code class="option">--help</code> option with any MySQL Cluster
      executable to view a list of the options which it supports.
    </p><p>
      The following options are common to all MySQL Cluster executables:
    </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2346892"></a><a class="indexterm" name="id2346904"></a><a class="indexterm" name="id2346916"></a><p>
          <code class="option">--help</code> <code class="option">--usage</code>,
          <code class="option">-?</code>
        </p><p>
          Prints a short list with descriptions of the available command
          options.
        </p></li><li><a class="indexterm" name="id2346950"></a><a class="indexterm" name="id2346959"></a><p>
          <code class="option">--connect-string=<em class="replaceable"><code>connect_string</code></em></code>,
          <code class="option">-c <em class="replaceable"><code>connect_string</code></em></code>
        </p><p>
          <em class="replaceable"><code>connect_string</code></em> sets the
          connectstring to the management server as a command option.

</p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndbd --connect-string="nodeid=2;host=ndb_mgmd.mysql.com:1186"</code></strong>
</pre><p>

          For more information, see
          <a href="mysql-cluster.html#mysql-cluster-connectstring" title="20.3.4.2. The Cluster Connectstring">Section 20.3.4.2, “The Cluster Connectstring”</a>.
        </p></li><li><a class="indexterm" name="id2347011"></a><p>
          <code class="option">--debug[=<em class="replaceable"><code>options</code></em>]</code>
        </p><p>
          This option can be used only for versions compiled with
          debugging enabled. It is used to enable output from debug
          calls in the same manner as for the <span><strong class="command">mysqld</strong></span>
          process.
        </p></li><li><a class="indexterm" name="id2347044"></a><a class="indexterm" name="id2347053"></a><p>
          <code class="option">--execute=<code class="literal">command</code></code>,
          <code class="option">-e <code class="literal">command</code></code>
        </p><p>
          Can be used to send a command to a Cluster executable from the
          system shell. For example, either of the following:
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgm -e "SHOW"</code></strong>
</pre><p>
          or
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgm --execute="SHOW"</code></strong>
</pre><p>
          is equivalent to
        </p><pre class="programlisting">ndb_mgm&gt; <strong class="userinput"><code>SHOW</code></strong>
</pre><p>
          This is analogous to how the <code class="option">--execute</code> or
          <code class="option">-e</code> option works with the
          <span><strong class="command">mysql</strong></span> command-line client. See
          <a href="programs.html#command-line-options" title="4.2.3.1. Using Options on the Command Line">Section 4.2.3.1, “Using Options on the Command Line”</a>.
        </p></li><li><a class="indexterm" name="id2347153"></a><a class="indexterm" name="id2347162"></a><p>
          <code class="option">--version</code>, <code class="option">-V</code>
        </p><p>
          Prints the MySQL Cluster version number of the executable. The
          version number is relevant because not all versions can be
          used together, and the MySQL Cluster startup process verifies
          that the versions of the binaries being used can co-exist in
          the same cluster. This is also important when performing an
          online (rolling) software upgrade or downgrade of MySQL
          Cluster. (See
          <a href="mysql-cluster.html#mysql-cluster-rolling-restart" title="20.5.1. Performing a Rolling Restart of the Cluster">Section 20.5.1, “Performing a Rolling Restart of the Cluster”</a>).
        </p></li></ul></div><p>
      The next few sections describe options specific to individual
      <code class="literal">NDB</code> programs.
    </p><p>
      See <a href="mysql-cluster.html#mysql-cluster-mysqld-command-options" title="20.4.2. MySQL Cluster-Related Command Options for mysqld">Section 20.4.2, “MySQL Cluster-Related Command Options for <span><strong class="command">mysqld</strong></span>”</a>, for
      <span><strong class="command">mysqld</strong></span> options relating to MySQL Cluster.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-ndbd-command-options"></a>20.6.5.1. Command Options for <span><strong class="command">ndbd</strong></span></h4></div></div></div><a class="indexterm" name="id2347232"></a><a class="indexterm" name="id2347244"></a><a class="indexterm" name="id2347257"></a><a class="indexterm" name="id2347269"></a><p>
        For options common to all <code class="literal">NDB</code> programs, see
        <a href="mysql-cluster.html#mysql-cluster-command-options" title="20.6.5. Command Options for MySQL Cluster Processes">Section 20.6.5, “Command Options for MySQL Cluster Processes”</a>.
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            <code class="option">--bind-address</code>
          </p><p>
            Causes <span><strong class="command">ndbd</strong></span> to bind to a specific network
            interface (hostname or IP address). This option has no
            default value.
          </p><p>
            This option was added in MySQL 5.1.12.
          </p></li><li><p>
            <code class="option">--daemon</code>, <code class="option">-d</code>
          </p><p>
            Instructs <span><strong class="command">ndbd</strong></span> to execute as a daemon
            process. This is the default behavior.
            <code class="option">--nodaemon</code> can be used to prevent the
            process from running as a daemon.
          </p></li><li><a class="indexterm" name="id2347352"></a><p>
            <code class="option">--initial</code>
          </p><p>
            Instructs <span><strong class="command">ndbd</strong></span> to perform an initial
            start. An initial start erases any files created for
            recovery purposes by earlier instances of
            <span><strong class="command">ndbd</strong></span>. It also re-creates recovery log
            files. Note that on some operating systems this process can
            take a substantial amount of time.
          </p><p>
            An <code class="option">--initial</code> start is to be used
            <span class="emphasis"><em>only</em></span> when starting the
            <span><strong class="command">ndbd</strong></span> process under very special
            circumstances; this is because this option causes all files
            to be removed from the Cluster filesystem and all redo log
            files to be re-created. These circumstances are listed here:
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                When performing a software upgrade which has changed the
                contents of any files.
              </p></li><li><p>
                When restarting the node with a new version of
                <span><strong class="command">ndbd</strong></span>.
              </p></li><li><p>
                As a measure of last resort when for some reason the
                node restart or system restart repeatedly fails. In this
                case, be aware that this node can no longer be used to
                restore data due to the destruction of the data files.
              </p></li></ul></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              This option does <span class="emphasis"><em>not</em></span> affect either of
              the following:

              </p><div class="itemizedlist"><ul type="circle"><li><p>
                    Backup files that have already been created by the
                    affected node
                  </p></li><li><p>
                    Cluster Disk Data files (see
                    <a href="mysql-cluster.html#mysql-cluster-disk-data" title="20.12. MySQL Cluster Disk Data Tables">Section 20.12, “MySQL Cluster Disk Data Tables”</a>).
                  </p></li></ul></div><p>
            </p></div><p>
            It is permissible to use this option when starting the
            cluster for the very first time (that is, before any data
            node files have been created); however, it is
            <span class="emphasis"><em>not</em></span> necessary to do so.
          </p></li><li><a class="indexterm" name="id2347482"></a><p>
            <code class="option">--initial-start</code>
          </p><p>
            This option is used when performing a partial initial start
            of the cluster. Each node should be started with this
            option, as well as <code class="option">--nowait-nodes</code>.
          </p><p>
            For example, suppose you have a 4-node cluster whose data
            nodes have the IDs 2, 3, 4, and 5, and you wish to perform a
            partial initial start using only nodes 2, 4, and 5 —
            that is, omitting node 3:
          </p><pre class="programlisting">ndbd --ndbd-nodeid=2 --nowait-nodes=3 --initial-start
ndbd --ndbd-nodeid=4 --nowait-nodes=3 --initial-start
ndbd --ndbd-nodeid=5 --nowait-nodes=3 --initial-start
</pre><p>
            This option was added in MySQL 5.1.11.
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              Prior to MySQL 5.1.19, it was not possible to perform DDL
              operations involving Disk Data tables on a partially
              started cluster. (See <a href="http://bugs.mysql.com/24631" target="_top">Bug#24631</a>.)
            </p></div></li><li><a class="indexterm" name="id2347542"></a><p>
            <code class="option">--nowait-nodes=<em class="replaceable"><code>node_id_1</code></em>[,
            <em class="replaceable"><code>node_id_2</code></em>[, ...]]</code>
          </p><p>
            This option takes a list of data nodes which for which the
            cluster will not wait for before starting.
          </p><p>
            This can be used to start the cluster in a partitioned
            state. For example, to start the cluster with only half of
            the data nodes (nodes 2, 3, 4, and 5) running in a 4-node
            cluster, you can start each <span><strong class="command">ndbd</strong></span> process
            with <code class="option">--nowait-nodes=3,5</code>. In this case, the
            cluster starts as soon as nodes 2 and 4 connect, and does
            <span class="emphasis"><em>not</em></span> wait
            <code class="literal">StartPartitionedTimeout</code> milliseconds for
            nodes 3 and 5 to connect as it would otherwise.
          </p><p>
            If you wanted to start up the same cluster as in the
            previous example without one <span><strong class="command">ndbd</strong></span> —
            say, for example, that the host machine for node 3 has
            suffered a hardware failure — then start nodes 2, 4,
            and 5 with <code class="option">--nowait-nodes=3</code>. Then the
            cluster will start as soon as nodes 2, 4, and 5 connect and
            will not wait for node 3 to start.
          </p><p>
            This option was added in MySQL 5.1.9.
          </p></li><li><a class="indexterm" name="id2347621"></a><p>
            <code class="option">--nodaemon</code>
          </p><p>
            Instructs <span><strong class="command">ndbd</strong></span> not to start as a daemon
            process. This is useful when <span><strong class="command">ndbd</strong></span> is
            being debugged and you want output to be redirected to the
            screen.
          </p></li><li><a class="indexterm" name="id2347656"></a><a class="indexterm" name="id2347665"></a><p>
            <code class="option">--nostart</code>, <code class="option">-n</code>
          </p><p>
            Instructs <span><strong class="command">ndbd</strong></span> not to start
            automatically. When this option is used,
            <span><strong class="command">ndbd</strong></span> connects to the management server,
            obtains configuration data from it, and initializes
            communication objects. However, it does not actually start
            the execution engine until specifically requested to do so
            by the management server. This can be accomplished by
            issuing the proper <code class="literal">START</code> command in the
            management client (see
            <a href="mysql-cluster.html#mysql-cluster-mgm-client-commands" title="20.7.2. Commands in the MySQL Cluster Management Client">Section 20.7.2, “Commands in the MySQL Cluster Management Client”</a>).
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-ndb-mgmd-command-options"></a>20.6.5.2. Command Options for <span><strong class="command">ndb_mgmd</strong></span></h4></div></div></div><a class="indexterm" name="id2347730"></a><a class="indexterm" name="id2347742"></a><a class="indexterm" name="id2347755"></a><a class="indexterm" name="id2347767"></a><p>
        For options common to NDB programs, see
        <a href="mysql-cluster.html#mysql-cluster-command-options" title="20.6.5. Command Options for MySQL Cluster Processes">Section 20.6.5, “Command Options for MySQL Cluster Processes”</a>.
      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2347793"></a><p>
            <code class="option">--bind-address=<em class="replaceable"><code>host</code></em>[:<em class="replaceable"><code>port</code></em>]</code>
          </p><p>
            When specified, this option limits management server
            connections by management clients to clients at the
            specified hostname or IP address (and possibly port, if this
            is also specified). In such cases, a management client
            attempting to connect to the management server from any
            other address fails with the error <span class="errortext">Unable to
            setup port:
            <em class="replaceable"><code>host</code></em>:<em class="replaceable"><code>port</code></em>!</span>
          </p><p>
            If the <em class="replaceable"><code>port</code></em> is not specified, the
            management client attempts to use port 1186.
          </p><p>
            This option was added in MySQL Cluster NDB 6.2.5 and MySQL
            Cluster NDB 6.3.2.
          </p></li><li><a class="indexterm" name="id2347848"></a><a class="indexterm" name="id2347857"></a><a class="indexterm" name="id2347866"></a><p>
            <code class="option">--config-file=<em class="replaceable"><code>filename</code></em></code>,
            <code class="option">-f <em class="replaceable"><code>filename</code></em></code>
          </p><p>
            Instructs the management server as to which file it should
            use for its configuration file. By default, the management
            server looks for a file named
            <code class="filename">config.ini</code> in the same directory as the
            <span><strong class="command">ndb_mgmd</strong></span> executable; otherwise the
            filename and location must be specified explicitly.
          </p></li><li><p>
            <code class="option">--daemon</code>, <code class="option">-d</code>
          </p><p>
            Instructs <span><strong class="command">ndb_mgmd</strong></span> to start as a daemon
            process. This is the default behavior.
          </p></li><li><p>
            <code class="option">--nodaemon</code>
          </p><p>
            Instructs <span><strong class="command">ndb_mgmd</strong></span> not to start as a
            daemon process.
          </p></li><li><a class="indexterm" name="id2347954"></a><a class="indexterm" name="id2347963"></a><p>
            <code class="option">--print-full-config</code>, <code class="option">-P</code>
          </p><p>
            Shows extended information regarding the configuration of
            the cluster. With this option on the command line the
            <span><strong class="command">ndb_mgmd</strong></span> process prints information about
            the cluster setup including an extensive list of the cluster
            configuration sections as well as parameters and their
            values. Normally used together with the
            <code class="option">--config-file</code> (<code class="option">-f</code>) option.
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-ndb-mgm-command-options"></a>20.6.5.3. Command Options for <span><strong class="command">ndb_mgm</strong></span></h4></div></div></div><a class="indexterm" name="id2348017"></a><a class="indexterm" name="id2348029"></a><a class="indexterm" name="id2348042"></a><a class="indexterm" name="id2348054"></a><p>
        For options common to NDB programs, see
        <a href="mysql-cluster.html#mysql-cluster-command-options" title="20.6.5. Command Options for MySQL Cluster Processes">Section 20.6.5, “Command Options for MySQL Cluster Processes”</a>.
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            <code class="option">--try-reconnect=<em class="replaceable"><code>number</code></em></code>
          </p><p>
            If the connection to the management server is broken, the
            node tries to reconnect to it every 5 seconds until it
            succeeds. By using this option, it is possible to limit the
            number of attempts to <em class="replaceable"><code>number</code></em>
            before giving up and reporting an error instead.
          </p></li></ul></div></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-management"></a>20.7. Management of MySQL Cluster</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-start-phases">20.7.1. Summary of MySQL Cluster Start Phases</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-mgm-client-commands">20.7.2. Commands in the MySQL Cluster Management Client</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-event-reports">20.7.3. Event Reports Generated in MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-logs-ndb-messages">20.7.4. <code class="literal">NDB</code> Log Messages</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-single-user-mode">20.7.5. Single User Mode</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-sql-statements">20.7.6. Quick Reference: MySQL Cluster SQL Statements</a></span></dt></dl></div><a class="indexterm" name="id2348112"></a><a class="indexterm" name="id2348124"></a><p>
    Managing a MySQL Cluster involves a number of tasks, the first of
    which is to configure and start MySQL Cluster. This is covered in
    <a href="mysql-cluster.html#mysql-cluster-configuration" title="20.3. MySQL Cluster Configuration">Section 20.3, “MySQL Cluster Configuration”</a>, and
    <a href="mysql-cluster.html#mysql-cluster-process-management" title="20.6. Process Management in MySQL Cluster">Section 20.6, “Process Management in MySQL Cluster”</a>.
  </p><p>
    The following sections cover the management of a running MySQL
    Cluster.
  </p><p>
    For information about security issues relating to management and
    deployment of a MySQL Cluster, see
    <a href="mysql-cluster.html#mysql-cluster-security" title="20.8. MySQL Cluster Security Issues">Section 20.8, “MySQL Cluster Security Issues”</a>.
  </p><p>
    There are essentially two methods of actively managing a running
    MySQL Cluster. The first of these is through the use of commands
    entered into the management client whereby cluster status can be
    checked, log levels changed, backups started and stopped, and nodes
    stopped and started. The second method involves studying the
    contents of the cluster log
    <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_cluster.log</code>;
    this is usually found in the management server's
    <code class="literal">DataDir</code> directory, but this location can be
    overridden using the <code class="literal">LogDestination</code> option
    — see <a href="mysql-cluster.html#mysql-cluster-mgm-definition" title="20.3.4.4. Defining the Management Server">Section 20.3.4.4, “Defining the Management Server”</a>, for
    details. (Recall that <em class="replaceable"><code>node_id</code></em> represents
    the unique identifier of the node whose activity is being logged.)
    The cluster log contains event reports generated by
    <span><strong class="command">ndbd</strong></span>. It is also possible to send cluster log
    entries to a Unix system log.
  </p><p>
    In addition, some aspects of the cluster's operation can be
    monitored from an SQL node using the <code class="literal">SHOW ENGINE NDB
    STATUS</code> statement. See <a href="sql-syntax.html#show-engine" title="12.5.5.15. SHOW ENGINE Syntax">Section 12.5.5.15, “<code class="literal">SHOW ENGINE</code> Syntax”</a>, for
    more information.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-start-phases"></a>20.7.1. Summary of MySQL Cluster Start Phases</h3></div></div></div><a class="indexterm" name="id2348229"></a><a class="indexterm" name="id2348241"></a><p>
      This section provides a simplified outline of the steps involved
      when MySQL Cluster data nodes are started. More complete
      information can be found in
      <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-start-phases.html" target="_top">MySQL Cluster Start Phases</a>.
    </p><p>
      These phases are the same as those reported in the output from the
      <code class="literal"><em class="replaceable"><code>node_id</code></em> STATUS</code>
      command in the management client. (See
      <a href="mysql-cluster.html#mysql-cluster-mgm-client-commands" title="20.7.2. Commands in the MySQL Cluster Management Client">Section 20.7.2, “Commands in the MySQL Cluster Management Client”</a>, for more
      information about this command.)
    </p><p><b>Start types. </b>
        There are several different startup types and modes, as shown
        here:

        </p><div class="itemizedlist"><ul type="disc"><li><p><b>Initial Start. </b>
                The cluster starts with a clean filesystem on all data
                nodes. This occurs either when the cluster started for
                the very first time, or when all data nodes are
                restarted using the <code class="option">--initial</code> option.

                </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                    Disk Data files are not removed when restarting a
                    node using <code class="option">--initial</code>.
                  </p></div><p>
              </p></li><li><p><b>System Restart. </b>
                The cluster starts and reads data stored in the data
                nodes. This occurs when the cluster has been shut down
                after having been in use, when it is desired for the
                cluster to resume operations from the point where it
                left off.
              </p></li><li><p><b>Node Restart. </b>
                This is the online restart of a cluster node while the
                cluster itself is running.
              </p></li><li><p><b>Initial Node Restart. </b>
                This is the same as a node restart, except that the node
                is reinitialized and started with a clean filesystem.
              </p></li></ul></div><p>
      </p><p><b>Setup and initialization (Phase -1). </b>
        Prior to startup, each data node (<span><strong class="command">ndbd</strong></span>
        process) must be initialized. Initialization consists of the
        following steps:

        </p><div class="orderedlist"><ol type="1"><li><p>
              Obtain a node ID
            </p></li><li><p>
              Fetch configuration data
            </p></li><li><p>
              Allocate ports to be used for inter-node communications
            </p></li><li><p>
              Allocate memory according to settings obtained from the
              configuration file
            </p></li></ol></div><p>
      </p><p>
      When a data node or SQL node first connects to the management
      node, it reserves a cluster node ID. To make sure that no other
      node allocates the same node ID, this ID is retained until the
      node has managed to connect to the cluster and at least one
      <span><strong class="command">ndbd</strong></span> reports that this node is connected. This
      retention of the node ID is guarded by the connection between the
      node in question and <span><strong class="command">ndb_mgmd</strong></span>.
    </p><p>
      Normally, in the event of a problem with the node, the node
      disconnects from the management server, the socket used for the
      connection is closed, and the reserved node ID is freed. However,
      if a node is disconnected abruptly — for example, due to a
      hardware failure in one of the cluster hosts, or because of
      network issues — the normal closing of the socket by the
      operating system may not take place. In this case, the node ID
      continues to be reserved and not released until a TCP timeout
      occurs 10 or so minutes later.
    </p><a class="indexterm" name="id2348456"></a><p>
      To take care of this problem, you can use <code class="literal">PURGE STALE
      SESSIONS</code>. Running this statement forces all reserved
      node IDs to be checked; any that are not being used by nodes
      actually connected to the cluster are then freed.
    </p><p>
      Beginning with MySQL 5.1.11, timeout handling of node ID
      assignments is implemented. This performs the ID usage checks
      automatically after approximately 20 seconds, so that
      <code class="literal">PURGE STALE SESSIONS</code> should no longer be
      necessary in a normal Cluster start.
    </p><p>
      After each data node has been initialized, the cluster startup
      process can proceed. The stages which the cluster goes through
      during this process are listed here:

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Phase 0. </b>
              The <code class="literal">NDBFS</code> and
              <code class="literal">NDBCNTR</code> blocks start (see
              <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-kernel-blocks.html" target="_top"><code class="literal">NDB</code> Kernel Blocks</a>). The
              cluster filesystem is cleared, if the cluster was started
              with the <code class="option">--initial</code> option.
            </p></li><li><p><b>Phase 1. </b>
              In this stage, all remaining <code class="literal">NDB</code> kernel
              blocks are started. Cluster connections are set up,
              inter-block communications are established, and Cluster
              heartbeats are started. In the case of a node restart, API
              node connections are also checked.

              </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                  When one or more nodes hang in Phase 1 while the
                  remaining node or nodes hang in Phase 2, this often
                  indicates network problems. One possible cause of such
                  issues is one or more cluster hosts having multiple
                  network interfaces. Another common source of problems
                  causing this condition is the blocking of TCP/IP ports
                  needed for communications between cluster nodes. In
                  the latter case, this is often due to a misconfigured
                  firewall.
                </p></div><p>
            </p></li><li><p><b>Phase 2. </b>
              The <code class="literal">NDBCNTR</code> kernel block checks the
              states of all existing nodes. The master node is chosen,
              and the cluster schema file is initialized.
            </p></li><li><p><b>Phase 3. </b>
              The <code class="literal">DBLQH</code> and <code class="literal">DBTC</code>
              kernel blocks set up communications between them. The
              startup type is determined; if this is a restart, the
              <code class="literal">DBDIH</code> block obtains permission to
              perform the restart.
            </p></li><li><p><b>Phase 4. </b>
              For an initial start or initial node restart, the redo log
              files are created. The number of these files is equal to
              <code class="literal">NoOfFragmentLogFiles</code>.
            </p><p>
            For a system restart:
          </p><div class="itemizedlist"><ul type="circle"><li><p>
                Read schema or schemas.
              </p></li><li><p>
                Read data from the local checkpoint.
              </p></li><li><p>
                Apply all redo information until the latest restorable
                global checkpoint has been reached.
              </p></li></ul></div><p>
            For a node restart, find the tail of the redo log.
          </p></li><li><p><b>Phase 5. </b>
              Most of the database-related portion of a data node start
              is performed during this phase. For an initial start or
              system restart, a local checkpoint is executed, followed
              by a global checkpoint. Periodic checks of memory usage
              begin during this phase, and any required node takeovers
              are performed.
            </p></li><li><p><b>Phase 6. </b>
              In this phase, node groups are defined and set up.
            </p></li><li><p><b>Phase 7. </b>
              The arbitrator node is selected and begins to function.
              The next backup ID is set, as is the backup disk write
              speed. Nodes reaching this start phase are marked as
              <code class="literal">Started</code>. It is now possible for API
              nodes (including SQL nodes) to connect to the cluster.
              connect.
            </p></li><li><p><b>Phase 8. </b>
              If this is a system restart, all indexes are rebuilt (by
              <code class="literal">DBDIH</code>).
            </p></li><li><p><b>Phase 9. </b>
              The node internal startup variables are reset.
            </p></li><li><p><b>Phase 100 (<span class="emphasis"><em>OBSOLETE</em></span>). </b>
              Formerly, it was at this point during a node restart or
              initial node restart that API nodes could connect to the
              node and begin to receive events. Currently, this phase is
              empty.
            </p></li><li><p><b>Phase 101. </b>
              At this point in a node restart or initial node restart,
              event delivery is handed over to the node joining the
              cluster. The newly-joined node takes over responsibility
              for delivering its primary data to subscribers. This phase
              is also referred to as <em class="firstterm"><code class="literal">SUMA</code>
              handover phase</em>.
            </p></li></ul></div><p>
    </p><p>
      After this process is completed for an initial start or system
      restart, transaction handling is enabled. For a node restart or
      initial node restart, completion of the startup process means that
      the node may now act as a transaction coordinator.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-mgm-client-commands"></a>20.7.2. Commands in the MySQL Cluster Management Client</h3></div></div></div><a class="indexterm" name="id2348819"></a><a class="indexterm" name="id2348831"></a><a class="indexterm" name="id2348843"></a><p>
      In addition to the central configuration file, a cluster may also
      be controlled through a command-line interface available through
      the management client <span><strong class="command">ndb_mgm</strong></span>. This is the
      primary administrative interface to a running cluster.
    </p><p>
      Commands for the event logs are given in
      <a href="mysql-cluster.html#mysql-cluster-event-reports" title="20.7.3. Event Reports Generated in MySQL Cluster">Section 20.7.3, “Event Reports Generated in MySQL Cluster”</a>; commands for
      creating backups and restoring from backup are provided in
      <a href="mysql-cluster.html#mysql-cluster-backup" title="20.9. On-line Backup of MySQL Cluster">Section 20.9, “On-line Backup of MySQL Cluster”</a>.
    </p><p>
      The management client has the following basic commands. In the
      listing that follows, <em class="replaceable"><code>node_id</code></em> denotes
      either a database node ID or the keyword <code class="literal">ALL</code>,
      which indicates that the command should be applied to all of the
      cluster's data nodes.
    </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2348900"></a><a class="indexterm" name="id2348912"></a><p>
          <code class="literal">HELP</code>
        </p><p>
          Displays information on all available commands.
        </p></li><li><a class="indexterm" name="id2348937"></a><a class="indexterm" name="id2348950"></a><p>
          <code class="literal">SHOW</code>
        </p><p>
          Displays information on the cluster's status.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            In a cluster where multiple management nodes are in use,
            this command displays information only for data nodes that
            are actually connected to the current management server.
          </p></div></li><li><a class="indexterm" name="id2348983"></a><a class="indexterm" name="id2348996"></a><p>
          <code class="literal"><em class="replaceable"><code>node_id</code></em> START</code>
        </p><p>
          Brings online the data node identified by
          <em class="replaceable"><code>node_id</code></em> (or all data nodes).
        </p><p>
          <code class="literal">ALL START</code> works on all data nodes only, and
          does not affect management nodes.
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
            To use this command to bring a data node online, the data
            node must have been started using <span><strong class="command">ndbd
            --nostart</strong></span> or <span><strong class="command">ndbd -n</strong></span>.
          </p></div></li><li><a class="indexterm" name="id2349056"></a><a class="indexterm" name="id2349069"></a><p>
          <code class="literal"><em class="replaceable"><code>node_id</code></em> STOP</code>
        </p><p>
          Stops the data or management node identified by
          <em class="replaceable"><code>node_id</code></em>. Note that <code class="literal">ALL
          STOP</code> works to stop all data nodes only, and does not
          affect management nodes.
        </p><p>
          A node affected by this command disconnects from the cluster,
          and its associated <span><strong class="command">ndbd</strong></span> or
          <span><strong class="command">ndb_mgmd</strong></span> process terminates.
        </p></li><li><a class="indexterm" name="id2349123"></a><a class="indexterm" name="id2349135"></a><p>
          <code class="literal"><em class="replaceable"><code>node_id</code></em> RESTART [-n] [-i]
          [-a]</code>
        </p><p>
          Restarts the data node identified by
          <em class="replaceable"><code>node_id</code></em> (or all data nodes).
        </p><p>
          Using the <code class="option">-i</code> option with
          <code class="literal">RESTART</code> causes the data node to perform an
          initial restart; that is, the node's filesystem is deleted and
          recreated. The effect is the same as that obtained from
          stopping the data node process and then starting it again
          using <span><strong class="command">ndbd --initial</strong></span> from the system shell.
          Note that backup files and Disk Data files are not removed
          when this option is used.
        </p><p>
          Using the <code class="option">-n</code> option causes the data node
          process to be restarted, but the data node is not actually
          brought online until the appropriate <code class="literal">START</code>
          command is issued. The effect of this option is the same as
          that obtained from stopping the data node and then starting it
          again using <code class="literal">ndbd --nostart</code> or <code class="literal">ndbd
          -n</code> from the system shell.
        </p><p>
          Using the <code class="option">-a</code> causes all current transactions
          relying on this node to be aborted. No GCP check is done when
          the node rejoins the cluster.
        </p></li><li><a class="indexterm" name="id2349224"></a><a class="indexterm" name="id2349237"></a><p>
          <code class="literal"><em class="replaceable"><code>node_id</code></em> STATUS</code>
        </p><p>
          Displays status information for the data node identified by
          <em class="replaceable"><code>node_id</code></em> (or for all data nodes).
        </p></li><li><a class="indexterm" name="id2349268"></a><a class="indexterm" name="id2349280"></a><p>
          <code class="literal"><em class="replaceable"><code>node_id</code></em> REPORT
          <em class="replaceable"><code>report-type</code></em></code>
        </p><p>
          Displays a report of type
          <em class="replaceable"><code>report-type</code></em> for the data node
          identified by <em class="replaceable"><code>node_id</code></em>, or for all
          data nodes using <code class="literal">ALL</code>.
        </p><p>
          Currently, there are two accepted values for
          <em class="replaceable"><code>report-type</code></em>:

          </p><div class="itemizedlist"><ul type="circle"><li><p>
                <code class="literal">BackupStatus</code> provides a status report
                on a cluster backup in progress
              </p></li><li><p>
                <code class="literal">MemoryUsage</code> displays how much data
                memory and index memory is being used by each data node.
              </p></li></ul></div><p>
        </p><p>
          The <code class="literal">REPORT</code> command was introduced in MySQL
          Cluster NDB 6.2.3 and MySQL Cluster NDB 6.3.0.
        </p></li><li><a class="indexterm" name="id2349371"></a><a class="indexterm" name="id2349384"></a><a class="indexterm" name="id2349393"></a><a class="indexterm" name="id2349405"></a><p>
          <code class="literal">ENTER SINGLE USER MODE
          <em class="replaceable"><code>node_id</code></em></code>
        </p><p>
          Enters single user mode, whereby only the MySQL server
          identified by the node ID <em class="replaceable"><code>node_id</code></em>
          is allowed to access the database.
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
            It is not possible in MySQL 5.1 for data nodes
            to join the cluster while it is running in single user mode.
            (See <a href="http://bugs.mysql.com/20395" target="_top">Bug#20395</a> for more information.)
          </p></div></li><li><a class="indexterm" name="id2349451"></a><a class="indexterm" name="id2349464"></a><p>
          <code class="literal">EXIT SINGLE USER MODE</code>
        </p><p>
          Exits single user mode, allowing all SQL nodes (that is, all
          running <span><strong class="command">mysqld</strong></span> processes) to access the
          database.
        </p></li><li><a class="indexterm" name="id2349495"></a><a class="indexterm" name="id2349508"></a><a class="indexterm" name="id2349517"></a><a class="indexterm" name="id2349529"></a><p>
          <code class="literal">QUIT</code>, <code class="literal">EXIT</code>
        </p><p>
          Terminates the management client.
        </p><p>
          This command does not affect any nodes connected to the
          cluster.
        </p></li><li><a class="indexterm" name="id2349564"></a><a class="indexterm" name="id2349576"></a><p>
          <code class="literal">SHUTDOWN</code>
        </p><p>
          Shuts down all cluster data nodes and management nodes. To
          exit the management client after this has been done, use
          <code class="literal">EXIT</code> or <code class="literal">QUIT</code>.
        </p><p>
          This command does <span class="emphasis"><em>not</em></span> shut down any SQL
          nodes or API nodes that are connected to the cluster.
        </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-event-reports"></a>20.7.3. Event Reports Generated in MySQL Cluster</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-logging-management-commands">20.7.3.1. Logging Management Commands</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-log-events">20.7.3.2. Log Events</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-log-statistics">20.7.3.3. Using <code class="literal">CLUSTERLOG STATISTICS</code></a></span></dt></dl></div><a class="indexterm" name="id2349630"></a><a class="indexterm" name="id2349643"></a><a class="indexterm" name="id2349652"></a><a class="indexterm" name="id2349661"></a><a class="indexterm" name="id2349670"></a><a class="indexterm" name="id2349682"></a><p>
      In this section, we discuss the types of event logs provided by
      MySQL Cluster, and the types of events that are logged.
    </p><p>
      MySQL Cluster provides two types of event log:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          The <em class="firstterm">cluster log</em>, which includes events
          generated by all cluster nodes. The cluster log is the log
          recommended for most uses because it provides logging
          information for an entire cluster in a single location.
        </p><p>
          By default, the cluster log is saved to a file named
          <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_cluster.log</code>,
          (where <em class="replaceable"><code>node_id</code></em> is the node ID of
          the management server) in the same directory where the
          <span><strong class="command">ndb_mgm</strong></span> binary resides.
        </p><p>
          Cluster logging information can also be sent to
          <code class="literal">stdout</code> or a <code class="literal">syslog</code>
          facility in addition to or instead of being saved to a file,
          as determined by the values set for the
          <code class="literal">DataDir</code> and
          <code class="literal">LogDestination</code> configuration parameters.
          See <a href="mysql-cluster.html#mysql-cluster-mgm-definition" title="20.3.4.4. Defining the Management Server">Section 20.3.4.4, “Defining the Management Server”</a>, for more
          information about these parameters.
        </p></li><li><p>
          <em class="firstterm">Node logs</em> are local to each node.
        </p><p>
          Output generated by node event logging is written to the file
          <code class="filename">ndb_<em class="replaceable"><code>node_id</code></em>_out.log</code>
          (where <em class="replaceable"><code>node_id</code></em> is the node's node
          ID) in the node's <code class="literal">DataDir</code>. Node event logs
          are generated for both management nodes and data nodes.
        </p><p>
          Node logs are intended to be used only during application
          development, or for debugging application code.
        </p></li></ul></div><p>
      Both types of event logs can be set to log different subsets of
      events.
    </p><p>
      Each reportable event can be distinguished according to three
      different criteria:
    </p><a class="indexterm" name="id2349824"></a><a class="indexterm" name="id2349836"></a><div class="itemizedlist"><ul type="disc"><li><p>
          <span class="emphasis"><em>Category</em></span>: This can be any one of the
          following values: <code class="literal">STARTUP</code>,
          <code class="literal">SHUTDOWN</code>, <code class="literal">STATISTICS</code>,
          <code class="literal">CHECKPOINT</code>, <code class="literal">NODERESTART</code>,
          <code class="literal">CONNECTION</code>, <code class="literal">ERROR</code>, or
          <code class="literal">INFO</code>.
        </p></li><li><p>
          <span class="emphasis"><em>Priority</em></span>: This is represented by one of
          the numbers from 1 to 15 inclusive, where 1 indicates
          “<span class="quote">most important</span>” and 15 “<span class="quote">least
          important.</span>”
        </p></li><li><p>
          <span class="emphasis"><em>Severity Level</em></span>: This can be any one of
          the following values: <code class="literal">ALERT</code>,
          <code class="literal">CRITICAL</code>, <code class="literal">ERROR</code>,
          <code class="literal">WARNING</code>, <code class="literal">INFO</code>, or
          <code class="literal">DEBUG</code>.
        </p></li></ul></div><p>
      Both the cluster log and the node log can be filtered on these
      properties.
    </p><p>
      The format used in the cluster log is as shown here:
    </p><pre class="programlisting">2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 1: Data usage is 2%(60 32K pages of total 2560)
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 1: Index usage is 1%(24 8K pages of total 2336)
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 1: Resource 0 min: 0 max: 639 curr: 0
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 2: Data usage is 2%(76 32K pages of total 2560)
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 2: Index usage is 1%(24 8K pages of total 2336)
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 2: Resource 0 min: 0 max: 639 curr: 0
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 3: Data usage is 2%(58 32K pages of total 2560)
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 3: Index usage is 1%(25 8K pages of total 2336)
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 3: Resource 0 min: 0 max: 639 curr: 0
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 4: Data usage is 2%(74 32K pages of total 2560)
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 4: Index usage is 1%(25 8K pages of total 2336)
2007-01-26 19:35:55 [MgmSrvr] INFO     -- Node 4: Resource 0 min: 0 max: 639 curr: 0
2007-01-26 19:39:42 [MgmSrvr] INFO     -- Node 4: Node 9 Connected
2007-01-26 19:39:42 [MgmSrvr] INFO     -- Node 1: Node 9 Connected
2007-01-26 19:39:42 [MgmSrvr] INFO     -- Node 1: Node 9: API version 5.1.15
2007-01-26 19:39:42 [MgmSrvr] INFO     -- Node 2: Node 9 Connected
2007-01-26 19:39:42 [MgmSrvr] INFO     -- Node 2: Node 9: API version 5.1.15
2007-01-26 19:39:42 [MgmSrvr] INFO     -- Node 3: Node 9 Connected
2007-01-26 19:39:42 [MgmSrvr] INFO     -- Node 3: Node 9: API version 5.1.15
2007-01-26 19:39:42 [MgmSrvr] INFO     -- Node 4: Node 9: API version 5.1.15
2007-01-26 19:59:22 [MgmSrvr] ALERT    -- Node 2: Node 7 Disconnected
2007-01-26 19:59:22 [MgmSrvr] ALERT    -- Node 2: Node 7 Disconnected
</pre><p>
      Each line in the cluster log contains the following information:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          A timestamp in
          <code class="literal"><em class="replaceable"><code>YYYY</code></em>-<em class="replaceable"><code>MM</code></em>-<em class="replaceable"><code>DD</code></em>
          <em class="replaceable"><code>HH</code></em>:<em class="replaceable"><code>MM</code></em>:<em class="replaceable"><code>SS</code></em></code>
          format.
        </p></li><li><p>
          The type of node which is performing the logging. In the
          cluster log, this is always <code class="literal">[MgmSrvr]</code>.
        </p></li><li><p>
          The severity of the event.
        </p></li><li><p>
          The ID of the node reporting the event.
        </p></li><li><p>
          A description of the event. The most common types of events to
          appear in the log are connections and disconnections between
          different nodes in the cluster, and when checkpoints occur. In
          some cases, the description may contain status information.
        </p></li></ul></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-logging-management-commands"></a>20.7.3.1. Logging Management Commands</h4></div></div></div><a class="indexterm" name="id2350082"></a><a class="indexterm" name="id2350094"></a><a class="indexterm" name="id2350103"></a><a class="indexterm" name="id2350112"></a><a class="indexterm" name="id2350124"></a><a class="indexterm" name="id2350133"></a><p>
        The following management commands are related to the cluster
        log:
      </p><a class="indexterm" name="id2350150"></a><a class="indexterm" name="id2350162"></a><div class="itemizedlist"><ul type="disc"><li><p>
            <code class="literal">CLUSTERLOG ON</code>
          </p><p>
            Turns the cluster log on.
          </p></li><li><p>
            <code class="literal">CLUSTERLOG OFF</code>
          </p><p>
            Turns the cluster log off.
          </p></li><li><p>
            <code class="literal">CLUSTERLOG INFO</code>
          </p><p>
            Provides information about cluster log settings.
          </p></li><li><p>
            <code class="literal"><em class="replaceable"><code>node_id</code></em> CLUSTERLOG
            <em class="replaceable"><code>category</code></em>=<em class="replaceable"><code>threshold</code></em></code>
          </p><p>
            Logs <em class="replaceable"><code>category</code></em> events with
            priority less than or equal to
            <em class="replaceable"><code>threshold</code></em> in the cluster log.
          </p></li><li><p>
            <code class="literal">CLUSTERLOG FILTER
            <em class="replaceable"><code>severity_level</code></em></code>
          </p><p>
            Toggles cluster logging of events of the specified
            <em class="replaceable"><code>severity_level</code></em>.
          </p></li></ul></div><p>
        The following table describes the default setting (for all data
        nodes) of the cluster log category threshold. If an event has a
        priority with a value lower than or equal to the priority
        threshold, it is reported in the cluster log.
      </p><a class="indexterm" name="id2350282"></a><a class="indexterm" name="id2350295"></a><p>
        Note that events are reported per data node, and that the
        threshold can be set to different values on different nodes.
      </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Category</strong></span></td><td><span class="bold"><strong>Default threshold (All data nodes)</strong></span></td></tr><tr><td><code class="literal">STARTUP</code></td><td><span class="bold"><strong>7</strong></span></td></tr><tr><td><code class="literal">SHUTDOWN</code></td><td><span class="bold"><strong>7</strong></span></td></tr><tr><td><code class="literal">STATISTICS</code></td><td><span class="bold"><strong>7</strong></span></td></tr><tr><td><code class="literal">CHECKPOINT</code></td><td><span class="bold"><strong>7</strong></span></td></tr><tr><td><code class="literal">NODERESTART</code></td><td><span class="bold"><strong>7</strong></span></td></tr><tr><td><code class="literal">CONNECTION</code></td><td><span class="bold"><strong>7</strong></span></td></tr><tr><td><code class="literal">ERROR</code></td><td><span class="bold"><strong>15</strong></span></td></tr><tr><td><code class="literal">INFO</code></td><td><span class="bold"><strong>7</strong></span></td></tr></tbody></table></div><p>
        The <code class="literal">STATISTICS</code> category can provide a great
        deal of useful data. See
        <a href="mysql-cluster.html#mysql-cluster-log-statistics" title="20.7.3.3. Using CLUSTERLOG STATISTICS">Section 20.7.3.3, “Using <code class="literal">CLUSTERLOG STATISTICS</code>”</a>, for more
        information.
      </p><p>
        Thresholds are used to filter events within each category. For
        example, a <code class="literal">STARTUP</code> event with a priority of 3
        is not logged unless the threshold for
        <code class="literal">STARTUP</code> is set to 3 or higher. Only events
        with priority 3 or lower are sent if the threshold is 3.
      </p><a class="indexterm" name="id2350510"></a><a class="indexterm" name="id2350522"></a><p>
        The following table shows the event severity levels.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          These correspond to Unix <code class="literal">syslog</code> levels,
          except for <code class="literal">LOG_EMERG</code> and
          <code class="literal">LOG_NOTICE</code>, which are not used or mapped.
        </p></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>1</strong></span></td><td><code class="literal">ALERT</code></td><td>A condition that should be corrected immediately, such as a corrupted
                system database</td></tr><tr><td><span class="bold"><strong>2</strong></span></td><td><code class="literal">CRITICAL</code></td><td>Critical conditions, such as device errors or insufficient resources</td></tr><tr><td><span class="bold"><strong>3</strong></span></td><td><code class="literal">ERROR</code></td><td>Conditions that should be corrected, such as configuration errors</td></tr><tr><td><span class="bold"><strong>4</strong></span></td><td><code class="literal">WARNING</code></td><td>Conditions that are not errors, but that might require special handling</td></tr><tr><td><span class="bold"><strong>5</strong></span></td><td><code class="literal">INFO</code></td><td>Informational messages</td></tr><tr><td><span class="bold"><strong>6</strong></span></td><td><code class="literal">DEBUG</code></td><td>Debugging messages used for <code class="literal">NDBCLUSTER</code> development</td></tr></tbody></table></div><p>
        Event severity levels can be turned on or off (using
        <code class="literal">CLUSTERLOG FILTER</code> — see above). If a
        severity level is turned on, then all events with a priority
        less than or equal to the category thresholds are logged. If the
        severity level is turned off then no events belonging to that
        severity level are logged.
      </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
          Cluster log levels are set on a per
          <span><strong class="command">ndb_mgmd</strong></span>, per subscriber basis. This means
          that, in a MySQL Cluster with multiple management servers,
          using a <code class="literal">CLUSTERLOG</code> command in an instance
          of <span><strong class="command">ndb_mgm</strong></span> connected to one management
          server affects only logs generated by that management server
          but not by any of the others. This also means that, should one
          of the management servers be restarted, only logs generated by
          that management server are affected by the resetting of log
          levels caused by the restart.
        </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-log-events"></a>20.7.3.2. Log Events</h4></div></div></div><a class="indexterm" name="id2350771"></a><a class="indexterm" name="id2350784"></a><p>
        An event report reported in the event logs has the following
        format:
      </p><pre class="programlisting"><em class="replaceable"><code>datetime</code></em> [<em class="replaceable"><code>string</code></em>] <em class="replaceable"><code>severity</code></em> -- <em class="replaceable"><code>message</code></em>
</pre><p>
        For example:
      </p><pre class="programlisting">09:19:30 2005-07-24 [NDB] INFO -- Node 4 Start phase 4 completed
</pre><p>
        This section discusses all reportable events, ordered by
        category and severity level within each category.
      </p><p>
        In the event descriptions, GCP and LCP mean “<span class="quote">Global
        Checkpoint</span>” and “<span class="quote">Local Checkpoint</span>”,
        respectively.
      </p><a class="indexterm" name="id2350841"></a><a class="indexterm" name="id2350853"></a><a class="indexterm" name="id2350862"></a><a class="indexterm" name="id2350875"></a><p>
        <span class="bold"><strong><code class="literal">CONNECTION</code>
        Events</strong></span>
      </p><p>
        These events are associated with connections between Cluster
        nodes.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Event</strong></span></td><td><span class="bold"><strong>Priority</strong></span></td><td><span class="bold"><strong>Severity Level</strong></span></td><td><span class="bold"><strong>Description</strong></span></td></tr><tr><td>data nodes connected</td><td>8</td><td><code class="literal">INFO</code></td><td>Data nodes connected</td></tr><tr><td>data nodes disconnected</td><td>8</td><td><code class="literal">INFO</code></td><td>Data nodes disconnected</td></tr><tr><td>Communication closed</td><td>8</td><td><code class="literal">INFO</code></td><td>SQL node or data node connection closed</td></tr><tr><td>Communication opened</td><td>8</td><td><code class="literal">INFO</code></td><td>SQL node or data node connection opened</td></tr></tbody></table></div><p>
        <span class="bold"><strong><code class="literal">CHECKPOINT</code>
        Events</strong></span>
      </p><a class="indexterm" name="id2351055"></a><a class="indexterm" name="id2351067"></a><p>
        The logging messages shown here are associated with checkpoints.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Event</strong></span></td><td><span class="bold"><strong>Priority</strong></span></td><td><span class="bold"><strong>Severity Level</strong></span></td><td><span class="bold"><strong>Description</strong></span></td></tr><tr><td>LCP stopped in calc keep GCI</td><td>0</td><td><code class="literal">ALERT</code></td><td>LCP stopped</td></tr><tr><td>Local checkpoint fragment completed</td><td>11</td><td><code class="literal">INFO</code></td><td>LCP on a fragment has been completed</td></tr><tr><td>Global checkpoint completed</td><td>10</td><td><code class="literal">INFO</code></td><td>GCP finished</td></tr><tr><td>Global checkpoint started</td><td>9</td><td><code class="literal">INFO</code></td><td>Start of GCP: REDO log is written to disk</td></tr><tr><td>Local checkpoint completed</td><td>8</td><td><code class="literal">INFO</code></td><td>LCP completed normally</td></tr><tr><td>Local checkpoint started</td><td>7</td><td><code class="literal">INFO</code></td><td>Start of LCP: data written to disk</td></tr></tbody></table></div><p>
        <span class="bold"><strong><code class="literal">STARTUP</code>
        Events</strong></span>
      </p><a class="indexterm" name="id2351274"></a><a class="indexterm" name="id2351287"></a><p>
        The following events are generated in response to the startup of
        a node or of the cluster and of its success or failure. They
        also provide information relating to the progress of the startup
        process, including information concerning logging activities.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Event</strong></span></td><td><span class="bold"><strong>Priority</strong></span></td><td><span class="bold"><strong>Severity Level</strong></span></td><td><span class="bold"><strong>Description</strong></span></td></tr><tr><td>Internal start signal received STTORRY</td><td>15</td><td><code class="literal">INFO</code></td><td>Blocks received after completion of restart</td></tr><tr><td>New REDO log started</td><td>10</td><td><code class="literal">INFO</code></td><td>GCI keep <em class="replaceable"><code>X</code></em>, newest restorable GCI
                <em class="replaceable"><code>Y</code></em></td></tr><tr><td>New log started</td><td>10</td><td><code class="literal">INFO</code></td><td>Log part <em class="replaceable"><code>X</code></em>, start MB
                <em class="replaceable"><code>Y</code></em>, stop MB
                <em class="replaceable"><code>Z</code></em></td></tr><tr><td>Node has been refused for inclusion in the cluster</td><td>8</td><td><code class="literal">INFO</code></td><td>Node cannot be included in cluster due to misconfiguration, inability to
                establish communication, or other problem</td></tr><tr><td>data node neighbors</td><td>8</td><td><code class="literal">INFO</code></td><td>Shows neighboring data nodes</td></tr><tr><td>data node start phase <em class="replaceable"><code>X</code></em> completed</td><td>4</td><td><code class="literal">INFO</code></td><td>A data node start phase has been completed</td></tr><tr><td>Node has been successfully included into the cluster</td><td>3</td><td><code class="literal">INFO</code></td><td>Displays the node, managing node, and dynamic ID</td></tr><tr><td>data node start phases initiated</td><td>1</td><td><code class="literal">INFO</code></td><td>NDB Cluster nodes starting</td></tr><tr><td>data node all start phases completed</td><td>1</td><td><code class="literal">INFO</code></td><td>NDB Cluster nodes started</td></tr><tr><td>data node shutdown initiated</td><td>1</td><td><code class="literal">INFO</code></td><td>Shutdown of data node has commenced</td></tr><tr><td>data node shutdown aborted</td><td>1</td><td><code class="literal">INFO</code></td><td>Unable to shut down data node normally</td></tr></tbody></table></div><p>
        <span class="bold"><strong><code class="literal">NODERESTART</code>
        Events</strong></span>
      </p><a class="indexterm" name="id2351617"></a><a class="indexterm" name="id2351630"></a><p>
        The following events are generated when restarting a node and
        relate to the success or failure of the node restart process.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Event</strong></span></td><td><span class="bold"><strong>Priority</strong></span></td><td><span class="bold"><strong>Severity Level</strong></span></td><td><span class="bold"><strong>Description</strong></span></td></tr><tr><td>Node failure phase completed</td><td>8</td><td><code class="literal">ALERT</code></td><td>Reports completion of node failure phases</td></tr><tr><td>Node has failed, node state was <em class="replaceable"><code>X</code></em></td><td>8</td><td><code class="literal">ALERT</code></td><td>Reports that a node has failed</td></tr><tr><td>Report arbitrator results</td><td>2</td><td><code class="literal">ALERT</code></td><td>There are eight different possible results for arbitration attempts:

                <div class="itemizedlist"><ul type="disc"><li><p>
                      Arbitration check failed — less than 1/2
                      nodes left
                    </p></li><li><p>
                      Arbitration check succeeded — node group
                      majority
                    </p></li><li><p>
                      Arbitration check failed — missing node
                      group
                    </p></li><li><p>
                      Network partitioning — arbitration required
                    </p></li><li><p>
                      Arbitration succeeded — affirmative response
                      from node <em class="replaceable"><code>X</code></em>
                    </p></li><li><p>
                      Arbitration failed - negative response from node
                      <em class="replaceable"><code>X</code></em>
                    </p></li><li><p>
                      Network partitioning - no arbitrator available
                    </p></li><li><p>
                      Network partitioning - no arbitrator configured
                    </p></li></ul></div></td></tr><tr><td>Completed copying a fragment</td><td>10</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>Completed copying of dictionary information</td><td>8</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>Completed copying distribution information</td><td>8</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>Starting to copy fragments</td><td>8</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>Completed copying all fragments</td><td>8</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>GCP takeover started</td><td>7</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>GCP takeover completed</td><td>7</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>LCP takeover started</td><td>7</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>LCP takeover completed (state = <em class="replaceable"><code>X</code></em>)</td><td>7</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>Report whether an arbitrator is found or not</td><td>6</td><td><code class="literal">INFO</code></td><td>There are seven different possible outcomes when seeking an arbitrator:

                <div class="itemizedlist"><ul type="disc"><li><p>
                      Management server restarts arbitration thread
                      [state=<em class="replaceable"><code>X</code></em>]
                    </p></li><li><p>
                      Prepare arbitrator node
                      <em class="replaceable"><code>X</code></em>
                      [ticket=<em class="replaceable"><code>Y</code></em>]
                    </p></li><li><p>
                      Receive arbitrator node
                      <em class="replaceable"><code>X</code></em>
                      [ticket=<em class="replaceable"><code>Y</code></em>]
                    </p></li><li><p>
                      Started arbitrator node
                      <em class="replaceable"><code>X</code></em>
                      [ticket=<em class="replaceable"><code>Y</code></em>]
                    </p></li><li><p>
                      Lost arbitrator node <em class="replaceable"><code>X</code></em>
                      - process failure
                      [state=<em class="replaceable"><code>Y</code></em>]
                    </p></li><li><p>
                      Lost arbitrator node <em class="replaceable"><code>X</code></em>
                      - process exit
                      [state=<em class="replaceable"><code>Y</code></em>]
                    </p></li><li><p>
                      Lost arbitrator node <em class="replaceable"><code>X</code></em>
                      &lt;error msg&gt;
                      [state=<em class="replaceable"><code>Y</code></em>]
                    </p></li></ul></div></td></tr></tbody></table></div><p>
        <span class="bold"><strong><code class="literal">STATISTICS</code>
        Events</strong></span>
      </p><a class="indexterm" name="id2352145"></a><a class="indexterm" name="id2352158"></a><p>
        The following events are of a statistical nature. They provide
        information such as numbers of transactions and other
        operations, amount of data sent or received by individual nodes,
        and memory usage.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Event</strong></span></td><td><span class="bold"><strong>Priority</strong></span></td><td><span class="bold"><strong>Severity Level</strong></span></td><td><span class="bold"><strong>Description</strong></span></td></tr><tr><td>Report job scheduling statistics</td><td>9</td><td><code class="literal">INFO</code></td><td>Mean internal job scheduling statistics</td></tr><tr><td>Sent number of bytes</td><td>9</td><td><code class="literal">INFO</code></td><td>Mean number of bytes sent to node <em class="replaceable"><code>X</code></em></td></tr><tr><td>Received # of bytes</td><td>9</td><td><code class="literal">INFO</code></td><td>Mean number of bytes received from node <em class="replaceable"><code>X</code></em></td></tr><tr><td>Report transaction statistics</td><td>8</td><td><code class="literal">INFO</code></td><td>Numbers of: transactions, commits, reads, simple reads, writes,
                concurrent operations, attribute information, and aborts</td></tr><tr><td>Report operations</td><td>8</td><td><code class="literal">INFO</code></td><td>Number of operations</td></tr><tr><td>Report table create</td><td>7</td><td><code class="literal">INFO</code></td><td> </td></tr><tr><td>Memory usage</td><td>5</td><td><code class="literal">INFO</code></td><td>Data and index memory usage (80%, 90%, and 100%)</td></tr></tbody></table></div><p>
        <span class="bold"><strong><code class="literal">ERROR</code> Events</strong></span>
      </p><a class="indexterm" name="id2352390"></a><a class="indexterm" name="id2352402"></a><p>
        These events relate to Cluster errors and warnings. The presence
        of one or more of these generally indicates that a major
        malfunction or failure has occurred.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Event</strong></span></td><td><span class="bold"><strong>Priority</strong></span></td><td><span class="bold"><strong>Severity</strong></span></td><td><span class="bold"><strong>Description</strong></span></td></tr><tr><td>Dead due to missed heartbeat</td><td>8</td><td><code class="literal">ALERT</code></td><td>Node <em class="replaceable"><code>X</code></em> declared “<span class="quote">dead</span>” due to
                missed heartbeat</td></tr><tr><td>Transporter errors</td><td>2</td><td>ERROR</td><td> </td></tr><tr><td>Transporter warnings</td><td>8</td><td><code class="literal">WARNING</code></td><td> </td></tr><tr><td>Missed heartbeats</td><td>8</td><td><code class="literal">WARNING</code></td><td>Node <em class="replaceable"><code>X</code></em> missed heartbeat
                #<em class="replaceable"><code>Y</code></em></td></tr><tr><td>General warning events</td><td>2</td><td><code class="literal">WARNING</code></td><td> </td></tr></tbody></table></div><p>
        <span class="bold"><strong><code class="literal">INFO</code> Events</strong></span>
      </p><a class="indexterm" name="id2352595"></a><a class="indexterm" name="id2352608"></a><p>
        These events provide general information about the state of the
        cluster and activities associated with Cluster maintenance, such
        as logging and heartbeat transmission.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Event</strong></span></td><td><span class="bold"><strong>Priority</strong></span></td><td><span class="bold"><strong>Severity</strong></span></td><td><span class="bold"><strong>Description</strong></span></td></tr><tr><td>Sent heartbeat</td><td>12</td><td><code class="literal">INFO</code></td><td>Heartbeat sent to node <em class="replaceable"><code>X</code></em></td></tr><tr><td>Create log bytes</td><td>11</td><td><code class="literal">INFO</code></td><td>Log part, log file, MB</td></tr><tr><td>General information events</td><td>2</td><td><code class="literal">INFO</code></td><td> </td></tr></tbody></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-log-statistics"></a>20.7.3.3. Using <code class="literal">CLUSTERLOG STATISTICS</code></h4></div></div></div><a class="indexterm" name="id2352755"></a><a class="indexterm" name="id2352768"></a><a class="indexterm" name="id2352777"></a><a class="indexterm" name="id2352789"></a><a class="indexterm" name="id2352802"></a><a class="indexterm" name="id2352814"></a><p>
        The <code class="literal">NDB</code> management client's
        <code class="literal">CLUSTERLOG STATISTICS</code> command can provide a
        number of useful statistics in its output. The following
        statistics are reported by the transaction coordinator:
      </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Statistic</strong></span></td><td><span class="bold"><strong>Description (<span class="emphasis"><em>Number
                of...</em></span>)</strong></span></td></tr><tr><td><code class="literal">Trans. Count</code></td><td>Transactions attempted with this node as coordinator</td></tr><tr><td><code class="literal">Commit Count</code></td><td>Transactions committed with this node as coordinator</td></tr><tr><td><code class="literal">Read Count</code></td><td>Primary key reads (all)</td></tr><tr><td><code class="literal">Simple Read Count</code></td><td>Primary key reads reading the latest committed value</td></tr><tr><td><code class="literal">Write Count</code></td><td>Primary key writes (includes all <code class="literal">INSERT</code>,
                <code class="literal">UPDATE</code>, and <code class="literal">DELETE</code>
                operations)</td></tr><tr><td><code class="literal">AttrInfoCount</code></td><td>Data words used to describe all reads and writes received</td></tr><tr><td><code class="literal">Concurrent Operations</code></td><td>All concurrent operations ongoing at the moment the report is taken</td></tr><tr><td><code class="literal">Abort Count</code></td><td>Transactions with this node as coordinator that were aborted</td></tr><tr><td><code class="literal">Scans</code></td><td>Scans (all)</td></tr><tr><td><code class="literal">Range Scans</code></td><td>Index scans</td></tr></tbody></table></div><p>
        The <span><strong class="command">ndbd</strong></span> process has a scheduler that runs in
        an infinite loop. During each loop scheduler performs the
        following tasks:
      </p><a class="indexterm" name="id2353049"></a><div class="orderedlist"><ol type="1"><li><p>
            Read any incoming messages from sockets into a job buffer.
          </p></li><li><p>
            Check whether there are any timed messages to be executed;
            if so, put these into the job buffer as well.
          </p></li><li><p>
            Execute (in a loop) any messages in the job buffer.
          </p></li><li><p>
            Send any distributed messages that were generated by
            executing the messages in the job buffer.
          </p></li><li><p>
            Wait for any new incoming messages.
          </p></li></ol></div><p>
        The number of loops executed in the third step is reported as
        the <code class="literal">Mean Loop Counter</code>. This statistic
        increases in size as the utilisation of the TCP/IP buffer
        improves. You can use this to monitor performance as you add new
        processes to the cluster.
      </p><p>
        The <code class="literal">Mean send size</code> and <code class="literal">Mean receive
        size</code> statistics allow you to gauge the efficiency of
        writes and reads (respectively) between nodes. These values are
        given in bytes. Higher values mean a lower cost per byte sent or
        received; the maximum is 64k.
      </p><p>
        To cause all cluster log statistics to be logged, you can use
        the following command in the <code class="literal">NDB</code> management
        client:
      </p><pre class="programlisting">ndb_mgm&gt; <strong class="userinput"><code>ALL CLUSTERLOG STATISTICS=15</code></strong>
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          Setting the threshold for <code class="literal">STATISTICS</code> to 15
          causes the cluster log to become very verbose, and to gow
          quite rapidly in size, in direct proportion to the number of
          cluster nodes and the amount of activity on the cluster.
        </p></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-logs-ndb-messages"></a>20.7.4. <code class="literal">NDB</code> Log Messages</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-logs-cluster-log">20.7.4.1. Messages in the Cluster Log</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-ndb-transporter-errors">20.7.4.2. <code class="literal">NDB</code> Transporter Errors</a></span></dt></dl></div><p>
      This section contains information about the messages written to
      the cluster log in response to different cluster log events. It
      provides additional, more specific information on
      <code class="literal">NDB</code> transporter errors.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-logs-cluster-log"></a>20.7.4.1. Messages in the Cluster Log</h4></div></div></div><p>
        The following table lists the most common <code class="literal">NDB</code>
        cluster log messages. For information about the cluster log, log
        events, and event types, see
        <a href="mysql-cluster.html#mysql-cluster-event-reports" title="20.7.3. Event Reports Generated in MySQL Cluster">Section 20.7.3, “Event Reports Generated in MySQL Cluster”</a>. These log
        messages also correspond to log event types in the MGM API; see
        <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-logevent-type.html" target="_top">The <code class="literal">Ndb_logevent_type</code> Type</a>, for related information of
        interest to Cluster API developers.
      </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node
                    <em class="replaceable"><code>mgm_node_id</code></em>: Node
                    <em class="replaceable"><code>data_node_id</code></em>
                    Connected</code>
                  </p>

                <p><b>Description. </b>
                    The data node having node ID
                    <em class="replaceable"><code>node_id</code></em> has connected to
                    the management server (node
                    <em class="replaceable"><code>mgm_node_id</code></em>).
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">Connected</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Connection</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node
                    <em class="replaceable"><code>mgm_node_id</code></em>: Node
                    <em class="replaceable"><code>data_node_id</code></em>
                    Disconnected</code>
                  </p>

                <p><b>Description. </b>
                    The data node having node ID
                    <em class="replaceable"><code>data_node_id</code></em> has
                    disconnected from the management server (node
                    <em class="replaceable"><code>mgm_node_id</code></em>).
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">Disconnected</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Connection</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ALERT</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node
                    <em class="replaceable"><code>data_node_id</code></em>:
                    Communication to Node
                    <em class="replaceable"><code>api_node_id</code></em>
                    closed</code>
                  </p>

                <p><b>Description. </b>
                    The API node or SQL node having node ID
                    <em class="replaceable"><code>api_node_id</code></em> is no longer
                    communicating with data node
                    <em class="replaceable"><code>data_node_id</code></em>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">CommunicationClosed</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Connection</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node
                    <em class="replaceable"><code>data_node_id</code></em>:
                    Communication to Node
                    <em class="replaceable"><code>api_node_id</code></em>
                    opened</code>
                  </p>

                <p><b>Description. </b>
                    The API node or SQL node having node ID
                    <em class="replaceable"><code>api_node_id</code></em> is now
                    communicating with data node
                    <em class="replaceable"><code>data_node_id</code></em>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">CommunicationOpened</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Connection</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node
                    <em class="replaceable"><code>mgm_node_id</code></em>: Node
                    <em class="replaceable"><code>api_node_id</code></em>: API
                    <em class="replaceable"><code>version</code></em></code>
                  </p>

                <p><b>Description. </b>
                    The API node having node ID
                    <em class="replaceable"><code>api_node_id</code></em> has connected
                    to management node
                    <em class="replaceable"><code>mgm_node_id</code></em> using
                    <code class="literal">NDB</code> API version
                    <em class="replaceable"><code>version</code></em> (generally the
                    same as the MySQL version number).
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">ConnectedApiVersion</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Connection</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Global checkpoint <em class="replaceable"><code>gci</code></em>
                    started</code>
                  </p>

                <p><b>Description. </b>
                    A global checkpoint with the ID
                    <em class="replaceable"><code>gci</code></em> has been started;
                    node <em class="replaceable"><code>node_id</code></em> is the
                    master responsible for this global checkpoint.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">GlobalCheckpointStarted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Checkpoint</code>
                  </p>

                <p><b>Priority. </b>
                    9
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Global checkpoint <em class="replaceable"><code>gci</code></em>
                    completed</code>
                  </p>

                <p><b>Description. </b>
                    The global checkpoint having the ID
                    <em class="replaceable"><code>gci</code></em> has been completed;
                    node <em class="replaceable"><code>node_id</code></em> was the
                    master responsible for this global checkpoint.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">GlobalCheckpointCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Checkpoint</code>
                  </p>

                <p><b>Priority. </b>
                    10
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Local checkpoint <em class="replaceable"><code>lcp</code></em>
                    started. Keep GCI =
                    <em class="replaceable"><code>current_gci</code></em> oldest
                    restorable GCI =
                    <em class="replaceable"><code>old_gci</code></em></code>
                  </p>

                <p><b>Description. </b>
                    The local checkpoint having sequence ID
                    <em class="replaceable"><code>lcp</code></em> has been started on
                    node <em class="replaceable"><code>node_id</code></em>. The most
                    recent GCI that can be used has the index
                    <em class="replaceable"><code>current_gci</code></em>, and the
                    oldest GCI from which the cluster can be restored
                    has the index <em class="replaceable"><code>old_gci</code></em>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">LocalCheckpointStarted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Checkpoint</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Local checkpoint <em class="replaceable"><code>lcp</code></em>
                    completed</code>
                  </p>

                <p><b>Description. </b>
                    The local checkpoint having sequence ID
                    <em class="replaceable"><code>lcp</code></em> on node
                    <em class="replaceable"><code>node_id</code></em> has been
                    completed.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">LocalCheckpointCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Checkpoint</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Local Checkpoint stopped in
                    CALCULATED_KEEP_GCI</code>
                  </p>

                <p><b>Description. </b>
                    The node was unable to determine the most recent
                    usable GCI.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">LCPStoppedInCalcKeepGci</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Checkpoint</code>
                  </p>

                <p><b>Priority. </b>
                    0
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ALERT</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Table ID = <em class="replaceable"><code>table_id</code></em>,
                    fragment <em class="replaceable"><code>ID = fragment_id</code></em>
                    has completed LCP on Node
                    <em class="replaceable"><code>node_id</code></em> maxGciStarted:
                    <em class="replaceable"><code>started_gci</code></em>
                    maxGciCompleted:
                    <em class="replaceable"><code>completed_gci</code></em></code>
                  </p>

                <p><b>Description. </b>
                    A table fragment has been checkpointed to disk on
                    node <em class="replaceable"><code>node_id</code></em>. The GCI in
                    progress has the index
                    <em class="replaceable"><code>started_gci</code></em>, and the most
                    recent GCI to have been completed has the index
                    <em class="replaceable"><code>completed_gci</code></em>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">LCPFragmentCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Checkpoint</code>
                  </p>

                <p><b>Priority. </b>
                    11
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    ACC Blocked <em class="replaceable"><code>num_1</code></em> and TUP
                    Blocked <em class="replaceable"><code>num_2</code></em> times last
                    second</code>
                  </p>

                <p><b>Description. </b>
                    Undo logging is blocked because the log buffer is
                    close to overflowing.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">UndoLogBlocked</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Checkpoint</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Start initiated
                    <em class="replaceable"><code>version</code></em></code>
                  </p>

                <p><b>Description. </b>
                    Data node <em class="replaceable"><code>node_id</code></em>,
                    running <code class="literal">NDB</code> version
                    <em class="replaceable"><code>version</code></em>, is beginning its
                    startup process.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NDBStartStarted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    1
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Started <em class="replaceable"><code>version</code></em></code>
                  </p>

                <p><b>Description. </b>
                    Data node <em class="replaceable"><code>node_id</code></em>,
                    running <code class="literal">NDB</code> version
                    <em class="replaceable"><code>version</code></em>, has started
                    successfully.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NDBStartCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    1
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    STTORRY received after restart finished</code>
                  </p>

                <p><b>Description. </b>
                    The node has received a signal indicating that a
                    cluster restart has completed.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">STTORRYRecieved</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    15
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Start phase <em class="replaceable"><code>phase</code></em>
                    completed
                    (<em class="replaceable"><code>type</code></em>)</code>
                  </p>

                <p><b>Description. </b>
                    The node has completed start phase
                    <em class="replaceable"><code>phase</code></em> of a
                    <em class="replaceable"><code>type</code></em> start. For a listing
                    of start phases, see
                    <a href="mysql-cluster.html#mysql-cluster-start-phases" title="20.7.1. Summary of MySQL Cluster Start Phases">Section 20.7.1, “Summary of MySQL Cluster Start Phases”</a>.
                    (<em class="replaceable"><code>type</code></em> is one of
                    <code class="literal">initial</code>,
                    <code class="literal">system</code>, <code class="literal">node</code>,
                    <code class="literal">initial node</code>, or
                    <code class="literal">&lt;Unknown&gt;</code>.)
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">StartPhaseCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    4
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    CM_REGCONF president =
                    <em class="replaceable"><code>president_id</code></em>, own Node =
                    <em class="replaceable"><code>own_id</code></em>, our dynamic id =
                    <em class="replaceable"><code>dynamic_id</code></em></code>
                  </p>

                <p><b>Description. </b>
                    Node <em class="replaceable"><code>president_id</code></em> has
                    been selected as “<span class="quote">president</span>”.
                    <em class="replaceable"><code>own_id</code></em> and
                    <em class="replaceable"><code>dynamic_id</code></em> should always
                    be the same as the ID
                    (<em class="replaceable"><code>node_id</code></em>) of the
                    reporting node.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">CM_REGCONF</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    3
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    CM_REGREF from Node
                    <em class="replaceable"><code>president_id</code></em> to our Node
                    <em class="replaceable"><code>node_id</code></em>. Cause =
                    <em class="replaceable"><code>cause</code></em></code>
                  </p>

                <p><b>Description. </b>
                    The reporting node (ID
                    <em class="replaceable"><code>node_id</code></em>) was unable to
                    accept node <em class="replaceable"><code>president_id</code></em>
                    as president. The <em class="replaceable"><code>cause</code></em>
                    of the problem is given as one of
                    <code class="literal">Busy</code>, <code class="literal">Election with wait
                    = false</code>, <code class="literal">Not president</code>,
                    <code class="literal">Election without selecting new
                    candidate</code>, or <code class="literal">No such
                    cause</code>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">CM_REGREF</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>: We
                    are Node <em class="replaceable"><code>own_id</code></em> with
                    dynamic ID <em class="replaceable"><code>dynamic_id</code></em>,
                    our left neighbour is Node
                    <em class="replaceable"><code>id_1</code></em>, our right is Node
                    <em class="replaceable"><code>id_2</code></em></code>
                  </p>

                <p><b>Description. </b>
                    The node has discovered its neighboring nodes in the
                    cluster (node <em class="replaceable"><code>id_1</code></em> and
                    node <em class="replaceable"><code>id_2</code></em>).
                    <em class="replaceable"><code>node_id</code></em>,
                    <em class="replaceable"><code>own_id</code></em>, and
                    <em class="replaceable"><code>dynamic_id</code></em> should always
                    be the same; if they are not, this indicates a
                    serious misconfiguration of the cluster nodes.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">FIND_NEIGHBOURS</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    <em class="replaceable"><code>type</code></em> shutdown
                    initiated</code>
                  </p>

                <p><b>Description. </b>
                    The node has received a shutdown signal. The
                    <em class="replaceable"><code>type</code></em> of shutdown is
                    either <code class="literal">Cluster</code> or
                    <code class="literal">Node</code>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NDBStopStarted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    1
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Node shutdown completed </code>[<code class="literal">,
                    <em class="replaceable"><code>action</code></em></code>]
                    [<code class="literal">Initiated by signal
                    <em class="replaceable"><code>signal</code></em>.</code>]
                  </p>

                <p><b>Description. </b>
                    The node has been shut down. This report may include
                    an <em class="replaceable"><code>action</code></em>, which if
                    present is one of <code class="literal">restarting</code>,
                    <code class="literal">no start</code>, or
                    <code class="literal">initial</code>. The report may also
                    include a reference to an <code class="literal">NDB</code>
                    Protocol <em class="replaceable"><code>signal</code></em>; for
                    possible signals, refer to
                    <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-ndb-protocol-operations-signals.html" target="_top">Operations and Signals</a>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NDBStopCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    1
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Forced node shutdown completed </code>[<code class="literal">,
                    action</code>]<code class="literal">.</code>
                    [<code class="literal">Occured during startphase
                    <em class="replaceable"><code>start_phase</code></em>.</code>]
                    [<code class="literal"> Initiated by
                    <em class="replaceable"><code>signal</code></em>.</code>]
                    [<code class="literal">Caused by error
                    <em class="replaceable"><code>error_code</code></em>:
                    '<em class="replaceable"><code>error_message</code></em>(<em class="replaceable"><code>error_classification</code></em>).
                    <em class="replaceable"><code>error_status</code></em>'.</code>
                    [<code class="literal">(extra info
                    <em class="replaceable"><code>extra_code</code></em>)</code>]]
                  </p>

                <p><b>Description. </b>
                    The node has been forcibly shut down. The
                    <em class="replaceable"><code>action</code></em> (one of
                    <code class="literal">restarting</code>, <code class="literal">no
                    start</code>, or <code class="literal">initial</code>)
                    subsequently being taken, if any, is also reported.
                    If the shutdown occurred while the node was
                    starting, the report includes the
                    <em class="replaceable"><code>start_phase</code></em> during which
                    the node failed. If this was a result of a
                    <em class="replaceable"><code>signal</code></em> sent to the node,
                    this information is also provided (see
                    <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-ndb-protocol-operations-signals.html" target="_top">Operations and Signals</a>,
                    for more information). If the error causing the
                    failure is known, this is also included; for more
                    information about <code class="literal">NDB</code> error
                    messages and classifications, see
                    <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-errors.html" target="_top"><code class="literal">NDB</code> Errors</a>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NDBStopForced</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    1
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ALERT</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Node shutdown aborted</code>
                  </p>

                <p><b>Description. </b>
                    The node shutdown process was aborted by the user.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NDBStopAborted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    1
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    StartLog: [GCI Keep:
                    <em class="replaceable"><code>keep_pos</code></em> LastCompleted:
                    <em class="replaceable"><code>last_pos</code></em>
                    NewestRestorable:
                    <em class="replaceable"><code>restore_pos</code></em>]</code>
                  </p>

                <p><b>Description. </b>
                    This reports global checkpoints referenced during a
                    node start. The redo log prior to
                    <em class="replaceable"><code>keep_pos</code></em> is dropped.
                    <em class="replaceable"><code>last_pos</code></em> is the last
                    global checkpoint in which data node the
                    participated; <em class="replaceable"><code>restore_pos</code></em>
                    is the global checkpoint which is actually used to
                    restore all data nodes.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">StartREDOLog</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    4
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <em class="replaceable"><code>startup_message</code></em>
                    [<span class="emphasis"><em>Listed separately; see below.</em></span>]
                  </p>

                <p><b>Description. </b>
                    There are a number of possible startup messages that
                    can be logged under different circumstances.

                    

                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">StartReport</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">StartUp</code>
                  </p>

                <p><b>Priority. </b>
                    4
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Node restart completed copy of dictionary
                    information</code>
                  </p>

                <p><b>Description. </b>
                    Copying of data dictionary information to the
                    restarted node has been completed.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NR_CopyDict</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Node restart completed copy of distribution
                    information</code>
                  </p>

                <p><b>Description. </b>
                    Copying of data distribution information to the
                    restarted node has been completed.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NR_CopyDistr</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Node restart starting to copy the fragments to Node
                    <em class="replaceable"><code>node_id</code></em></code>
                  </p>

                <p><b>Description. </b>
                    Copy of fragments to starting data node
                    <em class="replaceable"><code>node_id</code></em> has begun
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NR_CopyFragsStarted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Table ID = <em class="replaceable"><code>table_id</code></em>,
                    fragment ID = <em class="replaceable"><code>fragment_id</code></em>
                    have been copied to Node
                    <em class="replaceable"><code>node_id</code></em></code>
                  </p>

                <p><b>Description. </b>
                    Fragment <em class="replaceable"><code>fragment_id</code></em> from
                    table <em class="replaceable"><code>table_id</code></em> has been
                    copied to data node
                    <em class="replaceable"><code>node_id</code></em>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NR_CopyFragDone</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    10
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Node restart completed copying the fragments to Node
                    <em class="replaceable"><code>node_id</code></em></code>
                  </p>

                <p><b>Description. </b>
                    Copying of all table fragments to restarting data
                    node <em class="replaceable"><code>node_id</code></em> has been
                    completed
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NR_CopyFragsCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    Any of the following:

                    </p><div class="orderedlist"><ol type="1"><li><p>
                          <code class="literal">Node
                          <em class="replaceable"><code>node_id</code></em>: Node
                          <em class="replaceable"><code>node1_id</code></em> completed
                          failure of Node
                          <em class="replaceable"><code>node2_id</code></em></code>
                        </p></li><li><p>
                          <code class="literal">All nodes completed failure of Node
                          <em class="replaceable"><code>node_id</code></em></code>
                        </p></li><li><p>
                          <code class="literal">Node failure of
                          <em class="replaceable"><code>node_id</code></em><em class="replaceable"><code>block</code></em>
                          completed</code>
                        </p></li></ol></div><p>
                  </p>

                <p><b>Description. </b>
                    One of the following (each corresponding to the
                    same-numbered message listed above):

                    </p><div class="orderedlist"><ol type="1"><li><p>
                          Data node <em class="replaceable"><code>node1_id</code></em>
                          has detected the failure of data node
                          <em class="replaceable"><code>node2_id</code></em>
                        </p></li><li><p>
                          All (remaining) data nodes have detected the
                          failure of data node
                          <em class="replaceable"><code>node_id</code></em>
                        </p></li><li><p>
                          The failure of data node
                          <em class="replaceable"><code>node_id</code></em> has been
                          detected in the
                          <em class="replaceable"><code>block</code></em><code class="literal">NDB</code>
                          kernel block, where block is 1 of
                          <code class="literal">DBTC</code>,
                          <code class="literal">DBDICT</code>,
                          <code class="literal">DBDIH</code>, or
                          <code class="literal">DBLQH</code>; for more
                          information, see
                          <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-kernel-blocks.html" target="_top"><code class="literal">NDB</code> Kernel Blocks</a>
                        </p></li></ol></div><p>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NodeFailCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ALERT</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node
                    <em class="replaceable"><code>mgm_node_id</code></em>: Node
                    <em class="replaceable"><code>data_node_id</code></em> has failed.
                    The Node state at failure was
                    <em class="replaceable"><code>state_code</code></em></code>
                  </p>

                <p><b>Description. </b>
                    A data node has failed. Its state at the time of
                    failure is described by an arbitration state code
                    <em class="replaceable"><code>state_code</code></em>: possible
                    state code values can be found in the file
                    <code class="filename">include/kernel/signaldata/ArbitSignalData.hpp</code>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">NODE_FAILREP</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ALERT</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">President restarts arbitration thread
                    [state=<em class="replaceable"><code>state_code</code></em>]</code>
                    or <code class="literal">Prepare arbitrator node
                    <em class="replaceable"><code>node_id</code></em>
                    [ticket=<em class="replaceable"><code>ticket_id</code></em>]</code>
                    or <code class="literal">Receive arbitrator node
                    <em class="replaceable"><code>node_id</code></em>
                    [ticket=<em class="replaceable"><code>ticket_id</code></em>]</code>
                    or <code class="literal">Started arbitrator node
                    <em class="replaceable"><code>node_id</code></em>
                    [ticket=<em class="replaceable"><code>ticket_id</code></em>]</code>
                    or <code class="literal">Lost arbitrator node
                    <em class="replaceable"><code>node_id</code></em> - process failure
                    [state=<em class="replaceable"><code>state_code</code></em>]</code>
                    or <code class="literal">Lost arbitrator node
                    <em class="replaceable"><code>node_id</code></em> - process exit
                    [state=<em class="replaceable"><code>state_code</code></em>]</code>
                    or <code class="literal">Lost arbitrator node
                    <em class="replaceable"><code>node_id</code></em> -
                    <em class="replaceable"><code>error_message</code></em>
                    [state=<em class="replaceable"><code>state_code</code></em>]</code>
                  </p>

                <p><b>Description. </b>
                    This is a report on the current state and progress
                    of arbitration in the cluster.
                    <em class="replaceable"><code>node_id</code></em> is the node ID of
                    the management node or SQL node selected as the
                    arbitrator. <em class="replaceable"><code>state_code</code></em> is
                    an arbitration state code, as found in
                    <code class="filename">include/kernel/signaldata/ArbitSignalData.hpp</code>.
                    When an error has occurred, an
                    <em class="replaceable"><code>error_message</code></em>, also
                    defined in <code class="filename">ArbitSignalData.hpp</code>,
                    is provided. <em class="replaceable"><code>ticket_id</code></em> is
                    a unique identifier handed out by the arbitrator
                    when it is selected to all the nodes that
                    participated in its selection; this is used to
                    insure that each node requesting arbitration was one
                    of the nodes that took part in the selection
                    process.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">ArbitState</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    6
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Arbitration check lost - less than 1/2
                    nodes left</code> or <code class="literal">Arbitration check
                    won - all node groups and more than 1/2 nodes
                    left</code> or <code class="literal">Arbitration check won -
                    node group majority</code> or
                    <code class="literal">Arbitration check lost - missing node
                    group</code> or <code class="literal">Network partitioning -
                    arbitration required</code> or
                    <code class="literal">Arbitration won - positive reply from node
                    <em class="replaceable"><code>node_id</code></em></code> or
                    <code class="literal">Arbitration lost - negative reply from node
                    <em class="replaceable"><code>node_id</code></em></code> or
                    <code class="literal">Network partitioning - no arbitrator
                    available</code> or <code class="literal">Network partitioning
                    - no arbitrator configured</code> or
                    <code class="literal">Arbitration failure -
                    <em class="replaceable"><code>error_message</code></em>
                    [state=<em class="replaceable"><code>state_code</code></em>]</code>
                  </p>

                <p><b>Description. </b>
                    This message reports on the result of arbitration.
                    In the event of arbitration failure, an
                    <em class="replaceable"><code>error_message</code></em> and an
                    arbitration <em class="replaceable"><code>state_code</code></em>
                    are provided; definitions for both of these are
                    found in
                    <code class="filename">include/kernel/signaldata/ArbitSignalData.hpp</code>.
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">ArbitResult</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    2
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ALERT</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    GCP Take over started</code>
                  </p>

                <p><b>Description. </b>
                    This node is attempting to assume responsibility for
                    the next global checkpoint (that is, it is becoming
                    the master node)
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">GCP_TakeoverStarted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    GCP Take over completed</code>
                  </p>

                <p><b>Description. </b>
                    This node has become the master, and has assumed
                    responsibility for the next global checkpoint
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">GCP_TakeoverCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    LCP Take over started</code>
                  </p>

                <p><b>Description. </b>
                    This node is attempting to assume responsibility for
                    the next set of local checkpoints (that is, it is
                    becoming the master node)
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">LCP_TakeoverStarted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    LCP Take over completed</code>
                  </p>

                <p><b>Description. </b>
                    This node has become the master, and has assumed
                    responsibility for the next set of local checkpoints
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">LCP_TakeoverCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">NodeRestart</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Trans. Count =
                    <em class="replaceable"><code>transactions</code></em>, Commit
                    Count = <em class="replaceable"><code>commits</code></em>, Read
                    Count = <em class="replaceable"><code>reads</code></em>, Simple
                    Read Count =
                    <em class="replaceable"><code>simple_reads</code></em>, Write Count
                    = <em class="replaceable"><code>writes</code></em>, AttrInfo Count
                    = <em class="replaceable"><code>AttrInfo_objects</code></em>,
                    Concurrent Operations =
                    <em class="replaceable"><code>concurrent_operations</code></em>,
                    Abort Count = <em class="replaceable"><code>aborts</code></em>,
                    Scans = <em class="replaceable"><code>scans</code></em>, Range
                    scans =
                    <em class="replaceable"><code>range_scans</code></em></code>
                  </p>

                <p><b>Description. </b>
                    This report of transaction activity is given
                    approximately once every 10 seconds
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">TransReportCounters</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Statistic</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Operations=<em class="replaceable"><code>operations</code></em></code>
                  </p>

                <p><b>Description. </b>
                    Number of operations performed by this node,
                    provided approximately once every 10 seconds
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">OperationReportCounters</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Statistic</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Table with ID = <em class="replaceable"><code>table_id</code></em>
                    created</code>
                  </p>

                <p><b>Description. </b>
                    A table having the table ID shown has been created
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">TableCreated</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Statistic</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Mean loop Counter in doJob last 8192 times =
                    <em class="replaceable"><code>count</code></em></code>
                  </p>

                <p><b>Description. </b></p></td><td><p><b>Event Name. </b>
                    <code class="literal">JobStatistic</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Statistic</code>
                  </p>

                <p><b>Priority. </b>
                    9
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Mean send size to Node =
                    <em class="replaceable"><code>node_id</code></em> last 4096 sends =
                    <em class="replaceable"><code>bytes</code></em> bytes</code>
                  </p>

                <p><b>Description. </b>
                    This node is sending an average of
                    <em class="replaceable"><code>bytes</code></em> bytes per send to
                    node <em class="replaceable"><code>node_id</code></em>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">SendBytesStatistic</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Statistic</code>
                  </p>

                <p><b>Priority. </b>
                    9
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Mean receive size to Node =
                    <em class="replaceable"><code>node_id</code></em> last 4096 sends =
                    <em class="replaceable"><code>bytes</code></em> bytes</code>
                  </p>

                <p><b>Description. </b>
                    This node is receiving an average of
                    <em class="replaceable"><code>bytes</code></em> of data each time
                    it receives data from node
                    <em class="replaceable"><code>node_id</code></em>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">ReceiveBytesStatistic</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Statistic</code>
                  </p>

                <p><b>Priority. </b>
                    9
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Data usage is
                    <em class="replaceable"><code>data_memory_percentage</code></em>%
                    (<em class="replaceable"><code>data_pages_used</code></em> 32K
                    pages of total
                    <em class="replaceable"><code>data_pages_total</code></em>)</code>
                    / <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Index usage is
                    <em class="replaceable"><code>index_memory_percentage</code></em>%
                    (<em class="replaceable"><code>index_pages_used</code></em> 8K
                    pages of total
                    <em class="replaceable"><code>index_pages_total</code></em>)
                    </code>
                  </p>

                <p><b>Description. </b>
                    This report is generated when a <code class="literal">DUMP
                    1000</code> command is issued in the cluster
                    management client; for more information, see
                    <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-dump-command-1000.html" target="_top"><code class="literal">DUMP 1000</code></a>,
                    in <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals.html" target="_top">MySQL Cluster Internals</a>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">MemoryUsage</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Statistic</code>
                  </p>

                <p><b>Priority. </b>
                    5
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node1_id</code></em>:
                    Transporter to node
                    <em class="replaceable"><code>node2_id</code></em> reported error
                    <em class="replaceable"><code>error_code</code></em>:
                    <em class="replaceable"><code>error_message</code></em></code>
                  </p>

                <p><b>Description. </b>
                    A transporter error occurred while communicating
                    with node <em class="replaceable"><code>node2_id</code></em>; for a
                    listing of transporter error codes and messages, see
                    <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-transporter-errors.html" target="_top"><code class="literal">NDB</code> Transporter Errors</a>, in
                    <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals.html" target="_top">MySQL Cluster Internals</a>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">TransporterError</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Error</code>
                  </p>

                <p><b>Priority. </b>
                    2
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ERROR</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node1_id</code></em>:
                    Transporter to node
                    <em class="replaceable"><code>node2_id</code></em> reported error
                    <em class="replaceable"><code>error_code</code></em>:
                    <em class="replaceable"><code>error_message</code></em></code>
                  </p>

                <p><b>Description. </b>
                    A warning of a potential transporter problem while
                    communicating with node
                    <em class="replaceable"><code>node2_id</code></em>; for a listing
                    of transporter error codes and messages, see
                    <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-transporter-errors.html" target="_top"><code class="literal">NDB</code> Transporter Errors</a>, for more
                    information
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">TransporterWarning</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Error</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">WARNING</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node1_id</code></em>:
                    Node <em class="replaceable"><code>node2_id</code></em> missed
                    heartbeat
                    <em class="replaceable"><code>heartbeat_id</code></em></code>
                  </p>

                <p><b>Description. </b>
                    This node missed a heartbeat from node
                    <em class="replaceable"><code>node2_id</code></em>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">MissedHeartbeat</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Error</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">WARNING</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node1_id</code></em>:
                    Node <em class="replaceable"><code>node2_id</code></em> declared
                    dead due to missed heartbeat</code>
                  </p>

                <p><b>Description. </b>
                    This node has missed at least 3 heartbeats from node
                    <em class="replaceable"><code>node2_id</code></em>, and so has
                    declared that node “<span class="quote">dead</span>”
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">DeadDueToHeartbeat</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Error</code>
                  </p>

                <p><b>Priority. </b>
                    8
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ALERT</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node1_id</code></em>:
                    Node Sent Heartbeat to node =
                    <em class="replaceable"><code>node2_id</code></em></code>
                  </p>

                <p><b>Description. </b>
                    This node has sent a heartbeat to node
                    <em class="replaceable"><code>node2_id</code></em>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">SentHeartbeat</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Info</code>
                  </p>

                <p><b>Priority. </b>
                    12
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Event buffer status:
                    used=<em class="replaceable"><code>bytes_used</code></em>
                    (<em class="replaceable"><code>percent_used</code></em>%)
                    alloc=<em class="replaceable"><code>bytes_allocated</code></em>
                    (<em class="replaceable"><code>percent_available</code></em>%)
                    max=<em class="replaceable"><code>bytes_available</code></em>
                    apply_gci=<em class="replaceable"><code>latest_restorable_GCI</code></em>
                    latest_gci=<em class="replaceable"><code>latest_GCI</code></em></code>
                  </p>

                <p><b>Description. </b>
                    This report is seen during heavy event buffer usage,
                    for example, when many updates are being applied in
                    a relatively short period of time; the report shows
                    the number of bytes and the percentage of event
                    buffer memory used, the bytes allocated and
                    percentage still available, and the latest and
                    latest restorable global checkpoints
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">EventBufferStatus</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Info</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Entering single user mode</code>, <code class="literal">Node
                    <em class="replaceable"><code>node_id</code></em>: Entered single
                    user mode Node
                    <em class="replaceable"><code>API_node_id</code></em> has exclusive
                    access</code>, <code class="literal">Node
                    <em class="replaceable"><code>node_id</code></em>: Entering single
                    user mode</code>
                  </p>

                <p><b>Description. </b>
                    These reports are written to the cluster log when
                    entering and exiting single user mode;
                    <em class="replaceable"><code>API_node_id</code></em> is the node
                    ID of the API or SQL having exclusive access to the
                    cluster (fro mroe information, see
                    <a href="mysql-cluster.html#mysql-cluster-single-user-mode" title="20.7.5. Single User Mode">Section 20.7.5, “Single User Mode”</a>);
                    the message <code class="literal">Unknown single user report
                    <em class="replaceable"><code>API_node_id</code></em></code>
                    indicates an error has taken place and should never
                    be seen in normal operation
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">SingleUser</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Info</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Backup <em class="replaceable"><code>backup_id</code></em> started
                    from node
                    <em class="replaceable"><code>mgm_node_id</code></em></code>
                  </p>

                <p><b>Description. </b>
                    A backup has been started using the management node
                    having <em class="replaceable"><code>mgm_node_id</code></em>; this
                    message is also displayed in the cluster management
                    client when the <code class="literal">START BACKUP</code>
                    command is issued; for more information, see
                    <a href="mysql-cluster.html#mysql-cluster-backup-using-management-client" title="20.9.2. Using The Management Client to Create a Backup">Section 20.9.2, “Using The Management Client to Create a Backup”</a>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">BackupStarted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Backup</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Backup <em class="replaceable"><code>backup_id</code></em> started
                    from node <em class="replaceable"><code>mgm_node_id</code></em>
                    completed. StartGCP:
                    <em class="replaceable"><code>start_gcp</code></em> StopGCP:
                    <em class="replaceable"><code>stop_gcp</code></em> #Records:
                    <em class="replaceable"><code>records</code></em> #LogRecords:
                    <em class="replaceable"><code>log_records</code></em> Data:
                    <em class="replaceable"><code>data_bytes</code></em> bytes Log:
                    <em class="replaceable"><code>log_bytes</code></em> bytes</code>
                  </p>

                <p><b>Description. </b>
                    The backup having the ID
                    <em class="replaceable"><code>backup_id</code></em> has been
                    completed; for more information, see
                    <a href="mysql-cluster.html#mysql-cluster-backup-using-management-client" title="20.9.2. Using The Management Client to Create a Backup">Section 20.9.2, “Using The Management Client to Create a Backup”</a>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">BackupCompleted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Backup</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">INFO</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Backup request from
                    <em class="replaceable"><code>mgm_node_id</code></em> failed to
                    start. Error:
                    <em class="replaceable"><code>error_code</code></em></code>
                  </p>

                <p><b>Description. </b>
                    The backup failed to start; for error codes, see
                    <a href="http://dev.mysql.com/doc/ndbapi/en/mgm-errors.html" target="_top">MGM<code class="literal"></code> API Errors</a>
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">BackupFailedToStart</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Backup</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ALERT</code>
                  </p></td></tr><tr><td><p><b>Log Message. </b>
                    <code class="literal">Node <em class="replaceable"><code>node_id</code></em>:
                    Backup <em class="replaceable"><code>backup_id</code></em> started
                    from <em class="replaceable"><code>mgm_node_id</code></em> has been
                    aborted. Error:
                    <em class="replaceable"><code>error_code</code></em></code>
                  </p>

                <p><b>Description. </b>
                    The backup was terminated after starting, possibly
                    due to user intervention
                  </p></td><td><p><b>Event Name. </b>
                    <code class="literal">BackupAborted</code>
                  </p>

                <p><b>Event Type. </b>
                    <code class="literal">Backup</code>
                  </p>

                <p><b>Priority. </b>
                    7
                  </p>

                <p><b>Severity. </b>
                    <code class="literal">ALERT</code>
                  </p></td></tr></tbody></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-ndb-transporter-errors"></a>20.7.4.2. <code class="literal">NDB</code> Transporter Errors</h4></div></div></div><p>
        This section lists error codes, names, and messages that are
        written to the cluster log in the event of transporter errors.
      </p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Error Code</th><th>Error Name</th><th>Error Text</th></tr></thead><tbody><tr><td><span class="errorcode">0x00</span></td><td><span class="errorname">TE_NO_ERROR</span></td><td><span class="errortext">No error</span></td></tr><tr><td><span class="errorcode">0x01</span></td><td><span class="errorname">TE_ERROR_CLOSING_SOCKET</span></td><td><span class="errortext">Error found during closing of socket</span></td></tr><tr><td><span class="errorcode">0x02</span></td><td><span class="errorname">TE_ERROR_IN_SELECT_BEFORE_ACCEPT</span></td><td><span class="errortext">Error found before accept. The transporter will
                retry</span></td></tr><tr><td><span class="errorcode">0x03</span></td><td><span class="errorname">TE_INVALID_MESSAGE_LENGTH</span></td><td><span class="errortext">Error found in message (invalid message length)</span></td></tr><tr><td><span class="errorcode">0x04</span></td><td><span class="errorname">TE_INVALID_CHECKSUM</span></td><td><span class="errortext">Error found in message (checksum)</span></td></tr><tr><td><span class="errorcode">0x05</span></td><td><span class="errorname">TE_COULD_NOT_CREATE_SOCKET</span></td><td><span class="errortext">Error found while creating socket(can't create
                socket)</span></td></tr><tr><td><span class="errorcode">0x06</span></td><td><span class="errorname">TE_COULD_NOT_BIND_SOCKET</span></td><td><span class="errortext">Error found while binding server socket</span></td></tr><tr><td><span class="errorcode">0x07</span></td><td><span class="errorname">TE_LISTEN_FAILED</span></td><td><span class="errortext">Error found while listening to server socket</span></td></tr><tr><td><span class="errorcode">0x08</span></td><td><span class="errorname">TE_ACCEPT_RETURN_ERROR</span></td><td><span class="errortext">Error found during accept(accept return error)</span></td></tr><tr><td><span class="errorcode">0x0b</span></td><td><span class="errorname">TE_SHM_DISCONNECT</span></td><td><span class="errortext">The remote node has disconnected</span></td></tr><tr><td><span class="errorcode">0x0c</span></td><td><span class="errorname">TE_SHM_IPC_STAT</span></td><td><span class="errortext">Unable to check shm segment</span></td></tr><tr><td><span class="errorcode">0x0d</span></td><td><span class="errorname">TE_SHM_UNABLE_TO_CREATE_SEGMENT</span></td><td><span class="errortext">Unable to create shm segment</span></td></tr><tr><td><span class="errorcode">0x0e</span></td><td><span class="errorname">TE_SHM_UNABLE_TO_ATTACH_SEGMENT</span></td><td><span class="errortext">Unable to attach shm segment</span></td></tr><tr><td><span class="errorcode">0x0f</span></td><td><span class="errorname">TE_SHM_UNABLE_TO_REMOVE_SEGMENT</span></td><td><span class="errortext">Unable to remove shm segment</span></td></tr><tr><td><span class="errorcode">0x10</span></td><td><span class="errorname">TE_TOO_SMALL_SIGID</span></td><td><span class="errortext">Sig ID too small</span></td></tr><tr><td><span class="errorcode">0x11</span></td><td><span class="errorname">TE_TOO_LARGE_SIGID</span></td><td><span class="errortext">Sig ID too large</span></td></tr><tr><td><span class="errorcode">0x12</span></td><td><span class="errorname">TE_WAIT_STACK_FULL</span></td><td><span class="errortext">Wait stack was full</span></td></tr><tr><td><span class="errorcode">0x13</span></td><td><span class="errorname">TE_RECEIVE_BUFFER_FULL</span></td><td><span class="errortext">Receive buffer was full</span></td></tr><tr><td><span class="errorcode">0x14</span></td><td><span class="errorname">TE_SIGNAL_LOST_SEND_BUFFER_FULL</span></td><td><span class="errortext">Send buffer was full,and trying to force send
                fails</span></td></tr><tr><td><span class="errorcode">0x15</span></td><td><span class="errorname">TE_SIGNAL_LOST</span></td><td><span class="errortext">Send failed for unknown reason(signal lost)</span></td></tr><tr><td><span class="errorcode">0x16</span></td><td><span class="errorname">TE_SEND_BUFFER_FULL</span></td><td><span class="errortext">The send buffer was full, but sleeping for a while
                solved</span></td></tr><tr><td><span class="errorcode">0x0017</span></td><td><span class="errorname">TE_SCI_LINK_ERROR</span></td><td><span class="errortext">There is no link from this node to the switch</span></td></tr><tr><td><span class="errorcode">0x18</span></td><td><span class="errorname">TE_SCI_UNABLE_TO_START_SEQUENCE</span></td><td><span class="errortext">Could not start a sequence, because system resources are
                exumed or no sequence has been created</span></td></tr><tr><td><span class="errorcode">0x19</span></td><td><span class="errorname">TE_SCI_UNABLE_TO_REMOVE_SEQUENCE</span></td><td><span class="errortext">Could not remove a sequence</span></td></tr><tr><td><span class="errorcode">0x1a</span></td><td><span class="errorname">TE_SCI_UNABLE_TO_CREATE_SEQUENCE</span></td><td><span class="errortext">Could not create a sequence, because system resources are
                exempted. Must reboot</span></td></tr><tr><td><span class="errorcode">0x1b</span></td><td><span class="errorname">TE_SCI_UNRECOVERABLE_DATA_TFX_ERROR</span></td><td><span class="errortext">Tried to send data on redundant link but failed</span></td></tr><tr><td><span class="errorcode">0x1c</span></td><td><span class="errorname">TE_SCI_CANNOT_INIT_LOCALSEGMENT</span></td><td><span class="errortext">Cannot initialize local segment</span></td></tr><tr><td><span class="errorcode">0x1d</span></td><td><span class="errorname">TE_SCI_CANNOT_MAP_REMOTESEGMENT</span></td><td><span class="errortext">Cannot map remote segment</span></td></tr><tr><td><span class="errorcode">0x1e</span></td><td><span class="errorname">TE_SCI_UNABLE_TO_UNMAP_SEGMENT</span></td><td><span class="errortext">Cannot free the resources used by this segment (step
                1)</span></td></tr><tr><td><span class="errorcode">0x1f</span></td><td><span class="errorname">TE_SCI_UNABLE_TO_REMOVE_SEGMENT</span></td><td><span class="errortext">Cannot free the resources used by this segment (step
                2)</span></td></tr><tr><td><span class="errorcode">0x20</span></td><td><span class="errorname">TE_SCI_UNABLE_TO_DISCONNECT_SEGMENT</span></td><td><span class="errortext">Cannot disconnect from a remote segment</span></td></tr><tr><td><span class="errorcode">0x21</span></td><td><span class="errorname">TE_SHM_IPC_PERMANENT</span></td><td><span class="errortext">Shm ipc Permanent error</span></td></tr><tr><td><span class="errorcode">0x22</span></td><td><span class="errorname">TE_SCI_UNABLE_TO_CLOSE_CHANNEL</span></td><td><span class="errortext">Unable to close the sci channel and the resources
                allocated</span></td></tr></tbody></table></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-single-user-mode"></a>20.7.5. Single User Mode</h3></div></div></div><a class="indexterm" name="id2360525"></a><a class="indexterm" name="id2360537"></a><p>
      <em class="firstterm">Single user mode</em> allows the database
      administrator to restrict access to the database system to a
      single API node, such as a MySQL server (SQL node) or an instance
      of <span><strong class="command">ndb_restore</strong></span>. When entering single user mode,
      connections to all other API nodes are closed gracefully and all
      running transactions are aborted. No new transactions are
      permitted to start.
    </p><p>
      Once the cluster has entered single user mode, only the designated
      API node is granted access to the database.
    </p><p>
      You can use the <span><strong class="command">ALL STATUS</strong></span> command to see when
      the cluster has entered single user mode.
    </p><p>
      Example:
    </p><pre class="programlisting">ndb_mgm&gt; <strong class="userinput"><code>ENTER SINGLE USER MODE 5</code></strong>
</pre><p>
      After this command has executed and the cluster has entered single
      user mode, the API node whose node ID is <code class="literal">5</code>
      becomes the cluster's only permitted user.
    </p><p>
      The node specified in the preceding command must be an API node;
      attempting to specify any other type of node will be rejected.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        When the preceding command is invoked, all transactions running
        on the designated node are aborted, the connection is closed,
        and the server must be restarted.
      </p></div><p>
      The command <span><strong class="command">EXIT SINGLE USER MODE</strong></span> changes the
      state of the cluster's data nodes from single user mode to normal
      mode. API nodes — such as MySQL Servers — waiting for
      a connection (that is, waiting for the cluster to become ready and
      available), are again permitted to connect. The API node denoted
      as the single-user node continues to run (if still connected)
      during and after the state change.
    </p><p>
      Example:
    </p><pre class="programlisting">ndb_mgm&gt; <strong class="userinput"><code>EXIT SINGLE USER MODE</code></strong>
</pre><a class="indexterm" name="id2360646"></a><p>
      There are two recommended ways to handle a node failure when
      running in single user mode:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          Method 1:
        </p><div class="orderedlist"><ol type="1"><li><p>
              Finish all single user mode transactions
            </p></li><li><p>
              Issue the <span><strong class="command">EXIT SINGLE USER MODE</strong></span> command
            </p></li><li><p>
              Restart the cluster's data nodes
            </p></li></ol></div></li><li><p>
          Method 2:
        </p><p>
          Restart database nodes prior to entering single user mode.
        </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-sql-statements"></a>20.7.6. Quick Reference: MySQL Cluster SQL Statements</h3></div></div></div><a class="indexterm" name="id2360727"></a><a class="indexterm" name="id2360740"></a><p>
      This section discusses several SQL statements that can prove
      useful in managing and monitoring a MySQL server that is connected
      to a MySQL Cluster, and in some cases provide information about
      the cluster itself.
    </p><div class="itemizedlist"><a class="indexterm" name="id2360756"></a><a class="indexterm" name="id2360769"></a><a class="indexterm" name="id2360778"></a><ul type="disc"><li><p>
          <code class="literal">SHOW ENGINE NDB STATUS</code>, <code class="literal">SHOW
          ENGINE NDBCLUSTER STATUS</code>
        </p><p>
          The output of this statement contains information about the
          server's connection to the cluster, creation and usage of
          MySQL Cluster objects, and binary logging for MySQL Cluster
          replication.
        </p><p>
          See <a href="sql-syntax.html#show-engine" title="12.5.5.15. SHOW ENGINE Syntax">Section 12.5.5.15, “<code class="literal">SHOW ENGINE</code> Syntax”</a>, for a usage example and
          more detailed information.
        </p></li><li><a class="indexterm" name="id2360821"></a><p>
          <code class="literal">SHOW ENGINES</code>
        </p><p>
          This statement can be used to determine whether or not
          clustering support is enabled in the MySQL server, and if so,
          whether it is active.
        </p><p>
          See <a href="sql-syntax.html#show-engines" title="12.5.5.16. SHOW ENGINES Syntax">Section 12.5.5.16, “<code class="literal">SHOW ENGINES</code> Syntax”</a>, for more detailed
          information.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            In MySQL 5.1, this statement no longer supports a
            <a href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause. However, you
            can use <a href="functions.html#operator_like"><code class="literal">LIKE</code></a> to filter
            queries against the
            <code class="literal">INFORMATION_SCHEMA.ENGINES</code>, as discussed
            in the next item.
          </p></div></li><li><a class="indexterm" name="id2360887"></a><p>
          <code class="literal">SELECT * FROM INFORMATION_SCHEMA.ENGINES [WHERE
          ENGINE LIKE 'NDB%']</code>
        </p><p>
          This is the equivalent of <code class="literal">SHOW ENGINES</code>, but
          uses the <code class="literal">ENGINES</code> table of the
          <code class="literal">INFORMATION_SCHEMA</code> database (available
          beginning with MySQL 5.1.5). Unlike the case with the
          <code class="literal">SHOW ENGINES</code> statement, it is possible to
          filter the results using a
          <a href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, and to select
          specific columns to obtain information that may be of use in
          scripts. For example, the following query shows whether the
          server was built with <code class="literal">NDB</code> support and, if
          so, whether it is enabled:

</p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT SUPPORT FROM INFORMATION_SCHEMA.ENGINES</code></strong>
    -&gt;   <strong class="userinput"><code>WHERE ENGINE LIKE 'NDB%';</code></strong>
+---------+
| support |
+---------+
| ENABLED |
+---------+
</pre><p>
        </p><p>
          See <a href="information-schema.html#engines-table" title="27.18. The INFORMATION_SCHEMA ENGINES Table">Section 27.18, “The <code class="literal">INFORMATION_SCHEMA ENGINES</code> Table”</a>, for more information.
        </p></li><li><a class="indexterm" name="id2360982"></a><p>
          <code class="literal">SHOW VARIABLES LIKE 'NDB%'</code>
        </p><p>
          This statement provides a list of most server system variables
          relating to the <code class="literal">NDB</code> storage engine, and
          their values, as shown here:

</p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'NDB%';</code></strong>
+-------------------------------------+-------+
| Variable_name                       | Value |
+-------------------------------------+-------+
| ndb_autoincrement_prefetch_sz       | 32    |
| ndb_cache_check_time                | 0     |
| ndb_extra_logging                   | 0     |
| ndb_force_send                      | ON    |
| ndb_index_stat_cache_entries        | 32    |
| ndb_index_stat_enable               | OFF   |
| ndb_index_stat_update_freq          | 20    |
| ndb_report_thresh_binlog_epoch_slip | 3     |
| ndb_report_thresh_binlog_mem_usage  | 10    |
| ndb_use_copying_alter_table         | OFF   |
| ndb_use_exact_count                 | ON    |
| ndb_use_transactions                | ON    |
+-------------------------------------+-------+
</pre><p>
        </p><p>
          See <a href="server-administration.html#server-system-variables" title="5.1.3. System Variables">Section 5.1.3, “System Variables”</a>, for more
          information.
        </p></li><li><a class="indexterm" name="id2361044"></a><p>
          <code class="literal">SELECT * FROM INFORMATION_SCHEMA.GLOBAL_VARIABLES
          WHERE VARIABLE_NAME LIKE 'NDB%';</code>
        </p><p>
          This statement is the equivalent of the
          <code class="literal">SHOW</code> described in the previous item, and
          provides almost identical output, as shown here:

</p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM INFORMATION_SCHEMA.GLOBAL_VARIABLES</code></strong> 
    -&gt;   <strong class="userinput"><code>WHERE VARIABLE_NAME LIKE 'NDB%';</code></strong>
+-------------------------------------+----------------+
| VARIABLE_NAME                       | VARIABLE_VALUE |
+-------------------------------------+----------------+
| NDB_AUTOINCREMENT_PREFETCH_SZ       | 32             |
| NDB_CACHE_CHECK_TIME                | 0              |
| NDB_EXTRA_LOGGING                   | 0              |
| NDB_FORCE_SEND                      | ON             |
| NDB_INDEX_STAT_CACHE_ENTRIES        | 32             |
| NDB_INDEX_STAT_ENABLE               | OFF            |
| NDB_INDEX_STAT_UPDATE_FREQ          | 20             |
| NDB_REPORT_THRESH_BINLOG_EPOCH_SLIP | 3              |
| NDB_REPORT_THRESH_BINLOG_MEM_USAGE  | 10             |
| NDB_USE_COPYING_ALTER_TABLE         | OFF            |
| NDB_USE_EXACT_COUNT                 | ON             |
| NDB_USE_TRANSACTIONS                | ON             |
+-------------------------------------+----------------+
</pre><p>

          Unlike the case with the <code class="literal">SHOW</code> statement, it
          is possible to select individual columns. For example:

</p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT VARIABLE_VALUE </code></strong>
    -&gt;   <strong class="userinput"><code>FROM INFORMATION_SCHEMA.GLOBAL_VARIABLES</code></strong>
    -&gt;   <strong class="userinput"><code>WHERE VARIABLE_NAME = 'ndb_force_send';</code></strong>
+----------------+
| VARIABLE_VALUE |
+----------------+
| ON             |
+----------------+
</pre><p>
        </p><p>
          See <a href="information-schema.html#variables-table" title="27.25. The INFORMATION_SCHEMA GLOBAL_VARIABLES and
      SESSION_VARIABLES Tables">Section 27.25, “The <code class="literal">INFORMATION_SCHEMA GLOBAL_VARIABLES</code> and
      <code class="literal">SESSION_VARIABLES</code> Tables”</a>, and
          <a href="server-administration.html#server-system-variables" title="5.1.3. System Variables">Section 5.1.3, “System Variables”</a>, for more
          information.
        </p></li><li><a class="indexterm" name="id2361150"></a><p>
          <code class="literal">SHOW STATUS LIKE 'NDB%'</code>
        </p><p>
          This statement shows at a glance whether or not the MySQL
          server is acting as a cluster SQL node, and if so, it provides
          the MySQL server's cluster node ID, the hostname and port for
          the cluster management server to which it is connected, and
          the number of data nodes in the cluster, as shown here:

</p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW STATUS LIKE 'NDB%';</code></strong>
+--------------------------+---------------+
| Variable_name            | Value         |
+--------------------------+---------------+
| Ndb_cluster_node_id      | 10            |
| Ndb_config_from_host     | 192.168.0.103 |
| Ndb_config_from_port     | 1186          |
| Ndb_number_of_data_nodes | 4             |
+--------------------------+---------------+
</pre><p>

          If the MySQL server was built with clustering support, but it
          is not connected to a cluster, all rows in the output of this
          statement contain a zero or an empty string:

</p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW STATUS LIKE 'NDB%';</code></strong>
+--------------------------+-------+
| Variable_name            | Value |
+--------------------------+-------+
| Ndb_cluster_node_id      | 0     |
| Ndb_config_from_host     |       |
| Ndb_config_from_port     | 0     |
| Ndb_number_of_data_nodes | 0     |
+--------------------------+-------+
</pre><p>
        </p><p>
          See also <a href="sql-syntax.html#show-status" title="12.5.5.32. SHOW STATUS Syntax">Section 12.5.5.32, “<code class="literal">SHOW STATUS</code> Syntax”</a>.
        </p></li><li><a class="indexterm" name="id2361220"></a><p>
          <code class="literal">SELECT * FROM INFORMATION_SCHEMA.GLOBAL_STATUS WHERE
          VARIABLE_NAME LIKE 'NDB%';</code>
        </p><p>
          Beginning with MySQL 5.1.12, this statement provides similar
          output to the <code class="literal">SHOW</code> statement discussed in
          the previous item. However, unlike the case with <code class="literal">SHOW
          STATUS</code>, it is possible using the
          <code class="literal">SELECT</code> to extract values in SQL for use in
          scripts for monitoring and automation purposes.
        </p><p>
          See <a href="information-schema.html#status-table" title="27.24. The INFORMATION_SCHEMA GLOBAL_STATUS and
      SESSION_STATUS Tables">Section 27.24, “The <code class="literal">INFORMATION_SCHEMA GLOBAL_STATUS</code> and
      <code class="literal">SESSION_STATUS</code> Tables”</a>, for more information.
        </p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-security"></a>20.8. MySQL Cluster Security Issues</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-security-networking-issues">20.8.1. MySQL Cluster Security and Networking Issues</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-security-mysql-privileges">20.8.2. MySQL Cluster and MySQL Privileges</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-security-mysql-security-procedures">20.8.3. MySQL Cluster and MySQL Security Procedures</a></span></dt></dl></div><a class="indexterm" name="id2361286"></a><p>
    This section discusses security considerations to take into account
    when setting up and running MySQL Cluster.
  </p><p>
    Topics to be covered in this chapter include the following:
  </p><div class="itemizedlist"><ul type="disc"><li><p>
        MySQL Cluster and network security issues
      </p></li><li><p>
        Configuration issues relating to running MySQL Cluster securely
      </p></li><li><p>
        MySQL Cluster and the MySQL privilege system
      </p></li><li><p>
        MySQL standard security procedures as applicable to MySQL
        Cluster
      </p></li></ul></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-security-networking-issues"></a>20.8.1. MySQL Cluster Security and Networking Issues</h3></div></div></div><a class="indexterm" name="id2361347"></a><p>
      In this section, we discuss basic network security issues as they
      relate to MySQL Cluster. It is extremely important to remember
      that MySQL Cluster “<span class="quote">out of the box</span>” is not secure;
      you or your network administrator must take the proper steps to
      insure that your cluster cannot be compromised over the network.
    </p><a class="indexterm" name="id2361373"></a><p>
      Cluster communication protocols are inherently insecure, and no
      encryption or similar security measures are used in communications
      between nodes in the cluster. Because network speed and latency
      have a direct impact on the cluster's efficiency, it is also not
      advisable to employ SSL or other encryption to network connections
      between nodes, as such schemes will effectively slow
      communications.
    </p><p>
      It is also true that no authentication is used for controlling API
      node access to a MySQL Cluster. As with encryption, the overhead
      of imposing authentication requirements would have an adverse
      impact on Cluster performance.
    </p><p>
      In addition, there is no checking of the source IP address for
      either of the following when accessing the cluster:

      </p><div class="itemizedlist"><ul type="disc"><li><p>
            SQL or API nodes using “<span class="quote">free slots</span>” created by
            empty <code class="literal">[mysqld]</code> or
            <code class="literal">[api]</code> sections in the
            <code class="filename">config.ini</code> file
          </p><p>
            This means that, if there are any empty
            <code class="literal">[mysqld]</code> or <code class="literal">[api]</code>
            sections in the <code class="filename">config.ini</code> file, then
            any API nodes (including SQL nodes) that know the management
            server's hostname (or IP address) and port can connect to
            the cluster and access its data without restriction. (See
            <a href="mysql-cluster.html#mysql-cluster-security-mysql-privileges" title="20.8.2. MySQL Cluster and MySQL Privileges">Section 20.8.2, “MySQL Cluster and MySQL Privileges”</a>,
            for more information about this and related issues.)
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              <a class="indexterm" name="id2361464"></a>

              <a class="indexterm" name="id2361480"></a>

              <a class="indexterm" name="id2361496"></a>

              You can exercise some control over SQL and API node access
              to the cluster by specifying a <code class="literal">HostName</code>
              parameter for all <code class="literal">[mysqld]</code> and
              <code class="literal">[api]</code> sections in the
              <code class="filename">config.ini</code> file. However, this also
              means that, should you wish to connect an API node to the
              cluster from a previously unused host, you need to add an
              <code class="literal">[api]</code> section containing its hostname
              to the <code class="filename">config.ini</code> file.
            </p><p>
              More information is available
              <a href="mysql-cluster.html#mysql-cluster-param-api-definition-hostname">elsewhere
              in this chapter</a> about the
              <code class="literal">HostName</code> parameter. Also see
              <a href="mysql-cluster.html#mysql-cluster-quick" title="20.3.3. Quick Test Setup of MySQL Cluster">Section 20.3.3, “Quick Test Setup of MySQL Cluster”</a>, for configuration
              examples using <code class="literal">HostName</code> with API nodes.
            </p></div></li><li><p>
            Any <span><strong class="command">ndb_mgm</strong></span> client
          </p><p>
            This means that any cluster management client that is given
            the management server's hostname (or IP address) and port
            (if not the standard port) can connect to the cluster and
            execute any management client command. This includes
            commands such as <code class="literal">ALL STOP</code> and
            <code class="literal">SHUTDOWN</code>.
          </p></li></ul></div><p>
    </p><p>
      <a class="indexterm" name="id2361610"></a>

      <a class="indexterm" name="id2361626"></a>

      For these reasons, it is necessary to protect the cluster on the
      network level. The safest network configuration for Cluster is one
      which isolates connections between Cluster nodes from any other
      network communications. This can be accomplished by any of the
      following methods:

      </p><div class="orderedlist"><ol type="1"><li><p>
            Keeping Cluster nodes on a network that is physically
            separate from any public networks. This option is the most
            dependable; however, it is the most expensive to implement.
          </p><p>
            We show an example of a MySQL Cluster setup using such a
            physically segregated network here:

            </p><div class="mediaobject"><img src="images/cluster-security-network-1.png" alt="MySQL Cluster on a private network
                protected with a hardware firewall"></div><p>

            This setup has two networks, one private (solid box) for the
            Cluster management servers and data nodes, and one public
            (dotted box) where the SQL nodes reside. (We show the
            management and data nodes connected using a gigabit switch
            since this provides the best performance.) Both networks are
            protected from the outside by a hardware firewall, sometimes
            also known as a <em class="firstterm">network-based
            firewall</em>.
          </p><p>
            This network setup is safest because no packets can reach
            the cluster's management or data nodes from outside the
            network — and none of the cluster's internal
            communications can reach the outside — without going
            through the SQL nodes, as long as the SQL nodes do not allow
            any packets to be forwarded. This means, of course, that all
            SQL nodes must be secured against hacking attempts.
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              With regard to potential security vulnerabilities, an SQL
              node is no different from any other MySQL server. See
              <a href="server-administration.html#security-against-attack" title="5.3.2. Making MySQL Secure Against Attackers">Section 5.3.2, “Making MySQL Secure Against Attackers”</a>, for a
              description of techniques you can use to secure MySQL
              servers.
            </p></div></li><li><p>
            <a class="indexterm" name="id2361723"></a>

            <a class="indexterm" name="id2361739"></a>

            Using one or more software firewalls (also known as
            <em class="firstterm">host-based firewalls</em>) to control
            which packets pass through to the cluster from portions of
            the network that do not require access to it. In this type
            of setup, a software firewall must be installed on every
            host in the cluster which might otherwise be accessible from
            outside the local network.
          </p><p>
            The host-based option is the least expensive to implement,
            but relies purely on software to provide protection and so
            is the most difficult to keep secure.
          </p><p>
            This type of network setup for MySQL Cluster is illustrated
            here:

            </p><div class="mediaobject"><img src="images/cluster-security-network-2.png" alt="MySQL Cluster deployed on a network
                using software firewalls to create public and private
                zones"></div><p>

            Using this type of network setup means that there are two
            zones of MySQL Cluster hosts. Each cluster host must be able
            to communicate with all of the other machines in the
            cluster, but only those hosting SQL nodes (dotted box) can
            be permitted to have any contact with the outside, while
            those in the zone containing the data nodes and management
            nodes (solid box) must be isolated from any machines that
            are not part of the cluster. Applications using the cluster
            and user of those applications must <span class="emphasis"><em>not</em></span>
            be permitted to have direct access to the management and
            data node hosts.
          </p><p>
            To accomplish this, you must set up software firewalls that
            limit the traffic to the type or types shown in the
            following table, according to the type of node that is
            running on each cluster host computer:

            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>Type of Node to be Accessed</th><th>Traffic to Allow</th></tr></thead><tbody><tr><td>SQL or API node</td><td><div class="itemizedlist"><ul type="disc"><li><p>
                            It originates from the IP address of a
                            management or data node (using any TCP or
                            UDP port).
                          </p></li><li><p>
                            It originates from within the network in
                            which the cluster resides and is on the port
                            that your application is using.
                          </p></li></ul></div></td></tr><tr><td>Data node or Management node</td><td><div class="itemizedlist"><ul type="disc"><li><p>
                            It originates from the IP address of a
                            management or data node (using any TCP or
                            UDP port).
                          </p></li><li><p>
                            It originates from the IP address of an SQL
                            or API node.
                          </p></li></ul></div></td></tr></tbody></table></div><p>

            Any traffic other than that shown in the table for a given
            node type should be denied.
          </p><p>
            The specifics of configuring a firewall vary from firewall
            application to firewall application, and are beyond the
            scope of this Manual. <span><strong class="command">iptables</strong></span> is a very
            common and reliable firewall application, which is often
            used with <span><strong class="command">APF</strong></span> as a front end to make
            configuration easier. You can (and should) consult the
            documentation for the software firewall that you employ,
            should you choose to implement a MySQL Cluster network setup
            of this type, or of a “<span class="quote">mixed</span>” type as discussed
            under the next item.
          </p></li><li><p>
            <a class="indexterm" name="id2361925"></a>

            <a class="indexterm" name="id2361941"></a>

            It is also possible to employ a combination of the first two
            methods, using both hardware and software to secure the
            cluster — that is, using both network-based and
            host-based firewalls. This is between the first two schemes
            in terms of both security level and cost. This type of
            network setup keeps the cluster behind the hardware
            firewall, but allows incoming packets to travel beyond the
            router connecting all cluster hosts in order to reach the
            SQL nodes.
          </p><p>
            One possible network deployment of a MySQL Cluster using
            hardware and software firewalls in combination is shown
            here:

            </p><div class="mediaobject"><img src="images/cluster-security-network-3.png" alt="Network setup for MySQL Cluster using
                a combination of hardware and software firewalls to
                provide protection"></div><p>

            In this case, you can set the rules in the hardware firewall
            to deny any external traffic except to SQL nodes and API
            nodes, and then allow traffic to them only on the ports
            required by your application.
          </p></li></ol></div><p>

      Whatever network configuration you use, remember that your
      objective from the viewpoint of keeping the cluster secure remains
      the same — to prevent any unessential traffic from reaching
      the cluster while ensuring the most efficient communication
      between the nodes in the cluster.
    </p><p>
      <a class="indexterm" name="id2362003"></a>

      <a class="indexterm" name="id2362019"></a>

      Because MySQL Cluster requires large numbers of ports to be open
      for communications between nodes, the recommended option is to use
      a segregated network. This represents the simplest way to prevent
      unwanted traffic from reaching the cluster.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        <a class="indexterm" name="id2362039"></a>

        <a class="indexterm" name="id2362055"></a>

        If you wish to administer a MySQL Cluster remotely (that is,
        from outside the local network), the recommended way to do this
        is to use <span><strong class="command">ssh</strong></span> or another secure login shell
        to access an SQL node host. From this host, you can then run the
        management client to access the management server safely, from
        within the Cluster's own local network.
      </p><p>
        Even though it is possible to do so in theory, it is
        <span class="emphasis"><em>not</em></span> recommended to use
        <span><strong class="command">ndb_mgm</strong></span> to manage a Cluster directly from
        outside the local network on which the Cluster is running. Since
        neither authentication nor encryption takes place between the
        management client and the management server, this represents an
        extremely insecure means of managing the cluster, and is almost
        certain to be compromised sooner or later.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-security-mysql-privileges"></a>20.8.2. MySQL Cluster and MySQL Privileges</h3></div></div></div><a class="indexterm" name="id2362105"></a><p>
      In this section, we discuss how the MySQL privilege system works
      in relation to MySQL Cluster and the implications of this for
      keeping a MySQL Cluster secure.
    </p><p>
      <a class="indexterm" name="id2362124"></a>

      Standard MySQL privileges apply to MySQL Cluster tables. This
      includes all MySQL privilege types (<code class="literal">SELECT</code>
      privilege, <code class="literal">UPDATE</code> privilege,
      <code class="literal">DELETE</code> privilege, and so on) granted on the
      database, table, and column level. As with any other MySQL Server,
      user and privilege information is stored in the
      <code class="literal">mysql</code> system database. The SQL statements used
      to grant and revoke privileges on <code class="literal">NDB</code> tables,
      databases containing such tables, and columns within such tables
      are identical in all respects with the <code class="literal">GRANT</code>
      and <code class="literal">REVOKE</code> statements used in connection with
      database objects involving any (other) MySQL storage engine. The
      same thing is true with respect to the <code class="literal">CREATE
      USER</code> and <code class="literal">DROP USER</code> statements.
    </p><p>
      <a class="indexterm" name="id2362198"></a>

      It is important to keep in mind that the MySQL grant tables use
      the <code class="literal">MyISAM</code> storage engine. Because of this,
      those tables are not duplicated or shared among MySQL servers
      acting as SQL nodes in a MySQL Cluster. By way of example, suppose
      that two SQL nodes <span class="bold"><strong>A</strong></span> and
      <span class="bold"><strong>B</strong></span> are connected to the same MySQL
      Cluster, which has an <code class="literal">NDB</code> table named
      <code class="literal">mytable</code> in a database named
      <code class="literal">mydb</code>, and that you execute an SQL statement on
      server <span class="bold"><strong>A</strong></span> that creates a new user
      <code class="literal">jon@localhost</code> and grants this user the
      <code class="literal">SELECT</code> privilege on that table:

</p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>GRANT SELECT ON mydb.mytable</code></strong>
    -&gt;   <strong class="userinput"><code>TO jon@localhost IDENTIFIED BY 'mypass';</code></strong>
</pre><p>

      This user is <span class="emphasis"><em>not</em></span> created on server
      <span class="bold"><strong>B</strong></span>. In order for this to take
      place, the statement must also be run on server
      <span class="bold"><strong>B</strong></span>. Similarly, statements run on
      server <span class="bold"><strong>A</strong></span> and affecting the
      privileges of existing users on server
      <span class="bold"><strong>A</strong></span> do not affect users on server
      <span class="bold"><strong>B</strong></span> unless those statements are
      actually run on server <span class="bold"><strong>B</strong></span> as well.
    </p><p>
      In other words, <span class="emphasis"><em>changes in users and their privileges do
      not automatically propagate between SQL nodes</em></span>.
      Synchronization of privileges between SQL nodes must be done
      either manually or by scripting an application that periodically
      synchronizes the privilege tables on all SQL nodes in the cluster.
    </p><p>
      <a class="indexterm" name="id2362338"></a>

      <a class="indexterm" name="id2362351"></a>

      Conversely, because there is no way in MySQL to deny privileges
      (privileges can either be revoked or not granted in the first
      place, but not denied as such), there is no special protection for
      <code class="literal">NDB</code> tables on one SQL node from users that have
      privileges on another SQL node. The most far-reaching example of
      this is the MySQL <code class="literal">root</code> account, which can
      perform any action on any database object. In combination with
      empty <code class="literal">[mysqld]</code> or <code class="literal">[api]</code>
      sections of the <code class="filename">config.ini</code> file, this account
      can be especially dangerous. To understand why, consider the
      following scenario:

      </p><div class="itemizedlist"><ul type="disc"><li><p>
            The <code class="filename">config.ini</code> file contains at least
            one empty <code class="literal">[mysqld]</code> or
            <code class="literal">[api]</code> section. This means that the
            Cluster management server performs no checking of the host
            from which a MySQL Server (or other API node) accesses the
            MySQL Cluster.
          </p></li><li><p>
            There is no firewall, or the firewall fails to protect
            against access to the Cluster from hosts external to the
            network.
          </p></li><li><p>
            The hostname or IP address of the Cluster's management
            server is known or can be determined from outside the
            network.
          </p></li></ul></div><p>

      If these conditions are true, then anyone, anywhere can start a
      MySQL Server with <code class="option">--ndbcluster
      --ndb-connectstring=<em class="replaceable"><code>management_host</code></em></code>
      and access the Cluster. Using the MySQL <code class="literal">root</code>
      account, this person can then perform the following actions:

      </p><div class="itemizedlist"><ul type="disc"><li><p>
            Execute a <code class="literal">SHOW DATABASES</code> statement to
            obtain a list of all databases that exist in the cluster
          </p></li><li><p>
            Execute a <code class="literal">SHOW TABLES FROM
            <em class="replaceable"><code>some_database</code></em></code> statement
            to obtain a list of all <code class="literal">NDB</code> tables in a
            given database
          </p></li><li><p>
            <a class="indexterm" name="id2362498"></a>

            <a class="indexterm" name="id2362511"></a>

            Run any legal MySQL statements on any of those tables, such
            as:

            </p><div class="itemizedlist"><ul type="circle"><li><p>
                  <code class="literal">SELECT * FROM
                  <em class="replaceable"><code>some_table</code></em></code> to
                  read all the data from any table
                </p></li><li><p>
                  <code class="literal">DELETE FROM
                  <em class="replaceable"><code>some_table</code></em></code> to
                  delete all the data from a table
                </p></li><li><p>
                  <code class="literal">DESCRIBE
                  <em class="replaceable"><code>some_table</code></em></code> or
                  <code class="literal">SHOW CREATE TABLE
                  <em class="replaceable"><code>some_table</code></em></code> to
                  determine the table schema
                </p></li><li><p>
                  <code class="literal">UPDATE <em class="replaceable"><code>some_table</code></em>
                  SET <em class="replaceable"><code>column1</code></em> =
                  <em class="replaceable"><code>any_value1</code></em></code> to
                  fill a table column with “<span class="quote">garbage</span>” data;
                  this could actually cause much greater damage than
                  simply deleting all the data
                </p><p>
                  Even more insidious variations might include
                  statements like these:

</p><pre class="programlisting">UPDATE <em class="replaceable"><code>some_table</code></em> SET <em class="replaceable"><code>an_int_column</code></em> = <em class="replaceable"><code>an_int_column</code></em> + 1
</pre><p>

                  or

</p><pre class="programlisting">                  
UPDATE <em class="replaceable"><code>some_table</code></em> SET <em class="replaceable"><code>a_varchar_column</code></em> = REVERSE(<em class="replaceable"><code>a_varchar_column</code></em>)
</pre><p>

                  Such malicious statements are limited only by the
                  imagination of the attacker.
                </p></li></ul></div><p>

            The only tables that would be safe from this sort of mayhem
            would be those tables that were created using storage
            engines other than <code class="literal">NDB</code>, and so not
            visible to a “<span class="quote">rogue</span>” SQL node.
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              <a class="indexterm" name="id2362665"></a>

              <a class="indexterm" name="id2362678"></a>

              A user who can log in as <code class="literal">root</code> can also
              access the <code class="literal">INFORMATION_SCHEMA</code> database
              and its tables, and so obtain information about databases,
              tables, stored routines, scheduled events, and any other
              database objects for which metadata is stored in
              <code class="literal">INFORMATION_SCHEMA</code>.
            </p></div><p>
            It is also a very good idea to use different passwords for
            the <code class="literal">root</code> accounts on different cluster
            SQL nodes.
          </p></li></ul></div><p>
    </p><p>
      In sum, you cannot have a safe MySQL Cluster if it is directly
      accessible from outside your local network.
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        <span class="emphasis"><em>Never leave the MySQL root account password
        empty</em></span>. This is just as true when running MySQL as a
        MySQL Cluster SQL node as it is when running it as a standalone
        (non-Cluster) MySQL Server, and should be done as part of the
        MySQL installation process before configuring the MySQL Server
        as an SQL node in a MySQL Cluster.
      </p></div><p>
      You should never convert the system tables in the
      <code class="literal">mysql</code> database to use the
      <code class="literal">NDB</code> storage engine. There are a number of
      reasons why you should not do this, but the most important reason
      is this: <span class="emphasis"><em>Many of the SQL statements that affect
      <code class="literal">mysql</code> tables storing information about user
      privileges, stored routines, scheduled events, and other database
      objects cease to function if these tables are changed to use any
      storage engine other than <code class="literal">MyISAM</code></em></span>.
      This is a consequence of various MySQL Server internals which are
      not expected to change in the foreseeable future.
    </p><p>
      If you need to synchronize <code class="literal">mysql</code> system tables
      between SQL nodes, you can use standard MySQL replication to do
      so, or employ a script to copy table entries between the MySQL
      servers.
    </p><p><b>Summary. </b>
        The two most important points to remember regarding the MySQL
        privilege system with regard to MySQL Cluster are:

        </p><div class="orderedlist"><ol type="1"><li><p>
              Users and privileges established on one SQL node do not
              automatically exist or take effect on other SQL nodes in
              the cluster.
            </p><p>
              Conversely, removing a user or privilege on one SQL node
              in the cluster does not remove the user or privilege from
              any other SQL nodes.
            </p></li><li><p>
              Once a MySQL user is granted privileges on an
              <code class="literal">NDB</code> table from one SQL node in a MySQL
              Cluster, that user can “<span class="quote">see</span>” any data in that
              table regardless of the SQL node from which the data
              originated.
            </p></li></ol></div><p>
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-security-mysql-security-procedures"></a>20.8.3. MySQL Cluster and MySQL Security Procedures</h3></div></div></div><a class="indexterm" name="id2362848"></a><a class="indexterm" name="id2362860"></a><p>
      In this section, we discuss MySQL standard security procedures as
      they apply to running MySQL Cluster.
    </p><p>
      In general, any standard procedure for running MySQL securely also
      applies to running a MySQL Server as part of a MySQL Cluster.
      First and foremost, you should always run a MySQL Server as the
      <code class="literal">mysql</code> system user; this is no different from
      running MySQL in a standard (non-Cluster) environment. The
      <code class="literal">mysql</code> system account should be uniquely and
      clearly defined. Fortunately, this is the default behavior for a
      new MySQL installation. You can verify that the
      <span><strong class="command">mysqld</strong></span> process is running as the system user
      <code class="literal">mysql</code> by using the system command such as the
      one shown here:

</p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ps aux | grep mysql</code></strong>
root     10467  0.0  0.1   3616  1380 pts/3    S    11:53   0:00 \ 
  /bin/sh ./mysqld_safe --ndbcluster --ndb-connectstring=localhost:1186
mysql    10512  0.2  2.5  58528 26636 pts/3    Sl   11:53   0:00 \ 
  /usr/local/mysql/libexec/mysqld --basedir=/usr/local/mysql \ 
  --datadir=/usr/local/mysql/var --user=mysql --ndbcluster \ 
  --ndb-connectstring=localhost:1186 --pid-file=/usr/local/mysql/var/mothra.pid \ 
  --log-error=/usr/local/mysql/var/mothra.err
jon      10579  0.0  0.0   2736   688 pts/0    S+   11:54   0:00 grep mysql
</pre><p>

      If the <span><strong class="command">mysqld</strong></span> process is running as any other
      user than <code class="literal">mysql</code>, you should immediately shut it
      down and restart it as the <code class="literal">mysql</code> user. If this
      user does not exist on the system, the <code class="literal">mysql</code>
      user account should be created, and this user should be part of
      the <code class="literal">mysql</code> user group; in this case, you should
      also make sure that the MySQL <code class="literal">DataDir</code> on this
      system is owned by the <code class="literal">mysql</code> user, and that the
      SQL node's <code class="filename">my.cnf</code> file includes
      <code class="literal">user=mysql</code> in the <code class="literal">[mysqld]</code>
      section. Alternatively, you can start the server with
      <code class="option">--user=mysql</code> on the command line, but it is
      preferable to use the <code class="filename">my.cnf</code> option, since
      you might forget to use the command-line option and so have
      <span><strong class="command">mysqld</strong></span> running as another user unintentionally.
      The <span><strong class="command">mysqld_safe</strong></span> startup script forces MySQL to
      run as the <code class="literal">mysql</code> user.
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        Never run <span><strong class="command">mysqld</strong></span> as the system root user.
        Doing so means that potentially any file on the system can be
        read by MySQL, and thus — should MySQL be compromised
        — by an attacker.
      </p></div><p>
      <a class="indexterm" name="id2363032"></a>

      As mentioned in the previous section (see
      <a href="mysql-cluster.html#mysql-cluster-security-mysql-privileges" title="20.8.2. MySQL Cluster and MySQL Privileges">Section 20.8.2, “MySQL Cluster and MySQL Privileges”</a>), you
      should always set a root password for the MySQL Server as soon as
      you have it running. You should also delete the anonymous user
      account that is installed by default. You can accomplish these
      tasks via the following statements:

</p><pre class="programlisting">shell&lt; <strong class="userinput"><code>mysql -u root</code></strong>

mysql&gt; <strong class="userinput"><code>UPDATE mysql.user</code></strong> 
    -&gt;     <strong class="userinput"><code>SET Password=PASSWORD('<em class="replaceable"><code>secure_password</code></em>')</code></strong>
    -&gt;     <strong class="userinput"><code>WHERE User='root';</code></strong>

mysql&gt; <strong class="userinput"><code>DELETE FROM mysql.user</code></strong>
    -&gt;     <strong class="userinput"><code>WHERE User='';</code></strong>

mysql&gt; <strong class="userinput"><code>FLUSH PRIVILEGES;</code></strong>
</pre><p>

      Be very careful when executing the <code class="literal">DELETE</code>
      statement not to omit the <code class="literal">WHERE</code> clause, or you
      risk deleting <span class="emphasis"><em>all</em></span> MySQL users. Be sure to run
      the <code class="literal">FLUSH PRIVILEGES</code> statement as soon as you
      have modified the <code class="literal">mysql.user</code> table, so that the
      changes take immediate effect. Without <code class="literal">FLUSH
      PRIVILEGES</code>, the changes do not take effect until the
      next time that the server is restarted.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        <a class="indexterm" name="id2363144"></a>

        <a class="indexterm" name="id2363156"></a>

        Many of the MySQL Cluster utilities such as
        <span><strong class="command">ndb_show_tables</strong></span>, <span><strong class="command">ndb_desc</strong></span>,
        and <span><strong class="command">ndb_select_all</strong></span> also work without
        authentication and can reveal table names, schemas, and data. By
        default these are installed on Unix-style systems with the
        permissions <code class="literal">wxr-xr-x</code> (755), which means they
        can be executed by any user that can access the
        <code class="filename">mysql/bin</code> directory.
      </p><p>
        See <a href="mysql-cluster.html#mysql-cluster-utilities" title="20.10. Cluster Utility Programs">Section 20.10, “Cluster Utility Programs”</a>, for more
        information about these utilities.
      </p></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-backup"></a>20.9. On-line Backup of MySQL Cluster</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-backup-concepts">20.9.1. Cluster Backup Concepts</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-backup-using-management-client">20.9.2. Using The Management Client to Create a Backup</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-restore">20.9.3. <span><strong class="command">ndb_restore</strong></span> — Restore a Cluster Backup</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-backup-configuration">20.9.4. Configuration for Cluster Backup</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-backup-troubleshooting">20.9.5. Backup Troubleshooting</a></span></dt></dl></div><a class="indexterm" name="id2363222"></a><a class="indexterm" name="id2363234"></a><p>
    This section describes how to create a backup and how to restore the
    database from a backup at a later time.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-backup-concepts"></a>20.9.1. Cluster Backup Concepts</h3></div></div></div><a class="indexterm" name="id2363259"></a><a class="indexterm" name="id2363271"></a><p>
      A backup is a snapshot of the database at a given time. The backup
      consists of three main parts:
    </p><div class="itemizedlist"><ul type="disc"><li><p><b>Metadata. </b>
            The names and definitions of all database tables
          </p></li><li><p><b>Table records. </b>
            The data actually stored in the database tables at the time
            that the backup was made
          </p></li><li><p><b>Transaction log. </b>
            A sequential record telling how and when data was stored in
            the database
          </p></li></ul></div><p>
      Each of these parts is saved on all nodes participating in the
      backup. During backup, each node saves these three parts into
      three files on disk:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          <code class="filename">BACKUP-<em class="replaceable"><code>backup_id</code></em>.<em class="replaceable"><code>node_id</code></em>.ctl</code>
        </p><p>
          A control file containing control information and metadata.
          Each node saves the same table definitions (for all tables in
          the cluster) to its own version of this file.
        </p></li><li><p>
          <code class="filename">BACKUP-<em class="replaceable"><code>backup_id</code></em>-0.<em class="replaceable"><code>node_id</code></em>.data</code>
        </p><p>
          A data file containing the table records, which are saved on a
          per-fragment basis. That is, different nodes save different
          fragments during the backup. The file saved by each node
          starts with a header that states the tables to which the
          records belong. Following the list of records there is a
          footer containing a checksum for all records.
        </p></li><li><p>
          <code class="filename">BACKUP-<em class="replaceable"><code>backup_id</code></em>.<em class="replaceable"><code>node_id</code></em>.log</code>
        </p><p>
          A log file containing records of committed transactions. Only
          transactions on tables stored in the backup are stored in the
          log. Nodes involved in the backup save different records
          because different nodes host different database fragments.
        </p></li></ul></div><p>
      In the listing above, <em class="replaceable"><code>backup_id</code></em> stands
      for the backup identifier and <em class="replaceable"><code>node_id</code></em>
      is the unique identifier for the node creating the file.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-backup-using-management-client"></a>20.9.2. Using The Management Client to Create a Backup</h3></div></div></div><a class="indexterm" name="id2363442"></a><a class="indexterm" name="id2363454"></a><p>
      Before starting a backup, make sure that the cluster is properly
      configured for performing one. (See
      <a href="mysql-cluster.html#mysql-cluster-backup-configuration" title="20.9.4. Configuration for Cluster Backup">Section 20.9.4, “Configuration for Cluster Backup”</a>.)
    </p><p>
      Creating a backup using the management client involves the
      following steps:

      </p><div class="orderedlist"><ol type="1"><li><p>
            Start the management client (<span><strong class="command">ndb_mgm</strong></span>), if
            it not running already.
          </p></li><li><a class="indexterm" name="id2363501"></a><a class="indexterm" name="id2363510"></a><p>
            Execute the <strong class="userinput"><code>START BACKUP</code></strong> command.
            This produces several lines of output indicating the
            progress of the backup, as shown here:

</p><pre class="programlisting">ndb_mgm&gt; <strong class="userinput"><code>START BACKUP</code></strong>
Waiting for completed, this may take several minutes
Node 2: Backup 1 started from node 1
Node 2: Backup 1 started from node 1 completed
 StartGCP: 177 StopGCP: 180
 #Records: 7362 #LogRecords: 0
 Data: 453648 bytes Log: 0 bytes
ndb_mgm&gt;
</pre><p>
          </p><p>
            The first line printed indicates that the management client
            is waiting for the backup to be completed before returning
            control to the client. This behavior is the default for the
            <code class="literal">START BACKUP</code> command, but can be changed.
            To specify when <code class="literal">START BACKUP</code> command
            should return control to the client, append
            <code class="literal">NOWAIT</code>, <code class="literal">WAIT STARTED</code>,
            or <code class="literal">WAIT COMPLETED</code> to the command. The
            effects that each of these has differs as follows:

            </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2363588"></a><a class="indexterm" name="id2363600"></a><p>
                  If <code class="literal">NOWAIT</code> is specified, the
                  management client displays a prompt immediately, as
                  seen here:

</p><pre class="programlisting">ndb_mgm&gt; <strong class="userinput"><code>START BACKUP NOWAIT</code></strong>
ndb_mgm&gt; 
</pre><p>

                  In this case, the management client can be used even
                  while it prints progress information from the backup
                  process.
                </p></li><li><a class="indexterm" name="id2363636"></a><a class="indexterm" name="id2363649"></a><p>
                  With <code class="literal">WAIT STARTED</code> the management
                  client waits until the backup has started before
                  returning control to the user, as shown here:

</p><pre class="programlisting">ndb_mgm&gt; <strong class="userinput"><code>START BACKUP WAIT STARTED</code></strong>
Waiting for started, this may take several minutes
Node 2: Backup 3 started from node 1
ndb_mgm&gt;
</pre><p>
                </p></li><li><a class="indexterm" name="id2363685"></a><a class="indexterm" name="id2363697"></a><p>
                  <strong class="userinput"><code>WAIT COMPLETED</code></strong> explicitly
                  specifies the default behavior — that is, it
                  causes the management client to wait until the backup
                  process is complete before returning control to the
                  user.
                </p></li></ul></div><p>
          </p></li><li><a class="indexterm" name="id2363726"></a><a class="indexterm" name="id2363739"></a><p>
            When the backup has started the management client displays
            this message:

</p><pre class="programlisting">Backup <em class="replaceable"><code>backup_id</code></em> started from node <em class="replaceable"><code>node_id</code></em>
</pre><p>

            <em class="replaceable"><code>backup_id</code></em> is the unique
            identifier for this particular backup. This identifier is
            saved in the cluster log, if it has not been configured
            otherwise. <em class="replaceable"><code>node_id</code></em> is the
            identifier of the management server that is coordinating the
            backup with the data nodes. At this point in the backup
            process the cluster has received and processed the backup
            request. It does not mean that the backup has finished. An
            example of this statement is shown here:

</p><pre class="programlisting">	
Node 2: Backup 1 started from node 1
</pre><p>
          </p></li><li><p>
            The management client indicates that the backup has
            completed with a message in the following format:

</p><pre class="programlisting">Backup <em class="replaceable"><code>backup_id</code></em> started from node <em class="replaceable"><code>node_id</code></em> completed
</pre><p>

            As is the case for the notification that the backup has
            started, <em class="replaceable"><code>backup_id</code></em> is the unique
            identifier for this particular backup, and
            <em class="replaceable"><code>node_id</code></em> is the node ID of the
            management server that is coordinating the backup with the
            data nodes. This output is accompanied by additional
            information including relevant global checkpoints, the
            number of records backed up, and the size of the data, as
            shown here:

</p><pre class="programlisting">	
Node 2: Backup 1 started from node 1 completed
 StartGCP: 177 StopGCP: 180
 #Records: 7362 #LogRecords: 0
 Data: 453648 bytes Log: 0 bytes
</pre><p>
          </p></li></ol></div><p>
    </p><p>
      Cluster backups are created by default in the
      <code class="filename">BACKUP</code> subdirectory of the
      <code class="literal">DataDir</code> on each data node. This can be
      overridden for one or more data nodes individually, or for all
      cluster data nodes in the <code class="filename">config.ini</code> file
      using the <code class="literal">BackupDataDir</code> configuration parameter
      as discussed in
      <a href="mysql-cluster.html#mysql-cluster-identifying-data-nodes">Identifying
      Data Nodes</a>. The backup files created for a backup with a
      given <em class="replaceable"><code>backup_id</code></em> are stored in a
      subdirectory named
      <code class="filename">BACKUP-<em class="replaceable"><code>backup_id</code></em></code>
      in the backup directory.
    </p><p>
      To abort a backup that is already in progress:
    </p><div class="orderedlist"><ol type="1"><li><p>
          Start the management client.
        </p></li><li><p>
          Execute this command:
        </p><pre class="programlisting">ndb_mgm&gt; <strong class="userinput"><code>ABORT BACKUP <em class="replaceable"><code>backup_id</code></em></code></strong>
</pre><p>
          The number <em class="replaceable"><code>backup_id</code></em> is the
          identifier of the backup that was included in the response of
          the management client when the backup was started (in the
          message <code class="literal">Backup <em class="replaceable"><code>backup_id</code></em>
          started from node
          <em class="replaceable"><code>management_node_id</code></em></code>).
        </p></li><li><p>
          The management client will acknowledge the abort request with
          <code class="literal">Abort of backup <em class="replaceable"><code>backup_id</code></em>
          ordered</code>.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            At this point, the management client has not yet received a
            response from the cluster data nodes to this request, and
            the backup has not yet actually been aborted.
          </p></div></li><li><p>
          After the backup has been aborted, the management client will
          report this fact in a manner similar to what is shown here:
        </p><pre class="programlisting">Node 1: Backup 3 started from 5 has been aborted. Error: 1321 - Backup aborted by user request: Permanent error: User defined error
Node 3: Backup 3 started from 5 has been aborted. Error: 1323 - 1323: Permanent error: Internal error
Node 2: Backup 3 started from 5 has been aborted. Error: 1323 - 1323: Permanent error: Internal error
Node 4: Backup 3 started from 5 has been aborted. Error: 1323 - 1323: Permanent error: Internal error
</pre><p>
          In this example, we have shown sample output for a cluster
          with 4 data nodes, where the sequence number of the backup to
          be aborted is <code class="literal">3</code>, and the management node to
          which the cluster management client is connected has the node
          ID <code class="literal">5</code>. The first node to complete its part
          in aborting the backup reports that the reason for the abort
          was due to a request by the user. (The remaining nodes report
          that the backup was aborted due to an unspecified internal
          error.)
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            There is no guarantee that the cluster nodes respond to an
            <code class="literal">ABORT BACKUP</code> command in any particular
            order.
          </p></div><p>
          The <code class="literal">Backup <em class="replaceable"><code>backup_id</code></em>
          started from node
          <em class="replaceable"><code>management_node_id</code></em> has been
          aborted</code> messages mean that the backup has been
          terminated and that all files relating to this backup have
          been removed from the cluster filesystem.
        </p></li></ol></div><p>
      It is also possible to abort a backup in progress from a system
      shell using this command:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgm -e "ABORT BACKUP <em class="replaceable"><code>backup_id</code></em>"</code></strong>
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        If there is no backup with ID
        <em class="replaceable"><code>backup_id</code></em> running when an
        <code class="literal">ABORT BACKUP</code> is issued, the management client
        makes no response, nor is it indicated in the cluster log that
        an invalid abort command was sent.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-restore"></a>20.9.3. <span><strong class="command">ndb_restore</strong></span> — Restore a Cluster Backup</h3></div></div></div><p>
          The cluster restoration program is implemented as a separate
          command-line utility <span><strong class="command">ndb_restore</strong></span>, which can
          normally be found in the MySQL <code class="filename">bin</code>
          directory. This program reads the files created as a result of
          the backup and inserts the stored information into the
          database.
        </p><p>
          <span><strong class="command">ndb_restore</strong></span> must be executed once for each
          of the backup files that were created by the <code class="literal">START
          BACKUP</code> command used to create the backup (see
          <a href="mysql-cluster.html#mysql-cluster-backup-using-management-client" title="20.9.2. Using The Management Client to Create a Backup">Section 20.9.2, “Using The Management Client to Create a Backup”</a>).
          This is equal to the number of data nodes in the cluster at
          the time that the backup was created.
        </p><a class="indexterm" name="id2364119"></a><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            Before using <span><strong class="command">ndb_restore</strong></span>, it is
            recommended that the cluster be running in single user mode,
            unless you are restoring multiple data nodes in parallel.
            See <a href="mysql-cluster.html#mysql-cluster-single-user-mode" title="20.7.5. Single User Mode">Section 20.7.5, “Single User Mode”</a>, for
            more information about single user mode.
          </p></div><p>
          Typical options for this utility are shown here:
        </p><pre class="programlisting">ndb_restore [-c <em class="replaceable"><code>connectstring</code></em>] -n <em class="replaceable"><code>node_id</code></em> [-s] [-m] -b <em class="replaceable"><code>backup_id</code></em> -r [backup_path=]<em class="replaceable"><code>/path/to/backup/files</code></em> [-e]
</pre><p>
          The <code class="option">-c</code> option is used to specify a
          connectstring which tells <code class="literal">ndb_restore</code> where
          to locate the cluster management server. (See
          <a href="mysql-cluster.html#mysql-cluster-connectstring" title="20.3.4.2. The Cluster Connectstring">Section 20.3.4.2, “The Cluster Connectstring”</a>, for information
          on connectstrings.) If this option is not used, then
          <span><strong class="command">ndb_restore</strong></span> attempts to connect to a
          management server on <code class="literal">localhost:1186</code>. This
          utility acts as a cluster API node, and so requires a free
          connection “<span class="quote">slot</span>” to connect to the cluster
          management server. This means that there must be at least one
          <code class="literal">[api]</code> or <code class="literal">[mysqld]</code>
          section that can be used by it in the cluster
          <code class="filename">config.ini</code> file. It is a good idea to
          keep at least one empty <code class="literal">[api]</code> or
          <code class="literal">[mysqld]</code> section in
          <code class="filename">config.ini</code> that is not being used for a
          MySQL server or other application for this reason (see
          <a href="mysql-cluster.html#mysql-cluster-api-definition" title="20.3.4.6. Defining SQL and Other API Nodes">Section 20.3.4.6, “Defining SQL and Other API Nodes”</a>).
        </p><p>
          You can verify that <span><strong class="command">ndb_restore</strong></span> is
          connected to the cluster by using the <span><strong class="command">SHOW</strong></span>
          command in the <span><strong class="command">ndb_mgm</strong></span> management client.
          You can also accomplish this from a system shell, as shown
          here:
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_mgm -e "SHOW"</code></strong>
</pre><p>
          <code class="option">-n</code> is used to specify the node ID of the data
          node on which the backups were taken.
        </p><p>
          The first time you run the <span><strong class="command">ndb_restore</strong></span>
          restoration program, you also need to restore the metadata. In
          other words, you must re-create the database tables —
          this can be done by running it with the <code class="option">-m</code>
          option. Note that the cluster should have an empty database
          when starting to restore a backup. (In other words, you should
          start <span><strong class="command">ndbd</strong></span> with <code class="option">--initial</code>
          prior to performing the restore. You should also remove
          manually any Disk Data files present in the data node's
          <code class="literal">DataDir</code>.)
        </p><p>
          It is possible to restore data without restoring table
          metadata. Prior to MySQL 5.1.17,
          <span><strong class="command">ndb_restore</strong></span> did not perform any checks of
          table schemas; if a table was altered between the time the
          backup was taken and when <span><strong class="command">ndb_restore</strong></span> was
          run, <span><strong class="command">ndb_restore</strong></span> would still attempt to
          restore the data to the altered table.
        </p><p>
          Beginning with MySQL 5.1.17, the default behavior is for
          <span><strong class="command">ndb_restore</strong></span> is to fail with an error if
          table data do not match the table schema; this can be
          overridden using the <code class="option">--skip-table-check</code> or
          <code class="option">-s</code> option. Prior to MySQL 5.1.21, if this
          option is used, then <span><strong class="command">ndb_restore</strong></span> attempts
          to fit data into the existing table schema, but the result of
          restoring a backup to a table schema that does not match the
          original is unspecified.
        </p><p>
          <a class="indexterm" name="id2364383"></a>

          <a class="indexterm" name="id2364395"></a>

          Beginning with MySQL Cluster NDB 6.3.8,
          <span><strong class="command">ndb_restore</strong></span> supports limited
          <em class="firstterm">attribute promotion</em> in much the same
          way that it is supported by MySQL replication; that is, data
          backed up from a column of a given type can generally be
          restored to a column using a “<span class="quote">larger, similar</span>”
          type. For example, data from a <code class="literal">CHAR(20)</code>
          column can be restored to a column declared as
          <code class="literal">VARCHAR(20)</code>,
          <code class="literal">VARCHAR(30)</code>, or
          <code class="literal">CHAR(30)</code>; data from a
          <code class="literal">MEDIUMINT</code> column can be restored to a
          column of type <code class="literal">INT</code> or
          <code class="literal">BIGINT</code>. See
          <a href="replication.html#replication-features-different-data-types" title="19.3.1.22.2. Replication of Columns Having Different Data Types">Section 19.3.1.22.2, “Replication of Columns Having Different Data Types”</a>,
          for a table of type conversions currently supported by
          attribute promotion.
        </p><p>
          Attribute promotion by <span><strong class="command">ndb_restore</strong></span> must be
          enabled explicitly, as follows:

          </p><div class="orderedlist"><ol type="1"><li><p>
                Prepare the table to which the backup is to be restored.
                <span><strong class="command">ndb_restore</strong></span> cannot be used to
                re-create the table with a different definition from the
                original; this means that you must either create the
                table manually, or alter the columns which you wish to
                promote using <code class="literal">ALTER TABLE</code> after
                restoring the table metadata but before restoring the
                data.
              </p></li><li><p>
                Invoke <span><strong class="command">ndb_restore</strong></span> with the
                <code class="option">--promote-attributes</code> option (short form
                <code class="option">-A</code>) when restoring the table data.
                Attribute promotion does not occur if this option is not
                used; instead, the restore operation fails with an
                error.
              </p></li></ol></div><p>
        </p><p>
          In addition to <code class="option">--promote-attributes</code>, a
          <code class="option">--preserve-trailing-spaces</code> option is also
          available for use with <span><strong class="command">ndb_restore</strong></span>
          beginning with MySQL 5.1.23-ndb-6.3.8. This option (short form
          <code class="option">-R</code>) causes trailing spaces to be preserved
          when promoting a <code class="literal">CHAR</code> column to
          <code class="literal">VARCHAR</code> or a <code class="literal">BINARY</code>
          column to <code class="literal">VARBINARY</code>. Otherwise, any
          trailing spaces are dropped from column values when they are
          inserted into the new columns.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            Although you can promote <code class="literal">CHAR</code> columns to
            <code class="literal">VARCHAR</code> and <code class="literal">BINARY</code>
            columns to <code class="literal">VARBINARY</code>, you cannot promote
            <code class="literal">VARCHAR</code> columns to
            <code class="literal">CHAR</code> or <code class="literal">VARBINARY</code>
            columns to <code class="literal">BINARY</code>.
          </p></div><p>
          The <code class="option">-b</code> option is used to specify the ID or
          sequence number of the backup, and is the same number shown by
          the management client in the <code class="literal">Backup
          <em class="replaceable"><code>backup_id</code></em> completed</code>
          message displayed upon completion of a backup. (See
          <a href="mysql-cluster.html#mysql-cluster-backup-using-management-client" title="20.9.2. Using The Management Client to Create a Backup">Section 20.9.2, “Using The Management Client to Create a Backup”</a>.)
        </p><p>
          <code class="option">-e</code> adds (or restores) epoch information to
          the cluster replication status table. This is useful for
          starting replication on a MySQL Cluster replication slave.
          When this option is used, the row in the
          <code class="literal">mysql.ndb_apply_status</code> having
          <code class="literal">0</code> in the <code class="literal">id</code> column is
          updated if it already exists; such a row is inserted if it
          does not already exist. (See
          <a href="mysql-cluster.html#mysql-cluster-replication-backups" title="20.11.9. MySQL Cluster Backups With Replication">Section 20.11.9, “MySQL Cluster Backups With Replication”</a>.)
        </p><p>
          The path to the backup directory is required, and must include
          the subdirectory corresponding to the ID backup of the backup
          to be restored. For example, if the data node's
          <code class="literal">DataDir</code> is
          <code class="filename">/var/lib/mysql-cluster</code>, then the backup
          directory is
          <code class="filename">/var/lib/mysql-cluster/BACKUP</code>, and the
          backup files for the backup with the ID 3 can be found in
          <code class="filename">/var/lib/mysql-cluster/BACKUP/BACKUP-3</code>.
          The path may be absolute or relative to the directory in which
          the <span><strong class="command">ndb_restore</strong></span> executable is located, and
          may be optionally prefixed with <code class="option">backup_path=</code>.
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
            When restoring cluster backups, you must be sure to restore
            all data nodes from backups having the same backup ID. Using
            files from different backups will at best result in
            restoring the cluster to an inconsistent state, and may fail
            altogether.
          </p></div><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
            It is not possible to restore a backup made from a newer
            version of MySQL Cluster using an older version of
            <span><strong class="command">ndb_restore</strong></span>. You can restore a backup
            made from a newer version of MySQL to an older cluster, but
            you must use a copy of <span><strong class="command">ndb_restore</strong></span> from
            the newer MySQL Cluster version to do so.
          </p><p>
            For example, to restore a cluster backup taken from a
            cluster running MySQL 5.1.23 to a cluster running MySQL
            Cluster 5.1.20, you must use a copy of
            <span><strong class="command">ndb_restore</strong></span> from the 5.1.23 distribution.
          </p></div><p>
          It is possible to restore a backup to a database with a
          different configuration than it was created from. For example,
          suppose that a backup with backup ID <code class="literal">12</code>,
          created in a cluster with two database nodes having the node
          IDs <code class="literal">2</code> and <code class="literal">3</code>, is to be
          restored to a cluster with four nodes. Then
          <span><strong class="command">ndb_restore</strong></span> must be run twice — once
          for each database node in the cluster where the backup was
          taken. However, <span><strong class="command">ndb_restore</strong></span> cannot always
          restore backups made from a cluster running one version of
          MySQL to a cluster running a different MySQL version. See
          <a href="mysql-cluster.html#mysql-cluster-upgrade-downgrade-compatibility" title="20.5.2. MySQL Cluster 5.1 and MySQL Cluster NDB 6.x Upgrade and Downgrade
      Compatibility">Section 20.5.2, “MySQL Cluster 5.1 and MySQL Cluster NDB 6.x Upgrade and Downgrade
      Compatibility”</a>,
          for more information.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            For more rapid restoration, the data may be restored in
            parallel, provided that there is a sufficient number of
            cluster connections available. That is, when restoring to
            multiple nodes in parallel, you must have an
            <code class="literal">[api]</code> or <code class="literal">[mysqld]</code>
            section in the cluster <code class="filename">config.ini</code> file
            available for each concurrent <span><strong class="command">ndb_restore</strong></span>
            process. However, the data files must always be applied
            before the logs.
          </p></div><p>
          Formerly, when using <span><strong class="command">ndb_restore</strong></span> to restore
          a backup made from a MySQL 5.0 cluster to a 5.1 cluster,
          <code class="literal">VARCHAR</code> columns were not resized and were
          recreated using the 5.0 fixed format. Beginning with MySQL
          5.1.19, <code class="literal">ndb_restore</code> recreates such
          <code class="literal">VARCHAR</code> columns using MySQL Cluster 5.1's
          variable-width format. Also beginning with MySQL 5.1.19, this
          behavior can be overridden using the
          <code class="option">--no-upgrade</code> option (short form:
          <code class="option">-u</code>) when running
          <span><strong class="command">ndb_restore</strong></span>.
        </p><p>
          Most of the options available for this program are shown in
          the following table:
        </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Long Form</strong></span></td><td><span class="bold"><strong>Short Form</strong></span></td><td><span class="bold"><strong>Description</strong></span></td><td><span class="bold"><strong>Default Value</strong></span></td></tr><tr><td><code class="option">--backup-id</code></td><td><code class="option">-b</code></td><td>Backup sequence ID</td><td><code class="literal">0</code></td></tr><tr><td><code class="option">--backup_path</code></td><td><span class="emphasis"><em>None</em></span></td><td>Path to backup files</td><td><code class="filename">./</code></td></tr><tr><td><code class="option">--character-sets-dir</code></td><td><span class="emphasis"><em>None</em></span></td><td>Specify the directory where character set information can be found</td><td><span class="emphasis"><em>None</em></span></td></tr><tr><td><code class="option">--connect</code>, <code class="option">--connectstring</code>, or
                  <code class="option">--ndb-connectstring</code></td><td><code class="option">-c</code> or <code class="option">-C</code></td><td>Set the connectstring in
                  <code class="literal">[nodeid=<em class="replaceable"><code>node_id;][host=]</code></em><em class="replaceable"><code>host</code></em>[:<em class="replaceable"><code>port</code></em>]</code>
                  format</td><td><code class="literal">localhost:1186</code></td></tr><tr><td><code class="option">--core-file</code></td><td><span class="emphasis"><em>None</em></span></td><td>Write a core file in the event of an error</td><td><code class="literal">TRUE</code></td></tr><tr><td><code class="option">--debug</code></td><td><code class="option">-#</code></td><td>Output debug log</td><td><code class="literal">d:t:O,<code class="filename">/tmp/ndb_restore.trace</code></code></td></tr><tr><td><code class="option">--dont_ignore_systab_0</code></td><td><code class="option">-f</code></td><td>Do not ignore system table during restore —
                  <span class="emphasis"><em>EXPERIMENTAL; not for production
                  use</em></span></td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="option">--help</code> or <code class="option">--usage</code></td><td><code class="option">-?</code></td><td>Display help message with available options and current values, then
                  exit</td><td>[N/A]</td></tr><tr><td><code class="option">--ndb-mgmd-host</code></td><td><span class="emphasis"><em>None</em></span></td><td>Set the host and port in
                  <code class="literal"><em class="replaceable"><code>host</code></em>[:<em class="replaceable"><code>port</code></em>]</code>
                  format for the management server to connect to; this
                  is the same as <code class="option">--connect</code>,
                  <code class="option">--connectstring</code>, or
                  <code class="option">--ndb-connectstring</code>, but without a
                  way to specify the <code class="literal">nodeid</code></td><td><span class="emphasis"><em>None</em></span></td></tr><tr><td><code class="option">--ndb-nodegroup-map</code></td><td><code class="option">-z</code></td><td>Specifies a nodegroup map — <span class="emphasis"><em>Syntax</em></span>: list of
                  (<em class="replaceable"><code>source_nodegroup</code></em>,
                  <em class="replaceable"><code>destination_nodegroup</code></em>)</td><td><span class="emphasis"><em>None</em></span></td></tr><tr><td><code class="option">--ndb-nodeid</code></td><td><span class="emphasis"><em>None</em></span></td><td>Specify a node ID for the <span><strong class="command">ndb_restore</strong></span> process</td><td><code class="literal">0</code></td></tr><tr><td><code class="option">--ndb-optimized-node-selection</code></td><td><span class="emphasis"><em>None</em></span></td><td>Optimize selection of nodes for transactions</td><td><code class="literal">TRUE</code></td></tr><tr><td><code class="option">--ndb-shm</code></td><td><span class="emphasis"><em>None</em></span></td><td>Use shared memory connections when available</td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="option">--no-binlog</code></td><td><span class="emphasis"><em>None</em></span></td><td>Do not write anything to <span><strong class="command">mysqld</strong></span> binary logs (added in
                  MySQL Cluster NDB 6.2.16 and 6.3.16)</td><td><code class="literal">FALSE</code> (in other words, write to binary logs unless
                  this option is used)</td></tr><tr><td><code class="option">--no-restore-disk-objects</code></td><td><code class="option">-d</code></td><td>Do not restore Disk Data objects such as tablespaces and log file groups</td><td><code class="literal">FALSE</code> (in other words, restore Disk Data objects
                  unless this option is used)</td></tr><tr><td><code class="option">--no-upgrade</code></td><td><code class="option">-u</code></td><td>Do not re-create <code class="literal">VARSIZE</code> columns from a MySQL 5.0
                  Cluster backup as variable-width columns (added in
                  MySQL 5.1.19)</td><td><code class="literal">FALSE</code> (in other words, re-create
                  <code class="literal">VARSIZE</code> columns from a MySQL 5.0
                  Cluster backup as variable-width columns unless this
                  option is used)</td></tr><tr><td><code class="option">--nodeid</code></td><td><code class="option">-n</code></td><td>Use backup files from node with the specified ID</td><td><code class="literal">0</code></td></tr><tr><td><code class="option">--parallelism</code></td><td><code class="option">-p</code></td><td>Set from 1 to 1024 parallel transactions to be used during the
                  restoration process</td><td><code class="literal">128</code></td></tr><tr><td><code class="option">--print</code></td><td><span class="emphasis"><em>None</em></span></td><td>Print metadata, data, and log to <code class="literal">stdout</code></td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="option">--print_data</code></td><td><span class="emphasis"><em>None</em></span></td><td>Print data to <code class="literal">stdout</code></td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="option">--print_log</code></td><td><span class="emphasis"><em>None</em></span></td><td>Print log to <code class="literal">stdout</code></td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="option">--print_meta</code></td><td><span class="emphasis"><em>None</em></span></td><td>Print metadata to <code class="literal">stdout</code></td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="option">--restore_data</code></td><td><code class="option">-r</code></td><td>Restore data and logs</td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="option">--restore_epoch</code></td><td><code class="option">-e</code></td><td>Restore epoch data into the status table; the row in the
                  <code class="literal">cluster.apply_status</code> having the id
                  <code class="literal">0</code> is inserted or updated as
                  appropriate — this is convenient when starting
                  up replication on a MySQL Cluster replication slave</td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="option">--restore_meta</code></td><td><code class="option">-m</code></td><td>Restore table metadata</td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="option">--skip-table-check</code></td><td><code class="option">-s</code></td><td>Do not check table schemas (Added in MySQL 5.1.17)</td><td><code class="literal">FALSE</code></td></tr><tr><td><code class="option">--version</code></td><td><code class="option">-V</code></td><td>Output version information and exit</td><td>[N/A]</td></tr></tbody></table></div><p>
          Beginning with MySQL 5.1.18, several additional options are
          available for use with the <code class="option">--print_data</code>
          option in generating data dumps, either to
          <code class="literal">stdout</code>, or to a file. These are similar to
          some of the options used with <span><strong class="command">mysqldump</strong></span>,
          and are shown in the following table:

          </p><div class="informaltable"><table border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Long Form</strong></span></td><td><span class="bold"><strong>Short Form</strong></span></td><td><span class="bold"><strong>Description</strong></span></td><td><span class="bold"><strong>Default Value</strong></span></td></tr><tr><td><code class="option">--tab</code></td><td><code class="option">-T</code></td><td>Creates dumpfiles, one per table, each named
                    <code class="filename"><em class="replaceable"><code>tbl_name</code></em>.txt</code>.
                    Takes as its argument the path to the directory
                    where the files should be saved (required; use
                    <code class="literal">.</code> for the current directory).</td><td><span class="emphasis"><em>None</em></span></td></tr><tr><td><code class="option">--fields-enclosed-by</code></td><td><span class="emphasis"><em>None</em></span></td><td>String used to enclose all column values</td><td><span class="emphasis"><em>None</em></span></td></tr><tr><td><code class="option">--fields-optionally-enclosed-by</code></td><td><span class="emphasis"><em>None</em></span></td><td>String used to enclose column values containing character data (such as
                    <code class="literal">CHAR</code>, <code class="literal">VARCHAR</code>,
                    <code class="literal">BINARY</code>, <code class="literal">TEXT</code>,
                    or <code class="literal">ENUM</code>)</td><td><span class="emphasis"><em>None</em></span></td></tr><tr><td><code class="option">--fields-terminated-by</code></td><td><span class="emphasis"><em>None</em></span></td><td>String used to separate column values</td><td><code class="literal">\t</code> (tab character)</td></tr><tr><td><code class="option">--hex</code></td><td><span class="emphasis"><em>None</em></span></td><td>Use hex format for binary values</td><td>[N/A]</td></tr><tr><td><code class="option">--lines-terminated-by</code></td><td><span class="emphasis"><em>None</em></span></td><td>String used to terminate each line</td><td><code class="literal">\n</code> (linefeed character)</td></tr><tr><td><code class="option">--append</code></td><td><span class="emphasis"><em>None</em></span></td><td>When used with <code class="option">--tab</code>, causes the data to be appended to
                    existing files of the same name</td><td>[N/A]</td></tr></tbody></table></div><p>
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            If a table has no explicit primary key, then the output
            generated when using the <code class="option">--print</code> includes
            the table's hidden primary key.
          </p></div><p>
          Beginning with MySQL 5.1.18, it is possible to restore
          selected databases, or to restore selected tables from a given
          database using the syntax shown here:

</p><pre class="programlisting">ndb_restore <em class="replaceable"><code>other_options</code></em> <em class="replaceable"><code>db_name_1</code></em> [<em class="replaceable"><code>db_name_2</code></em>[, <em class="replaceable"><code>db_name_3</code></em>][, ...] | <em class="replaceable"><code>tbl_name_1</code></em>[, <em class="replaceable"><code>tbl_name_2</code></em>][, ...]]
</pre><p>

          In other words, you can specify either of the following to be
          restored:

          </p><div class="itemizedlist"><ul type="disc"><li><p>
                All tables from one or more databases
              </p></li><li><p>
                One or more tables from a single database
              </p></li></ul></div><p>
        </p><a class="indexterm" name="id2366042"></a><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            <span><strong class="command">ndb_restore</strong></span> reports both temporary and
            permanent errors. In the case of temporary errors, it may
            able to recover from them. Beginning with MySQL 5.1.12, it
            reports <code class="literal">Restore successful, but encountered
            temporary error, please look at configuration</code> in
            such cases.
          </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-backup-configuration"></a>20.9.4. Configuration for Cluster Backup</h3></div></div></div><a class="indexterm" name="id2366085"></a><a class="indexterm" name="id2366097"></a><a class="indexterm" name="id2366110"></a><a class="indexterm" name="id2366122"></a><p>
      Five configuration parameters are essential for backup:
    </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2366142"></a><p>
          <code class="literal">BackupDataBufferSize</code>
        </p><p>
          The amount of memory used to buffer data before it is written
          to disk.
        </p></li><li><a class="indexterm" name="id2366168"></a><p>
          <code class="literal">BackupLogBufferSize</code>
        </p><p>
          The amount of memory used to buffer log records before these
          are written to disk.
        </p></li><li><a class="indexterm" name="id2366193"></a><p>
          <code class="literal">BackupMemory</code>
        </p><p>
          The total memory allocated in a database node for backups.
          This should be the sum of the memory allocated for the backup
          data buffer and the backup log buffer.
        </p></li><li><a class="indexterm" name="id2366219"></a><p>
          <code class="literal">BackupWriteSize</code>
        </p><p>
          The default size of blocks written to disk. This applies for
          both the backup data buffer and the backup log buffer.
        </p></li><li><a class="indexterm" name="id2366245"></a><p>
          <code class="literal">BackupMaxWriteSize</code>
        </p><p>
          The maximum size of blocks written to disk. This applies for
          both the backup data buffer and the backup log buffer.
        </p></li></ul></div><p>
      More detailed information about these parameters can be found in
      <a href="mysql-cluster.html#mysql-cluster-backup-parameters">Backup
      Parameters</a>.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-backup-troubleshooting"></a>20.9.5. Backup Troubleshooting</h3></div></div></div><a class="indexterm" name="id2366288"></a><a class="indexterm" name="id2366301"></a><a class="indexterm" name="id2366313"></a><p>
      If an error code is returned when issuing a backup request, the
      most likely cause is insufficient memory or disk space. You should
      check that there is enough memory allocated for the backup.
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        If you have set <code class="literal">BackupDataBufferSize</code> and
        <code class="literal">BackupLogBufferSize</code> and their sum is greater
        than 4MB, then you must also set <code class="literal">BackupMemory</code>
        as well. See
        <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-backupmemory"><code class="literal">BackupMemory</code></a>.
      </p></div><p>
      You should also make sure that there is sufficient space on the
      hard drive partition of the backup target.
    </p><p>
      <code class="literal">NDB</code> does not support repeatable reads, which
      can cause problems with the restoration process. Although the
      backup process is “<span class="quote">hot</span>”, restoring a MySQL Cluster
      from backup is not a 100% “<span class="quote">hot</span>” process. This is due
      to the fact that, for the duration of the restore process, running
      transactions get non-repeatable reads from the restored data. This
      means that the state of the data is inconsistent while the restore
      is in progress.
    </p><p class="mnmas-kb"><b>MySQL Enterprise</b>
        MySQL Enterprise subscribers will find more information about
        Cluster backup in the Knowledge Base article,
        <a href="https://kb.mysql.com/view.php?id=5803" target="_top"> How Do I
        Backup my Cluster Database</a>. Access to the MySQL
        Knowledge Base collection of articles is one of the advantages
        of subscribing to MySQL Enterprise. For more information, see
        <a href="http://www.mysql.com/products/enterprise/advisors.html" target="_top">http://www.mysql.com/products/enterprise/advisors.html</a>.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-utilities"></a>20.10. Cluster Utility Programs</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-config">20.10.1. <span><strong class="command">ndb_config</strong></span> — Extract NDB Configuration Information</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-cpcd">20.10.2. <span><strong class="command">ndb_cpcd</strong></span> — Automate Testing for NDB Development</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-delete-all">20.10.3. <span><strong class="command">ndb_delete_all</strong></span> — Delete All Rows from NDB Table</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-desc">20.10.4. <span><strong class="command">ndb_desc</strong></span> — Describe NDB Tables</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-drop-index">20.10.5. <span><strong class="command">ndb_drop_index</strong></span> — Drop Index from NDB Table</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-drop-table">20.10.6. <span><strong class="command">ndb_drop_table</strong></span> — Drop NDB Table</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-error-reporter">20.10.7. <span><strong class="command">ndb_error_reporter</strong></span> — NDB Error-Reporting Utility</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-print-backup-file">20.10.8. <span><strong class="command">ndb_print_backup_file</strong></span> — Print NDB Backup File Contents</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-print-schema-file">20.10.9. <span><strong class="command">ndb_print_schema_file</strong></span> — Print NDB Schema File Contents</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-print-sys-file">20.10.10. <span><strong class="command">ndb_print_sys_file</strong></span> — Print NDB System File Contents</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndbd-redo-log-reader">20.10.11. <span><strong class="command">ndbd_redo_log_reader</strong></span> — Check and Print Content of Cluster Redo Log</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-select-all">20.10.12. <span><strong class="command">ndb_select_all</strong></span> — Print Rows from NDB Table</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-select-count">20.10.13. <span><strong class="command">ndb_select_count</strong></span> — Print Row Counts for NDB Tables</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-show-tables">20.10.14. <span><strong class="command">ndb_show_tables</strong></span> — Display List of NDB Tables</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-size">20.10.15. <span><strong class="command">ndb_size.pl</strong></span> — NDBCLUSTER Size Requirement Estimator</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-utilities-ndb-waiter">20.10.16. <span><strong class="command">ndb_waiter</strong></span> — Wait for Cluster to Reach a Given Status</a></span></dt></dl></div><a class="indexterm" name="id2366426"></a><a class="indexterm" name="id2366434"></a><a class="indexterm" name="id2366443"></a><a class="indexterm" name="id2366452"></a><a class="indexterm" name="id2366461"></a><a class="indexterm" name="id2366470"></a><a class="indexterm" name="id2366479"></a><a class="indexterm" name="id2366488"></a><a class="indexterm" name="id2366497"></a><a class="indexterm" name="id2366506"></a><a class="indexterm" name="id2366515"></a><a class="indexterm" name="id2366524"></a><a class="indexterm" name="id2366533"></a><a class="indexterm" name="id2366542"></a><a class="indexterm" name="id2366551"></a><a class="indexterm" name="id2366560"></a><p>
    This section discusses the MySQL Cluster utility programs that can
    be found in the <code class="filename">mysql/bin</code> directory. Each of
    these — except for <code class="filename">ndb_size.pl</code> and
    <span><strong class="command">ndb_error_reporter</strong></span> — is a standalone binary
    that can be used from a system shell, and that does not need to
    connect to a MySQL server (nor even requires that a MySQL server be
    connected to the cluster).
  </p><p>
    These utilities can also serve as examples for writing your own
    applications using the <code class="literal">NDB</code> API. The source code
    for most of these programs may be found in the
    <code class="filename">storage/ndb/tools</code> directory of the MySQL
    5.1 tree (see <a href="installing.html#installing-source" title="2.9. MySQL Installation Using a Source Distribution">Section 2.9, “MySQL Installation Using a Source Distribution”</a>). The
    <code class="literal">NDB</code> API is not covered in this manual; please
    refer to the <a href="http://dev.mysql.com/doc/ndbapi/en/index.html" target="_top"><code class="literal">NDB</code> API
    Guide</a> for information about this API.
  </p><p>
    All of the <code class="literal">NDB</code> utilities are listed here with
    brief descriptions:
  </p><div class="itemizedlist"><ul type="disc"><li><p>
        <span><strong class="command">ndb_config</strong></span>: Retrieves Cluster configuration
        option values.
      </p></li><li><p>
        <span><strong class="command">ndb_cpcd</strong></span>: Used in testing and debugging MySQL
        Cluster.
      </p></li><li><p>
        <span><strong class="command">ndb_delete_all</strong></span>: Deletes all rows from a given
        table.
      </p></li><li><p>
        <span><strong class="command">ndb_desc</strong></span>: Lists all properties of an
        <code class="literal">NDB</code> table.
      </p></li><li><p>
        <span><strong class="command">ndb_drop_index</strong></span>: Drops the specified index
        from an <code class="literal">NDB</code> table.
      </p></li><li><p>
        <span><strong class="command">ndb_drop_table</strong></span>: Drops an
        <code class="literal">NDB</code> table.
      </p></li><li><p>
        <span><strong class="command">ndb_error_reporter</strong></span>: Can be used to gather
        information useful for diagnosing problems with the cluster.
      </p></li><li><p>
        <span><strong class="command">ndb_mgm</strong></span>: This is the MySQL Cluster management
        client, which is discussed in
        <a href="mysql-cluster.html#mysql-cluster-mgm-client-commands" title="20.7.2. Commands in the MySQL Cluster Management Client">Section 20.7.2, “Commands in the MySQL Cluster Management Client”</a>.
      </p></li><li><p>
        <span><strong class="command">ndb_print_backup_file</strong></span>: Prints diagnostic
        information obtained from cluster backup files.
      </p></li><li><p>
        <span><strong class="command">ndb_print_schema_file</strong></span>: Prints diagnostic
        information obtained from cluster schema files.
      </p></li><li><p>
        <span><strong class="command">ndb_print_sys_file</strong></span>: Prints diagnostic
        information obtained from cluster system files.
      </p></li><li><p>
        <span><strong class="command">ndb_restore</strong></span>: This utility is used to restore
        a cluster from backup. See
        <a href="mysql-cluster.html#mysql-cluster-restore" title="20.9.3. ndb_restore — Restore a Cluster Backup">Section 20.9.3, “<span><strong class="command">ndb_restore</strong></span> — Restore a Cluster Backup”</a>, for more information.
      </p></li><li><p>
        <span><strong class="command">ndb_select_all</strong></span>: Prints all rows from an
        <code class="literal">NDB</code> table.
      </p></li><li><p>
        <span><strong class="command">ndb_select_count</strong></span>: Gets the number of rows in
        one or more <code class="literal">NDB</code> tables.
      </p></li><li><p>
        <span><strong class="command">ndb_show_tables</strong></span>: Shows all
        <code class="literal">NDB</code> tables anywhere in the cluster.
      </p></li><li><p>
        <span><strong class="command">ndb_size.pl</strong></span>: Examines all the tables in a
        given non-Cluster database and calculates the amount of storage
        each would require if it were converted to use the
        <code class="literal">NDB</code> storage engine.
      </p></li><li><p>
        <span><strong class="command">ndb_waiter</strong></span>: Reports on the status of cluster
        data nodes in a manner similar to that of the management client
        command <code class="literal">ALL STATUS</code>.
      </p></li><li><p>
        <span><strong class="command">ndbd_redo_log_reader</strong></span>: Reads a redo log file,
        checking it for errors, printing it in a human-readable format,
        or both.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          An alpha version of this utility was made available in MySQL
          Cluster NDB 6.1.3. Currently, it should be considered
          experimental.
        </p></div></li></ul></div><p>
    Most of these utilities need to connect to a Cluster management
    server in order to function. The exceptions are
    <code class="filename">ndb_size.pl</code> (see below), and the following
    utilities which access a cluster data node filesystem and so need to
    be run on a data node host:
  </p><div class="itemizedlist"><ul type="disc"><li><p>
        <span><strong class="command">ndb_print_backup_file</strong></span>
      </p></li><li><p>
        <span><strong class="command">ndb_print_schema_file</strong></span>
      </p></li><li><p>
        <span><strong class="command">ndb_print_sys_file</strong></span>
      </p></li><li><p>
        <span><strong class="command">ndbd_redo_log_reader</strong></span>
      </p></li></ul></div><p>
    <code class="filename">ndb_size.pl</code> is a Perl script which is also
    intended to be used from the shell; however it is a MySQL
    application and must be able to connect to a MySQL server. See
    <a href="mysql-cluster.html#mysql-cluster-utilities-ndb-size" title="20.10.15. ndb_size.pl — NDBCLUSTER Size Requirement Estimator">Section 20.10.15, “<span><strong class="command">ndb_size.pl</strong></span> — NDBCLUSTER Size Requirement Estimator”</a>, for additional
    requirements for using this script.
  </p><p>
    <span><strong class="command">ndb_error_reporter</strong></span> is also a Perl script. It is
    used to gather cluster data node and management node logs together
    into a tarball to submit along with a bug report. It can use
    <span><strong class="command">ssh</strong></span> or <span><strong class="command">scp</strong></span> to access the node
    filesystems remotely.
  </p><p>
    Additional information about each of these utilities (except for
    <span><strong class="command">ndb_mgm</strong></span> and <span><strong class="command">ndb_restore</strong></span>) can
    be found in the sections that follow.
  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
      All of these utilities (except for <span><strong class="command">ndb_size.pl</strong></span>
      and <span><strong class="command">ndb_config</strong></span>) can use the options discussed
      in <a href="mysql-cluster.html#mysql-cluster-command-options" title="20.6.5. Command Options for MySQL Cluster Processes">Section 20.6.5, “Command Options for MySQL Cluster Processes”</a>. Additional
      options specific to each utility program are discussed in the
      individual program listings.
    </p></div><p>
    The order in which these options are used is generally not
    important. For example, all of these commands produce exactly the
    same output:
  </p><div class="itemizedlist"><ul type="disc"><li><p>
        <code class="literal">ndb_desc -c localhost fish -d test</code>
      </p></li><li><p>
        <code class="literal">ndb_desc fish -c localhost -d test</code>
      </p></li><li><p>
        <code class="literal">ndb_desc -d test fish -c localhost</code>
      </p></li></ul></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-utilities-ndb-config"></a>20.10.1. <span><strong class="command">ndb_config</strong></span> — Extract NDB Configuration Information</h3></div></div></div><p>
          This tool extracts configuration information for data nodes,
          SQL nodes, and API nodes from a cluster management node (and
          possibly its <code class="filename">config.ini</code> file).
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_config <em class="replaceable"><code>options</code></em>
</pre><p>
          The <em class="replaceable"><code>options</code></em> available for this
          utility differ somewhat from those used with the other
          utilities, and so are listed in their entirety in the next
          section, followed by some examples.
        </p><p>
          <span class="bold"><strong>Options</strong></span>:
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              <a class="indexterm" name="id2367194"></a>

              <a class="indexterm" name="id2367206"></a>

              <code class="option">--usage</code>, <code class="option">--help</code>, or
              <code class="option">-?</code>
            </p><p>
              Causes <span><strong class="command">ndb_config</strong></span> to print a list of
              available options, and then exit.
            </p></li><li><p>
              <a class="indexterm" name="id2367245"></a>

              <a class="indexterm" name="id2367258"></a>

              <code class="option">--version</code>, <code class="option">-V</code>
            </p><p>
              Causes <span><strong class="command">ndb_config</strong></span> to print a version
              information string, and then exit.
            </p></li><li><p>
              <a class="indexterm" name="id2367293"></a>

              <a class="indexterm" name="id2367306"></a>

              <code class="option">--ndb-connectstring=<em class="replaceable"><code>connect_string</code></em></code>
            </p><p>
              Specifies the connectstring to use in connecting to the
              management server. The format for the connectstring is the
              same as described in
              <a href="mysql-cluster.html#mysql-cluster-connectstring" title="20.3.4.2. The Cluster Connectstring">Section 20.3.4.2, “The Cluster Connectstring”</a>, and
              defaults to <code class="literal">localhost:1186</code>.
            </p><p>
              The use of <code class="option">-c</code> as a short version for this
              option is supported for <span><strong class="command">ndb_config</strong></span>
              beginning with MySQL 5.1.12.
            </p></li><li><p>
              <a class="indexterm" name="id2367360"></a>

              <a class="indexterm" name="id2367372"></a>

              <code class="option">--config-file=<em class="replaceable"><code>path-to-file</code></em></code>
            </p><p>
              Gives the path to the management server's configuration
              file (<code class="filename">config.ini</code>). This may be a
              relative or absolute path. If the management node resides
              on a different host from the one on which
              <span><strong class="command">ndb_config</strong></span> is invoked, then an absolute
              path must be used.
            </p></li><li><p>
              <a class="indexterm" name="id2367415"></a>

              <a class="indexterm" name="id2367427"></a>

              <code class="option">--query=<em class="replaceable"><code>query-options</code></em></code>,
              <code class="option">-q</code>
              <em class="replaceable"><code>query-options</code></em>
            </p><p>
              This is a comma-delimited list of <em class="firstterm">query
              options</em> — that is, a list of one or more
              node attributes to be returned. These include
              <code class="literal">id</code> (node ID), type (node type —
              that is, <code class="literal">ndbd</code>,
              <code class="literal">mysqld</code>, or
              <code class="literal">ndb_mgmd</code>), and any configuration
              parameters whose values are to be obtained.
            </p><p>
              For example,

              <a class="indexterm" name="id2367491"></a>

              <a class="indexterm" name="id2367503"></a>

              <code class="option">--query=id,type,indexmemory,datamemory</code>
              would return the node ID, node type,
              <code class="literal">DataMemory</code>, and
              <code class="literal">IndexMemory</code> for each node.
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                If a given parameter is not applicable to a certain type
                of node, than an empty string is returned for the
                corresponding value. See the examples later in this
                section for more information.
              </p></div></li><li><p>
              <a class="indexterm" name="id2367547"></a>

              <a class="indexterm" name="id2367560"></a>

              <code class="option">--host=<em class="replaceable"><code>hostname</code></em></code>
            </p><p>
              Specifies the hostname of the node for which configuration
              information is to be obtained.
            </p></li><li><p>
              <a class="indexterm" name="id2367589"></a>

              <a class="indexterm" name="id2367601"></a>

              <code class="option">--id=<em class="replaceable"><code>node_id</code></em></code>,

              <a class="indexterm" name="id2367620"></a>

              <a class="indexterm" name="id2367632"></a>

              <code class="option">--nodeid=<em class="replaceable"><code>node_id</code></em></code>
            </p><p>
              Used to specify the node ID of the node for which
              configuration information is to be obtained.
            </p></li><li><p>
              <a class="indexterm" name="id2367661"></a>

              <a class="indexterm" name="id2367674"></a>

              <code class="option">--nodes</code>
            </p><p>
              (Tells <span><strong class="command">ndb_config</strong></span> to print information
              from parameters defined in <code class="literal">[ndbd]</code>
              sections only. Currently, using this option has no affect,
              since these are the only values checked, but it may become
              possible in future to query parameters set in
              <code class="literal">[tcp]</code> and other sections of cluster
              configuration files.)
            </p></li><li><p>
              <a class="indexterm" name="id2367720"></a>

              <a class="indexterm" name="id2367732"></a>

              <code class="option">--type=<em class="replaceable"><code>node_type</code></em></code>
            </p><p>
              Filters results so that only configuration values applying
              to nodes of the specified
              <em class="replaceable"><code>node_type</code></em>
              (<code class="literal">ndbd</code>, <code class="literal">mysqld</code>, or
              <code class="literal">ndb_mgmd</code>) are returned.
            </p></li><li><p>
              <a class="indexterm" name="id2367783"></a>

              <a class="indexterm" name="id2367796"></a>

              <code class="option">--fields=<em class="replaceable"><code>delimiter</code></em></code>,
              <code class="option">-f</code> <em class="replaceable"><code>delimiter</code></em>
            </p><p>
              Specifies a <em class="replaceable"><code>delimiter</code></em> string
              used to separate the fields in the result. The default is
              “<span class="quote"><code class="literal">,</code></span>” (the comma character).
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                If the <em class="replaceable"><code>delimiter</code></em> contains
                spaces or escapes (such as <code class="literal">\n</code> for the
                linefeed character), then it must be quoted.
              </p></div></li><li><p>
              <a class="indexterm" name="id2367859"></a>

              <a class="indexterm" name="id2367872"></a>

              <code class="option">--rows=<em class="replaceable"><code>separator</code></em></code>,
              <code class="option">-r</code> <em class="replaceable"><code>separator</code></em>
            </p><p>
              Specifies a <em class="replaceable"><code>separator</code></em> string
              used to separate the rows in the result. The default is a
              space character.
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                If the <em class="replaceable"><code>separator</code></em> contains
                spaces or escapes (such as <code class="literal">\n</code> for the
                linefeed character), then it must be quoted.
              </p></div></li></ul></div><p>
          <span class="bold"><strong>Examples</strong></span>:
        </p><div class="orderedlist"><ol type="1"><li><p>
              To obtain the node ID and type of each node in the
              cluster:
            </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_config --query=id,type --fields=':' --rows='\n'</code></strong>
1:ndbd
2:ndbd
3:ndbd
4:ndbd
5:ndb_mgmd
6:mysqld
7:mysqld
8:mysqld
9:mysqld
</pre><p>
              In this example, we used the <code class="option">--fields</code>
              options to separate the ID and type of each node with a
              colon character (<code class="literal">:</code>), and the
              <code class="option">--rows</code> options to place the values for
              each node on a new line in the output.
            </p></li><li><p>
              To produce a connectstring that can be used by data, SQL,
              and API nodes to connect to the management server:
            </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_config --config-file=usr/local/mysql/cluster-data/config.ini --query=hostname,portnumber --fields=: --rows=, --type=ndb_mgmd</code></strong>
192.168.0.179:1186

</pre></li><li><p>
              This invocation of <span><strong class="command">ndb_config</strong></span> checks
              only data nodes (using the <code class="option">--type</code>
              option), and shows the values for each node's ID and
              hostname, and its <code class="literal">DataMemory</code>,
              <code class="literal">IndexMemory</code>, and
              <code class="literal">DataDir</code> parameters:
            </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_config --type=ndbd --query=id,host,datamemory,indexmemory,datadir -f ' : ' -r '\n'</code></strong>
1 : 192.168.0.193 : 83886080 : 18874368 : /usr/local/mysql/cluster-data
2 : 192.168.0.112 : 83886080 : 18874368 : /usr/local/mysql/cluster-data
3 : 192.168.0.176 : 83886080 : 18874368 : /usr/local/mysql/cluster-data
4 : 192.168.0.119 : 83886080 : 18874368 : /usr/local/mysql/cluster-data
</pre><p>
              In this example, we used the short options
              <code class="option">-f</code> and <code class="option">-r</code> for setting
              the field delimiter and row separator, respectively.
            </p></li><li><p>
              To exclude results from any host except one in particular,
              use the <code class="option">--host</code> option:
            </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_config --host=192.168.0.176 -f : -r '\n' -q id,type</code></strong>
3:ndbd
5:ndb_mgmd
</pre><p>
              In this example, we also used the short form
              <code class="option">-q</code> to determine the attributes to be
              queried.
            </p><p>
              Similarly, you can limit results to a node with a specific
              ID using the <code class="option">--id</code> or
              <code class="option">--nodeid</code> option.
            </p></li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-utilities-ndb-cpcd"></a>20.10.2. <span><strong class="command">ndb_cpcd</strong></span> — Automate Testing for NDB Development</h3></div></div></div><p>
          This utility is found in the <code class="filename">libexec</code>
          directory. It is part of an internal automated test framework
          used in testing and bedugging MySQL Cluster. Because it can
          control processes on remote systems, it is not advisable to
          use <span><strong class="command">ndb_cpcd</strong></span> in a production cluster.
        </p><p>
          The source files for <span><strong class="command">ndb_cpcd</strong></span> may be found
          in the directory <code class="filename">storage/ndb/src/cw/cpcd</code>,
          in the MySQL 5.1 source tree.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-utilities-ndb-delete-all"></a>20.10.3. <span><strong class="command">ndb_delete_all</strong></span> — Delete All Rows from NDB Table</h3></div></div></div><p>
          <span><strong class="command">ndb_delete_all</strong></span> deletes all rows from the
          given <code class="literal">NDB</code> table. In some cases, this can be
          much faster than <code class="literal">DELETE</code> or even
          <code class="literal">TRUNCATE</code>.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_delete_all -c <em class="replaceable"><code>connect_string</code></em> <em class="replaceable"><code>tbl_name</code></em> -d <em class="replaceable"><code>db_name</code></em>
</pre><p>
          This deletes all rows from the table named
          <em class="replaceable"><code>tbl_name</code></em> in the database named
          <em class="replaceable"><code>db_name</code></em>. It is exactly equivalent
          to executing <code class="literal">TRUNCATE
          <em class="replaceable"><code>db_name</code></em>.<em class="replaceable"><code>tbl_name</code></em></code>
          in MySQL.
        </p><p>
          <span class="bold"><strong>Additional Options</strong></span>:
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              <a class="indexterm" name="id2368258"></a>

              <a class="indexterm" name="id2368270"></a>

              <code class="option">--transactional</code>, <code class="option">-t</code>
            </p><p>
              Use of this option causes the delete operation to be
              performed as a single transaction.
            </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
                With very large tables, using this option may cause the
                number of operations available to the cluster to be
                exceeded.
              </p></div></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-utilities-ndb-desc"></a>20.10.4. <span><strong class="command">ndb_desc</strong></span> — Describe NDB Tables</h3></div></div></div><p>
          <span><strong class="command">ndb_desc</strong></span> provides a detailed description of
          one or more <code class="literal">NDB</code> tables.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_desc -c <em class="replaceable"><code>connect_string</code></em> <em class="replaceable"><code>tbl_name</code></em> -d <em class="replaceable"><code>db_name</code></em> [-p]
</pre><p>
          <span class="bold"><strong>Sample Output</strong></span>:
        </p><p>
          MySQL table creation and population statements:
        </p><pre class="programlisting">USE test;

CREATE TABLE fish (
    id INT(11) NOT NULL AUTO_INCREMENT,
    name VARCHAR(20),

    PRIMARY KEY pk (id),
    UNIQUE KEY uk (name)
) ENGINE=NDBCLUSTER;

INSERT INTO fish VALUES 
    ('','guppy'), ('','tuna'), ('','shark'), 
    ('','manta ray'), ('','grouper'), ('','puffer');
</pre><p>
          Output from <span><strong class="command">ndb_desc</strong></span>:
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_desc -c localhost fish -d test -p</code></strong>
-- fish --
Version: 16777221
Fragment type: 5
K Value: 6
Min load factor: 78
Max load factor: 80
Temporary table: no
Number of attributes: 2
Number of primary keys: 1
Length of frm data: 268
Row Checksum: 1
Row GCI: 1
TableStatus: Retrieved
-- Attributes --
id Int PRIMARY KEY DISTRIBUTION KEY AT=FIXED ST=MEMORY
name Varchar(20;latin1_swedish_ci) NULL AT=SHORT_VAR ST=MEMORY

-- Indexes --
PRIMARY KEY(id) - UniqueHashIndex
uk(name) - OrderedIndex
PRIMARY(id) - OrderedIndex
uk$unique(name) - UniqueHashIndex

-- Per partition info --
Partition  Row count  Commit count  Frag fixed memory  Frag varsized memory
2          2          2             65536              327680
1          2          2             65536              327680
3          2          2             65536              327680

NDBT_ProgramExit: 0 - OK
</pre><p>
          <span class="bold"><strong>Additional Options</strong></span>:
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              <a class="indexterm" name="id2368424"></a>

              <a class="indexterm" name="id2368436"></a>

              <code class="option">--extra-partition-info</code>,
              <code class="option">-p</code>
            </p><p>
              Prints additional information about the table's
              partitions.
            </p></li><li><p>
              Information about multiple tables can be obtained in a
              single invocation of <span><strong class="command">ndb_desc</strong></span> by using
              their names, separated by spaces. All of the tables must
              be in the same database.
            </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-utilities-ndb-drop-index"></a>20.10.5. <span><strong class="command">ndb_drop_index</strong></span> — Drop Index from NDB Table</h3></div></div></div><p>
          <span><strong class="command">ndb_drop_index</strong></span> drops the specified index
          from an <code class="literal">NDB</code> table. <span class="emphasis"><em>It is
          recommended that you use this utility only as an example for
          writing NDB API applications</em></span> — see the
          Warning later in this section for details.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_drop_index -c <em class="replaceable"><code>connect_string</code></em> <em class="replaceable"><code>table_name</code></em> <em class="replaceable"><code>index</code></em> -d <em class="replaceable"><code>db_name</code></em>
</pre><p>
          The statement shown above drops the index named
          <em class="replaceable"><code>index</code></em> from the
          <em class="replaceable"><code>table</code></em> in the
          <em class="replaceable"><code>database</code></em>.
        </p><p>
          <span class="bold"><strong>Additional Options</strong></span>: None that
          are specific to this application.
        </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
            <span class="emphasis"><em>Operations performed on Cluster table indexes
            using the NDB API are not visible to MySQL and make the
            table unusable by a MySQL server</em></span>. If you use this
            program to drop an index, then try to access the table from
            an SQL node, an error results, as shown here:
          </p></div><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_drop_index -c localhost dogs ix -d ctest1</code></strong>
Dropping index dogs/idx...OK

NDBT_ProgramExit: 0 - OK

shell&gt; <strong class="userinput"><code>./mysql -u jon -p ctest1</code></strong>
Enter password: *******
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 7 to server version: 5.1.12-beta-20060817

Type 'help;' or '\h' for help. Type '\c' to clear the buffer.

mysql&gt; SHOW TABLES;
+------------------+
| Tables_in_ctest1 |
+------------------+
| a                |
| bt1              |
| bt2              |
| dogs             |
| employees        |
| fish             |
+------------------+
6 rows in set (0.00 sec)

mysql&gt; SELECT * FROM dogs;
<span class="errortext">ERROR 1296 (HY000): Got error 4243 'Index not found' from NDBCLUSTER</span>
</pre><p>
          In such a case, your <span class="emphasis"><em>only</em></span> option for
          making the table available to MySQL again is to drop the table
          and re-create it. You can use either the SQL
          statement<code class="literal">DROP TABLE</code> or the
          <span><strong class="command">ndb_drop_table</strong></span> utility (see
          <a href="mysql-cluster.html#mysql-cluster-utilities-ndb-drop-table" title="20.10.6. ndb_drop_table — Drop NDB Table">Section 20.10.6, “<span><strong class="command">ndb_drop_table</strong></span> — Drop NDB Table”</a>) to
          drop the table.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-utilities-ndb-drop-table"></a>20.10.6. <span><strong class="command">ndb_drop_table</strong></span> — Drop NDB Table</h3></div></div></div><p>
          <span><strong class="command">ndb_drop_table</strong></span> drops the specified
          <code class="literal">NDB</code> table. (If you try to use this on a
          table created with a storage engine other than NDB, it fails
          with the error <span class="errortext">723: No such table
          exists</span>.) This operation is extremely fast —
          in some cases, it can be an order of magnitude faster than
          using <code class="literal">DROP TABLE</code> on an
          <code class="literal">NDB</code> table from MySQL.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_drop_table -c <em class="replaceable"><code>connect_string</code></em> <em class="replaceable"><code>tbl_name</code></em> -d <em class="replaceable"><code>db_name</code></em>
</pre><p>
          <span class="bold"><strong>Additional Options</strong></span>: None.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-utilities-ndb-error-reporter"></a>20.10.7. <span><strong class="command">ndb_error_reporter</strong></span> — NDB Error-Reporting Utility</h3></div></div></div><p>
          <span><strong class="command">ndb_error_reporter</strong></span> creates an archive from
          data node and management node log files that can be used to
          help diagnose bugs or other problems with a cluster.
          <span class="emphasis"><em>It is highly recommended that you make use of this
          utility when filing reports of bugs in MySQL
          Cluster</em></span>.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_error_reporter <em class="replaceable"><code>path/to/config-file</code></em> [<em class="replaceable"><code>username</code></em>] [--fs]
</pre><p>
          This utility is intended for use on a management node host,
          and requires the path to the management host configuration
          file (<code class="filename">config.ini</code>). Optionally, you can
          supply the name of a user that is able to access the cluster's
          data nodes via SSH, in order to copy the data node log files.
          ndb_error_reporter then includes all of these files in archive
          that is created in the same directory in which it is run. The
          archive is named
          <code class="filename">ndb_error_report_<em class="replaceable"><code>YYYYMMDDHHMMSS</code></em>.tar.bz2</code>,
          where <em class="replaceable"><code>YYYYMMDDHHMMSS</code></em> is a datetime
          string.
        </p><p>
          If the <code class="option">--fs</code> is used, then the data node
          filesystems are also copied to the management host and
          included in the archive that is produced by this script. As
          data node filesystems can be extremely large even after being
          compressed, we ask that you please do <span class="emphasis"><em>not</em></span>
          send archives created using this option to MySQL AB unless you
          are specifically requested to do so.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-utilities-ndb-print-backup-file"></a>20.10.8. <span><strong class="command">ndb_print_backup_file</strong></span> — Print NDB Backup File Contents</h3></div></div></div><p>
          <span><strong class="command">ndb_print_backup_file</strong></span> obtains diagnostic
          information from a cluster backup file.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_print_backup_file <em class="replaceable"><code>file_name</code></em>
</pre><p>
          <em class="replaceable"><code>file_name</code></em> is the name of a cluster
          backup file. This can be any of the files
          (<code class="filename">.Data</code>, <code class="filename">.ctl</code>, or
          <code class="filename">.log</code> file) found in a cluster backup
          directory. These files are found in the data node's backup
          directory under the subdirectory
          <code class="filename">BACKUP-<em class="replaceable"><code>#</code></em></code>,
          where <em class="replaceable"><code>#</code></em> is the sequence number for
          the backup. For more information about cluster backup files
          and their contents, see
          <a href="mysql-cluster.html#mysql-cluster-backup-concepts" title="20.9.1. Cluster Backup Concepts">Section 20.9.1, “Cluster Backup Concepts”</a>.
        </p><p>
          Like <span><strong class="command">ndb_print_schema_file</strong></span> and
          <span><strong class="command">ndb_print_sys_file</strong></span> (and unlike most of the
          other <code class="literal">NDB</code> utilities that are intended to be
          run on a management server host or to connect to a management
          server) <span><strong class="command">ndb_print_backup_file</strong></span> must be run
          on a cluster data node, since it accesses the data node
          filesystem directly. Because it does not make use of the
          management server, this utility can be used when the
          management server is not running, and even when the cluster
          has been completely shut down.
        </p><p>
          <span class="bold"><strong>Additional Options</strong></span>: None.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-utilities-ndb-print-schema-file"></a>20.10.9. <span><strong class="command">ndb_print_schema_file</strong></span> — Print NDB Schema File Contents</h3></div></div></div><p>
          <span><strong class="command">ndb_print_schema_file</strong></span> obtains diagnostic
          information from a cluster schema file.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_print_schema_file <em class="replaceable"><code>file_name</code></em>
</pre><p>
          <em class="replaceable"><code>file_name</code></em> is the name of a cluster
          schema file. For more information about cluster schema files,
          see <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-ndbd-filesystemdir-files.html" target="_top">Cluster Data Node <code class="literal">FileSystemDir</code> Files</a>.
        </p><p>
          Like <span><strong class="command">ndb_print_backup_file</strong></span> and
          <span><strong class="command">ndb_print_sys_file</strong></span> (and unlike most of the
          other <code class="literal">NDB</code> utilities that are intended to be
          run on a management server host or to connect to a management
          server) <span><strong class="command">ndb_schema_backup_file</strong></span> must be run
          on a cluster data node, since it accesses the data node
          filesystem directly. Because it does not make use of the
          management server, this utility can be used when the
          management server is not running, and even when the cluster
          has been completely shut down.
        </p><p>
          <span class="bold"><strong>Additional Options</strong></span>: None.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-utilities-ndb-print-sys-file"></a>20.10.10. <span><strong class="command">ndb_print_sys_file</strong></span> — Print NDB System File Contents</h3></div></div></div><p>
          <span><strong class="command">ndb_print_sys_file</strong></span> obtains diagnostic
          information from a cluster system file.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_print_sys_file <em class="replaceable"><code>file_name</code></em>
</pre><p>
          <em class="replaceable"><code>file_name</code></em> is the name of a cluster
          system file (sysfile). Cluster system files are located in a
          data node's data directory (<code class="literal">DataDir</code>); the
          path under this directory to system files matches the pattern
          <code class="filename">ndb_<em class="replaceable"><code>#</code></em>_fs/D<em class="replaceable"><code>#</code></em>/DBDIH/P<em class="replaceable"><code>#</code></em>.sysfile</code>.
          In each case, the <em class="replaceable"><code>#</code></em> represents a
          number (not necessarily the same number). For more
          information, see
          <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-ndbd-filesystemdir-files.html" target="_top">Cluster Data Node <code class="literal">FileSystemDir</code> Files</a>.
        </p><p>
          Like <span><strong class="command">ndb_print_backup_file</strong></span> and
          <span><strong class="command">ndb_print_schema_file</strong></span> (and unlike most of
          the other <code class="literal">NDB</code> utilities that are intended
          to be run on a management server host or to connect to a
          management server) <span><strong class="command">ndb_print_backup_file</strong></span>
          must be run on a cluster data node, since it accesses the data
          node filesystem directly. Because it does not make use of the
          management server, this utility can be used when the
          management server is not running, and even when the cluster
          has been completely shut down.
        </p><p>
          <span class="bold"><strong>Additional Options</strong></span>: None.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-utilities-ndbd-redo-log-reader"></a>20.10.11. <span><strong class="command">ndbd_redo_log_reader</strong></span> — Check and Print Content of Cluster Redo Log</h3></div></div></div><p>
          Reads a redo log file, checking it for errors, printing its
          contents in a human-readable format, or both.
          <span><strong class="command">ndbd_redo_log_reader</strong></span> is intended for use
          primarily by MySQL developers and support personnel in
          debugging and diagnosing problems.
        </p><p>
          This utility was made available as part of default builds
          beginning with MySQL Cluster NDB 6.1.3. It remains under
          development, and its syntax and behavior are subject to change
          in future releases. For this reason, it should be considered
          experimental at this time.
        </p><p>
          The C++ source files for
          <span><strong class="command">ndbd_redo_log_reader</strong></span> can be found in the
          directory
          <code class="filename">/storage/ndb/src/kernel/blocks/dblqh/redoLogReader</code>.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndbd_redo_log_reader <em class="replaceable"><code>file_name</code></em> [<em class="replaceable"><code>options</code></em>]
</pre><p>
          <em class="replaceable"><code>file_name</code></em> is the name of a cluster
          REDO log file. REDO log files are located in the numbered
          directories under the data node's data directory
          (<code class="literal">DataDir</code>); the path under this directory to
          the REDO log files matches the pattern
          <code class="filename">ndb_<em class="replaceable"><code>#</code></em>_fs/D<em class="replaceable"><code>#</code></em>/LCP/<em class="replaceable"><code>#</code></em>/T<em class="replaceable"><code>#</code></em>F<em class="replaceable"><code>#</code></em>.Data</code>.
          In each case, the <em class="replaceable"><code>#</code></em> represents a
          number (not necessarily the same number). For more
          information, see
          <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-ndbd-filesystemdir-files.html" target="_top">Cluster Data Node <code class="literal">FileSystemDir</code> Files</a>.
        </p><p>
          <span class="bold"><strong>Additional Options</strong></span>:
        </p><p>
          The name of the file to be read may be followed by one or more
          of the options listed here:

          </p><div class="itemizedlist"><ul type="disc"><li><p>
                <code class="option">-noprint</code>: Do not print the contents of
                the log file.
              </p></li><li><p>
                <code class="option">-nocheck</code>: Do not check the log filre
                for errors.
              </p></li></ul></div><p>
        </p><p>
          Like <span><strong class="command">ndb_print_backup_file</strong></span> and
          <span><strong class="command">ndb_print_schema_file</strong></span> (and unlike most of
          the <code class="literal">NDB</code> utilities that are intended to be
          run on a management server host or to connect to a management
          server) <span><strong class="command">ndbd_redo_log_reader</strong></span> must be run on
          a cluster data node, since it accesses the data node
          filesystem directly. Because it does not make use of the
          management server, this utility can be used when the
          management server is not running, and even when the cluster
          has been completely shut down.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-utilities-ndb-select-all"></a>20.10.12. <span><strong class="command">ndb_select_all</strong></span> — Print Rows from NDB Table</h3></div></div></div><p>
          <span><strong class="command">ndb_select_all</strong></span> prints all rows from an
          <code class="literal">NDB</code> table to <code class="literal">stdout</code>.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_select_all -c <em class="replaceable"><code>connect_string</code></em> <em class="replaceable"><code>tbl_name</code></em> -d <em class="replaceable"><code>db_name</code></em> [&gt; <em class="replaceable"><code>file_name</code></em>]
</pre><p>
          <span class="bold"><strong>Additional Options</strong></span>:
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              <a class="indexterm" name="id2369452"></a>

              <a class="indexterm" name="id2369464"></a>

              <code class="option">--lock=<em class="replaceable"><code>lock_type</code></em></code>,
              <code class="option">-l <em class="replaceable"><code>lock_type</code></em></code>
            </p><p>
              Employs a lock when reading the table. Possible values for
              <em class="replaceable"><code>lock_type</code></em> are:
            </p><div class="itemizedlist"><ul type="circle"><li><p>
                  <code class="literal">0</code>: Read lock
                </p></li><li><p>
                  <code class="literal">1</code>: Read lock with hold
                </p></li><li><p>
                  <code class="literal">2</code>: Exclusive read lock
                </p></li></ul></div><p>
              There is no default value for this option.
            </p></li><li><p>
              <a class="indexterm" name="id2369547"></a>

              <a class="indexterm" name="id2369559"></a>

              <code class="option">--order=<em class="replaceable"><code>index_name</code></em></code>,
              <code class="option">-o <em class="replaceable"><code>index_name</code></em></code>
            </p><p>
              Orders the output according to the index named
              <em class="replaceable"><code>index_name</code></em>. Note that this is
              the name of an index, not of a column, and that the index
              must have been explicitly named when created.
            </p></li><li><p>
              <a class="indexterm" name="id2369598"></a>

              <a class="indexterm" name="id2369611"></a>

              <code class="option">--descending</code>, <code class="option">-z</code>
            </p><p>
              Sorts the output in descending order. This option can be
              used only in conjunction with the <code class="option">-o</code>
              (<code class="option">--order</code>) option.
            </p></li><li><p>
              <a class="indexterm" name="id2369648"></a>

              <a class="indexterm" name="id2369660"></a>

              <code class="option">--header=FALSE</code>
            </p><p>
              Excludes column headers from the output.
            </p></li><li><p>
              <a class="indexterm" name="id2369686"></a>

              <a class="indexterm" name="id2369699"></a>

              <code class="option">--useHexFormat</code> <code class="option">-x</code>
            </p><p>
              Causes all numeric values to be displayed in hexadecimal
              format. This does not affect the output of numerals
              contained in strings or datetime values.
            </p></li><li><p>
              <a class="indexterm" name="id2369729"></a>

              <a class="indexterm" name="id2369742"></a>

              <code class="option">--delimiter=<em class="replaceable"><code>character</code></em></code>,
              <code class="option">-D <em class="replaceable"><code>character</code></em></code>
            </p><p>
              Causes the <em class="replaceable"><code>character</code></em> to be used
              as a column delimiter. Only table data columns are
              separated by this delimiter.
            </p><p>
              The default delimiter is the tab character.
            </p></li><li><p>
              <a class="indexterm" name="id2369791"></a>

              <a class="indexterm" name="id2369804"></a>

              <code class="option">--disk</code>
            </p><p>
              Adds a disk reference column to the output. The column is
              non-empty only for Disk Data tables having non-indexed
              columns.
            </p></li><li><p>
              <a class="indexterm" name="id2369838"></a>

              <a class="indexterm" name="id2369850"></a>

              <code class="option">--rowid</code>
            </p><p>
              Adds a <code class="literal">ROWID</code> column providing
              information about the fragments in which rows are stored.
            </p></li><li><p>
              <a class="indexterm" name="id2369882"></a>

              <a class="indexterm" name="id2369895"></a>

              <code class="option">--gci</code>
            </p><p>
              Adds a column to the output showing the global checkpoint
              at which each row was last updated. See
              <a href="mysql-cluster.html#mysql-cluster-glossary" title="20.16. MySQL Cluster Glossary">Section 20.16, “MySQL Cluster Glossary”</a>, and
              <a href="mysql-cluster.html#mysql-cluster-log-events" title="20.7.3.2. Log Events">Section 20.7.3.2, “Log Events”</a>, for more
              information about checkpoints.
            </p></li><li><p>
              <a class="indexterm" name="id2369938"></a>

              <a class="indexterm" name="id2369950"></a>

              <code class="option">--tupscan</code>, <code class="option">-t</code>
            </p><p>
              Scan the table in the order of the tuples.
            </p></li><li><p>
              <a class="indexterm" name="id2369980"></a>

              <a class="indexterm" name="id2369992"></a>

              <code class="option">--nodata</code>
            </p><p>
              Causes any table data to be omitted.
            </p></li></ul></div><p>
          <span class="bold"><strong>Sample Output</strong></span>:
        </p><p>
          Output from a MySQL <code class="literal">SELECT</code> statement:
        </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM ctest1.fish;</code></strong>
+----+-----------+
| id | name      |
+----+-----------+
|  3 | shark     |
|  6 | puffer    |
|  2 | tuna      |
|  4 | manta ray |
|  5 | grouper   |
|  1 | guppy     |
+----+-----------+
6 rows in set (0.04 sec)
</pre><p>
          Output from the equivalent invocation of
          <span><strong class="command">ndb_select_all</strong></span>:
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_select_all -c localhost fish -d ctest1</code></strong>
id      name
3       [shark]
6       [puffer]
2       [tuna]
4       [manta ray]
5       [grouper]
1       [guppy]
6 rows returned

NDBT_ProgramExit: 0 - OK
</pre><p>
          Note that all string values are enclosed by square brackets
          (“<span class="quote"><code class="literal">[</code>...<code class="literal">]</code></span>”)
          in the output of <span><strong class="command">ndb_select_all</strong></span>. For a
          further example, consider the table created and populated as
          shown here:
        </p><pre class="programlisting">CREATE TABLE dogs (
    id INT(11) NOT NULL AUTO_INCREMENT,
    name VARCHAR(25) NOT NULL,
    breed VARCHAR(50) NOT NULL,
    PRIMARY KEY pk (id),
    KEY ix (name)
) 
TABLESPACE ts STORAGE DISK 
ENGINE=NDB;

INSERT INTO dogs VALUES 
    ('', 'Lassie', 'collie'),
    ('', 'Scooby-Doo', 'Great Dane'),
    ('', 'Rin-Tin-Tin', 'Alsatian'),
    ('', 'Rosscoe', 'Mutt');
</pre><p>
          This demonstrates the use of several additional
          <span><strong class="command">ndb_select_all</strong></span> options:
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_select_all -d ctest1 dogs -o ix -z --gci --disk</code></strong>        
GCI     id name          breed        DISK_REF
834461  2  [Scooby-Doo]  [Great Dane] [ m_file_no: 0 m_page: 98 m_page_idx: 0 ]
834878  4  [Rosscoe]     [Mutt]       [ m_file_no: 0 m_page: 98 m_page_idx: 16 ]
834463  3  [Rin-Tin-Tin] [Alsatian]   [ m_file_no: 0 m_page: 34 m_page_idx: 0 ]
835657  1  [Lassie]      [Collie]     [ m_file_no: 0 m_page: 66 m_page_idx: 0 ]
4 rows returned

NDBT_ProgramExit: 0 - OK
</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-utilities-ndb-select-count"></a>20.10.13. <span><strong class="command">ndb_select_count</strong></span> — Print Row Counts for NDB Tables</h3></div></div></div><p>
          <span><strong class="command">ndb_select_count</strong></span> prints the number of rows
          in one or more <code class="literal">NDB</code> tables. With a single
          table, the result is equivalent to that obtained by using the
          MySQL statement <code class="literal">SELECT COUNT(*) FROM
          <em class="replaceable"><code>tbl_name</code></em></code>.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_select_count [-c <em class="replaceable"><code>connect_string</code></em>] -d<em class="replaceable"><code>db_name</code></em> <em class="replaceable"><code>tbl_name</code></em>[, <em class="replaceable"><code>tbl_name2</code></em>[, ...]]
</pre><p>
          <span class="bold"><strong>Additional Options</strong></span>: None that
          are specific to this application. However, you can obtain row
          counts from multiple tables in the same database by listing
          the table names separated by spaces when invoking this
          command, as shown under <span class="bold"><strong>Sample
          Output</strong></span>.
        </p><p>
          <span class="bold"><strong>Sample Output</strong></span>:
        </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_select_count -c localhost -d ctest1 fish dogs</code></strong>
6 records in table fish
4 records in table dogs

NDBT_ProgramExit: 0 - OK
</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-utilities-ndb-show-tables"></a>20.10.14. <span><strong class="command">ndb_show_tables</strong></span> — Display List of NDB Tables</h3></div></div></div><p>
          <span><strong class="command">ndb_show_tables</strong></span> displays a list of all
          <code class="literal">NDB</code> database objects in the cluster. By
          default, this includes not only both user-created tables and
          <code class="literal">NDB</code> system tables, but
          <code class="literal">NDB</code>-specific indexes, internal triggers,
          and Cluster Disk Data objects as well.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_show_tables [-c <em class="replaceable"><code>connect_string</code></em>]
</pre><p>
          <span class="bold"><strong>Additional Options</strong></span>:
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              <a class="indexterm" name="id2370309"></a>

              <a class="indexterm" name="id2370321"></a>

              <code class="option">--loops</code>, <code class="option">-l</code>
            </p><p>
              Specifies the number of times the utility should execute.
              This is 1 when this option is not specified, but if you do
              use the option, you must supply an integer argument for
              it.
            </p></li><li><p>
              <a class="indexterm" name="id2370352"></a>

              <a class="indexterm" name="id2370365"></a>

              <code class="option">--parsable</code>, <code class="option">-p</code>
            </p><p>
              Using this option causes the output to be in a format
              suitable for use with <code class="literal">LOAD DATA INFILE</code>.
            </p></li><li><p>
              <a class="indexterm" name="id2370400"></a>

              <a class="indexterm" name="id2370413"></a>

              <code class="option">--type</code>, <code class="option">-t</code>
            </p><p>
              Can be used to restrict the output to one type of object,
              specified by an integer type code as shown here:
            </p><div class="itemizedlist"><ul type="circle"><li><p>
                  <span class="bold"><strong>1</strong></span>: System table
                </p></li><li><p>
                  <span class="bold"><strong>2</strong></span>: User-created table
                </p></li><li><p>
                  <span class="bold"><strong>3</strong></span>: Unique hash index
                </p></li></ul></div><p>
              Any other value causes all <code class="literal">NDB</code> database
              objects to be listed (the default).
            </p></li><li><p>
              <a class="indexterm" name="id2370493"></a>

              <a class="indexterm" name="id2370505"></a>

              <code class="option">--unqualified</code>, <code class="option">-u</code>
            </p><p>
              If specified, this causes unqualified object names to be
              displayed.
            </p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            Only user-created Cluster tables may be accessed from MySQL;
            system tables such as <code class="literal">SYSTAB_0</code> are not
            visible to <span><strong class="command">mysqld</strong></span>. However, you can
            examine the contents of system tables using
            <code class="literal">NDB</code> API applications such as
            <span><strong class="command">ndb_select_all</strong></span> (see
            <a href="mysql-cluster.html#mysql-cluster-utilities-ndb-select-all" title="20.10.12. ndb_select_all — Print Rows from NDB Table">Section 20.10.12, “<span><strong class="command">ndb_select_all</strong></span> — Print Rows from NDB Table”</a>).
          </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-utilities-ndb-size"></a>20.10.15. <span><strong class="command">ndb_size.pl</strong></span> — NDBCLUSTER Size Requirement Estimator</h3></div></div></div><p>
          This is a Perl script that can be used to estimate the amount
          of space that would be required by a MySQL database if it were
          converted to use the <code class="literal">NDBCLUSTER</code> storage
          engine. Unlike the other utilities discussed in this section,
          it does not require access to a MySQL Cluster (in fact, there
          is no reason for it to do so). However, it does need to access
          the MySQL server on which the database to be tested resides.
        </p><p>
          <span class="bold"><strong>Requirements</strong></span>:
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              A running MySQL server. The server instance does not have
              to provide support for MySQL Cluster.
            </p></li><li><p>
              A working installation of Perl.
            </p></li><li><p>
              The <code class="literal">DBI</code> module, which can be obtained
              from CPAN if it is not already part of your Perl
              installation. (Many Linux and other operating system
              distributions provide their own packages for this
              library.)
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                Previous to MySQL 5.1.18, <span><strong class="command">ndb_size.pl</strong></span>
                also required the <code class="literal">HTML::Template</code>
                module and an associated template file
                <code class="filename">share/mysql/ndb_size.tmpl</code>.
                Beginning with MySQL 5.1.18,
                <code class="filename">ndb_size.tmpl</code> is no longer needed
                (or included).
              </p></div></li><li><p>
              A MySQL user account having the necessary privileges. If
              you do not wish to use an existing account, then creating
              one using <code class="literal">GRANT USAGE ON
              <em class="replaceable"><code>db_name</code></em>.*</code> —
              where <em class="replaceable"><code>db_name</code></em> is the name of
              the database to be examined — is sufficient for this
              purpose.
            </p></li></ul></div><p>
          <code class="filename">ndb_size.pl</code> can also be found in the
          MySQL sources in <code class="filename">storage/ndb/tools</code>. If
          this file is not present in your MySQL installation, you can
          obtain it from the
          <a href="http://forge.mysql.com/projects/project.php?id=88" target="_top">MySQL
          Forge project page</a>.
        </p><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><p>
</p><pre class="programlisting">ndb_size.pl [--database=<em class="replaceable"><code>db_name</code></em>|ALL] [--hostname=<em class="replaceable"><code>host</code></em>[:<em class="replaceable"><code>port</code></em>]] [--socket=<em class="replaceable"><code>socket</code></em>] [--user=<em class="replaceable"><code>user</code></em>] \
    [--password=<em class="replaceable"><code>password</code></em>] [--help|-h] [--format=(html|text)] [--loadqueries=<em class="replaceable"><code>file_name</code></em>] [--savequeries=<em class="replaceable"><code>file_name</code></em>]
</pre><p>
        </p><p>
          By default, this utility attempts to analyze all databases on
          the server. You can specify a single database using the
          <code class="option">--database</code> option; the default behavior can
          be made explicit by using <code class="literal">ALL</code> for the name
          of the database. You can also exclude one or more databases by
          using the <code class="option">--excludedbs</code> with a comma-separated
          list of the names of the databases to be skipped. Similarly,
          you can cause specific tables to be skipped by listing their
          names, separated by commas, following the optional
          <code class="option">--excludetables</code> option. A hostname (and
          possibly a port as well) can be specified using
          <code class="option">--hostname</code>; the default is
          <code class="literal">localhost:3306</code>. If necessary, you can
          specify a socket; the default is
          <code class="filename">/var/lib/mysql.sock</code>. A MySQL username and
          password can be specified the corresponding options shown. It
          also possible to control the format of the output using the
          <code class="option">--format</code> option; this can take either of the
          values <code class="literal">html</code> or <code class="literal">text</code>,
          with <code class="literal">text</code> being the default. An example of
          the text output is shown here:

</p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_size.pl --database=test --socket=/tmp/mysql.sock</code></strong>
ndb_size.pl report for database: 'test' (1 tables)
--------------------------------------------------
Connected to: DBI:mysql:host=localhost;mysql_socket=/tmp/mysql.sock

Including information for versions: 4.1, 5.0, 5.1

test.t1
-------

DataMemory for Columns (* means varsized DataMemory):
              Column Name                 Type  Varsized   Key       4.1        5.0        5.1
          HIDDEN_NDB_PKEY               bigint             PRI         8          8          8
                       c2          varchar(50)         Y              52         52         4*
                       c1              int(11)                         4          4          4
                                                                      --         --         --
Fixed Size Columns DM/Row                                             64         64         12
   Varsize Columns DM/Row                                              0          0          4

DataMemory for Indexes:
               Index Name                 Type        4.1        5.0        5.1
                  PRIMARY                BTREE         16         16         16
                                                       --         --         --
       Total Index DM/Row                              16         16         16

IndexMemory for Indexes:
               Index Name        4.1        5.0        5.1
                  PRIMARY         33         16         16
                                  --         --         --
           Indexes IM/Row         33         16         16

Summary (for THIS table):
                                 4.1        5.0        5.1
    Fixed Overhead DM/Row         12         12         16
           NULL Bytes/Row          4          4          4
           DataMemory/Row         96         96         48  (Includes overhead, bitmap and indexes)

  Varsize Overhead DM/Row          0          0          8
   Varsize NULL Bytes/Row          0          0          4
       Avg Varside DM/Row          0          0         16

                 No. Rows          0          0          0

        Rows/32kb DM Page        340        340        680
Fixedsize DataMemory (KB)          0          0          0

Rows/32kb Varsize DM Page          0          0       2040
  Varsize DataMemory (KB)          0          0          0

         Rows/8kb IM Page        248        512        512
         IndexMemory (KB)          0          0          0

Parameter Minimum Requirements
------------------------------
* indicates greater than default

                Parameter          Default             4.1              5.0              5.1
          DataMemory (KB)            81920               0                0                0
       NoOfOrderedIndexes              128               1                1                1
               NoOfTables              128               1                1                1
         IndexMemory (KB)            18432               0                0                0
    NoOfUniqueHashIndexes               64               0                0                0
           NoOfAttributes             1000               3                3                3
             NoOfTriggers              768               5                5                5
</pre><p>
        </p><p>
          For debugging purposes, the Perl arrays containing the queries
          run by this script can be read from the file specified using
          can be saved to a file using <code class="option">--savequeries</code>; a
          file containing such arrays to be read in during script
          execution can be specified using
          <code class="option">--loadqueries</code>. Neither of these options has a
          default value.
        </p><p>
          To produce output in HTML format, use the
          <code class="option">--format</code> option and redirect the output to a
          file, as shown in this example:

</p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_size.pl --database=test --socket=/tmp/mysql.sock --format=html &gt; ndb_size.html</code></strong>
</pre><p>

          (Without the redirection, the output is sent to
          <code class="literal">stdout</code>.) This figure shows a portion of the
          generated <code class="filename">ndb_size.html</code> output file, as
          viewed in a Web browser:
        </p><div class="mediaobject"><img src="images/ndb-size-pl-1.png" alt="Partial sample output from
            ndb_size.pl as viewed in a Web
            browser."></div><p>
          The output from this script includes:

          </p><div class="itemizedlist"><ul type="disc"><li><p>
                Minimum values for the <code class="literal">DataMemory</code>,
                <code class="literal">IndexMemory</code>,
                <code class="literal">MaxNoOfTables</code>,
                <code class="literal">MaxNoOfAttributes</code>,
                <code class="literal">MaxNoOfOrderedIndexes</code>,
                <code class="literal">MaxNoOfUniqueHashIndexes</code>, and
                <code class="literal">MaxNoOfTriggers</code> configuration
                parameters required to accommodate the tables analyzed.
              </p></li><li><p>
                Memory requirements for all of the tables, attributes,
                ordered indexes, and unique hash indexes defined in the
                database.
              </p></li><li><p>
                The <code class="literal">IndexMemory</code> and
                <code class="literal">DataMemory</code> required per table and
                table row.
              </p></li></ul></div><p>
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            Prior to MySQL 5.1.23, MySQL Cluster NDB 6.2.5, and MySQL
            Cluster NDB 6.3.7, <code class="filename">ndb_size.pl</code> was
            invoked as shown here:

</p><pre class="programlisting">perl ndb_size.pl <em class="replaceable"><code>db_name</code></em> <em class="replaceable"><code>hostname</code></em> <em class="replaceable"><code>username</code></em> <em class="replaceable"><code>password</code></em> &gt; <em class="replaceable"><code>file_name</code></em>.html
</pre><p>

            For more information about this change, see <a href="http://bugs.mysql.com/28683" target="_top">Bug#28683</a> and
            <a href="http://bugs.mysql.com/28253" target="_top">Bug#28253</a>.
          </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-utilities-ndb-waiter"></a>20.10.16. <span><strong class="command">ndb_waiter</strong></span> — Wait for Cluster to Reach a Given Status</h3></div></div></div><p>
          <span><strong class="command">ndb_waiter</strong></span> repeatedly (each 100
          milliseconds) prints out the status of all cluster data nodes
          until either the cluster reaches a given status or the
          <code class="option">--timeout</code> limit is exceeded, then exits. By
          default, it waits for the cluster to achieve
          <code class="literal">STARTED</code> status, in which all nodes have
          started and connected to the cluster. This can be overridden
          using the <code class="option">--no-contact</code> and
          <code class="option">--not-started</code> options (see
          <a href="mysql-cluster.html#mysql-cluster-utilities-ndb-waiter-additional-options">Additional
          Options</a>).
        </p><p>
          The node states reported by this utility are as follows:
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              <code class="literal">NO_CONTACT</code>: The node cannot be
              contacted.
            </p></li><li><p>
              <code class="literal">UNKNOWN</code>: The node can be contacted, but
              its status is not yet known. Usually, this means that the
              node has received a <code class="literal">START</code> or
              <code class="literal">RESTART</code> command from the management
              server, but has not yet acted on it.
            </p></li><li><p>
              <code class="literal">NOT_STARTED</code>: The node has stopped, but
              remains in contact with the cluster. This is seen when
              restarting the node using the management client's
              <code class="literal">RESTART</code> command.
            </p></li><li><p>
              <code class="literal">STARTING</code>: The node's
              <span><strong class="command">ndbd</strong></span> process has started, but the node
              has not yet joined the cluster.
            </p></li><li><p>
              <code class="literal">STARTED</code>: The node is operational, and
              has joined the cluster.
            </p></li><li><p>
              <code class="literal">SHUTTING_DOWN</code>: The node is shutting
              down.
            </p></li><li><p>
              <code class="literal">SINGLE USER MODE</code>: This is shown for all
              cluster data nodes when the cluster is in single user
              mode.
            </p></li></ul></div><p>
          <span class="bold"><strong>Usage</strong></span>:
        </p><pre class="programlisting">ndb_waiter [-c <em class="replaceable"><code>connect_string</code></em>]
</pre><p><a name="mysql-cluster-utilities-ndb-waiter-additional-options"></a>
          <span class="bold"><strong>Additional Options</strong></span>:
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              <a class="indexterm" name="id2371315"></a>

              <a class="indexterm" name="id2371328"></a>

              <code class="option">--no-contact</code>, <code class="option">-n</code>
            </p><p>
              Instead of waiting for the <code class="literal">STARTED</code>
              state, <span><strong class="command">ndb_waiter</strong></span> continues running
              until the cluster reaches <code class="literal">NO_CONTACT</code>
              status before exiting.
            </p></li><li><p>
              <a class="indexterm" name="id2371376"></a>

              <a class="indexterm" name="id2371388"></a>

              <code class="option">--not-started</code>
            </p><p>
              Instead of waiting for the <code class="literal">STARTED</code>
              state, <span><strong class="command">ndb_waiter</strong></span> continues running
              until the cluster reaches <code class="literal">NOT_STARTED</code>
              status before exiting.
            </p></li><li><p>
              <a class="indexterm" name="id2371433"></a>

              <a class="indexterm" name="id2371445"></a>

              <code class="option">--timeout=<em class="replaceable"><code>seconds</code></em></code>,
              <code class="option">-t <em class="replaceable"><code>seconds</code></em></code>
            </p><p>
              Time to wait. The program exits if the desired state is
              not achieved within this number of seconds. The default is
              120 seconds (1200 reporting cycles).
            </p></li></ul></div><p><b>Sample Output. </b>
            Shown here is the output from <span><strong class="command">ndb_waiter</strong></span>
            when run against a 4-node cluster in which two nodes have
            been shut down and then started again manually. Duplicate
            reports (indicated by “<span class="quote"><code class="literal">...</code></span>”)
            are omitted.
          </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./ndb_waiter -c localhost</code></strong>

Connecting to mgmsrv at (localhost)
State node 1 STARTED
State node 2 NO_CONTACT
State node 3 STARTED
State node 4 NO_CONTACT
Waiting for cluster enter state STARTED

...

State node 1 STARTED
State node 2 UNKNOWN
State node 3 STARTED
State node 4 NO_CONTACT
Waiting for cluster enter state STARTED

...

State node 1 STARTED
State node 2 STARTING
State node 3 STARTED
State node 4 NO_CONTACT
Waiting for cluster enter state STARTED

...

State node 1 STARTED
State node 2 STARTING
State node 3 STARTED
State node 4 UNKNOWN
Waiting for cluster enter state STARTED

...

State node 1 STARTED
State node 2 STARTING
State node 3 STARTED
State node 4 STARTING
Waiting for cluster enter state STARTED

...

State node 1 STARTED
State node 2 STARTED
State node 3 STARTED
State node 4 STARTING
Waiting for cluster enter state STARTED

...

State node 1 STARTED
State node 2 STARTED
State node 3 STARTED
State node 4 STARTED
Waiting for cluster enter state STARTED

NDBT_ProgramExit: 0 - OK
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            If no connectstring is specified, then
            <span><strong class="command">ndb_waiter</strong></span> tries to connect to a
            management on <code class="literal">localhost</code>, and reports
            <code class="literal">Connecting to mgmsrv at (null)</code>.
          </p></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-replication"></a>20.11. MySQL Cluster Replication</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-abbreviations">20.11.1. Abbreviations and Symbols</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-general">20.11.2. Assumptions and General Requirements</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-issues">20.11.3. Known Issues in MySQL Cluster Replication</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-schema">20.11.4. Cluster Replication Schema and Tables</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-preparation">20.11.5. Preparing the Cluster for Replication</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-starting">20.11.6. Starting Replication (Single Replication Channel)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-two-channels">20.11.7. Using Two Replication Channels</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-failover">20.11.8. Implementing Failover with MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-backups">20.11.9. MySQL Cluster Backups With Replication</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-conflict-resolution">20.11.10. MySQL Cluster Replication Conflict Resolution</a></span></dt></dl></div><a class="indexterm" name="id2371558"></a><a class="indexterm" name="id2371574"></a><a class="indexterm" name="id2371590"></a><a class="indexterm" name="id2371599"></a><a class="indexterm" name="id2371612"></a><p>
    Previous to MySQL 5.1.6, <em class="firstterm">asynchronous
    replication</em>, more usually referred to simply as
    “<span class="quote">replication</span>”, was not available when using MySQL
    Cluster. MySQL 5.1.6 introduces master-slave replication of this
    type for MySQL Cluster databases. This section explains how to set
    up and manage a configuration wherein one group of computers
    operating as a MySQL Cluster replicates to a second computer or
    group of computers. We assume some familiarity on the part of the
    reader with standard MySQL replication as discussed elsewhere in
    this Manual. (See <a href="replication.html" title="Chapter 19. Replication">Chapter 19, <i>Replication</i></a>).
  </p><p>
    Normal (non-clustered) replication involves a “<span class="quote">master</span>”
    server and a “<span class="quote">slave</span>” server, the master being the
    source of the operations and data to be replicated and the slave
    being the recipient of these. In MySQL Cluster, replication is
    conceptually very similar but can be more complex in practice, as it
    may be extended to cover a number of different configurations
    including replicating between two complete clusters. Although a
    MySQL Cluster itself depends on the <code class="literal">NDBCLUSTER</code>
    storage engine for clustering functionality, it is not necessary to
    use the Cluster storage engine on the slave. However, for maximum
    availability, it is possible to replicate from one MySQL Cluster to
    another, and it is this type of configuration that we discuss, as
    shown in the following figure:
  </p><div class="mediaobject"><img src="images/cluster-replication-overview.png" alt="MySQL Cluster-to-Cluster Replication
      Layout"></div><p>
    In this scenario, the replication process is one in which successive
    states of a master cluster are logged and saved to a slave cluster.
    This process is accomplished by a special thread known as the NDB
    binlog injector thread, which runs on each MySQL server and produces
    a binary log (<code class="literal">binlog</code>). This thread ensures that
    all changes in the cluster producing the binary log — and not
    just those changes that are effected via the MySQL Server —
    are inserted into the binary log with the correct serialization
    order. We refer to the MySQL replication master and replication
    slave servers as replication servers or replication nodes, and the
    data flow or line of communication between them as a
    <em class="firstterm">replication channel</em>.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-replication-abbreviations"></a>20.11.1. Abbreviations and Symbols</h3></div></div></div><a class="indexterm" name="id2371719"></a><p>
      Throughout this section, we use the following abbreviations or
      symbols for referring to the master and slave clusters, and to
      processes and commands run on the clusters or cluster nodes:
    </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Symbol or Abbreviation</strong></span></td><td><span class="bold"><strong>Description (Refers to...)</strong></span></td></tr><tr><td><em class="replaceable"><code>M</code></em></td><td>The cluster serving as the (primary) replication master</td></tr><tr><td><em class="replaceable"><code>S</code></em></td><td>The cluster acting as the (primary) replication slave</td></tr><tr><td><code class="literal">shell<em class="replaceable"><code>M</code></em>&gt;</code></td><td>Shell command to be issued on the master cluster</td></tr><tr><td><code class="literal">mysql<em class="replaceable"><code>M</code></em>&gt;</code></td><td>MySQL client command issued on a single MySQL server running as an SQL
              node on the master cluster</td></tr><tr><td><code class="literal">mysql<em class="replaceable"><code>M*</code></em>&gt;</code></td><td>MySQL client command to be issued on all SQL nodes participating in the
              replication master cluster</td></tr><tr><td><code class="literal">shell<em class="replaceable"><code>S</code></em>&gt;</code></td><td>Shell command to be issued on the slave cluster</td></tr><tr><td><code class="literal">mysql<em class="replaceable"><code>S</code></em>&gt;</code></td><td>MySQL client command issued on a single MySQL server running as an SQL
              node on the slave cluster</td></tr><tr><td><code class="literal">mysql<em class="replaceable"><code>S*</code></em>&gt;</code></td><td>MySQL client command to be issued on all SQL nodes participating in the
              replication slave cluster</td></tr><tr><td><em class="replaceable"><code>C</code></em></td><td>Primary replication channel</td></tr><tr><td><em class="replaceable"><code>C'</code></em></td><td>Secondary replication channel</td></tr><tr><td><em class="replaceable"><code>M'</code></em></td><td>Secondary replication master</td></tr><tr><td><em class="replaceable"><code>S'</code></em></td><td>Secondary replication slave</td></tr></tbody></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-replication-general"></a>20.11.2. Assumptions and General Requirements</h3></div></div></div><a class="indexterm" name="id2371955"></a><p>
      A replication channel requires two MySQL servers acting as
      replication servers (one each for the master and slave). For
      example, this means that in the case of a replication setup with
      two replication channels (to provide an extra channel for
      redundancy), there will be a total of four replication nodes, two
      per cluster.
    </p><p>
      Replication of a MySQL Cluster as described in this section and
      those following is dependent on row-based replication. This means
      that the replication master MySQL server must be started with
      <code class="option">--binlog-format=ROW</code> or
      <code class="option">--binlog-format=MIXED</code>, as described in
      <a href="mysql-cluster.html#mysql-cluster-replication-starting" title="20.11.6. Starting Replication (Single Replication Channel)">Section 20.11.6, “Starting Replication (Single Replication Channel)”</a>. For general
      information about row-based replication, see
      <a href="replication.html#replication-formats" title="19.1.2. Replication Formats">Section 19.1.2, “Replication Formats”</a>.
    </p><p>
      (It is possible to replicate a MySQL Cluster using statement-based
      replication. However, in this case, the following restrictions
      apply: All updates to data rows on the cluster acting as the
      master must be directed to a single MySQL server; It is not
      possible to replicate a cluster using several MySQL replication
      processes at the same time; Only changes made at the SQL level are
      replicated.)
    </p><p>
      Each MySQL server used for replication in either cluster must be
      uniquely identified among all the MySQL replication servers
      participating in either cluster (you cannot have replication
      servers on both the master and slave clusters sharing the same
      ID). This can be done by starting each SQL node using the
      <code class="option">--server-id=<em class="replaceable"><code>id</code></em></code>
      option, where <em class="replaceable"><code>id</code></em> is a unique integer.
      Although it is not strictly necessary, we will assume for purposes
      of this discussion that all MySQL installations are the same
      version.
    </p><p>
      In any event, both MySQL servers involved in replication must be
      compatible with one another with respect to both the version of
      the replication protocol used and the SQL feature sets which they
      support; the simplest and easiest way to assure that this is the
      case is to use the same MySQL version for all servers involved.
      Note that in many cases it is not possible to replicate to a slave
      running a version of MySQL with a lower version number than that
      of the master — see
      <a href="replication.html#replication-compatibility" title="19.3.2. Replication Compatibility Between MySQL Versions">Section 19.3.2, “Replication Compatibility Between MySQL Versions”</a>, for details.
    </p><p>
      We assume that the slave server or cluster is dedicated to
      replication of the master, and that no other data is being stored
      on it.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-replication-issues"></a>20.11.3. Known Issues in MySQL Cluster Replication</h3></div></div></div><a class="indexterm" name="id1812728"></a><p>
      The following are known problems or issues when using replication
      with MySQL Cluster in MySQL 5.1:
    </p><div class="itemizedlist"><ul type="disc"><li><p><b>Loss of master-slave connection. </b><a class="indexterm" name="id1812754"></a>
            Prior to MySQL 5.1.18, a MySQL Cluster replication slave
            <span><strong class="command">mysqld</strong></span> had no way of detecting that the
            connection from the master had been interrupted (due to, for
            instance, the master going down or a network failure). For
            this reason, it was possible for the slave to become
            inconsistent with the master.
          </p><p>
          Beginning with MySQL 5.1.18, the master issues a
          “<span class="quote">gap</span>” event when connecting to the cluster. When
          the slave encounters a gap in the replication log, it stops
          with an error message. This message is available in the output
          of <code class="literal">SHOW SLAVE STATUS</code>, and indicates that
          the SQL thread has stopped due to an incident registered in
          the replication stream, and that manual intervention is
          required. In order to restart the slave, it is necessary to
          issue the following commands:

</p><pre class="programlisting">SET GLOBAL SQL_SLAVE_SKIP_COUNTER = 1;
START SLAVE; 
</pre><p>

          The slave then resumes reading the master binlog from the
          point where the gap was recorded.
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
            If high availability is a requirement for the slave server
            or cluster, then it is still advisable to set up multiple
            replication lines, to monitor the master
            <span><strong class="command">mysqld</strong></span> on the primary replication line,
            and to fail over to a secondary line if and as necessary.
            For information about implementing this type of setup, see
            <a href="mysql-cluster.html#mysql-cluster-replication-two-channels" title="20.11.7. Using Two Replication Channels">Section 20.11.7, “Using Two Replication Channels”</a>,
            and <a href="mysql-cluster.html#mysql-cluster-replication-failover" title="20.11.8. Implementing Failover with MySQL Cluster">Section 20.11.8, “Implementing Failover with MySQL Cluster”</a>.
          </p><p>
            However, if you are replicating from a standalone MySQL
            server to a MySQL Cluster, one channel is usually
            sufficient.
          </p></div></li><li><p><b>Multi-byte character sets. </b><a class="indexterm" name="id2372304"></a><a class="indexterm" name="id2372317"></a>
            There are several known issues with regard to the use of
            multi-byte characters sets with MySQL Cluster Replication.
            See <a href="http://bugs.mysql.com/27404" target="_top">Bug#27404</a> (fixed in MySQL 5.1.21), <a href="http://bugs.mysql.com/29562" target="_top">Bug#29562</a>, <a href="http://bugs.mysql.com/29563" target="_top">Bug#29563</a>, and <a href="http://bugs.mysql.com/29564" target="_top">Bug#29564</a> for more information.
          </p></li><li><p><b>Circular replication. </b><a class="indexterm" name="id2372375"></a><a class="indexterm" name="id2372388"></a><a class="indexterm" name="id2372400"></a>
            Prior to MySQL 5.1.18, circular replication was not
            supported with MySQL Cluster replication, due to the fact
            that all log events created in a particular MySQL Cluster
            were wrongly tagged with the server ID of the MySQL server
            used as master and not with the server ID of the originating
            server.
          </p><p>
          Beginning with MySQL 5.1.18, this limitation is lifted, as
          discussed in the next few paragraphs, in which we consider the
          example of a replication setup involving three MySQL Clusters
          numbered 1, 2, and 3, in which Cluster 1 acts as the
          replication master for Cluster 2, Cluster 2 acts as the master
          for Cluster 3, and Cluster 3 acts as the master for Cluster 1.
          Each cluster has two SQL nodes, with SQL nodes A and B
          belonging to Cluster 1, SQL nodes C and D belonging to Cluster
          2, and SQL nodes E and F belonging to Cluster 3.
        </p><p>
          Circular replication using these clusters is supported as long
          as:

          </p><div class="itemizedlist"><ul type="circle"><li><p>
                the SQL nodes on all masters and slaves are the same
              </p></li><li><p>
                All SQL nodes acting as replication masters and slaves
                are started using the
                <code class="option">--log-slave-updates</code> option
              </p></li></ul></div><p>

          This type of circular replication setup is shown in the
          following diagram:

          </p><div class="mediaobject"><img src="images/cluster-circular-replication-1.png" alt="Cluster circular replication scheme in
              which all master SQL nodes are also slaves."></div><p>

          In this scenario, SQL node A in Cluster 1 replicates to SQL
          node C in Cluster 2; SQL node C replicates to SQL node E in
          Cluster 3; SQL node E replicates to SQL node A. In other
          words, the replication line (indicated by the red arrows in
          the diagram) directly connects all SQL nodes used as
          replication masters and slaves.
        </p><p>
          It should also be possible to set up circular replication in
          which not all master SQL nodes are also slaves, as shown here:

          </p><div class="mediaobject"><img src="images/cluster-circular-replication-2.png" alt="Cluster circular replication scheme in
              which all master SQL nodes are not also necessarily
              slaves."></div><p>

          In this case, different SQL nodes in each cluster are used as
          replication masters and slaves. However, you must
          <span class="emphasis"><em>not</em></span> start any of the SQL nodes using
          <code class="option">--log-slave-updates</code> (see the
          <a href="replication.html#option_mysqld_log-slave-updates">description of
          this option</a> for more information). This type of
          circular replication scheme for MySQL Cluster, in which the
          line of replication (again indicated by the red arrows in the
          diagram) is discontinuous, should be possible, but it should
          be noted that it has not yet been thoroughly tested and must
          therefore still be considered experimental.
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
            Beginning with MySQL 5.1.24, you should execute the
            following statement before starting circular replication:

</p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SET GLOBAL SLAVE_EXEC_MODE = 'IDEMPOTENT';</code></strong>
</pre><p>

            This is necessary to suppress duplicate-key and other errors
            that otherwise break circular replication of MySQL Cluster.
            <code class="literal">IDEMPOTENT</code> mode is also required for
            multi-master replication when using MySQL Cluster. (<a href="http://bugs.mysql.com/31609" target="_top">Bug#31609</a>)
          </p><p>
            See
            <a href="server-administration.html#option_mysqld_slave_exec_mode"><code class="literal">Slave_exec_mode</code></a>,
            for more information.
          </p></div></li><li><p><b>DDL statements. </b><a class="indexterm" name="id2372583"></a>
            The use of data definition statements, such as
            <code class="literal">CREATE TABLE</code>, <code class="literal">DROP
            TABLE</code>, and <code class="literal">ALTER TABLE</code>, are
            recorded in the binary log for only the MySQL server on
            which they are issued.
          </p></li><li><p><b>Cluster replication and primary keys. </b><a class="indexterm" name="id2372628"></a>
            In MySQL 5.1.6, only those <code class="literal">NDB</code> tables
            having explicit primary keys could be replicated. This
            limitation was lifted in MySQL 5.1.7. However, in the event
            of a node failure, errors in replication of
            <code class="literal">NDB</code> tables without primary keys can still
            occur, due to the possibility of duplicate rows being
            inserted in such cases. For this reason, it is highly
            recommended that all <code class="literal">NDB</code> tables being
            replicated have primary keys.
          </p></li><li><p><b>Restarting with <code class="option">--initial</code>. </b><a class="indexterm" name="id2372678"></a>
            Restarting the cluster with the <code class="option">--initial</code>
            option causes the sequence of GCI and epoch numbers to start
            over from <code class="literal">0</code>. (This is generally true of
            MySQL Cluster and not limited to replication scenarios
            involving Cluster.) The MySQL servers involved in
            replication should in this case be restarted. After this,
            you should use the <code class="literal">RESET MASTER</code> and
            <code class="literal">RESET SLAVE</code> statements to clear the
            invalid <code class="literal">ndb_binlog_index</code> and
            <code class="literal">ndb_apply_status</code> tables. respectively.
          </p></li><li><p><b><code class="literal">auto_increment_offset</code> and
            <code class="literal">auto_increment_increment</code> variables. </b><a class="indexterm" name="id2372751"></a>
            The use of the <code class="literal">auto_increment_offset</code> and
            <code class="literal">auto_increment_increment</code> server system
            variables is supported beginning with MySQL 5.1.20.
            Previously, these produced unpredictable results when used
            with <code class="literal">NDB</code> tables or MySQL Cluster
            replication.
          </p></li><li><p><b>Replication from <code class="literal">NDBCLUSTER</code> to other storage engines. </b><a class="indexterm" name="id2372803"></a>
            If you attempt to replicate from a MySQL Cluster to a slave
            that uses a storage engine that does not handle its own
            binary logging, the replication process aborts with the
            error <span class="errortext">Binary logging not possible ... Statement
            cannot be written atomically since more than one engine
            involved and at least one engine is self-logging</span>
            (Error <span class="errorcode">1595</span>). It is possible to work
            around this issue in one of the following ways:

            </p><div class="itemizedlist"><ul type="circle"><li><p><b>Turn off binary logging on the slave. </b>
                    This can be accomplished by setting
                    <code class="literal">SQL_LOG_BIN = 0</code>.
                  </p></li><li><p><b>Change the storage engine used for the
                    <code class="literal">mysql.ndb_apply_status</code> table. </b>
                    Causing this table to use an engine that does not
                    handle its own binary logging can also eliminate the
                    conflict. This can be done by issuing a statement
                    such as <code class="literal">ALTER TABLE mysql.ndb_apply_status
                    ENGINE=MyISAM</code> on the slave. It is safe to
                    do this when using a non-<code class="literal">NDB</code>
                    storage engine on the slave, since you do not then
                    need to worry about keeping multiple slave SQL nodes
                    synchronized.
                  </p></li><li><p><b>Filter out changes to the <code class="literal">mysql.ndb_apply_status</code>
                    table on the slave. </b>
                    This can be done by starting the slave SQL node with
                    the option
                    <code class="option">--replicate-ignore-table=mysql.ndb_apply_status</code>.
                    If you need for other tables to be ignored by
                    replication, you might wish to use an appropriate
                    <code class="option">--replicate-wild-ignore-table</code>
                    option instead.
                  </p></li></ul></div><p>

            </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
                You should <span class="emphasis"><em>not</em></span> disable replication
                or binary logging of
                <code class="literal">mysql.ndb_apply_status</code> or change the
                storage engine used for this table when replicating from
                one MySQL Cluster to another. See <em class="citetitle">Replication
                and binary log filtering rules with replication between
                MySQL Clusters</em> elsewhere in this section for
                details.
              </p></div><p>
          </p></li><li><p><b>Replication and binary log filtering rules with replication between
            MySQL Clusters. </b>
            If you are using any of the options
            <code class="option">--replicate-do-*</code>,
            <code class="option">--replicate-ignore-*</code>,
            <code class="option">--binlog-do-db</code>, or
            <code class="option">--binlog-ignore-db</code> to filter databases or
            tables being replicated, care must be taken not to block
            replication or binary logging of the
            <code class="literal">mysql.ndb_apply_status</code>, which is required
            for replication between MySQL Clusters to operate properly.
            In particular, you must keep in mind the following:

            </p><div class="orderedlist"><ol type="1"><li><p>
                  Using
                  <code class="option">--replicate-do-db=<em class="replaceable"><code>db_name</code></em></code>
                  (and no other <code class="option">--replicate-do-*</code> or
                  <code class="option">--replicate-ignore-*</code> options) means
                  that <span class="emphasis"><em>only</em></span> tables in database
                  <em class="replaceable"><code>db_name</code></em> are replicated. In
                  this case, you should also use
                  <code class="option">--replicate-do-db=mysql</code>,
                  <code class="option">--binlog-do-db=mysql</code>, or
                  <code class="option">--replicate-do-table=mysql.ndb_apply_status</code>
                  to insure that
                  <code class="literal">mysql.ndb_apply_status</code> is populated
                  on slaves.
                </p><p>
                  Using
                  <code class="option">--binlog-do-db=<em class="replaceable"><code>db_name</code></em></code>
                  (and no other <code class="option">--binlog-do-db</code> options)
                  means that changes <span class="emphasis"><em>only</em></span> to tables
                  in database <em class="replaceable"><code>db_name</code></em> are
                  written to the binary log. In this case, you should
                  also use <code class="option">--replicate-do-db=mysql</code>,
                  <code class="option">--binlog-do-db=mysql</code>, or
                  <code class="option">--replicate-do-table=mysql.ndb_apply_status</code>
                  to insure that
                  <code class="literal">mysql.ndb_apply_status</code> is populated
                  on slaves.
                </p></li><li><p>
                  Using <code class="option">--replicate-ignore-db=mysql</code>
                  means that no tables in the <code class="literal">mysql</code>
                  database are replicated. In this case, you should also
                  use
                  <code class="option">--replicate-do-table=mysql.ndb_apply_status</code>
                  to insure that
                  <code class="literal">mysql.ndb_apply_status</code> is
                  replicated.
                </p><p>
                  Using <code class="option">--binlog-ignore-db=mysql</code> means
                  that no changes to tables in the
                  <code class="literal">mysql</code> database are written to the
                  binary log. In this case, you should also use
                  <code class="option">--replicate-do-table=mysql.ndb_apply_status</code>
                  to insure that
                  <code class="literal">mysql.ndb_apply_status</code> is
                  replicated.
                </p></li></ol></div><p>

            You should also remember that:

            </p><div class="orderedlist"><ol type="1"><li><p>
                  Each replication filtering rule requires its own
                  <code class="option">--replicate-do-*</code> or
                  <code class="option">--replicate-ignore-*</code> option, and that
                  multiple rules cannot be expressed in a single
                  replication filtering option. For information about
                  these rules, see
                  <a href="replication.html#replication-options" title="19.1.3. Replication Options and Variables">Section 19.1.3, “Replication Options and Variables”</a>.
                </p></li><li><p>
                  Each binary log filtering rule requires its own
                  <code class="option">--binlog-do-db</code> or
                  <code class="option">--binlog-ignore-db</code> option, and that
                  multiple rules cannot be expressed in a single binary
                  log filtering option. For information about these
                  rules, see <a href="server-administration.html#binary-log" title="5.2.4. The Binary Log">Section 5.2.4, “The Binary Log”</a>.
                </p></li></ol></div><p>

            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                If you are replicating a MySQL Cluster to a slave that
                uses a storage engine other than
                <code class="literal">NDBCLUSTER</code>, the considerations just
                given previously may not apply. See
                <em class="citetitle">Replication from
                <code class="literal">NDBCLUSTER</code> to other storage
                engines</em> elsewhere in this this section for
                details.
              </p></div><p>
          </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-replication-schema"></a>20.11.4. Cluster Replication Schema and Tables</h3></div></div></div><a class="indexterm" name="id2373218"></a><a class="indexterm" name="id2373231"></a><a class="indexterm" name="id2373244"></a><a class="indexterm" name="id2373256"></a><a class="indexterm" name="id2373269"></a><a class="indexterm" name="id2373282"></a><a class="indexterm" name="id2373294"></a><p>
      Replication in MySQL Cluster makes use of a number of dedicated
      tables in the <code class="literal">mysql</code> database on each MySQL
      Server instance acting as an SQL node in both the cluster being
      replicated and the replication slave (whether the slave is a
      single server or a cluster). These tables are created during the
      MySQL installation process by the
      <span><strong class="command">mysql_install_db</strong></span> script, and include a table
      for storing the binary log's indexing data. Since the
      <code class="literal">ndb_binlog_index</code> table is local to each MySQL
      server and does not participate in clustering, it uses the
      <code class="literal">MyISAM</code> storage engine. This means that it must
      be created separately on each <span><strong class="command">mysqld</strong></span>
      participating in the master cluster. (However, the binlog itself
      contains updates from all MySQL servers in the cluster to be
      replicated.) This table is defined as follows:
    </p><pre class="programlisting">        
CREATE TABLE `ndb_binlog_index` (
    `Position`  BIGINT(20) UNSIGNED NOT NULL,
    `File`      VARCHAR(255) NOT NULL,
    `epoch`     BIGINT(20) UNSIGNED NOT NULL,
    `inserts`   BIGINT(20) UNSIGNED NOT NULL,
    `updates`   BIGINT(20) UNSIGNED NOT NULL,
    `deletes`   BIGINT(20) UNSIGNED NOT NULL,
    `schemaops` BIGNINT(20) UNSIGNED NOT NULL,
    PRIMARY KEY (`epoch`)
) ENGINE=MYISAM  DEFAULT CHARSET=latin1;
</pre><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        Prior to MySQL 5.1.14, the <code class="literal">ndb_binlog_index</code>
        table was known as <code class="literal">binlog_index</code>, and was kept
        in a separate <code class="literal">cluster</code> database, which in
        MySQL 5.1.7 and earlier was known as the
        <code class="literal">cluster_replication</code> database. Similarly, the
        <code class="literal">ndb_apply_status</code> and
        <code class="literal">ndb_schema</code> tables were known as
        <code class="literal">apply_status</code> and <code class="literal">schema</code>,
        and were also found in the <code class="literal">cluster</code> (earlier
        <code class="literal">cluster_replication</code>) database. However,
        beginning with MySQL 5.1.14, all MySQL Cluster replication
        tables reside in the <code class="literal">mysql</code> system database.
      </p><p>
        Information about how this change affects upgrades from MySQL
        Cluster 5.1.13 and earlier to 5.1.14 and later versions can be
        found in <a href="news.html#news-5-1-14" title="C.1.16. Changes in  MySQL 5.1.14 (05 December 2006)">Section C.1.16, “Changes in  MySQL 5.1.14 (05 December 2006)”</a>.
      </p></div><p>
      Beginning with MySQL Cluster NDB 6.3.2, this table has been
      changed to facilitate 3-way replication recovery. Two columns
      <code class="literal">orig_server_id</code> and
      <code class="literal">orig_epoch</code> have been added to this table; when
      <span><strong class="command">mysqld</strong></span> is started with the
      <code class="option">--ndb-log-orig</code> option, these columns store,
      respectively, the ID of the server on which the event originated
      and the epoch in which the event took place on the originating
      server. In addition, the table's primary key now includes
      these two columns. The modified table definition is shown here:

</p><pre class="programlisting">CREATE TABLE `ndb_binlog_index` (
    `Position` BIGINT(20) UNSIGNED NOT NULL,
    `File` VARCHAR(255) NOT NULL,
    `epoch` BIGINT(20) UNSIGNED NOT NULL,
    `inserts` INT(10) UNSIGNED NOT NULL,
    `updates` INT(10) UNSIGNED NOT NULL,
    `deletes` INT(10) UNSIGNED NOT NULL,
    `schemaops` INT(10) UNSIGNED NOT NULL,
    `orig_server_id` INT(10) UNSIGNED NOT NULL,
    `orig_epoch` BIGINT(20) UNSIGNED NOT NULL,
    `gci` INT(10) UNSIGNED NOT NULL
    PRIMARY KEY (`epoch`,`orig_server_id`,`orig_epoch`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1;
</pre><p>

      The <code class="literal">gci</code> column was added in MySQL Cluster NDB
      6.2.6 and MySQL Cluster NDB 6.3.2.
    </p><p>
      The following figure shows the relationship of the MySQL Cluster
      replication master server, its binlog injector thread, and the
      <code class="literal">mysql.ndb_binlog_index</code> table.
    </p><div class="mediaobject"><img src="images/cluster-replication-binlog-injector.png" alt="The replication master cluster, the
        binlog-injector thread, and the
        ndb_binlog_index table"></div><a class="indexterm" name="id2373525"></a><a class="indexterm" name="id2373538"></a><p>
      An additional table, named <code class="literal">ndb_apply_status</code>, is
      used to keep a record of the operations that have been replicated
      from the master to the slave. Unlike the case with
      <code class="literal">ndb_binlog_index</code>, the data in this table is not
      specific to any one SQL node in the (slave) cluster, and so
      <code class="literal">ndb_apply_status</code> can use the <code class="literal">NDB
      Cluster</code> storage engine, as shown here:

</p><pre class="programlisting">CREATE TABLE `ndb_apply_status` (
    `server_id`   INT(10) UNSIGNED NOT NULL,
    `epoch`       BIGINT(20) UNSIGNED NOT NULL,
    `log_name`    VARCHAR(255) CHARACTER SET latin1 COLLATE latin1_bin NOT NULL,
    `start_pos`   BIGINT(20) UNSIGNED NOT NULL,
    `end_pos`     BIGINT(20) UNSIGNED NOT NULL,
    PRIMARY KEY (`server_id`) USING HASH
) ENGINE=NDBCLUSTER   DEFAULT CHARSET=latin1;
</pre><p>
    </p><p>
      This table is populated only on slaves; on the master, no
      <code class="literal">DataMemory</code> is allocated to it. However, the
      table is populated <span class="emphasis"><em>from</em></span> the master. For this
      reason, this table must be replicated and any replication
      filtering or binary log filtering rules that prevent this prevent
      replication between clusters from operating properly. For more
      information about potential problems arising from such filtering
      rules, see <a href="mysql-cluster.html#mysql-cluster-replication-issues" title="20.11.3. Known Issues in MySQL Cluster Replication">Section 20.11.3, “Known Issues in MySQL Cluster Replication”</a>.
    </p><p>
      The <code class="literal">log_name</code>, <code class="literal">start_pos</code>, and
      <code class="literal">end_pos</code> columns were added in MySQL 5.1.18.
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        If you are using MySQL Cluster replication, see
        <a href="mysql-cluster.html#mysql-cluster-upgrade-downgrade-compatibility" title="20.5.2. MySQL Cluster 5.1 and MySQL Cluster NDB 6.x Upgrade and Downgrade
      Compatibility">Section 20.5.2, “MySQL Cluster 5.1 and MySQL Cluster NDB 6.x Upgrade and Downgrade
      Compatibility”</a>
        before upgrading to MySQL 5.1.18 or later from an earlier
        version.
      </p></div><p>
      The <code class="literal">ndb_binlog_index</code> and
      <code class="literal">ndb_apply_status</code> tables are created in the
      <code class="literal">mysql</code> database because they should not be
      replicated. No user intervention is normally required to create or
      maintain either of them. Both the
      <code class="literal">ndb_binlog_index</code> and the
      <code class="literal">ndb_apply_status</code> tables are maintained by the
      <code class="literal">NDB</code> injector thread. This keeps the master
      <span><strong class="command">mysqld</strong></span> process updated to changes performed by
      the <code class="literal">NDB</code> storage engine. The
      <code class="literal">NDB</code> <em class="firstterm">binlog injector
      thread</em> receives events directly from the
      <code class="literal">NDB</code> storage engine. The <code class="literal">NDB</code>
      injector is responsible for capturing all the data events within
      the cluster, and ensures that all events which change, insert, or
      delete data are recorded in the
      <code class="literal">ndb_binlog_index</code> table. The slave I/O thread
      transfers the events from the master's binary log to the slave's
      relay log.
    </p><p>
      However, it is advisable to check for the existence and integrity
      of these tables as an initial step in preparing a MySQL Cluster
      for replication. It is possible to view event data recorded in the
      binary log by querying the
      <code class="literal">mysql.ndb_binlog_index</code> table directly on the
      master. This can be also be accomplished using the <code class="literal">SHOW
      BINLOG EVENTS</code> statement on either the replication master
      or slave MySQL servers. (See
      <a href="sql-syntax.html#show-binlog-events" title="12.5.5.3. SHOW BINLOG EVENTS Syntax">Section 12.5.5.3, “<code class="literal">SHOW BINLOG EVENTS</code> Syntax”</a>.)
    </p><p>
      You can also obtain useful information from the output of
      <a href="sql-syntax.html#show-engine-ndb-status"><code class="literal">SHOW ENGINE NDB
      STATUS</code></a>.
    </p><a class="indexterm" name="id2373767"></a><p>
      The <code class="literal">ndb_schema</code> table is used to track schema
      changes made to <code class="literal">NDB</code> tables. It is defined as
      shown here:

</p><pre class="programlisting">CREATE TABLE ndb_schema ( 
    `db` VARBINARY(63) NOT NULL,
    `name` VARBINARY(63) NOT NULL,
    `slock` BINARY(32) NOT NULL,
    `query` BLOB NOT NULL,
    `node_id` INT UNSIGNED NOT NULL,
    `epoch` BIGINT UNSIGNED NOT NULL,
    `id` INT UNSIGNED NOT NULL,
    `version` INT UNSIGNED NOT NULL,
    `type` INT UNSIGNED NOT NULL,
    PRIMARY KEY USING HASH (db,name) 
) ENGINE=NDB   DEFAULT CHARSET=latin1;
</pre><p>
    </p><p>
      Unlike the two tables previously mentioned in this section, the
      <code class="literal">ndb_schema</code> table is not visible either to MySQL
      <code class="literal">SHOW</code> statements, or in any
      <code class="literal">INFORMATION_SCHEMA</code> tables; however, it can be
      seen in the output of <span><strong class="command">ndb_show_tables</strong></span>, as shown
      here:

</p><pre class="programlisting">shell&gt; <strong class="userinput"><code>ndb_show_tables -t 2</code></strong>
id    type                 state    logging database     schema   name
4     UserTable            Online   Yes     mysql        def      ndb_apply_status
5     UserTable            Online   Yes     ndbworld     def      City
6     UserTable            Online   Yes     ndbworld     def      Country
3     UserTable            Online   Yes     mysql        def      NDB$BLOB_2_3
7     UserTable            Online   Yes     ndbworld     def      CountryLanguage
<span class="emphasis"><em>2     UserTable            Online   Yes     mysql        def      ndb_schema</em></span>

NDBT_ProgramExit: 0 - OK
</pre><p>

      It is also possible to <code class="literal">SELECT</code> from this table
      in <span><strong class="command">mysql</strong></span> and other MySQL client applications,
      as shown here:

</p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SELECT * FROM mysql.ndb_schema WHERE name='City' \G</code></strong>
*************************** 1. row ***************************
     db: ndbworld
   name: City
  slock:
  query: alter table City engine=ndb
node_id: 4
  epoch: 0
     id: 0
version: 0
   type: 7
1 row in set (0.00 sec)
</pre><p>

      This can sometimes be useful when debugging applications.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        When performing schema changes on <code class="literal">NDB</code> tables,
        applications should wait until the <code class="literal">ALTER
        TABLE</code> statement has returned in the MySQL client
        connection that issued the statement before attempting to use
        the updated definition of the table.
      </p></div><p>
      The <span><strong class="command">ndb_schema</strong></span> table was added in MySQL 5.1.8.
    </p><p>
      Beginning with MySQL 5.1.14, if either of the
      <code class="literal">ndb_apply_status</code> or
      <code class="literal">ndb_schema</code> tables does not exist on the slave,
      it is created by <span><strong class="command">ndb_restore</strong></span>. (<a href="http://bugs.mysql.com/14612" target="_top">Bug#14612</a>)
    </p><p>
      Conflict resolution for MySQL Cluster Replication requires the
      presence of an additional <code class="literal">mysql.ndb_replication</code>
      table. Currently, this table must be created manually. For
      details, see
      <a href="mysql-cluster.html#mysql-cluster-replication-conflict-resolution" title="20.11.10. MySQL Cluster Replication Conflict Resolution">Section 20.11.10, “MySQL Cluster Replication Conflict Resolution”</a>.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-replication-preparation"></a>20.11.5. Preparing the Cluster for Replication</h3></div></div></div><a class="indexterm" name="id2373963"></a><a class="indexterm" name="id2373976"></a><p>
      Preparing the MySQL Cluster for replication consists of the
      following steps:
    </p><div class="orderedlist"><ol type="1"><li><p>
          Check all MySQL servers for version compatibility (see
          <a href="mysql-cluster.html#mysql-cluster-replication-general" title="20.11.2. Assumptions and General Requirements">Section 20.11.2, “Assumptions and General Requirements”</a>).
        </p></li><li><p>
          Create a slave account on the master Cluster with the
          appropriate privileges:
        </p><pre class="programlisting">mysql<em class="replaceable"><code>M</code></em>&gt; <strong class="userinput"><code>GRANT REPLICATION SLAVE</code></strong>
     -&gt; <strong class="userinput"><code>ON *.* TO '<em class="replaceable"><code>slave_user</code></em>'@'<em class="replaceable"><code>slave_host</code></em>'</code></strong>
     -&gt; <strong class="userinput"><code>IDENTIFIED BY '<em class="replaceable"><code>slave_password</code></em>';</code></strong>
</pre><p>
          In the previous statement,
          <em class="replaceable"><code>slave_user</code></em> is the slave account
          username, <em class="replaceable"><code>slave_host</code></em> is the
          hostname or IP address of the replication slave, and
          <em class="replaceable"><code>slave_password</code></em> is the password to
          assign to this account.
        </p><p>
          For example, to create a slave user account with the name
          “<span class="quote"><code class="literal">myslave</code>,</span>” logging in from the
          host named “<span class="quote"><code class="literal">rep-slave</code>,</span>” and
          using the password “<span class="quote"><code class="literal">53cr37</code>,</span>”
          use the following <code class="literal">GRANT</code> statement:
        </p><pre class="programlisting">mysql<em class="replaceable"><code>M</code></em>&gt; <strong class="userinput"><code>GRANT REPLICATION SLAVE</code></strong>
     -&gt; <strong class="userinput"><code>ON *.* TO 'myslave'@'rep-slave'</code></strong>
     -&gt; <strong class="userinput"><code>IDENTIFIED BY '53cr37';</code></strong>
</pre><p>
          For security reasons, it is preferable to use a unique user
          account — not employed for any other purpose — for
          the replication slave account.
        </p></li><li><p>
          Configure the slave to use the master. Using the MySQL
          Monitor, this can be accomplished with the <code class="literal">CHANGE
          MASTER TO</code> statement:
        </p><a class="indexterm" name="id2374153"></a><pre class="programlisting">mysql<em class="replaceable"><code>S</code></em>&gt; <strong class="userinput"><code>CHANGE MASTER TO</code></strong>
     -&gt; <strong class="userinput"><code>MASTER_HOST='<em class="replaceable"><code>master_host</code></em>',</code></strong>
     -&gt; <strong class="userinput"><code>MASTER_PORT=<em class="replaceable"><code>master_port</code></em>,</code></strong>
     -&gt; <strong class="userinput"><code>MASTER_USER='<em class="replaceable"><code>slave_user</code></em>',</code></strong>
     -&gt; <strong class="userinput"><code>MASTER_PASSWORD='<em class="replaceable"><code>slave_password</code></em>';</code></strong>
</pre><p>
          In the previous statement,
          <em class="replaceable"><code>master_host</code></em> is the hostname or IP
          address of the replication master,
          <em class="replaceable"><code>master_port</code></em> is the port for the
          slave to use for connecting to the master,
          <em class="replaceable"><code>slave_user</code></em> is the username set up
          for the slave on the master, and
          <em class="replaceable"><code>slave_password</code></em> is the password set
          for that user account in the previous step.
        </p><p>
          For example, to tell the slave to replicate from the MySQL
          server whose hostname is
          “<span class="quote"><code class="literal">rep-master</code>,</span>” using the
          replication slave account created in the previous step, use
          the following statement:
        </p><pre class="programlisting">mysql<em class="replaceable"><code>S</code></em>&gt; <strong class="userinput"><code>CHANGE MASTER TO</code></strong>
     -&gt; <strong class="userinput"><code>MASTER_HOST='rep-master'</code></strong>
     -&gt; <strong class="userinput"><code>MASTER_PORT=3306,</code></strong>
     -&gt; <strong class="userinput"><code>MASTER_USER='myslave'</code></strong>
     -&gt; <strong class="userinput"><code>MASTER_PASSWORD='53cr37';</code></strong>
</pre><p>
          For a complete list of clauses that can be used with this
          statement, see <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax">Section 12.6.2.1, “<code class="literal">CHANGE MASTER TO</code> Syntax”</a>.
        </p><p>
          You can also configure the slave to use the master by setting
          the corresponding startup options in the slave server's
          <code class="filename">my.cnf</code> file. To configure the slave in
          the same way as the preceding example <code class="literal">CHANGE MASTER
          TO</code> statement, the following information would need
          to be included in the slave's <code class="filename">my.cnf</code>
          file:
        </p><pre class="programlisting">[mysqld]
master-host=rep-master
master-port=3306
master-user=myslave
master-password=53cr37
</pre><p>
          For additional options that can be set in
          <code class="filename">my.cnf</code> for replication slaves, see
          <a href="replication.html#replication-options" title="19.1.3. Replication Options and Variables">Section 19.1.3, “Replication Options and Variables”</a>.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            To provide replication backup capability, you will also need
            to add an <code class="option">ndb-connectstring</code> option to the
            slave's <code class="filename">my.cnf</code> file prior to starting
            the replication process. See
            <a href="mysql-cluster.html#mysql-cluster-replication-backups" title="20.11.9. MySQL Cluster Backups With Replication">Section 20.11.9, “MySQL Cluster Backups With Replication”</a>, for
            details.
          </p></div></li><li><p>
          If the master cluster is already in use, you can create a
          backup of the master and load this onto the slave to cut down
          on the amount of time required for the slave to synchronize
          itself with the master. If the slave is also running MySQL
          Cluster, this can be accomplished using the backup and restore
          procedure described in
          <a href="mysql-cluster.html#mysql-cluster-replication-backups" title="20.11.9. MySQL Cluster Backups With Replication">Section 20.11.9, “MySQL Cluster Backups With Replication”</a>.
        </p><pre class="programlisting">ndb-connectstring=<em class="replaceable"><code>management_host</code></em>[:<em class="replaceable"><code>port</code></em>]
</pre><p>
          In the event that you are <span class="emphasis"><em>not</em></span> using MySQL
          Cluster on the replication slave, you can create a backup with
          this command on the replication master:
        </p><pre class="programlisting">shell<em class="replaceable"><code>M</code></em>&gt; <strong class="userinput"><code>mysqldump --master-data=1</code></strong>
</pre><p>
          Then import the resulting data dump onto the slave by copying
          the dump file over to the slave. After this, you can use the
          <span><strong class="command">mysql</strong></span> client to import the data from the
          dumpfile into the slave database as shown here, where
          <em class="replaceable"><code>dump_file</code></em> is the name of the file
          that was generated using <span><strong class="command">mysqldump</strong></span> on the
          master, and <em class="replaceable"><code>db_name</code></em> is the name of
          the database to be replicated:
        </p><pre class="programlisting">shell<em class="replaceable"><code>S</code></em>&gt; <strong class="userinput"><code>mysql -u root -p <em class="replaceable"><code>db_name</code></em> &lt; <em class="replaceable"><code>dump_file</code></em></code></strong>
</pre><p>
          For a complete list of options to use with
          <span><strong class="command">mysqldump</strong></span>, see <a href="programs.html#mysqldump" title="4.5.4. mysqldump — A Database Backup Program">Section 4.5.4, “<span><strong class="command">mysqldump</strong></span> — A Database Backup Program”</a>.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            If you copy the data to the slave in this fashion, you
            should make sure that the slave is started with the
            <code class="option">--skip-slave-start</code> option on the
            command line, or else include
            <code class="literal">skip-slave-start</code> in the slave's
            <code class="filename">my.cnf</code> file to keep it from trying to
            connect to the master to begin replicating before all the
            data has been loaded. Once the data loading has completed,
            follow the additional steps outlined in the next two
            sections.
          </p></div></li><li><p>
          Ensure that each MySQL server acting as a replication master
          is configured with a unique server ID, and with binary logging
          enabled, using the row format. (See
          <a href="replication.html#replication-formats" title="19.1.2. Replication Formats">Section 19.1.2, “Replication Formats”</a>.) These options can be
          set either in the master server's <code class="filename">my.cnf</code>
          file, or on the command line when starting the master
          <span><strong class="command">mysqld</strong></span> process. See
          <a href="mysql-cluster.html#mysql-cluster-replication-starting" title="20.11.6. Starting Replication (Single Replication Channel)">Section 20.11.6, “Starting Replication (Single Replication Channel)”</a>, for
          information regarding the latter option.
        </p></li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-replication-starting"></a>20.11.6. Starting Replication (Single Replication Channel)</h3></div></div></div><a class="indexterm" name="id2374549"></a><p>
      This section outlines the procedure for starting MySQL CLuster
      replication using a single replication channel.
    </p><div class="orderedlist"><ol type="1"><li><p>
          Start the MySQL replication master server by issuing this
          command:
        </p><pre class="programlisting">shell<em class="replaceable"><code>M</code></em>&gt; <strong class="userinput"><code>mysqld --ndbcluster --server-id=<em class="replaceable"><code>id</code></em> \</code></strong> 
        <strong class="userinput"><code>--log-bin --binlog-format=ROW &amp;</code></strong>
</pre><p>
          In the previous statement, <em class="replaceable"><code>id</code></em> is
          this server's unique ID (see
          <a href="mysql-cluster.html#mysql-cluster-replication-general" title="20.11.2. Assumptions and General Requirements">Section 20.11.2, “Assumptions and General Requirements”</a>). This
          starts the server's <span><strong class="command">mysqld</strong></span> process with
          binary logging enabled using the proper logging format.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            You can also start the master with
            <code class="option">--binlog-format=MIXED</code>, in which case
            row-based replication is used automatically when replicating
            between clusters.
          </p></div></li><li><p>
          Start the MySQL replication slave server as shown here:
        </p><pre class="programlisting">shell<em class="replaceable"><code>S</code></em>&gt; <strong class="userinput"><code>mysqld --ndbcluster --server-id=<em class="replaceable"><code>id</code></em> &amp;</code></strong>
</pre><p>
          In the previous statement, <em class="replaceable"><code>id</code></em> is
          the slave server's unique ID. It is not necessary to enable
          logging on the replication slave.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            You should use the <code class="option">--skip-slave-start</code>
            option with this command or else you should include
            <code class="literal">skip-slave-start</code> in the slave server's
            <code class="filename">my.cnf</code> file, unless you want
            replication to begin immediately. With the use of this
            option, the start of replication is delayed until the
            appropriate <code class="literal">START SLAVE</code> statement has
            been issued, as explained in Step 4 below.
          </p></div></li><li><p>
          It is necessary to synchronize the slave server with the
          master server's replication binlog. If binary logging has not
          previously been running on the master, run the following
          statement on the slave:
        </p><pre class="programlisting">mysql<em class="replaceable"><code>S</code></em>&gt; <strong class="userinput"><code>CHANGE MASTER TO</code></strong>
     -&gt; <strong class="userinput"><code>MASTER_LOG_FILE='',</code></strong>
     -&gt; <strong class="userinput"><code>MASTER_LOG_POS=4;</code></strong>
</pre><p>
          This instructs the slave to begin reading the master's binary
          log from the log's starting point. Otherwise — that is,
          if you are loading data from the master using a backup —
          see <a href="mysql-cluster.html#mysql-cluster-replication-failover" title="20.11.8. Implementing Failover with MySQL Cluster">Section 20.11.8, “Implementing Failover with MySQL Cluster”</a>, for
          information on how to obtain the correct values to use for
          <code class="literal">MASTER_LOG_FILE</code> and
          <code class="literal">MASTER_LOG_POS</code> in such cases.
        </p></li><li><p>
          Finally, you must instruct the slave to begin applying
          replication by issuing this command from the
          <span><strong class="command">mysql</strong></span> client on the replication slave:
        </p><pre class="programlisting">mysql<em class="replaceable"><code>S</code></em>&gt; <strong class="userinput"><code>START SLAVE;</code></strong>
</pre><p>
          This also initiates the transmission of replication data from
          the master to the slave.
        </p></li></ol></div><p>
      It is also possible to use two replication channels, in a manner
      simlar to the procedure described in the next section; the
      differences between this and using a single replication channel
      are covered in
      <a href="mysql-cluster.html#mysql-cluster-replication-two-channels" title="20.11.7. Using Two Replication Channels">Section 20.11.7, “Using Two Replication Channels”</a>.
    </p><a class="indexterm" name="id2374804"></a><p>
      Beginning with MySQL Cluster NDB 6.2.3, it is possible to improve
      cluster replication performance by enabling <em class="firstterm">batched
      updates</em>. This can be accomplished by starting slave
      <span><strong class="command">mysqld</strong></span> processes with the
      <code class="option">--slave-allow-batching</code> option. Normally, updates
      are applied as soon as they are received. However, the use of
      batching causes updates to be applied in 32 KB batches, which can
      result in higher throughput and less CPU usage, particularly where
      individual updates are relatively small.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        Slave batching works on a per-epoch basis; updates belonging to
        more than one transaction can be sent as part of the same batch.
      </p><p>
        All outstanding updates are applied when the end of an epoch is
        reached, even if the updates total less than 32 KB.
      </p></div><p>
      Batching can be turned on and off at runtime. To activate it at
      runtime, you can use either of these two statements:

      <a class="indexterm" name="id2374850"></a>

</p><pre class="programlisting">SET GLOBAL slave_allow_batching = 1;
SET GLOBAL slave_allow_batching = ON;
</pre><p>

      If a particular batch causes problems (such as a statement whose
      effects do not appear to be replicated correctly), slave batching
      can be deactivated using either of the following statements:

</p><pre class="programlisting">SET GLOBAL slave_allow_batching = 0;
SET GLOBAL slave_allow_batching = OFF;
</pre><p>

      You can check whether slave batching is currently being used by
      means of an appropriate <code class="literal">SHOW VARIABLES</code>
      statement, like this one:

</p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'slave%';</code></strong>
+---------------------------+-------+
| Variable_name             | Value |
+---------------------------+-------+
| slave_allow_batching      | ON    |
| slave_compressed_protocol | OFF   |
| slave_load_tmpdir         | /tmp  |
| slave_net_timeout         | 3600  |
| slave_skip_errors         | OFF   |
| slave_transaction_retries | 10    |
+---------------------------+-------+
6 rows in set (0.00 sec)
</pre><p>
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-replication-two-channels"></a>20.11.7. Using Two Replication Channels</h3></div></div></div><a class="indexterm" name="id2374906"></a><p>
      In a more complete example scenario, we envision two replication
      channels to provide redundancy and thereby guard against possible
      failure of a single replication channel. This requires a total of
      four replication servers, two masters for the master cluster and
      two slave servers for the slave cluster. For purposes of the
      discussion that follows, we assume that unique identifiers are
      assigned as shown here:
    </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><tbody><tr><td><span class="bold"><strong>Server ID</strong></span></td><td><span class="bold"><strong>Description</strong></span></td></tr><tr><td>1</td><td>Master - primary replication channel (<span class="emphasis"><em>M</em></span>)</td></tr><tr><td>2</td><td>Master - secondary replication channel (<span class="emphasis"><em>M'</em></span>)</td></tr><tr><td>3</td><td>Slave - primary replication channel (<span class="emphasis"><em>S</em></span>)</td></tr><tr><td>4</td><td>Slave - secondary replication channel (<span class="emphasis"><em>S'</em></span>)</td></tr></tbody></table></div><p>
      Setting up replication with two channels is not radically
      different from setting up a single replication channel. First, the
      <span><strong class="command">mysqld</strong></span> processes for the primary and secondary
      replication masters must be started, followed by those for the
      primary and secondary slaves. Then the replication processes may
      be initiated by issuing the <code class="literal">START SLAVE</code>
      statement on each of the slaves. The commands and the order in
      which they need to be issued are shown here:
    </p><div class="orderedlist"><ol type="1"><li><p>
          Start the primary replication master:
        </p><pre class="programlisting">shell<em class="replaceable"><code>M</code></em>&gt; <strong class="userinput"><code>mysqld --ndbcluster --server-id=1 \</code></strong> 
               <strong class="userinput"><code>--log-bin --binlog-format=row &amp;</code></strong>
</pre></li><li><p>
          Start the secondary replication master:
        </p><pre class="programlisting">shell<em class="replaceable"><code>M'</code></em>&gt; <strong class="userinput"><code>mysqld --ndbcluster --server-id=2 \</code></strong>
               <strong class="userinput"><code>--log-bin --binlog-format=row &amp;</code></strong>
</pre></li><li><p>
          Start the primary replication slave server:
        </p><pre class="programlisting">shell<em class="replaceable"><code>S</code></em>&gt; <strong class="userinput"><code>mysqld --ndbcluster --server-id=3 \</code></strong>
               <strong class="userinput"><code>--skip-slave-start &amp;</code></strong>
</pre></li><li><p>
          Start the secondary replication slave:
        </p><pre class="programlisting">shell<em class="replaceable"><code>S'</code></em>&gt; <strong class="userinput"><code>mysqld --ndbcluster --server-id=4 \</code></strong>
                <strong class="userinput"><code>--skip-slave-start &amp;</code></strong>
</pre></li><li><p>
          Finally, initiate replication on the primary channel by
          executing the <code class="literal">START SLAVE</code> statement on the
          primary slave as shown here:

</p><pre class="programlisting">mysql<em class="replaceable"><code>S</code></em>&gt; <strong class="userinput"><code>START SLAVE;</code></strong>
</pre><p>

          </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
              Only the primary channel is to be started at this point.
              The secondary replication channel is to be started only in
              the event that the primary replication channel fails, as
              described in
              <a href="mysql-cluster.html#mysql-cluster-replication-failover" title="20.11.8. Implementing Failover with MySQL Cluster">Section 20.11.8, “Implementing Failover with MySQL Cluster”</a>.
              Running multiple replication channels simultaneously can
              result in unwanted duplicate records being created on the
              replication slaves.
            </p></div><p>
        </p></li></ol></div><p>
      As mentioned previously, it is not necessary to enable binary
      logging on replication slaves.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-replication-failover"></a>20.11.8. Implementing Failover with MySQL Cluster</h3></div></div></div><a class="indexterm" name="id2375209"></a><a class="indexterm" name="id2375221"></a><p>
      In the event that the primary Cluster replication process fails,
      it is possible to switch over to the secondary replication
      channel. The following procedure describes the steps required to
      accomplish this.
    </p><div class="orderedlist"><ol type="1"><li><p>
          <a class="indexterm" name="id2375250"></a>

          Obtain the time of the most recent global checkpoint (GCP).
          That is, you need to determine the most recent epoch from the
          <code class="literal">ndb_apply_status</code> table on the slave
          cluster, which can be found using the following query:
        </p><pre class="programlisting">mysql<em class="replaceable"><code>S'</code></em>&gt; <strong class="userinput"><code>SELECT @latest:=MAX(epoch)</code></strong>
      -&gt;        <strong class="userinput"><code>FROM mysql.ndb_apply_status;</code></strong>
</pre></li><li><a class="indexterm" name="id2375293"></a><p>
          Using the information obtained from the query shown in Step 1,
          obtain the corresponding records from the
          <code class="literal">ndb_binlog_index</code> table on the master
          cluster as shown here:
        </p><pre class="programlisting">mysql<em class="replaceable"><code>M'</code></em>&gt; <strong class="userinput"><code>SELECT</code></strong> 
      -&gt;     <strong class="userinput"><code>@file:=SUBSTRING_INDEX(File, '/', -1),</code></strong>
      -&gt;     <strong class="userinput"><code>@pos:=Position</code></strong>
      -&gt; <strong class="userinput"><code>FROM mysql.ndb_binlog_index</code></strong>
      -&gt; <strong class="userinput"><code>WHERE epoch &gt;= @latest</code></strong>
      -&gt; <strong class="userinput"><code>ORDER BY epoch ASC LIMIT 1;</code></strong>
</pre><p>
          These are the records saved on the master since the failure of
          the primary replication channel. We have employed a user
          variable <code class="literal">@latest</code> here to represent the
          value obtained in Step 1. Of course, it is not possible for
          one <span><strong class="command">mysqld</strong></span> instance to access user
          variables set on another server instance directly. These
          values must be “<span class="quote">plugged in</span>” to the second query
          manually or in application code.
        </p></li><li><p>
          Now it is possible to synchronize the secondary channel by
          running the following query on the secondary slave server:
        </p><pre class="programlisting">mysql<em class="replaceable"><code>S'</code></em>&gt; <strong class="userinput"><code>CHANGE MASTER TO</code></strong>
      -&gt;     <strong class="userinput"><code>MASTER_LOG_FILE='@file',</code></strong>
      -&gt;     <strong class="userinput"><code>MASTER_LOG_POS=@pos;</code></strong>
</pre><p>
          Again we have employed user variables (in this case
          <code class="literal">@file</code> and <code class="literal">@pos</code>) to
          represent the values obtained in Step 2 and applied in Step 3;
          in practice these values must be inserted manually or using
          application code that can access both of the servers involved.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            <code class="literal">@file</code> is a string value such as
            <code class="literal">'/var/log/mysql/replication-master-bin.00001'</code>,
            and so must be quoted when used in SQL or application code.
            However, the value represented by <code class="literal">@pos</code>
            must <span class="emphasis"><em>not</em></span> be quoted. Although MySQL
            normally attempts to convert strings to numbers, this case
            is an exception.
          </p></div></li><li><p>
          You can now initiate replication on the secondary channel by
          issuing the appropriate command on the secondary slave
          <span><strong class="command">mysqld</strong></span>:
        </p><pre class="programlisting">mysql<em class="replaceable"><code>S'</code></em>&gt; <strong class="userinput"><code>START SLAVE;</code></strong>
</pre></li></ol></div><p>
      Once the secondary replication channel is active, you can
      investigate the failure of the primary and effect repairs. The
      precise actions required to do this will depend upon the reasons
      for which the primary channel failed.
    </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
        The secondary replication channel is to be started only if and
        when the primary replication channel has failed. Running
        multiple replication channels simultaneously can result in
        unwanted duplicate records being created on the replication
        slaves.
      </p></div><p>
      If the failure is limited to a single server, it should (in
      theory) be possible to replicate from <em class="replaceable"><code>M</code></em>
      to <em class="replaceable"><code>S'</code></em>, or from
      <em class="replaceable"><code>M'</code></em> to <em class="replaceable"><code>S</code></em>;
      however, this has not yet been tested.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-replication-backups"></a>20.11.9. MySQL Cluster Backups With Replication</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-replication-auto-sync">20.11.9.1. Automating Synchronization of the Slave to the Master binlog</a></span></dt></dl></div><a class="indexterm" name="id2375537"></a><a class="indexterm" name="id2375549"></a><a class="indexterm" name="id2375562"></a><a class="indexterm" name="id2375574"></a><p>
      This section discusses making backups and restoring from them
      using MySQL Cluster replication. We assume that the replication
      servers have already been configured as covered previously (see
      <a href="mysql-cluster.html#mysql-cluster-replication-preparation" title="20.11.5. Preparing the Cluster for Replication">Section 20.11.5, “Preparing the Cluster for Replication”</a>, and the
      sections immediately following). This having been done, the
      procedure for making a backup and then restoring from it is as
      follows:
    </p><div class="orderedlist"><ol type="1"><li><p>
          There are two different methods by which the backup may be
          started.
        </p><div class="itemizedlist"><ul type="disc"><li><p><b>Method A. </b>
                This method requires that the cluster backup process was
                previously enabled on the master server, prior to
                starting the replication process. This can be done by
                including the following line in a
                <code class="literal">[mysql_cluster]</code> section in the
                <code class="filename">my.cnf file</code>, where
                <em class="replaceable"><code>management_host</code></em> is the IP
                address or hostname of the <code class="literal">NDB</code>
                management server for the master cluster, and
                <em class="replaceable"><code>port</code></em> is the management
                server's port number:

</p><pre class="programlisting">ndb-connectstring=<em class="replaceable"><code>management_host</code></em>[:<em class="replaceable"><code>port</code></em>]
</pre><p>

                </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                    The port number needs to be specified only if the
                    default port (1186) is not being used. See
                    <a href="mysql-cluster.html#mysql-cluster-multi-config" title="20.2.3. Multi-Computer Configuration">Section 20.2.3, “Multi-Computer Configuration”</a>, for
                    more information about ports and port allocation in
                    MySQL Cluster.
                  </p></div><p>

                <a class="indexterm" name="id2375678"></a>

                In this case, the backup can be started by executing
                this statement on the replication master:

</p><pre class="programlisting">shell<em class="replaceable"><code>M</code></em>&gt; <strong class="userinput"><code>ndb_mgm -e "START BACKUP"</code></strong>
</pre><p>
              </p></li><li><p><b>Method B. </b>
                If the <code class="filename">my.cnf</code> file does not specify
                where to find the management host, you can start the
                backup process by passing this information to the
                <code class="literal">NDB</code> management client as part of the
                <code class="literal">START BACKUP</code> command. This can be
                done as shown here, where
                <em class="replaceable"><code>management_host</code></em> and
                <em class="replaceable"><code>port</code></em> are the hostname and
                port number of the management server:

</p><pre class="programlisting">shell<em class="replaceable"><code>M</code></em>&gt; <strong class="userinput"><code>ndb_mgm <em class="replaceable"><code>management_host</code></em>:<em class="replaceable"><code>port</code></em> -e "START BACKUP"</code></strong>
</pre><p>

                In our scenario as outlined earlier (see
                <a href="mysql-cluster.html#mysql-cluster-replication-preparation" title="20.11.5. Preparing the Cluster for Replication">Section 20.11.5, “Preparing the Cluster for Replication”</a>),
                this would be executed as follows:

</p><pre class="programlisting">shell<em class="replaceable"><code>M</code></em>&gt; <strong class="userinput"><code>ndb_mgm rep-master:1186 -e "START BACKUP"</code></strong>
</pre><p>
              </p></li></ul></div></li><li><p>
          Copy the cluster backup files to the slave that is being
          brought on line. Each system running an
          <span><strong class="command">ndbd</strong></span> process for the master cluster will
          have cluster backup files located on it, and
          <span class="emphasis"><em>all</em></span> of these files must be copied to the
          slave to ensure a successful restore. The backup files can be
          copied into any directory on the computer where the slave
          management host resides, so long as the MySQL and NDB binaries
          have read permissions in that directory. In this case, we will
          assume that these files have been copied into the directory
          <code class="filename">/var/BACKUPS/BACKUP-1</code>.
        </p><p>
          It is not necessary that the slave cluster have the same
          number of <span><strong class="command">ndbd</strong></span> processes (data nodes) as
          the master; however, it is highly recommended this number be
          the same. It <span class="emphasis"><em>is</em></span> necessary that the slave
          be started with the <code class="option">--skip-slave-start</code>
          option, to prevent premature startup of the replication
          process.
        </p></li><li><p>
          Create any databases on the slave cluster that are present on
          the master cluster that are to be replicated to the slave.
        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
            A <code class="literal">CREATE DATABASE</code> (or <code class="literal">CREATE
            SCHEMA</code>) statement corresponding to each database
            to be replicated must be executed on each SQL node in the
            slave cluster.
          </p></div></li><li><p>
          Reset the slave cluster using this statement in the MySQL
          Monitor:
        </p><pre class="programlisting">mysql<em class="replaceable"><code>S</code></em>&gt; <strong class="userinput"><code>RESET SLAVE;</code></strong>
</pre><p>
          It is important to make sure that the slave's
          <code class="literal">apply_status</code> table does not contain any
          records prior to running the restore process. You can
          accomplish this by running this SQL statement on the slave:
        </p><pre class="programlisting">mysql<em class="replaceable"><code>S</code></em>&gt; <strong class="userinput"><code>DELETE FROM mysql.ndb_apply_status;</code></strong>
</pre></li><li><p>
          You can now start the cluster restoration process on the
          replication slave using the <span><strong class="command">ndb_restore</strong></span>
          command for each backup file in turn. For the first of these,
          it is necessary to include the <code class="option">-m</code> option to
          restore the cluster metadata:
        </p><pre class="programlisting">shell<em class="replaceable"><code>S</code></em>&gt; <strong class="userinput"><code>ndb_restore -c <em class="replaceable"><code>slave_host</code></em>:<em class="replaceable"><code>port</code></em> -n <em class="replaceable"><code>node-id</code></em> \</code></strong>
        <strong class="userinput"><code>-b <em class="replaceable"><code>backup-id</code></em> -m -r <em class="replaceable"><code>dir</code></em></code></strong>
</pre><p>
          <em class="replaceable"><code>dir</code></em> is the path to the directory
          where the backup files have been placed on the replication
          slave. For the <span><strong class="command">ndb_restore</strong></span> commands
          corresponding to the remaining backup files, the
          <code class="option">-m</code> option should <span class="emphasis"><em>not</em></span> be
          used.
        </p><p>
          For restoring from a master cluster with four data nodes (as
          shown in the figure in
          <a href="mysql-cluster.html#mysql-cluster-replication" title="20.11. MySQL Cluster Replication">Section 20.11, “MySQL Cluster Replication”</a>) where the backup
          files have been copied to the directory
          <code class="filename">/var/BACKUPS/BACKUP-1</code>, the proper
          sequence of commands to be executed on the slave might look
          like this:
        </p><pre class="programlisting">shell<em class="replaceable"><code>S</code></em>&gt; <strong class="userinput"><code>ndb_restore -c rep-slave:1186 -n 2 -b 1 -m \</code></strong>
        <strong class="userinput"><code>-r ./var/BACKUPS/BACKUP-1</code></strong>
shell<em class="replaceable"><code>S</code></em>&gt; <strong class="userinput"><code>ndb_restore -c rep-slave:1186 -n 3 -b 1 \</code></strong>
        <strong class="userinput"><code>-r ./var/BACKUPS/BACKUP-1</code></strong>
shell<em class="replaceable"><code>S</code></em>&gt; <strong class="userinput"><code>ndb_restore -c rep-slave:1186 -n 4 -b 1 \</code></strong>
        <strong class="userinput"><code>-r ./var/BACKUPS/BACKUP-1</code></strong>
shell<em class="replaceable"><code>S</code></em>&gt; <strong class="userinput"><code>ndb_restore -c rep-slave:1186 -n 5 -b 1 -e \</code></strong>
        <strong class="userinput"><code>-r ./var/BACKUPS/BACKUP-1</code></strong>
</pre><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
            The <code class="option">-e</code> (or
            <code class="option">--restore-epoch</code>) option in the final
            invocation of <span><strong class="command">ndb_restore</strong></span> in this example
            is required in order that the epoch is written to the slave
            <code class="literal">mysql.ndb_apply_status</code>. Without this
            information, the slave will not be able to synchronize
            properly with the master. (See
            <a href="mysql-cluster.html#mysql-cluster-restore" title="20.9.3. ndb_restore — Restore a Cluster Backup">Section 20.9.3, “<span><strong class="command">ndb_restore</strong></span> — Restore a Cluster Backup”</a>.)
          </p></div></li><li><p>
          Now you need to obtain the most recent epoch from the
          <code class="literal">ndb_apply_status</code> table on the slave (as
          discussed in
          <a href="mysql-cluster.html#mysql-cluster-replication-failover" title="20.11.8. Implementing Failover with MySQL Cluster">Section 20.11.8, “Implementing Failover with MySQL Cluster”</a>):
        </p><pre class="programlisting">mysql<em class="replaceable"><code>S</code></em>&gt; <strong class="userinput"><code>SELECT @latest:=MAX(epoch)</code></strong>
        <strong class="userinput"><code>FROM mysql.ndb_apply_status;</code></strong>
</pre></li><li><p>
          Using <code class="literal">@latest</code> as the epoch value obtained
          in the previous step, you can obtain the correct starting
          position <code class="literal">@pos</code> in the correct binary log
          file <code class="literal">@file</code> from the master's
          <code class="literal">mysql.ndb_binlog_index</code> table using the
          query shown here:

</p><pre class="programlisting">mysql<em class="replaceable"><code>M</code></em>&gt; <strong class="userinput"><code>SELECT</code></strong> 
     -&gt;     <strong class="userinput"><code>@file:=SUBSTRING_INDEX(File, '/', -1),</code></strong>
     -&gt;     <strong class="userinput"><code>@pos:=Position</code></strong>
     -&gt; <strong class="userinput"><code>FROM mysql.ndb_binlog_index</code></strong>
     -&gt; <strong class="userinput"><code>WHERE epoch &gt; @latest</code></strong>
     -&gt; <strong class="userinput"><code>ORDER BY epoch ASC LIMIT 1;</code></strong>
</pre><p>
        </p><p>
          In the event that there is currently no replication traffic,
          you can get this information by running <code class="literal">SHOW MASTER
          STATUS</code> on the master and using the value in the
          <code class="literal">Position</code> column for the file whose name has
          the suffix with the greatest value for all files shown in the
          <code class="literal">File</code> column. However, in this case, you
          must determine this and supply it in the next step manually or
          by parsing the output with a script.
        </p></li><li><p>
          Using the values obtained in the previous step, you can now
          issue the appropriate <code class="literal">CHANGE MASTER TO</code>
          statement in the slave's <span><strong class="command">mysql</strong></span> client:
        </p><pre class="programlisting">mysql<em class="replaceable"><code>S</code></em>&gt; <strong class="userinput"><code>CHANGE MASTER TO</code></strong>
     -&gt;     <strong class="userinput"><code>MASTER_LOG_FILE='@file',</code></strong>
     -&gt;     <strong class="userinput"><code>MASTER_LOG_POS=@pos;</code></strong>
</pre></li><li><p>
          Now that the slave “<span class="quote">knows</span>” from what point in
          which <code class="literal">binlog</code> file to start reading data
          from the master, you can cause the slave to begin replicating
          with this standard MySQL statement:
        </p><pre class="programlisting">mysql<em class="replaceable"><code>S</code></em>&gt; <strong class="userinput"><code>START SLAVE;</code></strong>
</pre></li></ol></div><p>
      To perform a backup and restore on a second replication channel,
      it is necessary only to repeat these steps, substituting the
      hostnames and IDs of the secondary master and slave for those of
      the primary master and slave replication servers where
      appropriate, and running the preceding statements on them.
    </p><p>
      For additional information on performing Cluster backups and
      restoring Cluster from backups, see
      <a href="mysql-cluster.html#mysql-cluster-backup" title="20.9. On-line Backup of MySQL Cluster">Section 20.9, “On-line Backup of MySQL Cluster”</a>.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-replication-auto-sync"></a>20.11.9.1. Automating Synchronization of the Slave to the Master binlog</h4></div></div></div><a class="indexterm" name="id2376358"></a><p>
        It is possible to automate much of the process described in the
        previous section (see
        <a href="mysql-cluster.html#mysql-cluster-replication-backups" title="20.11.9. MySQL Cluster Backups With Replication">Section 20.11.9, “MySQL Cluster Backups With Replication”</a>). The
        following Perl script <code class="filename">reset-slave.pl</code> serves
        as an example of how you can do this.
      </p><a class="indexterm" name="id2376386"></a><a class="indexterm" name="id2376399"></a><pre class="programlisting">#!/user/bin/perl -w

#  file: reset-slave.pl

#  Copyright ©2005 MySQL AB

#  This program is free software; you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation; either version 2 of the License, or
#  (at your option) any later version.

#  This program is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details.

#  You should have received a copy of the GNU General Public License
#  along with this program; if not, write to: 
#  Free Software Foundation, Inc. 
#  59 Temple Place, Suite 330 
#  Boston, MA 02111-1307 USA
#
#  Version 1.1


######################## Includes ###############################

use DBI;

######################## Globals ################################

my  $m_host='';
my  $m_port='';
my  $m_user='';
my  $m_pass='';
my  $s_host='';
my  $s_port='';
my  $s_user='';
my  $s_pass='';
my  $dbhM='';
my  $dbhS='';

####################### Sub Prototypes ##########################

sub CollectCommandPromptInfo;
sub ConnectToDatabases;
sub DisconnectFromDatabases;
sub GetSlaveEpoch;
sub GetMasterInfo;
sub UpdateSlave;

######################## Program Main ###########################

CollectCommandPromptInfo;
ConnectToDatabases;
GetSlaveEpoch;
GetMasterInfo;
UpdateSlave;
DisconnectFromDatabases;

################## Collect Command Prompt Info ##################

sub CollectCommandPromptInfo
{
  ### Check that user has supplied correct number of command line args
  die "Usage:\n
       reset-slave &gt;master MySQL host&lt; &gt;master MySQL port&lt; \n
                   &gt;master user&lt; &gt;master pass&lt; &gt;slave MySQL host&lt; \n
                   &gt;slave MySQL port&lt; &gt;slave user&lt; &gt;slave pass&lt; \n
       All 8 arguments must be passed. Use BLANK for NULL passwords\n"
       unless @ARGV == 8;

  $m_host  =  $ARGV[0];
  $m_port  =  $ARGV[1];
  $m_user  =  $ARGV[2];
  $m_pass  =  $ARGV[3];
  $s_host  =  $ARGV[4];
  $s_port  =  $ARGV[5];
  $s_user  =  $ARGV[6];
  $s_pass  =  $ARGV[7];

  if ($m_pass eq "BLANK") { $m_pass = '';}
  if ($s_pass eq "BLANK") { $s_pass = '';}
}

###############  Make connections to both databases #############

sub ConnectToDatabases
{
  ### Connect to both master and slave cluster databases

  ### Connect to master
  $dbhM
    = DBI-&gt;connect(
    "dbi:mysql:database=mysql;host=$m_host;port=$m_port",
    "$m_user", "$m_pass")
      or die "Can't connect to Master Cluster MySQL process!
              Error: $DBI::errstr\n";

  ### Connect to slave
  $dbhS 
    = DBI-&gt;connect(
          "dbi:mysql:database=mysql;host=$s_host",
          "$s_user", "$s_pass")
    or die "Can't connect to Slave Cluster MySQL process!
            Error: $DBI::errstr\n";
}

################  Disconnect from both databases ################

sub DisconnectFromDatabases
{
  ### Disconnect from master

  $dbhM-&gt;disconnect
  or warn " Disconnection failed: $DBI::errstr\n";

  ### Disconnect from slave

  $dbhS-&gt;disconnect
  or warn " Disconnection failed: $DBI::errstr\n";
}

######################  Find the last good GCI ##################

sub GetSlaveEpoch
{
  $sth = $dbhS-&gt;prepare("SELECT MAX(epoch)
                         FROM mysql.ndb_apply_status;")
      or die "Error while preparing to select epoch from slave: ", 
             $dbhS-&gt;errstr;

  $sth-&gt;execute
      or die "Selecting epoch from slave error: ", $sth-&gt;errstr;

  $sth-&gt;bind_col (1, \$epoch);
  $sth-&gt;fetch;
  print "\tSlave Epoch =  $epoch\n";
  $sth-&gt;finish;
}

#######  Find the position of the last GCI in the binlog ########

sub GetMasterInfo
{
  $sth = $dbhM-&gt;prepare("SELECT 
                           SUBSTRING_INDEX(File, '/', -1), Position
                         FROM mysql.ndb_binlog_index
                         WHERE epoch &gt; $epoch 
                         ORDER BY epoch ASC LIMIT 1;")
      or die "Prepare to select from master error: ", $dbhM-&gt;errstr;

  $sth-&gt;execute
      or die "Selecting from master error: ", $sth-&gt;errstr;

  $sth-&gt;bind_col (1, \$binlog);
  $sth-&gt;bind_col (2, \$binpos);
  $sth-&gt;fetch;
  print "\tMaster bin log =  $binlog\n";
  print "\tMaster Bin Log position =  $binpos\n";
  $sth-&gt;finish;
}

##########  Set the slave to process from that location #########

sub UpdateSlave
{
  $sth = $dbhS-&gt;prepare("CHANGE MASTER TO
                         MASTER_LOG_FILE='$binlog',
                         MASTER_LOG_POS=$binpos;")
      or die "Prepare to CHANGE MASTER error: ", $dbhS-&gt;errstr;

  $sth-&gt;execute
       or die "CHANGE MASTER on slave error: ", $sth-&gt;errstr;
  $sth-&gt;finish;
  print "\tSlave has been updated. You may now start the slave.\n";
}

# end reset-slave.pl
</pre></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-replication-conflict-resolution"></a>20.11.10. MySQL Cluster Replication Conflict Resolution</h3></div></div></div><a class="indexterm" name="id2376471"></a><p>
      When using a replication setup involving multiple masters
      (including circular replication), it is possible that different
      masters may try to update the same row on the slave with different
      data. Conflict resolution in MySQL Cluster Replication provides a
      means of resolving such conflicts by allowing a user defined
      resolution column to be used to determine whether or not an update
      to the row on a given master should be applied on the slave. (This
      column is sometimes referred to as a “<span class="quote">timestamp</span>”
      column, even though this column' type cannot be
      <code class="literal">TIMESTAMP</code>, as explained later in this section.)
      Different methods can be used to compare resolution column values
      on the slave when conflicts occur, as explained later in this
      section; the method used can be set on a per-table basis.
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        Conflict resolution as described in this section is always
        applied on a row-by-row basis rather than a transactional basis.
        In addition, it is the application's responsibility to
        ensure that the resolution column is correctly populated with
        relevant values, so that the resolution function can make the
        appropriate choice when determining whether to apply an update.
      </p></div><p><b>Requirements. </b>
        Preparations for conflict resolution must be made on both the
        master and the slave:

        </p><div class="itemizedlist"><ul type="disc"><li><p>
              On the master writing the binlogs, you must determine
              which columns are sent (all columns or only those that
              have been updated). This is done for the MySQL Server as a
              whole by applying the <span><strong class="command">mysqld</strong></span> startup
              option <code class="option">-–ndb-log-updated-only</code>
              (described later in this section) or on a per-table basis
              by entries in the <code class="literal">mysql.ndb_replication</code>
              table.
            </p></li><li><p>
              On the slave, you must determine which type of conflict
              resolution to apply (“<span class="quote">latest timestamp wins</span>”,
              “<span class="quote">same timestamp wins</span>”, or none). This is done
              using the <code class="literal">mysql.ndb_replication</code> system
              table, on a per-table basis.
            </p></li></ul></div><p>

        If only some but not all columns are sent, then the master and
        slave can diverge.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        We refer to the column used for determining updates as a
        “<span class="quote">timestamp</span>” column, but the data type of this
        column is never <code class="literal">TIMESTAMP</code>; rather, its data
        type should be <code class="literal">INT</code>
        (<code class="literal">INTEGER</code>) or <code class="literal">BIGINT</code>. This
        column should be <code class="literal">UNSIGNED</code> and <code class="literal">NOT
        NULL</code>.
      </p></div><a class="indexterm" name="id2376623"></a><p><b>Master column control. </b>
        We can see update operations in terms of “<span class="quote">before</span>”
        and “<span class="quote">after</span>” images — that is, the states of
        the table before and after the update is applied. Normally, when
        updating a table with a primary key, the “<span class="quote">before</span>”
        image is not of great interest; however, when we need to
        determine on a per-update basis whether or not to use the
        updated values on a replication slave, we need to make sure that
        both images are written to the master's binary log. This is done
        with the <code class="option">--ndb-log-update-as-write</code> startup
        option for <span><strong class="command">mysqld</strong></span>, as described later in this
        section.

        </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
            Whether logging of complete rows or of updated columns only
            is done is decided when the MySQL server is started, and
            cannot be changed online; you must either restart
            <span><strong class="command">mysqld</strong></span>, or start a new
            <span><strong class="command">mysqld</strong></span> instance with different logging
            options.
          </p></div><p>
      </p><a class="indexterm" name="id2376692"></a><p><b>Logging full or partial rows (<code class="option">--ndb-log-updated-only</code>
        option). </b>
        For purposes of conflict resolution, there are two basic methods
        of logging rows, as determined by the setting of the
        <code class="option">--ndb-log-updated-only</code> option for
        <span><strong class="command">mysqld</strong></span>:

        </p><div class="itemizedlist"><ul type="disc"><li><p>
              Log complete rows
            </p></li><li><p>
              Log only column data that has been updated — that
              is, column data whose value has been set, regardless of
              whether or not this value was actually changed.
            </p></li></ul></div><p>

        It is more efficient to log updated columns only; however, if
        you need to log full rows, you can do so by setting
        <code class="option">--ndb-log-updated-only</code> to <code class="literal">0</code>
        or <code class="literal">OFF</code>.
      </p><p><b>Logging changed data as updates
        (<code class="option">--ndb-log-update-as-write</code> option). </b>
        Either of these logging methods can be configured to be done
        with or without the “<span class="quote">before</span>” image as determined by
        the setting of another MySQL Server option
        <code class="option">--ndb-log-update-as-write</code>. Because conflict
        resolution is done in the MySQL Server's update handler, it is
        necessary to control logging on the master such that updates are
        updates and not writes; that is, such that updates are treated
        as changes in existing rows rather than the writing of new rows
        (even though these replace existing rows). This option is turned
        on by default; to turn it off, start the server with
        <code class="option">--ndb-log-update-as-write=0</code> or
        <code class="option">--ndb-log-update-as-write=OFF</code>.
      </p><a class="indexterm" name="id2376806"></a><p><b>Conflict resolution control. </b>
        Conflict resolution is usually enabled on the server where
        conflicts can occur. Like logging method selection, it is
        enabled by entries in the
        <code class="literal">mysql.ndb_replication</code> table.
      </p><p><b>The <code class="literal">ndb_replication</code> system table. </b>
        To enable conflict resolution, it is necessary to create an
        <code class="literal">ndb_replication</code> table in the
        <code class="literal">mysql</code> system database on the master, the
        slave, or both, depending on the conflict resolution type and
        method to be employed. This table is used to control logging and
        conflict resolution functions on a per-table basis, and has one
        row per table invoved in replication.
        <code class="literal">ndb_replication</code> is created and filled with
        control information on the server where the conflict is to be
        resolved. In a simple master-slave setup where data can also be
        changed locally on the slave this will typically be the slave.
        In a more complex master-master (2-way) replication schema this
        will usually be all of the masters involved. Each row in
        <code class="literal">mysql.ndb_replication</code> corresponds to a table
        being replicated, and specifies how to log and resolve conflicts
        (that is, which conflict resolution function, if any, to use)
        for that table. The definition of the
        <code class="literal">mysql.ndb_replication</code> table is shown here:

</p><pre class="programlisting">CREATE TABLE mysql.ndb_replication  (
    db VARBINARY(63),
    table_name VARBINARY(63),
    server_id INT UNSIGNED,
    binlog_type INT UNSIGNED,
    conflict_fn VARBINARY(128),
    PRIMARY KEY USING HASH (db, table_name, server_id)
)   ENGINE=NDB 
PARTITION BY KEY(db,table_name);
</pre><p>

        The columns in this table are described in the following list:

        </p><div class="itemizedlist"><ul type="disc"><li><p><b><code class="literal">db</code>. </b>
                The name of the database containing the table to be
                replicated.
              </p></li><li><p><b><code class="literal">table_name</code>. </b>
                The name of the table to be replicated.
              </p></li><li><p><b><code class="literal">server_id</code>. </b>
                The unique server ID of the MySQL instance (SQL node)
                where the table resides.
              </p></li><li><p><b><code class="literal">binlog_type</code>. </b>
                The type of binary logging to be employed. This is
                determined as shown in the following table:

                </p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><thead><tr><th>Value</th><th>Internal Value</th><th>Description</th></tr></thead><tbody><tr><td>0</td><td><code class="literal">NBT_DEFAULT</code></td><td>Use server default</td></tr><tr><td>1</td><td><code class="literal">NBT_NO_LOGGING</code></td><td>Do not log this table in the binary log</td></tr><tr><td>2</td><td><code class="literal">NBT_UPDATED_ONLY</code></td><td>Only updated attributes are logged</td></tr><tr><td>3</td><td><code class="literal">NBT_FULL</code></td><td>Log full row, even if not updated (MySQL server default behavior)</td></tr><tr><td>4</td><td><code class="literal">NBT_USE_UPDATE</code></td><td>(For generating <code class="literal">NBT_UPDATED_ONLY_USE_UPDATE</code> and
                          <code class="literal">NBT_FULL_USE_UPDATE</code> values
                          only — not intended for separate use)</td></tr><tr><td>5</td><td>[<span class="emphasis"><em>Not used</em></span>]</td><td>---</td></tr><tr><td>6</td><td><code class="literal">NBT_UPDATED_ONLY_USE_UPDATE</code> (equal to
                          <code class="literal">NBT_UPDATED_ONLY |
                          NBT_USE_UPDATE</code>)</td><td>Use updated attributes, even if values are unchanged</td></tr><tr><td>7</td><td><code class="literal">NBT_FULL_USE_UPDATE</code> (equal to <code class="literal">NBT_FULL |
                          NBT_USE_UPDATE</code>)</td><td>Use full row, even if values are unchanged</td></tr></tbody></table></div><p>
              </p></li><li><p><b><code class="literal">conflict_fn</code>. </b>
                The conflict resolution function to be applied. This
                function must be specified as one of the following:

                </p><div class="itemizedlist"><ul type="circle"><li><p><b><code class="literal">NDB$MAX(<em class="replaceable"><code>column_name</code></em></code>). </b>
                        Indicates that “<span class="quote">greatest timestamp
                        wins</span>” conflict resolution is to be used
                        — that is, if the “<span class="quote">timestamp</span>”
                        for a given row coming from the master is higher
                        than that on the slave, it is applied; otherwise
                        it is not applied on the slave. This ensures
                        that, in the event of a conflict, the version of
                        the row that was most recently updated is the
                        version that persists.
                      </p><p>
                      This conflict resolution function is available
                      beginning with MySQL Cluster NDB 6.3.0.
                    </p></li><li><p><b><code class="literal">NDB$OLD(<em class="replaceable"><code>column_name</code></em></code>). </b>
                        Indicates that an update is applied only if the
                        value of <em class="replaceable"><code>column_name</code></em>
                        is the same on both the master and the slave.
                        This ensures that updates are not applied from
                        the wrong master.
                      </p><p>
                      This conflict resolution function is available
                      beginning with MySQL Cluster NDB 6.3.4.
                    </p></li><li><p>
                      <code class="literal">NULL</code>: Indicates that conflict
                      resolution is not to be used for the corresponding
                      table
                    </p></li></ul></div><p>

                .
              </p></li></ul></div><p>
      </p><p><b>Status information. </b>
        Beginning with MySQL Cluster NDB 6.3.3, a server status variable
        <code class="literal">Ndb_conflict_fn_max</code> provides a count of the
        number of times that a row was not applied on the current SQL
        node due to “<span class="quote">greatest timestamp wins</span>” conflict
        resolution since the last time that <span><strong class="command">mysqld</strong></span>
        was started.
      </p><p><a name="option_mysqld_Ndb_conflict_fn_old"></a>
      Beginning with MySQL Cluster NDB 6.3.4, the number of times that a
      row was not applied as the result of “<span class="quote">same timestamp
      wins</span>” conflict resolution on a given
      <span><strong class="command">mysqld</strong></span> since the last time it was restarted is
      given by the global status variable
      <code class="literal">Ndb_conflict_fn_old</code>. In addition to
      incrementing <code class="literal">Ndb_conflict_fn_old</code>, the primary
      key of the row that was not used is inserted into an
      <em class="firstterm">exceptions table</em>, as explained later in
      this section.
    </p><p><b>Additional requirements for “<span class="quote">Same timestamp wins</span>” conflict
        resolution. </b>
        To use the <code class="literal">NDB$OLD()</code> conflict resolution
        function, it is also necessary to create an exceptions table
        corresponding to each <code class="literal">NDB</code> table for which
        this type of conflict resolution is to be employed. The name of
        this table is that of the table for which “<span class="quote">same timestamp
        wins</span>” conflict resolution is to be applied, with the
        string <code class="literal">$EX</code> appended. (For example, if the
        name of the original table is <code class="literal">mytable</code>, the
        name of the corresponding exception table name should be
        <code class="literal">mytable$EX</code>.) This table is created as
        follows:

</p><pre class="programlisting">CREATE TABLE <em class="replaceable"><code>original_table</code></em>$EX  (
    server_id INT UNSIGNED,
    master_server_id INT UNSIGNED, 
    master_epoch BIGINT UNSIGNED,
    count INT UNSIGNED,
    <em class="replaceable"><code>original_table_pk_columns</code></em>,
    [<em class="replaceable"><code>additional_columns</code></em>,]
    PRIMARY KEY(server_id, master_server_id, master_epoch, count)
) ENGINE=NDB;
</pre><p>

        The first four columns are required. Following these columns,
        the columns making up the original table's primary key should be
        copied in the order in which they are used to define the primary
        key of the original table.

        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            The names of the first four columns and the columns matching
            the original table's primary key columns are not critical;
            however, we suggest for reasons of clarity and consistency,
            that you use the names shown here for the
            <code class="literal">server_id</code>,
            <code class="literal">master_server_id</code>,
            <code class="literal">master_epoch</code>, and
            <code class="literal">count</code> columns, and that you use the same
            names as in the original table for the columns matching
            those in the original table's primary key.
          </p><p>
            The data types for the columns duplicating the primary key
            columns of the original table should be the same as for (or
            larger than) the original columns.
          </p></div><p>

        Additional columns may optionally be defined following these
        columns, but not before any of them; any such extra columns
        cannot be <code class="literal">NOT NULL</code>. The exception
        table's primary key must be defined as shown. The exception
        table must use the <code class="literal">NDB</code> storage engine. An
        example of use for <code class="literal">NDB$OLD()</code> and an exception
        table is given later in this section.
      </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        The <code class="literal">mysql.ndb_replication</code> table is read when
        a data table is set up for replication, so the row corresponding
        to a table to be replicated must be inserted into
        <code class="literal">mysql.ndb_replication</code>
        <span class="emphasis"><em>before</em></span> the table to be replicated is
        created.
      </p></div><p><b>Examples. </b>
        The following examples assume that you have already a working
        MySQL Cluster replication setup, as described in
        <a href="mysql-cluster.html#mysql-cluster-replication-preparation" title="20.11.5. Preparing the Cluster for Replication">Section 20.11.5, “Preparing the Cluster for Replication”</a>, and
        <a href="mysql-cluster.html#mysql-cluster-replication-starting" title="20.11.6. Starting Replication (Single Replication Channel)">Section 20.11.6, “Starting Replication (Single Replication Channel)”</a>.

        </p><div class="itemizedlist"><ul type="disc"><li><p><b><code class="literal">NDB$MAX()</code> example. </b>
                Suppose you wish to enable “<span class="quote">greatest timestamp
                wins</span>” conflict resolution on table
                <code class="literal">test.t1</code>, using column
                <code class="literal">mycol</code> as the
                “<span class="quote">timestamp</span>”. This can be done using the
                following steps:

                </p><div class="orderedlist"><ol type="1"><li><p>
                      Make sure that you have started the master
                      <span><strong class="command">mysqld</strong></span> with
                      <code class="option">-–ndb-log-update-as-write=OFF</code>.
                    </p></li><li><p>
                      On the master, perform this
                      <code class="literal">INSERT</code> statement:

</p><pre class="programlisting">INSERT INTO mysql.ndb_replication 
    VALUES ('test', 't1', 0, NULL, 'NDB$MAX(mycol)');
</pre><p>
                    </p><p>
                      Inserting a 0 into the
                      <code class="literal">server_id</code> indicates that all
                      SQL nodes accessing this table should use conflict
                      resolution. If you want to use conflict resolution
                      on a specific <span><strong class="command">mysqld</strong></span> only, use
                      the actual server ID.
                    </p><p>
                      Inserting <code class="literal">NULL</code> into the
                      <code class="literal">binlog_type</code> column has the same
                      effect as inserting 0
                      (<code class="literal">NBT_DEFAULT</code>); the server
                      default is used.
                    </p></li><li><p>
                      Create the <code class="literal">test.t1</code> table:

</p><pre class="programlisting">CREATE TABLE test.t1 (
    <em class="replaceable"><code>columns</code></em>
    mycol INT UNSIGNED,
    <em class="replaceable"><code>columns</code></em>
) ENGINE=NDB;
</pre><p>

                      Now, when updates are done on this table, conflict
                      resolution will be applied, and the version of the
                      row having the greatest value for
                      <code class="literal">mycol</code> will be written to the
                      slave.
                    </p></li></ol></div><p>
              </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                Other <code class="literal">binlog_type</code> options —
                such as <code class="literal">NBT_UPDATED_ONLY_USE_UPDATE</code>
                should be used in order to control logging on the master
                via the <code class="literal">ndb_replication</code> table rather
                than by using command-line options.
              </p></div></li><li><p><b><code class="literal">NDB$OLD()</code> example. </b>
                Suppose an <code class="literal">NDB</code> table such as the one
                defined here is being replicated, and you wish to enable
                “<span class="quote">same timestamp wins</span>” conflict resolution
                for updates to this table:

</p><pre class="programlisting">CREATE TABLE test.t2  (
    a INT UNSIGNED NOT NULL,
    b CHAR(25) NOT NULL,
    <em class="replaceable"><code>columns</code></em>,
    mycol INT UNSIGNED NOT NULL,
    <em class="replaceable"><code>columns</code></em>,
    PRIMARY KEY pk (a, b)
)   ENGINE=NDB;
</pre><p>

                The following steps are required, in the order shown:

                </p><div class="orderedlist"><ol type="1"><li><p>
                      First — and <span class="emphasis"><em>prior</em></span> to
                      creating <code class="literal">test.t2</code> — you
                      must insert a row into the
                      <code class="literal">mysql.ndb_replication</code> table, as
                      shown here:

</p><pre class="programlisting">INSERT INTO mysql.ndb_replication 
    VALUES ('test', 't2', 0, NULL, 'NDB$OLD(mycol)');
</pre><p>

                      Possible values for the
                      <code class="literal">binlog_type</code> column are shown
                      earlier in this section. The value
                      <code class="literal">'NDB$OLD(mycol)'</code> should be
                      inserted into the <code class="literal">conflict_fn</code>
                      column.
                    </p></li><li><p>
                      Create an appropriate exceptions table for
                      <code class="literal">test.t2</code>. The table creation
                      statement shown here includes all required
                      columns; any additional columns must be declared
                      following these columns, and before the definition
                      of the table's primary key.

</p><pre class="programlisting">CREATE TABLE test.t2$EX  (
    server_id SMALLINT UNSIGNED,
    master_server_id SMALLINT UNSIGNED, 
    master_epoch BIGINT UNSIGNED,
    count BIGINT UNSIGNED,
    a INT UNSIGNED NOT NULL,
    b CHAR(25) NOT NULL,
    [<em class="replaceable"><code>additional_columns</code></em>,]
    PRIMARY KEY(server_id, master_server_id, master_epoch, count)
)   ENGINE=NDB;
</pre><p>
                    </p></li><li><p>
                      Create the table <code class="literal">test.t2</code> as
                      shown previously.
                    </p></li></ol></div><p>

                These steps must be followed for every table for which
                you wish to perform conflict resolution using
                <code class="literal">NDB$OLD()</code>. For each such table, there
                must be a corresponding row in
                <code class="literal">mysql.ndb_replication</code>, and there must
                be an exceptions table in the same database as the table
                being replicated.
              </p></li></ul></div><p>
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-disk-data"></a>20.12. MySQL Cluster Disk Data Tables</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-disk-data-objects">20.12.1. Disk Data Objects</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-disk-data-storage-requirements">20.12.2. Disk Data Storage Requirements</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-disk-data-parameters">20.12.3. Disk Data Configuration Parameters</a></span></dt></dl></div><a class="indexterm" name="id2377884"></a><a class="indexterm" name="id2377893"></a><a class="indexterm" name="id2377909"></a><p>
    Beginning with MySQL 5.1.6, it is possible to store the non-indexed
    columns of <code class="literal">NDB</code> tables on disk, rather than in RAM
    as with previous versions of MySQL Cluster.
  </p><p>
    As part of implementing Cluster Disk Data work, a number of
    improvements were made in MySQL Cluster for the efficient handling
    of very large amounts (terabytes) of data during node recovery and
    restart. These include a “<span class="quote">no-steal</span>” algorithm for
    synchronising a starting node with very large data sets. For more
    information, see the paper
    <a href="http://www.vldb2005.org/program/paper/wed/p1108-ronstrom.pdf" target="_top">Recovery
    Principles of MySQL Cluster 5.1</a>, by MySQL Cluster developers
    Mikael Ronström and Jonas Oreland.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-disk-data-objects"></a>20.12.1. Disk Data Objects</h3></div></div></div><p>
      This section discusses Disk Data objects — which include
      tables, log file groups, and tablespaces — as well as how to
      create and drop them.
    </p><p>
      Assuming that you have already set up a MySQL Cluster with all
      nodes (including management and SQL nodes) running MySQL 5.1.6 or
      newer, the basic steps for creating a Cluster table on disk are as
      follows:
    </p><a class="indexterm" name="id2377977"></a><div class="orderedlist"><ol type="1"><li><p>
          Create a <em class="firstterm">log file group</em>, and assign one
          or more undo log files to it (an undo log file is also
          referred as an <em class="firstterm">undofile</em>).
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            In MySQL 5.1, undo log files are necessary only for Disk
            Data tables. They are no longer used for tables that are
            stored in memory.
          </p></div></li><li><p>
          Create a <em class="firstterm">tablespace</em>, and assign the log
          file group to it, as well as one or more data files.
        </p></li><li><p>
          Create a Disk Data table that uses this tablespace for data
          storage.
        </p></li></ol></div><p>
      Each of these tasks can be accomplished using SQL statements, as
      shown in the following example.
    </p><div class="orderedlist"><ol type="1"><li><a class="indexterm" name="id2378051"></a><p>
          We create a log file group named <code class="literal">lg_1</code> using
          <code class="literal">CREATE LOGFILE GROUP</code>. This log file group
          is to be made up of two undo log files, which we name
          <code class="filename">undo_1.dat</code> and
          <code class="filename">undo_2.dat</code>, whose initial sizes are 16 MB
          and 12 MB, respectively. (The default initial size for an undo
          log file is 128 MB.) Optionally, you can also specify a size
          for the log file group's <code class="literal">UNDO</code> buffer, or
          allow it to assume the default value of 8 MB. In this example,
          we set the UNDO buffer's size at 2 MB. A log file group must
          be created with an undo log file; so we add
          <code class="filename">undo_1.dat</code> to <code class="literal">lg_1</code> in
          this <code class="literal">CREATE LOGFILE GROUP</code> statement:
        </p><pre class="programlisting">CREATE LOGFILE GROUP lg_1
    ADD UNDOFILE 'undo_1.dat'
    INITIAL_SIZE 16M
    UNDO_BUFFER_SIZE 2M
    ENGINE NDB;
</pre><p>
          To add <code class="filename">undo_2.dat</code> to the log file group,
          use the following <code class="literal">ALTER LOGFILE GROUP</code>
          statement:
        </p><pre class="programlisting">ALTER LOGFILE GROUP lg_1
    ADD UNDOFILE 'undo_2.dat'
    INITIAL_SIZE 12M
    ENGINE NDB;
</pre><p>
          Some items of note:
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              The <code class="filename">.dat</code> file extension used here is
              not required. We use it merely to make the log and data
              files easily recognisable.
            </p></li><li><p>
              Every <code class="literal">CREATE LOGFILE GROUP</code> and
              <code class="literal">ALTER LOGFILE GROUP</code> statement must
              include an <code class="literal">ENGINE</code> clause. In MySQL
              5.1, the permitted values for this clause are
              <code class="literal">NDB</code> and <code class="literal">NDBCLUSTER</code>.
            </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
                In MySQL 5.1.8 and later, there can exist only one log
                file group at any given time.
              </p></div></li><li><p>
              When you add an undo log file to a log file group using
              <code class="literal">ADD UNDOFILE
              '<em class="replaceable"><code>filename</code></em>'</code>, a file
              with the name <em class="replaceable"><code>filename</code></em> is
              created in the
              <code class="literal">ndb_<em class="replaceable"><code>nodeid</code></em>_fs</code>
              directory within the <code class="literal">DataDirectory</code> of
              each data node in the cluster, where
              <em class="replaceable"><code>nodeid</code></em> is the node ID of the
              data node.
            </p></li><li><p>
              <code class="literal">UNDO_BUFFER_SIZE</code> is limited by the
              amount of system memory available.
            </p></li><li><p>
              For more information about the <code class="literal">CREATE LOGFILE
              GROUP</code> statement, see
              <a href="sql-syntax.html#create-logfile-group" title="12.1.8. CREATE LOGFILE GROUP Syntax">Section 12.1.8, “<code class="literal">CREATE LOGFILE GROUP</code> Syntax”</a>. For more
              information about <code class="literal">ALTER LOGFILE GROUP</code>,
              see <a href="sql-syntax.html#alter-logfile-group" title="12.1.2. ALTER LOGFILE GROUP Syntax">Section 12.1.2, “<code class="literal">ALTER LOGFILE GROUP</code> Syntax”</a>.
            </p></li></ul></div></li><li><a class="indexterm" name="id2378300"></a><p>
          Now we can create a tablespace, which contains files to be
          used by MySQL Cluster Disk Data tables for storing their data.
          A tablespace is also associated with a particular log file
          group. When creating a new tablespace, you must specify the
          log file group which it is to use for undo logging; you must
          also specify a data file. You can add more data files to the
          tablespace after the tablespace is created; it is also
          possible to drop data files from a tablespace (an example of
          dropping data files is provided later in this section).
        </p><p>
          Assume that we wish to create a tablespace named
          <code class="literal">ts_1</code> which uses <code class="literal">lg_1</code> as
          its log file group. This tablespace is to contain two data
          files named <code class="filename">data_1.dat</code> and
          <code class="filename">data_2.dat</code>, whose initial sizes are 32 MB
          and 48 MB, respectively. (The default value for
          <code class="literal">INITIAL_SIZE</code> is 128 MB.) We can do this
          using two SQL statements, as shown here:
        </p><pre class="programlisting">CREATE TABLESPACE ts_1
    ADD DATAFILE 'data_1.dat'
    USE LOGFILE GROUP lg_1
    INITIAL_SIZE 32M
    ENGINE NDB;

ALTER TABLESPACE ts_1
    ADD DATAFILE 'data_2.dat'
    INITIAL_SIZE 48M
    ENGINE NDB;
</pre><p>
          The <code class="literal">CREATE TABLESPACE</code> statement creates a
          tablespace <code class="literal">ts_1</code> with the data file
          <code class="filename">data_1.dat</code>, and associates
          <code class="literal">ts_1</code> with log file group
          <code class="literal">lg_1</code>. The <code class="literal">ALTER
          TABLESPACE</code> adds the second data file
          (<code class="filename">data_2.dat</code>).
        </p><p>
          Some items of note:
        </p><div class="itemizedlist"><ul type="disc"><li><p>
              As is the case with the filenames used here for undo log
              files, there is no special significance for the
              <code class="filename">.dat</code> file extension; it is used
              merely for easy recognition.
            </p></li><li><p>
              All <code class="literal">CREATE TABLESPACE</code> and
              <code class="literal">ALTER TABLESPACE</code> statements must
              contain an <code class="literal">ENGINE</code> clause; only tables
              using the same storage engine as the tablespace can be
              created in the tablespace. In MySQL 5.1, the
              only permitted values for this clause are
              <code class="literal">NDB</code> and <code class="literal">NDBCLUSTER</code>.
            </p><p>
              For more information about the <code class="literal">CREATE
              TABLESPACE</code> and <code class="literal">ALTER
              TABLESPACE</code> statements, see
              <a href="sql-syntax.html#create-tablespace" title="12.1.11. CREATE TABLESPACE Syntax">Section 12.1.11, “<code class="literal">CREATE TABLESPACE</code> Syntax”</a>, and
              <a href="sql-syntax.html#alter-tablespace" title="12.1.5. ALTER TABLESPACE Syntax">Section 12.1.5, “<code class="literal">ALTER TABLESPACE</code> Syntax”</a>.
            </p></li></ul></div></li><li><a class="indexterm" name="id2378499"></a><p>
          Now it is possible to create a table whose non-indexed columns
          are stored on disk in the tablespace <code class="literal">ts_1</code>:
        </p><pre class="programlisting">CREATE TABLE dt_1 (
    member_id INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY,
    last_name VARCHAR(50) NOT NULL,
    first_name VARCHAR(50) NOT NULL,
    dob DATE NOT NULL,
    joined DATE NOT NULL,
    INDEX(last_name, first_name)
    )
    TABLESPACE ts_1 STORAGE DISK
    ENGINE NDB;
</pre><p>
          The <code class="literal">TABLESPACE ... STORAGE DISK</code> clause
          tells the <code class="literal">NDBCLUSTER</code> storage engine to use
          tablespace <code class="literal">ts_1</code> for disk data storage.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            Beginning with MySQL Cluster NDB 6.2.5 and MySQL Cluster NDB
            6.3.2, it is also possible to specify whether an individual
            column is stored on disk or in memory by using a
            <code class="literal">STORAGE</code> clause as part of the column's
            definition in a <code class="literal">CREATE TABLE</code> or
            <code class="literal">ALTER TABLE</code> statement. <code class="literal">STORAGE
            DISK</code> causes the column to be stored on disk, and
            <code class="literal">STORAGE MEMORY</code> causes in-memory storage
            to be used. See <a href="sql-syntax.html#create-table" title="12.1.10. CREATE TABLE Syntax">Section 12.1.10, “<code class="literal">CREATE TABLE</code> Syntax”</a>, for more
            information.
          </p></div><p>
          Once table <code class="literal">ts_1</code> has been created as shown,
          you can perform <code class="literal">INSERT</code>,
          <code class="literal">SELECT</code>, <code class="literal">UPDATE</code>, and
          <code class="literal">DELETE</code> statements on it just as you would
          with any other MySQL table.
        </p><p>
          For table <code class="literal">dt_1</code> as it has been defined here,
          only the <code class="literal">dob</code> and <code class="literal">joined</code>
          columns are stored on disk. This is because there are indexes
          on the <code class="literal">id</code>, <code class="literal">last_name</code>,
          and <code class="literal">first_name</code> columns, and so data
          belonging to these columns is stored in RAM. In MySQL 5.1,
          only non-indexed columns can be held on disk; indexes and
          indexed column data continue to be stored in memory. This
          tradeoff between the use of indexes and conservation of RAM is
          something you must keep in mind as you design Disk Data
          tables.
        </p></li></ol></div><p><b>Performance note. </b>
        The performance of a cluster using Disk Data storage is greatly
        improved if Disk Data files are kept on a separate physical disk
        from the data node filesystem. This must be done for each data
        node in the cluster to derive any noticeable benefit.
      </p><p>
      You may use absolute and relative filesystem paths with
      <code class="literal">ADD UNDOFILE</code> and <code class="literal">ADD
      DATAFILE</code>. Relative paths are calculated relative to the
      data node's data directory.

      

    </p><p>
      A log file group, a tablespace, and any Disk Data tables using
      these must be created in a particular order. The same is true for
      dropping any of these objects:
    </p><a class="indexterm" name="id2378715"></a><div class="itemizedlist"><ul type="disc"><li><p>
          A log file group cannot be dropped, so long as any tablespaces
          are using it.
        </p></li><li><p>
          A tablespace cannot be dropped as long as it contains any data
          files.
        </p></li><li><p>
          You cannot drop any data files from a tablespace as long as
          there remain any tables which are using the tablespace.
        </p></li><li><p>
          Beginning with MySQL 5.1.12, it is no longer possible to drop
          files created in association with a different tablespace than
          the one with which the files were created. (<a href="http://bugs.mysql.com/20053" target="_top">Bug#20053</a>)
        </p></li></ul></div><p>
      For example, to drop all the objects created so far in this
      section, you would use the following statements:
    </p><pre class="programlisting">mysql&gt; <strong class="userinput"><code>DROP TABLE dt_1;</code></strong>

mysql&gt; <strong class="userinput"><code>ALTER TABLESPACE ts_1</code></strong>
    -&gt; <strong class="userinput"><code>DROP DATAFILE 'data_2.dat'</code></strong>
    -&gt; <strong class="userinput"><code>ENGINE NDB;</code></strong>

mysql&gt; <strong class="userinput"><code>ALTER TABLESPACE ts_1</code></strong>
    -&gt; <strong class="userinput"><code>DROP DATAFILE 'data_1.dat'</code></strong>
    -&gt; <strong class="userinput"><code>ENGINE NDB;</code></strong>

mysql&gt; <strong class="userinput"><code>DROP TABLESPACE ts_1</code></strong>
    -&gt; <strong class="userinput"><code>ENGINE NDB;</code></strong>

mysql&gt; <strong class="userinput"><code>DROP LOGFILE GROUP lg_1</code></strong>
    -&gt; <strong class="userinput"><code>ENGINE NDB;</code></strong>
</pre><p>
      These statements must be performed in the order shown, except that
      the two <code class="literal">ALTER TABLESPACE ... DROP DATAFILE</code>
      statements may be executed in either order.
    </p><p>
      You can obtain information about data files used by Disk Data
      tables by querying the <code class="literal">FILES</code> table in the
      <code class="literal">INFORMATION_SCHEMA</code> database. An extra
      “<span class="quote"><code class="literal">NULL</code> row</span>” was added to this table
      in MySQL 5.1.14 for providing additional information about undo
      log files. For more information and examples of use, see
      <a href="information-schema.html#files-table" title="27.21. The INFORMATION_SCHEMA FILES Table">Section 27.21, “The <code class="literal">INFORMATION_SCHEMA FILES</code> Table”</a>.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-disk-data-storage-requirements"></a>20.12.2. Disk Data Storage Requirements</h3></div></div></div><p>
      <a class="indexterm" name="id2378897"></a>

      The following items apply to Disk Data storage requirements:

      </p><div class="itemizedlist"><ul type="disc"><li><p>
            Variable-length columns of Disk Data tables take up a fixed
            amount of space. For each row, this is equal to the space
            required to store the largest possible value for that
            column.
          </p><p>
            For general information about calculating these values, see
            <a href="data-types.html#storage-requirements" title="10.5. Data Type Storage Requirements">Section 10.5, “Data Type Storage Requirements”</a>.
          </p></li><li><p>
            In a Disk Data table, the first 256 bytes of a
            <code class="literal">TEXT</code> or <code class="literal">BLOB</code> column
            are stored in memory; only the remainder is stored on disk.
          </p></li></ul></div><p>
    </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
        Starting the cluster with the <code class="option">--initial</code> option
        does <span class="emphasis"><em>not</em></span> remove Disk Data files. You must
        remove these manually prior to performing an initial restart of
        the cluster.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-disk-data-parameters"></a>20.12.3. Disk Data Configuration Parameters</h3></div></div></div><p>
      Configuration parameters affecting Disk Data behaviour include the
      following:

      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2378983"></a><p><a name="mysql-cluster-param-disk-data-diskpagebuffermemory"></a>
            <code class="literal">DiskPageBufferMemory</code>
          </p><p>
            This determines the amount of space used for caching pages
            on disk, and is set in the <code class="literal">[ndbd]</code> or
            <code class="literal">[ndbd default]</code> section of the
            <code class="filename">config.ini</code> file. It is measured in
            bytes. Each page takes up 32 KB. This means that Cluster
            Disk Data storage always uses <em class="replaceable"><code>N</code></em> *
            32 KB memory where <em class="replaceable"><code>N</code></em> is some
            non-negative integer.
          </p></li><li><a class="indexterm" name="id2379037"></a><p><a name="mysql-cluster-param-disk-data-sharedglobalmemory"></a>
            <code class="literal">SharedGlobalMemory</code>
          </p><p>
            This determines the amount of memory that is used for log
            buffers, disk operations (such as page requests and wait
            queues), and metadata for tablespaces, log file groups,
            <code class="literal">UNDO</code> files, and data files. It can be set
            in the <code class="literal">[ndbd]</code> or <code class="literal">[ndbd
            default]</code> section of the
            <code class="filename">config.ini</code> configuration file, and is
            measured in bytes.
          </p><p>
            The default value is <code class="literal">20M</code>.
          </p></li></ul></div><p>

      These parameters were added in MySQL 5.1.6
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        The <code class="literal">OPTIMIZE TABLE</code> statement does not have
        any effect on Disk Data tables.
      </p></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-interconnects"></a>20.13. Using High-Speed Interconnects with MySQL Cluster</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-sci-sockets">20.13.1. Configuring MySQL Cluster to use SCI Sockets</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-interconnects-performance">20.13.2. MySQL Cluster Interconnects and Performance</a></span></dt></dl></div><a class="indexterm" name="id2379124"></a><a class="indexterm" name="id2379137"></a><p>
    Even before design of <code class="literal">NDBCLUSTER</code> began in 1996,
    it was evident that one of the major problems to be encountered in
    building parallel databases would be communication between the nodes
    in the network. For this reason, <code class="literal">NDBCLUSTER</code> was
    designed from the very beginning to allow for the use of a number of
    different data transport mechanisms. In this Manual, we use the term
    <em class="firstterm">transporter</em> for these.
  </p><p>
    The MySQL Cluster codebase includes support for four different
    transporters:
  </p><div class="itemizedlist"><ul type="disc"><li><p>
        <span class="emphasis"><em>TCP/IP using 100 Mbps or gigabit Ethernet</em></span>,
        as discussed in <a href="mysql-cluster.html#mysql-cluster-tcp-definition" title="20.3.4.7. Cluster TCP/IP Connections">Section 20.3.4.7, “Cluster TCP/IP Connections”</a>.
      </p></li><li><p>
        <span class="emphasis"><em>Direct (machine-to-machine) TCP/IP</em></span>;
        although this transporter uses the same TCP/IP protocol as
        mentioned in the previous item, it requires setting up the
        hardware differently and is configured differently as well. For
        this reason, it is considered a separate transport mechanism for
        MySQL Cluster. See
        <a href="mysql-cluster.html#mysql-cluster-tcp-definition-direct" title="20.3.4.8. TCP/IP Connections Using Direct Connections">Section 20.3.4.8, “TCP/IP Connections Using Direct Connections”</a>, for
        details.
      </p></li><li><p>
        <span class="emphasis"><em>Shared memory (SHM)</em></span>. For more information
        about SHM, see <a href="mysql-cluster.html#mysql-cluster-shm-definition" title="20.3.4.9. Shared-Memory Connections">Section 20.3.4.9, “Shared-Memory Connections”</a>.
      </p></li><li><p>
        <span class="emphasis"><em>Scalable Coherent Interface (SCI)</em></span>, as
        described in the next section of this chapter,
        <a href="mysql-cluster.html#mysql-cluster-sci-definition" title="20.3.4.10. SCI Transport Connections">Section 20.3.4.10, “SCI Transport Connections”</a>.
      </p></li></ul></div><p>
    Most users today employ TCP/IP over Ethernet because it is
    ubiquitous. TCP/IP is also by far the best-tested transporter for
    use with MySQL Cluster.
  </p><p>
    We are working to make sure that communication with the
    <span><strong class="command">ndbd</strong></span> process is made in “<span class="quote">chunks</span>”
    that are as large as possible because this benefits all types of
    data transmission.
  </p><p>
    For users who desire it, it is also possible to use cluster
    interconnects to enhance performance even further. There are two
    ways to achieve this: Either a custom transporter can be designed to
    handle this case, or you can use socket implementations that bypass
    the TCP/IP stack to one extent or another. We have experimented with
    both of these techniques using the SCI (Scalable Coherent Interface)
    technology developed by
    <a href="http://www.dolphinics.com/" target="_top">Dolphin</a>.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-sci-sockets"></a>20.13.1. Configuring MySQL Cluster to use SCI Sockets</h3></div></div></div><a class="indexterm" name="id2379283"></a><a class="indexterm" name="id2379295"></a><a class="indexterm" name="id2379308"></a><p>
      In this section, we show how to adapt a cluster configured for
      normal TCP/IP communication to use SCI Sockets instead. This
      documentation is based on SCI Sockets version 2.3.0 as of 01
      October 2004.
    </p><p><b>Prerequisites. </b>
        Any machines with which you wish to use SCI Sockets must be
        equipped with SCI cards.
      </p><p>
      No special builds (other than the <code class="literal">-max</code> builds)
      are needed for SCI Sockets because it uses normal TCP/IP socket
      calls which are already available in MySQL Cluster. However, SCI
      Sockets are currently supported only on the Linux 2.4 and 2.6
      kernels. For other operating systems, you can use SCI
      Transporters, but this requires that the server be built using
      <code class="option">--with-ndb-sci=/opt/DIS</code>.
    </p><p>
      Prior to MySQL 5.1.20, there were issues with building MySQL
      Cluster with SCI support (see <a href="http://bugs.mysql.com/25470" target="_top">Bug#25470</a>), but these have been
      resolved due to work contributed by Dolphin International. SCI
      Sockets are now correctly supported for MySQL Cluster using the
      <code class="literal">-max</code> builds, and versions of MySQL Cluster with
      SCI Transporter support can be built using either of
      <span><strong class="command">compile-amd64-max-sci</strong></span> or
      <span><strong class="command">compile-pentium64-max-sci</strong></span>. Both of these build
      scripts can be found in the <code class="filename">BUILD</code> directory
      of the MySQL 5.1 source; it should not be difficult
      to adapt them for other platforms.
    </p><a class="indexterm" name="id2379390"></a><p>
      There are essentially four requirements for SCI Sockets:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          Building the SCI Socket libraries.
        </p></li><li><p>
          Installation of the SCI Socket kernel libraries.
        </p></li><li><p>
          Installation of one or two configuration files.
        </p></li><li><p>
          The SCI Socket kernel library must be enabled either for the
          entire machine or for the shell where the MySQL Cluster
          processes are started.
        </p></li></ul></div><p>
      This process needs to be repeated for each machine in the cluster
      where you plan to use SCI Sockets for inter-node communication.
    </p><p>
      Two packages need to be retrieved to get SCI Sockets working:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          The source code package containing the DIS support libraries
          for the SCI Sockets libraries.
        </p></li><li><p>
          The source code package for the SCI Socket libraries
          themselves.
        </p></li></ul></div><p>
      Currently, these are available only in source code format. The
      latest versions of these packages at the time of this writing were
      available as (respectively)
      <code class="filename">DIS_GPL_2_5_0_SEP_10_2004.tar.gz</code> and
      <code class="filename">SCI_SOCKET_2_3_0_OKT_01_2004.tar.gz</code>. You
      should be able to find these (or possibly newer versions) at
      <a href="http://www.dolphinics.com/support/downloads.html" target="_top">http://www.dolphinics.com/support/downloads.html</a>.
    </p><p><b>Package Installation. </b><a class="indexterm" name="id2379494"></a>
        Once you have obtained the library packages, the next step is to
        unpack them into appropriate directories, with the SCI Sockets
        library unpacked into a directory below the DIS code. Next, you
        need to build the libraries. This example shows the commands
        used on Linux/x86 to perform this task:
      </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>tar xzf DIS_GPL_2_5_0_SEP_10_2004.tar.gz</code></strong>
shell&gt; <strong class="userinput"><code>cd DIS_GPL_2_5_0_SEP_10_2004/src/</code></strong>
shell&gt; <strong class="userinput"><code>tar xzf ../../SCI_SOCKET_2_3_0_OKT_01_2004.tar.gz</code></strong>
shell&gt; <strong class="userinput"><code>cd ../adm/bin/Linux_pkgs</code></strong>
shell&gt; <strong class="userinput"><code>./make_PSB_66_release</code></strong>
</pre><p>
      It is possible to build these libraries for some 64-bit
      processors. To build the libraries for Opteron CPUs using the
      64-bit extensions, run
      <span><strong class="command">make_PSB_66_X86_64_release</strong></span> rather than
      <span><strong class="command">make_PSB_66_release</strong></span>. If the build is made on an
      Itanium machine, you should use
      <span><strong class="command">make_PSB_66_IA64_release</strong></span>. The X86-64 variant
      should work for Intel EM64T architectures but this has not yet (to
      our knowledge) been tested.
    </p><p>
      Once the build process is complete, the compiled libraries will be
      found in a zipped tar file with a name along the lines of
      <code class="filename">DIS-<em class="replaceable"><code>&lt;operating-system&gt;</code></em>-<em class="replaceable"><code>time</code></em>-<em class="replaceable"><code>date</code></em></code>.
      It is now time to install the package in the proper place. In this
      example we will place the installation in
      <code class="filename">/opt/DIS</code>. You most likely need to run the
      following as the system <code class="literal">root</code> user.
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cp DIS_Linux_2.4.20-8_181004.tar.gz /opt/</code></strong>
shell&gt; <strong class="userinput"><code>cd /opt</code></strong>
shell&gt; <strong class="userinput"><code>tar xzf DIS_Linux_2.4.20-8_181004.tar.gz</code></strong>
shell&gt; <strong class="userinput"><code>mv DIS_Linux_2.4.20-8_181004 DIS</code></strong>
</pre><p><b>Network configuration. </b><a class="indexterm" name="id2379643"></a><a class="indexterm" name="id2379656"></a>
        Now that all the libraries and binaries are in their proper
        place, we need to ensure that the SCI cards have proper node IDs
        within the SCI address space.
      </p><p>
      It is also necessary to decide on the network structure before
      proceeding. There are three types of network structures which can
      be used in this context:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          A simple one-dimensional ring
        </p></li><li><p>
          One or more SCI switches with one ring per switch port
        </p></li><li><p>
          A two- or three-dimensional torus.
        </p></li></ul></div><p>
      Each of these topologies has its own method for providing node
      IDs. We discuss each of them in brief.
    </p><p>
      A simple ring uses node IDs which are non-zero multiples of 4: 4,
      8, 12,...
    </p><p>
      The next possibility uses SCI switches. An SCI switch has 8 ports,
      each of which can support a ring. It is necessary to make sure
      that different rings use different node ID spaces. In a typical
      configuration, the first port uses node IDs below 64 (4 –
      60), the next 64 node IDs (68 – 124) are assigned to the
      next port, and so on, with node IDs 452 – 508 being assigned
      to the eighth port.
    </p><p>
      Two- and three-dimensional torus network structures take into
      account where each node is located in each dimension, incrementing
      by 4 for each node in the first dimension, by 64 in the second
      dimension, and (where applicable) by 1024 in the third dimension.
      See
      <a href="http://www.dolphinics.com/support/index.html" target="_top">Dolphin's
      Web site</a> for more thorough documentation.
    </p><p>
      In our testing we have used switches, although most large cluster
      installations use 2- or 3-dimensional torus structures. The
      advantage provided by switches is that, with dual SCI cards and
      dual switches, it is possible to build with relative ease a
      redundant network where the average failover time on the SCI
      network is on the order of 100 microseconds. This is supported by
      the SCI transporter in MySQL Cluster and is also under development
      for the SCI Socket implementation.
    </p><p>
      Failover for the 2D/3D torus is also possible but requires sending
      out new routing indexes to all nodes. However, this requires only
      100 milliseconds or so to complete and should be acceptable for
      most high-availability cases.
    </p><p>
      By placing cluster data nodes properly within the switched
      architecture, it is possible to use 2 switches to build a
      structure whereby 16 computers can be interconnected and no single
      failure can hinder more than one of them. With 32 computers and 2
      switches it is possible to configure the cluster in such a manner
      that no single failure can cause the loss of more than two nodes;
      in this case, it is also possible to know which pair of nodes is
      affected. Thus, by placing the two nodes in separate node groups,
      it is possible to build a “<span class="quote">safe</span>” MySQL Cluster
      installation.
    </p><p>
      To set the node ID for an SCI card use the following command in
      the <code class="filename">/opt/DIS/sbin</code> directory. In this example,
      <code class="option">-c 1</code> refers to the number of the SCI card (this
      is always 1 if there is only 1 card in the machine); <code class="option">-a
      0</code> refers to adapter 0; and <code class="literal">68</code> is the
      node ID:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./sciconfig -c 1 -a 0 -n 68</code></strong>
</pre><p>
      If you have multiple SCI cards in the same machine, you can
      determine which card has which slot by issuing the following
      command (again we assume that the current working directory is
      <code class="filename">/opt/DIS/sbin</code>):
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>./sciconfig -c 1 -gsn</code></strong>
</pre><p>
      This will give you the SCI card's serial number. Then repeat this
      procedure with <code class="option">-c 2</code>, and so on, for each card in
      the machine. Once you have matched each card with a slot, you can
      set node IDs for all cards.
    </p><p>
      After the necessary libraries and binaries are installed, and the
      SCI node IDs are set, the next step is to set up the mapping from
      hostnames (or IP addresses) to SCI node IDs. This is done in the
      SCI sockets configuration file, which should be saved as
      <code class="filename">/etc/sci/scisock.conf</code>. In this file, each SCI
      node ID is mapped through the proper SCI card to the hostname or
      IP address that it is to communicate with. Here is a very simple
      example of such a configuration file:
    </p><pre class="programlisting">#host           #nodeId
alpha           8
beta            12
192.168.10.20   16
</pre><p>
      It is also possible to limit the configuration so that it applies
      only to a subset of the available ports for these hosts. An
      additional configuration file
      <code class="filename">/etc/sci/scisock_opt.conf</code> can be used to
      accomplish this, as shown here:
    </p><pre class="programlisting">#-key                        -type        -values
EnablePortsByDefault                yes
EnablePort                  tcp           2200
DisablePort                 tcp           2201
EnablePortRange             tcp           2202 2219
DisablePortRange            tcp           2220 2231
</pre><p><b>Driver installation. </b><a class="indexterm" name="id2379877"></a>
        With the configuration files in place, the drivers can be
        installed.
      </p><p>
      First, the low-level drivers and then the SCI socket driver need
      to be installed:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cd DIS/sbin/</code></strong>
shell&gt; <strong class="userinput"><code>./drv-install add PSB66</code></strong>
shell&gt; <strong class="userinput"><code>./scisocket-install add</code></strong>
</pre><p>
      If desired, the installation can be checked by invoking a script
      which verifies that all nodes in the SCI socket configuration
      files are accessible:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cd /opt/DIS/sbin/</code></strong>
shell&gt; <strong class="userinput"><code>./status.sh</code></strong>
</pre><p>
      If you discover an error and need to change the SCI socket
      configuration, it is necessary to use
      <span><strong class="command">ksocketconfig</strong></span> to accomplish this task:

</p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cd /opt/DIS/util</code></strong>
shell&gt; <strong class="userinput"><code>./ksocketconfig -f</code></strong>
</pre><p>

      For more information about <span><strong class="command">ksocketconfig</strong></span>,
      consult the documentation available from
      <a href="http://www.dolphinics.com/support/documentation.html" target="_top">http://www.dolphinics.com/support/documentation.html</a>.
    </p><p><b>Testing the setup. </b>
        To ensure that SCI sockets are actually being used, you can
        employ the <span><strong class="command">latency_bench</strong></span> test program. Using
        this utility's server component, clients can connect to the
        server to test the latency of the connection. Determining
        whether SCI is enabled should be fairly simple from observing
        the latency.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        Before using <span><strong class="command">latency_bench</strong></span>, it is necessary
        to set the <code class="literal">LD_PRELOAD</code> environment variable as
        shown later in this section.
      </p></div><p>
      To set up a server, use the following:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cd /opt/DIS/bin/socket</code></strong>
shell&gt; <strong class="userinput"><code>./latency_bench -server</code></strong>
</pre><p>
      To run a client, use <span><strong class="command">latency_bench</strong></span> again,
      except this time with the <code class="option">-client</code> option:
    </p><pre class="programlisting">shell&gt; <strong class="userinput"><code>cd /opt/DIS/bin/socket</code></strong>
shell&gt; <strong class="userinput"><code>./latency_bench -client <em class="replaceable"><code>server_hostname</code></em></code></strong>
</pre><p>
      SCI socket configuration should now be complete and MySQL Cluster
      ready to use both SCI Sockets and the SCI transporter (see
      <a href="mysql-cluster.html#mysql-cluster-sci-definition" title="20.3.4.10. SCI Transport Connections">Section 20.3.4.10, “SCI Transport Connections”</a>).
    </p><p><b>Starting the cluster. </b>
        The next step in the process is to start MySQL Cluster. To
        enable usage of SCI Sockets it is necessary to set the
        environment variable <code class="literal">LD_PRELOAD</code> before
        starting <span><strong class="command">ndbd</strong></span>, <span><strong class="command">mysqld</strong></span>, and
        <span><strong class="command">ndb_mgmd</strong></span>. This variable should point to the
        kernel library for SCI Sockets.
      </p><p>
      To start <span><strong class="command">ndbd</strong></span> in a bash shell, do the
      following:
    </p><pre class="programlisting">bash-shell&gt; <strong class="userinput"><code>export LD_PRELOAD=/opt/DIS/lib/libkscisock.so</code></strong>
bash-shell&gt; <strong class="userinput"><code>ndbd</code></strong>
</pre><p>
      In a tcsh environment the same thing can be accomplished with:
    </p><pre class="programlisting">tcsh-shell&gt; <strong class="userinput"><code>setenv LD_PRELOAD=/opt/DIS/lib/libkscisock.so</code></strong>
tcsh-shell&gt; <strong class="userinput"><code>ndbd</code></strong>
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        MySQL Cluster can use only the kernel variant of SCI Sockets.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-interconnects-performance"></a>20.13.2. MySQL Cluster Interconnects and Performance</h3></div></div></div><a class="indexterm" name="id2380187"></a><a class="indexterm" name="id2380200"></a><p>
      The <span><strong class="command">ndbd</strong></span> process has a number of simple
      constructs which are used to access the data in a MySQL Cluster.
      We have created a very simple benchmark to check the performance
      of each of these and the effects which various interconnects have
      on their performance.
    </p><p>
      There are four access methods:
    </p><div class="itemizedlist"><ul type="disc"><li><p><b>Primary key access. </b>
            This is access of a record through its primary key. In the
            simplest case, only one record is accessed at a time, which
            means that the full cost of setting up a number of TCP/IP
            messages and a number of costs for context switching are
            borne by this single request. In the case where multiple
            primary key accesses are sent in one batch, those accesses
            share the cost of setting up the necessary TCP/IP messages
            and context switches. If the TCP/IP messages are for
            different destinations, additional TCP/IP messages need to
            be set up.
          </p></li><li><p><b>Unique key access. </b>
            Unique key accesses are similar to primary key accesses,
            except that a unique key access is executed as a read on an
            index table followed by a primary key access on the table.
            However, only one request is sent from the MySQL Server, and
            the read of the index table is handled by
            <span><strong class="command">ndbd</strong></span>. Such requests also benefit from
            batching.
          </p></li><li><p><b>Full table scan. </b>
            When no indexes exist for a lookup on a table, a full table
            scan is performed. This is sent as a single request to the
            <span><strong class="command">ndbd</strong></span> process, which then divides the
            table scan into a set of parallel scans on all cluster
            <span><strong class="command">ndbd</strong></span> processes. In future versions of
            MySQL Cluster, an SQL node will be able to filter some of
            these scans.
          </p></li><li><p>
          <span class="bold"><strong>Range scan using ordered
          index</strong></span>
        </p><p>
          When an ordered index is used, it performs a scan in the same
          manner as the full table scan, except that it scans only those
          records which are in the range used by the query transmitted
          by the MySQL server (SQL node). All partitions are scanned in
          parallel when all bound index attributes include all
          attributes in the partitioning key.
        </p></li></ul></div><p>
      With benchmarks developed internally by MySQL for testing simple
      and batched primary and unique key accesses, we have found that
      using SCI sockets improves performance by approximately 100% over
      TCP/IP, except in rare instances when communication performance is
      not an issue. This can occur when scan filters make up most of
      processing time or when very large batches of primary key accesses
      are achieved. In that case, the CPU processing in the
      <span><strong class="command">ndbd</strong></span> processes becomes a fairly large part of
      the overhead.
    </p><p>
      Using the SCI transporter instead of SCI Sockets is only of
      interest in communicating between <span><strong class="command">ndbd</strong></span>
      processes. Using the SCI transporter is also only of interest if a
      CPU can be dedicated to the <span><strong class="command">ndbd</strong></span> process
      because the SCI transporter ensures that this process will never
      go to sleep. It is also important to ensure that the
      <span><strong class="command">ndbd</strong></span> process priority is set in such a way that
      the process does not lose priority due to running for an extended
      period of time, as can be done by locking processes to CPUs in
      Linux 2.6. If such a configuration is possible, the
      <span><strong class="command">ndbd</strong></span> process will benefit by 10–70% as
      compared with using SCI sockets. (The larger figures will be seen
      when performing updates and probably on parallel scan operations
      as well.)
    </p><p>
      There are several other optimized socket implementations for
      computer clusters, including Myrinet, Gigabit Ethernet, Infiniband
      and the VIA interface. However, we have tested MySQL Cluster so
      far only with SCI sockets. See
      <a href="mysql-cluster.html#mysql-cluster-sci-sockets" title="20.13.1. Configuring MySQL Cluster to use SCI Sockets">Section 20.13.1, “Configuring MySQL Cluster to use SCI Sockets”</a>, for information on
      how to set up SCI sockets using ordinary TCP/IP for MySQL Cluster.
    </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-limitations"></a>20.14. Known Limitations of MySQL Cluster</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-syntax">20.14.1. Non-Compliance In SQL Syntax</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-limits">20.14.2. Limits and Differences from Standard MySQL Limits</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-transactions">20.14.3. Limits Relating to Transaction Handling</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-error-handling">20.14.4. Error Handling</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-database-objects">20.14.5. Limits Associated with Database Objects</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-unsupported-missing">20.14.6. Unsupported Or Missing Features</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-performance">20.14.7. Limitations Relating to Performance</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-exclusive-to-cluster">20.14.8. Issues Exclusive to MySQL Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-disk-data">20.14.9. Limitations Relating to Disk Data Storage</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-multiple-nodes">20.14.10. Limitations Relating to Multiple Cluster Nodes</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-limitations-resolved">20.14.11. Previous MySQL Cluster Issues Resolved in MySQL 5.1</a></span></dt></dl></div><a class="indexterm" name="id2380390"></a><a class="indexterm" name="id2380399"></a><p>
    In the sections that follow, we discuss known limitations in current
    releases pf MySQL Cluster as compared with the features available
    when using the <code class="literal">MyISAM</code> and
    <code class="literal">InnoDB</code> storage engines. If you check the
    “<span class="quote">Cluster</span>” category in the MySQL bugs database at
    <a href="http://bugs.mysql.com" target="_top">http://bugs.mysql.com</a>, you can find known bugs in the
    following categories under “<span class="quote">MySQL Server:</span>” in the MySQL
    bugs database at <a href="http://bugs.mysql.com" target="_top">http://bugs.mysql.com</a>, which we
    intend to correct in upcoming releases of MySQL Cluster:

    </p><div class="itemizedlist"><ul type="disc"><li><p>
          Cluster
        </p></li><li><p>
          Cluster Direct API (NDBAPI)
        </p></li><li><p>
          Cluster Disk Data
        </p></li><li><p>
          Cluster Replication
        </p></li></ul></div><p>
  </p><p>
    This information is intended to be complete with respect to the
    conditions just set forth. You can report any discrepancies that you
    encounter to the MySQL bugs database using the instructions given in
    <a href="introduction.html#bug-reports" title="1.7. How to Report Bugs or Problems">Section 1.7, “How to Report Bugs or Problems”</a>. If we do not plan to fix the problem
    in MySQL 5.1, we will add it to the list.
  </p><p>
    See <a href="mysql-cluster.html#mysql-cluster-limitations-resolved" title="20.14.11. Previous MySQL Cluster Issues Resolved in MySQL 5.1">Section 20.14.11, “Previous MySQL Cluster Issues Resolved in MySQL 5.1”</a> for a list
    of issues in MySQL Cluster in MySQL 5.0 that have been
    resolved in the current version.
  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
      Limitations and other issues specific to MySQL Cluster Replication
      are described in
      <a href="mysql-cluster.html#mysql-cluster-replication-issues" title="20.11.3. Known Issues in MySQL Cluster Replication">Section 20.11.3, “Known Issues in MySQL Cluster Replication”</a>.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-syntax"></a>20.14.1. Non-Compliance In SQL Syntax</h3></div></div></div><a class="indexterm" name="id2380513"></a><p>
      Some SQL statements relating to certain MySQL features produce
      errors when used with <code class="literal">NDB</code> tables, as described
      in the following list:

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Temporary tables. </b>
              Temporary tables are not supported. Trying either to
              create a temporary table that uses the
              <code class="literal">NDB</code> storage engine or to alter an
              existing temporary table to use <code class="literal">NDB</code>
              fails with the error <span class="errortext">Table storage engine
              'ndbcluster' does not support the create option
              'TEMPORARY'</span>.
            </p></li><li><p><b>Indexes and keys in <code class="literal">NDB</code> tables. </b>
              Keys and indexes on MySQL Cluster tables are subject to
              the following limitations:

              </p><div class="itemizedlist"><ul type="circle"><li><p><b><code class="literal">TEXT</code> and <code class="literal">BLOB</code> columns. </b>
                      You cannot create indexes on
                      <code class="literal">NDB</code> table columns that use any
                      of the <code class="literal">TEXT</code> or
                      <code class="literal">BLOB</code> data types.
                    </p></li><li><p><b><code class="literal">FULLTEXT</code> indexes. </b>
                      The <code class="literal">NDB</code> storage engine does not
                      support <code class="literal">FULLTEXT</code> indexes, which
                      are possible for <code class="literal">MyISAM</code> tables
                      only.
                    </p><p>
                    However, you can create indexes on
                    <code class="literal">VARCHAR</code> columns of
                    <code class="literal">NDB</code> tables.
                  </p></li><li><p><b><code class="literal">BIT</code> columns. </b>
                      A <code class="literal">BIT</code> column cannot be a
                      primary key, unique key, or index, nor can it be
                      part of a composite primary key, unique key, or
                      index.
                    </p></li><li><p><b><code class="literal">AUTO_INCREMENT</code> columns. </b>
                      Like other MySQL storage engines, the
                      <code class="literal">NDB</code> storage engine can handle a
                      maximum of one <code class="literal">AUTO_INCREMENT</code>
                      column per table. However, in the case of a
                      Cluster table with no explicit primary key, an
                      <code class="literal">AUTO_INCREMENT</code> column is
                      automatically defined and used as a
                      “<span class="quote">hidden</span>” primary key. For this
                      reason, you cannot define a table that has an
                      explicit <code class="literal">AUTO_INCREMENT</code> column
                      unless that column is also declared using the
                      <code class="literal">PRIMARY KEY</code> option. Attempting
                      to create a table with an
                      <code class="literal">AUTO_INCREMENT</code> column that is
                      not the table's primary key, and using the
                      <code class="literal">NDB</code> storage engine, fails with
                      an error.
                    </p></li></ul></div><p>
            </p></li><li><p><b>MySQL Cluster and geometry data types. </b><a class="indexterm" name="id2380789"></a>
              Geometry datatypes (<code class="literal">WKT</code> and
              <code class="literal">WKB</code>) are supported in
              <code class="literal">NDB</code> tables in MySQL 5.1.
              However, spatial indexes are not supported.
            </p></li><li><a class="indexterm" name="id2380828"></a><a class="indexterm" name="id2380840"></a><a class="indexterm" name="id2380853"></a><p><b>Creating <code class="literal">NDB</code> tables with user-defined partitioning. </b>
              Support for user-defined partitioning for MySQL Cluster in
              MySQL 5.1 is restricted to
              [<code class="literal">LINEAR</code>] <code class="literal">KEY</code>
              partitioning. Beginning with MySQL 5.1.12, using any other
              partitioning type with <code class="literal">ENGINE=NDB</code> or
              <code class="literal">ENGINE=NDBCLUSTER</code> in a <code class="literal">CREATE
              TABLE</code> statement results in an error.
            </p><p><b>Default partitioning scheme. </b>
              As of MySQL 5.1.6, all Cluster tables are by default
              partitioned by <code class="literal">KEY</code> using the table's
              primary key as the partitioning key. If no primary key is
              explicitly set for the table, the “<span class="quote">hidden</span>”
              primary key automatically created by the
              <code class="literal">NDB</code> storage engine is used instead. For
              additional discussion of these and related issues, see
              <a href="partitioning.html#partitioning-key" title="21.2.4. KEY Partitioning">Section 21.2.4, “<code class="literal">KEY</code> Partitioning”</a>.
            </p><p><b><code class="literal">DROP PARTITION</code> not supported. </b>
              It is not possible to drop partitions from
              <code class="literal">NDB</code> tables using <code class="literal">ALTER TABLE
              ... DROP PARTITION</code>. The other partitioning
              extensions to <code class="literal">ALTER TABLE</code> —
              <code class="literal">ADD PARTITION</code>, <code class="literal">REORGANIZE
              PARTITION</code>, and <code class="literal">COALESCE
              PARTITION</code> — are supported for Cluster
              tables, but use copying and so are not optimised. See
              <a href="partitioning.html#partitioning-management-range-list" title="21.3.1. Management of RANGE and LIST
        Partitions">Section 21.3.1, “Management of <code class="literal">RANGE</code> and <code class="literal">LIST</code>
        Partitions”</a> and
              <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax">Section 12.1.4, “<code class="literal">ALTER TABLE</code> Syntax”</a>.
            </p></li><li><p><b>Row-based replication. </b><a class="indexterm" name="id2381018"></a>
              When using row-based replication with MySQL Cluster,
              binary logging cannot be disabled. That is, the
              <code class="literal">NDB</code> storage engine ignores the value of
              <code class="literal">SQL_LOG_BIN</code>. (<a href="http://bugs.mysql.com/16680" target="_top">Bug#16680</a>)
            </p></li></ul></div><p>
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-limits"></a>20.14.2. Limits and Differences from Standard MySQL Limits</h3></div></div></div><a class="indexterm" name="id2381066"></a><p>
      In this section, we list limits found in MySQL Cluster that either
      differ from limits found in, or that are not found in, standard
      MySQL.

      </p><div class="itemizedlist"><ul type="disc"><li><a class="indexterm" name="id2381087"></a><a class="indexterm" name="id2381099"></a><a class="indexterm" name="id2381112"></a><a class="indexterm" name="id2381124"></a><a class="indexterm" name="id2381137"></a><p><b>Memory usage and recovery. </b>
              Memory consumed when data is inserted into an
              <code class="literal">NDB</code> table is not automatically
              recovered when deleted, as it is with other storage
              engines. Instead, the following rules hold true:

              </p><div class="itemizedlist"><ul type="circle"><li><p>
                    A <code class="literal">DELETE</code> statement on an
                    <code class="literal">NDB</code> table makes the memory
                    formerly used by the deleted rows available for
                    re-use by inserts on the same table only. This
                    memory cannot be used by other
                    <code class="literal">NDB</code> tables.
                  </p></li><li><p>
                    A <code class="literal">DROP TABLE</code> or
                    <code class="literal">TRUNCATE</code> operation on an
                    <code class="literal">NDB</code> table frees the memory that
                    was used by this table for re-use by any
                    <code class="literal">NDB</code> table, either by the same
                    table or by another <code class="literal">NDB</code> table.
                  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                      Recall that <code class="literal">TRUNCATE</code> drops and
                      re-creates the table. See
                      <a href="sql-syntax.html#truncate" title="12.2.9. TRUNCATE Syntax">Section 12.2.9, “<code class="literal">TRUNCATE</code> Syntax”</a>.
                    </p></div><p>
                    Memory freed by <code class="literal">DELETE</code> operations
                    but still allocated to a specific table can also be
                    made available for general re-use by performing a
                    rolling restart of the cluster. See
                    <a href="mysql-cluster.html#mysql-cluster-rolling-restart" title="20.5.1. Performing a Rolling Restart of the Cluster">Section 20.5.1, “Performing a Rolling Restart of the Cluster”</a>.
                  </p><p>
                    Beginning with MySQL Cluster NDB 6.3.7, this
                    limitation can be overcome using <code class="literal">OPTIMIZE
                    TABLE</code>. See
                    <a href="mysql-cluster.html#mysql-cluster-limitations-resolved" title="20.14.11. Previous MySQL Cluster Issues Resolved in MySQL 5.1">Section 20.14.11, “Previous MySQL Cluster Issues Resolved in MySQL 5.1”</a>,
                    for more information.
                  </p></li><li><p><b>Limits imposed by the cluster's configuration. </b><a class="indexterm" name="id2381288"></a>
                      A number of hard limits exist which are
                      configurable, but available main memory in the
                      cluster sets limits. See the complete list of
                      configuration parameters in
                      <a href="mysql-cluster.html#mysql-cluster-config-file" title="20.3.4. Configuration File">Section 20.3.4, “Configuration File”</a>. Most
                      configuration parameters can be upgraded online.
                      These hard limits include:

                      </p><div class="itemizedlist"><ul type="square"><li><p>
                            Database memory size and index memory size
                            (<code class="literal">DataMemory</code> and
                            <code class="literal">IndexMemory</code>,
                            respectively).
                          </p><p>
                            <code class="literal">DataMemory</code> is allocated
                            as 32KB pages. As each
                            <code class="literal">DataMemory</code> page is used,
                            it is assigned to a specific table; once
                            allocated, this memory cannot be freed
                            except by dropping the table.
                          </p><p>
                            See
                            <a href="mysql-cluster.html#mysql-cluster-ndbd-definition" title="20.3.4.5. Defining Data Nodes">Section 20.3.4.5, “Defining Data Nodes”</a>,
                            for further information about
                            <code class="literal">DataMemory</code> and
                            <code class="literal">IndexMemory</code>.
                          </p></li><li><p>
                            The maximum number of operations that can be
                            performed per transaction is set using the
                            configuration parameters
                            <code class="literal">MaxNoOfConcurrentOperations</code>
                            and
                            <code class="literal">MaxNoOfLocalOperations</code>.
                          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                              Bulk loading, <code class="literal">TRUNCATE
                              TABLE</code>, and <code class="literal">ALTER
                              TABLE</code> are handled as special
                              cases by running multiple transactions,
                              and so are not subject to this limitation.
                            </p></div></li><li><p>
                            Different limits related to tables and
                            indexes. For example, the maximum number of
                            ordered indexes per table is determined by
                            <code class="literal">MaxNoOfOrderedIndexes</code>.
                          </p></li></ul></div><p>
                    </p></li><li><p><b>Node and data object maximums. </b>
                      The following limits apply to numbers of cluster
                      nodes and metadata objects:

                      </p><div class="itemizedlist"><ul type="square"><li><p>
                            The maximum number of data nodes is 48.
                          </p><p>
                            A data node must have a node ID in the range
                            of 1‐49, inclusive. (Management and API
                            nodes may use any integer in the range of
                            1‐63 inclusive as a node ID.)
                          </p></li><li><p>
                            The total maximum number of nodes in a MySQL
                            Cluster is 63. This number includes all SQL
                            nodes (MySQL Servers), API nodes
                            (applications accessing the cluster other
                            than MySQL servers), data nodes, and
                            management servers.
                          </p></li><li><p>
                            The maximum number of metadata objects in
                            current versions of MySQL Cluster. This
                            limit is hard-coded.
                          </p></li></ul></div><p>

                      See
                      <a href="mysql-cluster.html#mysql-cluster-limitations-resolved" title="20.14.11. Previous MySQL Cluster Issues Resolved in MySQL 5.1">Section 20.14.11, “Previous MySQL Cluster Issues Resolved in MySQL 5.1”</a>,
                      for more information.
                    </p></li></ul></div><p>
            </p></li></ul></div><p>
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-transactions"></a>20.14.3. Limits Relating to Transaction Handling</h3></div></div></div><a class="indexterm" name="id2381507"></a><p>
      A number of limitations exist in MySQL Cluster with regard to the
      handling of transactions. These include the following:

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Transaction isolation level. </b>
              The <code class="literal">NDBCLUSTER</code> storage engine supports
              only the <code class="literal">READ COMMITTED</code> transaction
              isolation level. (<code class="literal">InnoDB</code>, for example,
              supports <code class="literal">READ COMMITTED</code>, <code class="literal">READ
              UNCOMMITTED</code>, <code class="literal">REPEATABLE READ</code>,
              and <code class="literal">SERIALIZABLE</code>.) See
              <a href="mysql-cluster.html#mysql-cluster-backup-troubleshooting" title="20.9.5. Backup Troubleshooting">Section 20.9.5, “Backup Troubleshooting”</a>,
              for information on how this can affect backing up and
              restoring Cluster databases.)

              </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
                  If a <code class="literal">SELECT</code> from a Cluster table
                  includes a <code class="literal">BLOB</code> or
                  <code class="literal">TEXT</code> column, the <code class="literal">READ
                  COMMITTED</code> transaction isolation level is
                  converted to a read with read lock. This is done to
                  guarantee consistency, due to the fact that parts of
                  the values stored in columns of these types are
                  actually read from a separate table.
                </p></div><p>
            </p></li><li><p><b>Rollbacks. </b>
              There are no partial transactions, and no partial
              rollbacks of transactions. A duplicate key or similar
              error aborts the entire transaction, and subsequent
              statements raise <span class="errortext">ERROR 1296 (HY000): Got error
              4350 'Transaction already aborted' from
              NDBCLUSTER</span>. In such cases, you must issue an
              explicit <code class="literal">ROLLBACK</code> and retry the entire
              transaction.
            </p><p>
            This behavior differs from that of other transactional
            storage engines such as <code class="literal">InnoDB</code> that may
            roll back individual statements.
          </p></li><li><p><b>Transactions and memory usage. </b><a class="indexterm" name="id2381666"></a><a class="indexterm" name="id2381678"></a>
              As noted elsewhere in this chapter, MySQL Cluster does not
              handle large transactions well; it is better to perform a
              number of small transactions with a few operations each
              than to attempt a single large transaction containing a
              great many operations. Among other considerations, large
              transactions require very large amounts of memory. Because
              of this, the transactional behaviour of a number of MySQL
              statements is effected as described in the following list:

              </p><div class="itemizedlist"><ul type="circle"><li><p>
                    <code class="literal">TRUNCATE</code> is not transactional
                    when used on <code class="literal">NDB</code> tables. If a
                    <code class="literal">TRUNCATE</code> fails to empty the
                    table, then it must be re-run until it is
                    successful.
                  </p></li><li><p>
                    <code class="literal">DELETE FROM</code> (even with no
                    <code class="literal">WHERE</code> clause)
                    <span class="emphasis"><em>is</em></span> transactional. For tables
                    containing a great many rows, you may find that
                    performance is improved by using several
                    <code class="literal">DELETE FROM ... LIMIT ...</code>
                    statements to “<span class="quote">chunk</span>” the delete
                    operation. If your objective is to empty the table,
                    then you may wish to use <code class="literal">TRUNCATE</code>
                    instead.
                  </p></li><li><p><b><code class="literal">LOAD DATA</code> statements. </b>
                      <code class="literal">LOAD DATA INFILE</code> is not
                      transactional when used on <code class="literal">NDB</code>
                      tables.

                      </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
                          When executing a <code class="literal">LOAD DATA
                          INFILE</code> statement, the
                          <code class="literal">NDB</code> engine performs commits
                          at irregular intervals that enable better
                          utilization of the communication network. It
                          is not possible to know ahead of time when
                          such commits take place.
                        </p></div><p>

                      <code class="literal">LOAD DATA FROM MASTER</code> is not
                      supported in MySQL Cluster.
                    </p></li><li><p><b><code class="literal">ALTER TABLE</code> and transactions. </b>
                      When copying an <code class="literal">NDB</code> table as
                      part of an <code class="literal">ALTER TABLE</code>, the
                      creation of the copy is non-transactional. (In any
                      case, this operation is rolled back when the copy
                      is deleted.)
                    </p></li></ul></div><p>
            </p></li><li><p><b>Transactions and the <code class="literal">COUNT()</code> function. </b>
              When using MySQL Cluster Replication, it is not possible
              to guarantee the transactional consistency of the
              <code class="literal">COUNT()</code> function on the slave. In other
              words, when performing on the master a series of
              statements (<code class="literal">INSERT</code>,
              <code class="literal">DELETE</code>, or both) that changes the
              number of rows in a table within a single transaction,
              executing <code class="literal">SELECT COUNT(*) FROM
              <em class="replaceable"><code>table</code></em></code> queries on the
              slave may yield intermediate results. This is due to the
              fact that <code class="literal">SELECT COUNT(...)</code> may perform
              dirty reads, and is not a bug in the
              <code class="literal">NDB</code> storage engine. (See <a href="http://bugs.mysql.com/31321" target="_top">Bug#31321</a> for
              more information.)
            </p></li></ul></div><p>
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-error-handling"></a>20.14.4. Error Handling</h3></div></div></div><a class="indexterm" name="id2381940"></a><p>
      Starting, stopping, or restarting a node may give rise to
      temporary errors causing some transactions to fail. These include
      the following cases:

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Temporary errors. </b>
              When first starting a node, it is possible that you may
              see Error 1204 <span class="errortext">Temporary failure, distribution
              changed</span> and similar temporary errors.
            </p></li><li><p><b>Errors due to node failure. </b>
              The stopping or failure of any data node can result in a
              number of different node failure errors. (However, there
              should be no aborted transactions when performing a
              planned shutdown of the cluster.)
            </p></li></ul></div><p>
    </p><p>
      In either of these cases, any errors that are generated must be
      handled within the application. This should be done by retrying
      the transaction.
    </p><p>
      See also <a href="mysql-cluster.html#mysql-cluster-limitations-limits" title="20.14.2. Limits and Differences from Standard MySQL Limits">Section 20.14.2, “Limits and Differences from Standard MySQL Limits”</a>.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-database-objects"></a>20.14.5. Limits Associated with Database Objects</h3></div></div></div><a class="indexterm" name="id2382017"></a><p>
      Some database objects such as tables and indexes have different
      limitations when using the <code class="literal">NDBCLUSTER</code> storage
      engine:

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Identifiers. </b>
              Database names, table names and attribute names cannot be
              as long in <code class="literal">NDB</code> tables as when using
              other table handlers. Attribute names are truncated to 31
              characters, and if not unique after truncation give rise
              to errors. Database names and table names can total a
              maximum of 122 characters. In other words, the maximum
              length for an <code class="literal">NDB</code> table name is 122
              characters, less the number of characters in the name of
              the database of which that table is a part.
            </p></li><li><p><b>Table names containing special characters. </b>
              <code class="literal">NDB</code> tables whose names contain
              characters other than letters, numbers, dashes, and
              underscores and which are created on one SQL node were not
              always discovered correctly by other SQL nodes. (<a href="http://bugs.mysql.com/31470" target="_top">Bug#31470</a>)

              </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                  This issue was fixed in MySQL 5.1.23, MySQL Cluster
                  NDB 6.2.7, and MySQL Cluster NDB 6.3.4.
                </p></div><p>
            </p></li><li><p><b>Number of tables. </b>
              The maximum number of <code class="literal">NDB</code> tables is
              limited to 20320.
            </p></li><li><p><b>Attributes per table. </b>
              The maximum number of attributes (that is, columns and
              indexes) per table is limited to 128.
            </p></li><li><p><b>Attributes per key. </b>
              The maximum number of attributes per key is 32.
            </p></li><li><p><b>Row size. </b>
              The maximum permitted size of any one row is 8KB. Note
              that each <code class="literal">BLOB</code> or
              <code class="literal">TEXT</code> column contributes 256 + 8 = 264
              bytes towards this total.
            </p></li></ul></div><p>
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-unsupported-missing"></a>20.14.6. Unsupported Or Missing Features</h3></div></div></div><a class="indexterm" name="id2382190"></a><p>
      A number of features supported by other storage engines are not
      supported for <code class="literal">NDB</code> tables. Trying to use any of
      these features in MySQL Cluster does not cause errors in or of
      itself; however, errors may occur in applications that expects the
      features to be supported or enforced:

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Foreign key constraints. </b>
              The foreign key construct is ignored, just as it is in
              <code class="literal">MyISAM</code> tables.
            </p></li><li><p><b><code class="literal">OPTIMIZE</code> operations. </b>
              <code class="literal">OPTIMIZE</code> operations are not supported.
            </p><p>
            Beginning with MySQL Cluster NDB 6.3.7, this limitation has
            been lifted. See
            <a href="mysql-cluster.html#mysql-cluster-limitations-resolved" title="20.14.11. Previous MySQL Cluster Issues Resolved in MySQL 5.1">Section 20.14.11, “Previous MySQL Cluster Issues Resolved in MySQL 5.1”</a>, for
            more information.
          </p></li><li><p><b><code class="literal">LOAD TABLE ... FROM MASTER</code>. </b>
              <code class="literal">LOAD TABLE ... FROM MASTER</code> is not
              supported.
            </p></li><li><p><b>Savepoints and rollbacks. </b>
              Savepoints and rollbacks to savepoints are ignored as in
              <code class="literal">MyISAM</code>.
            </p></li><li><p><b>Durability of commits. </b>
              There are no durable commits on disk. Commits are
              replicated, but there is no guarantee that logs are
              flushed to disk on commit.
            </p></li><li><p><b>Replication. </b>
              Statement-based replication is not supported. Use
              --binlog-format=ROW (or --binlog-format=MIXED) when
              setting up cluster replication. See
              <a href="mysql-cluster.html#mysql-cluster-replication" title="20.11. MySQL Cluster Replication">Section 20.11, “MySQL Cluster Replication”</a>, for more
              information.
            </p></li></ul></div><p>
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
        See <a href="mysql-cluster.html#mysql-cluster-limitations-transactions" title="20.14.3. Limits Relating to Transaction Handling">Section 20.14.3, “Limits Relating to Transaction Handling”</a>,
        for more information relating to limitations on transaction
        handling in <code class="literal">NDB</code>.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-performance"></a>20.14.7. Limitations Relating to Performance</h3></div></div></div><a class="indexterm" name="id2382376"></a><p>
      The following performance issues are specific to or especially
      pronounced in MySQL Cluster:

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Range scans. </b>
              There are query performance issues due to sequential
              access to the <code class="literal">NDB</code> storage engine; it is
              also relatively more expensive to do many range scans than
              it is with either <code class="literal">MyISAM</code> or
              <code class="literal">InnoDB</code>.
            </p></li><li><p><b>Reliability of <code class="literal">Records in range</code>. </b>
              The <code class="literal">Records in range</code> statistic is
              available but is not completely tested or officially
              supported. This may result in non-optimal query plans in
              some cases. If necessary, you can employ <code class="literal">USE
              INDEX</code> or <code class="literal">FORCE INDEX</code> to alter
              the execution plan. See <a href="sql-syntax.html#index-hints" title="12.2.7.2. Index Hint Syntax">Section 12.2.7.2, “Index Hint Syntax”</a>, for
              more information on how to do this.
            </p></li><li><p><b>Unique hash indexes. </b>
              Unique hash indexes created with <code class="literal">USING
              HASH</code> cannot be used for accessing a table if
              <code class="literal">NULL</code> is given as part of the key.
            </p></li></ul></div><p>
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-exclusive-to-cluster"></a>20.14.8. Issues Exclusive to MySQL Cluster</h3></div></div></div><a class="indexterm" name="id2382507"></a><p>
      The following are limitations specific to the
      <code class="literal">NDBCLUSTER</code> storage engine:

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Machine architecture. </b>
              All machines used in the cluster must have the same
              architecture. That is, all machines hosting nodes must be
              either big-endian or little-endian, and you cannot use a
              mixture of both. For example, you cannot have a management
              node running on a PowerPC which directs a data node that
              is running on an x86 machine. This restriction does not
              apply to machines simply running <span><strong class="command">mysql</strong></span>
              or other clients that may be accessing the cluster's SQL
              nodes.
            </p></li><li><p><b>Adding and dropping of data nodes. </b>
              Online adding or dropping of data nodes is not currently
              possible. In such cases, the entire cluster must be
              restarted.
            </p></li><li><p><b>Binary logging. </b><a class="indexterm" name="id2382577"></a><a class="indexterm" name="id2382589"></a>
              MySQL Cluster has the following limitations or
              restrictions with regard to binary logging:

              </p><div class="itemizedlist"><ul type="circle"><li><p>
                    <code class="literal">SQL_LOG_BIN</code> has no effect on data
                    operations; however, it is supported for schema
                    operations.
                  </p></li><li><p>
                    MySQL Cluster cannot produce a binlog for tables
                    having <code class="literal">BLOB</code> columns but no
                    primary key.
                  </p></li><li><p>
                    Only the following schema operations are logged in a
                    cluster binlog which is <span class="emphasis"><em>not</em></span> on
                    the <span><strong class="command">mysqld</strong></span> executing the
                    statement:

                    </p><div class="itemizedlist"><ul type="square"><li><p>
                          <code class="literal">CREATE TABLE</code>
                        </p></li><li><p>
                          <code class="literal">ALTER TABLE</code>
                        </p></li><li><p>
                          <code class="literal">DROP TABLE</code>
                        </p></li><li><p>
                          <code class="literal">CREATE DATABASE</code> /
                          <code class="literal">CREATE SCHEMA</code>
                        </p></li><li><p>
                          <code class="literal">DROP DATABASE</code> /
                          <code class="literal">DROP SCHEMA</code>
                        </p></li><li><p>
                          <code class="literal">CREATE TABLESPACE</code>
                        </p></li><li><p>
                          <code class="literal">ALTER TABLESPACE</code>
                        </p></li><li><p>
                          <code class="literal">DROP TABLESPACE</code>
                        </p></li><li><p>
                          <code class="literal">CREATE LOGFILE GROUP</code>
                        </p></li><li><p>
                          <code class="literal">ALTER LOGFILE GROUP</code>
                        </p></li><li><p>
                          <code class="literal">DROP LOGFILE GROUP</code>
                        </p></li></ul></div><p>
                  </p></li></ul></div><p>
            </p></li></ul></div><p>

      See also
      <a href="mysql-cluster.html#mysql-cluster-limitations-multiple-nodes" title="20.14.10. Limitations Relating to Multiple Cluster Nodes">Section 20.14.10, “Limitations Relating to Multiple Cluster Nodes”</a>.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-disk-data"></a>20.14.9. Limitations Relating to Disk Data Storage</h3></div></div></div><a class="indexterm" name="id2382822"></a><div class="itemizedlist"><ul type="disc"><li><p>
          Disk data objects are subject to the following maximums:

          </p><div class="itemizedlist"><ul type="circle"><li><p>
                Maximum number of tablespaces: 2^32 (4294967296)
              </p></li><li><p>
                Maximum number of data files per tablespace: 2^16
                (65535)
              </p></li><li><p>
                The theoretical maximum number of extents per tablespace
                data file is 2^16 (65525); however, for practical
                purposes, the recommended maximum number of extents per
                data file is 2^8 (32768).
              </p></li><li><p>
                Maximum data file size: The theoretical limit is 64G;
                however, in MySQL 5.1, the practical upper
                limit is 32G. This is equivalent to 32768 extents of 1M
                each.
              </p><p>
                The minimum and maximum possible sizes of extents for
                tablespace data files are 32K and 2G, respectively. See
                <a href="sql-syntax.html#create-tablespace" title="12.1.11. CREATE TABLESPACE Syntax">Section 12.1.11, “<code class="literal">CREATE TABLESPACE</code> Syntax”</a>, for more
                information.
              </p></li></ul></div><p>
        </p></li><li><p>
          Use of Disk Data tables is not supported when running the
          cluster in diskless mode. Beginning with MySQL 5.1.12, it is
          disallowed altogether. (<a href="http://bugs.mysql.com/20008" target="_top">Bug#20008</a>)
        </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-multiple-nodes"></a>20.14.10. Limitations Relating to Multiple Cluster Nodes</h3></div></div></div><p><b>Multiple SQL nodes. </b><a class="indexterm" name="id2382919"></a>
        The following are issues relating to the use of multiple MySQL
        servers as MySQL Cluster SQL nodes, and are specific to the
        <code class="literal">NDBCLUSTER</code> storage engine:

        </p><div class="itemizedlist"><ul type="disc"><li><p><b>No distributed table locks. </b>
                A <code class="literal">LOCK TABLES</code> works only for the SQL
                node on which the lock is issued; no other SQL node in
                the cluster “<span class="quote">sees</span>” this lock. This is also
                true for a lock issued by any statement that locks
                tables as part of its operations. (See next item for an
                example.)
              </p></li><li><p><b><code class="literal">ALTER TABLE</code> operations. </b>
                <code class="literal">ALTER TABLE</code> is not fully locking when
                running multiple MySQL servers (SQL nodes). (As
                discussed in the previous item, MySQL Cluster does not
                support distributed table locks.)
              </p></li><li><p><b>DDL operations. </b>
                DDL operations (such as <code class="literal">CREATE TABLE</code>
                or <code class="literal">ALTER TABLE</code>) are not safe from
                data node failures. If a data node fails while trying to
                peform one of these, the data dictionary is locked and
                no further DDL statements can be executed without
                restarting the cluster.
              </p></li></ul></div><p>
      </p><p><b>Multiple management nodes. </b><a class="indexterm" name="id2383031"></a>
        When using multiple management servers:

        </p><div class="itemizedlist"><ul type="disc"><li><p>
              You must give nodes explicit IDs in connectstrings because
              automatic allocation of node IDs does not work across
              multiple management servers.
            </p></li><li><p>
              You must take extreme care to have the same configurations
              for all management servers. No special checks for this are
              performed by the cluster.
            </p></li></ul></div><p>
      </p><p><b>Multiple data node processes. </b>
        While it is possible to run multiple cluster processes
        concurrently on a single host, it is not always advisable to do
        so for reasons of performance and high availability, as well as
        other considerations. In particular, in MySQL 5.1 and MySQL
        Cluster NDB 6.x, we do not support for production use any MySQL
        Cluster deployment in which more than one
        <span><strong class="command">ndbd</strong></span> process is run on a single physical
        machine.

        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            We may support multiple data nodes per host in a future
            MySQL release, following additional testing. However, in
            current versions of MySQL Cluster, such configurations can
            be considered experimental only.
          </p></div><p>
      </p><p><b>Multiple network addresses. </b>
        Multiple network addresses per data node are not supported. Use
        of these is liable to cause problems: In the event of a data
        node failure, an SQL node waits for confirmation that the data
        node went down but never receives it because another route to
        that data node remains open. This can effectively make the
        cluster inoperable.

        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            It is possible to use multiple network hardware
            <span class="emphasis"><em>interfaces</em></span> (such as Ethernet cards) for
            a single data node, but these must be bound to the same
            address. This also means that it not possible to use more
            than one <code class="literal">[tcp]</code> section per connection in
            the <code class="literal">config.ini</code> file. See
            <a href="mysql-cluster.html#mysql-cluster-tcp-definition" title="20.3.4.7. Cluster TCP/IP Connections">Section 20.3.4.7, “Cluster TCP/IP Connections”</a>, for more
            information.
          </p></div><p>
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-limitations-resolved"></a>20.14.11. Previous MySQL Cluster Issues Resolved in MySQL 5.1</h3></div></div></div><a class="indexterm" name="id2383149"></a><p>
      A number of limitations and related issues existing in earlier
      versions of MySQL Cluster have been resolved:

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Variable-length column support. </b>
              The <code class="literal">NDBCLUSTER</code> storage engine now
              supports variable-length column types for in-memory
              tables.
            </p><p>
            Previously, for example, any Cluster table having one or
            more <code class="literal">VARCHAR</code> fields which contained only
            relatively small values, much more memory and disk space
            were required when using the <code class="literal">NDBCLUSTER</code>
            storage engine than would have been the case for the same
            table and data using the <code class="literal">MyISAM</code> engine.
            In other words, in the case of a <code class="literal">VARCHAR</code>
            column, such a column required the same amount of storage as
            a <code class="literal">CHAR</code> column of the same size. In MySQL
            5.1, this is no longer the case for in-memory tables, where
            storage requirements for variable-length column types such
            as <code class="literal">VARCHAR</code> and <code class="literal">BINARY</code>
            are comparable to those for these column types when used in
            <code class="literal">MyISAM</code> tables (see
            <a href="data-types.html#storage-requirements" title="10.5. Data Type Storage Requirements">Section 10.5, “Data Type Storage Requirements”</a>).
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
              For MySQL Cluster Disk Data tables, the fixed-width
              limitation continues to apply. See
              <a href="mysql-cluster.html#mysql-cluster-disk-data" title="20.12. MySQL Cluster Disk Data Tables">Section 20.12, “MySQL Cluster Disk Data Tables”</a>.
            </p></div></li><li><a class="indexterm" name="id2383264"></a><p><b>Replication with MySQL Cluster. </b>
              It is now possible to use MySQL replication with Cluster
              databases. For details, see
              <a href="mysql-cluster.html#mysql-cluster-replication" title="20.11. MySQL Cluster Replication">Section 20.11, “MySQL Cluster Replication”</a>.
            </p><p><b>Circular Replication. </b>
              Circular replication is supported for MySQL Cluster
              beginning with MySQL 5.1.18. See
              <a href="mysql-cluster.html#mysql-cluster-replication-issues" title="20.11.3. Known Issues in MySQL Cluster Replication">Section 20.11.3, “Known Issues in MySQL Cluster Replication”</a>.

            </p></li><li><p><b><code class="literal">auto_increment_increment</code> and
              <code class="literal">auto_increment_offset</code>. </b>
              The <code class="literal">auto_increment_increment</code> and
              <code class="literal">auto_increment_offset</code> server system
              variables are supported for Cluster replication beginning
              with MySQL 5.1.20.
            </p></li><li><a class="indexterm" name="id2383354"></a><p><b>Database autodiscovery and online schema changes. </b>
              Autodiscovery of databases is now supported for multiple
              MySQL servers accessing the same MySQL Cluster, provided
              that a given <span><strong class="command">mysqld</strong></span> is already running
              and is connected to the cluster at the time that the
              database is created on a different
              <span><strong class="command">mysqld</strong></span>.
            </p><p>
            What this means is that if a <span><strong class="command">mysqld</strong></span>
            process first connects to the cluster after a database named
            <em class="replaceable"><code>db_name</code></em> has been created, you
            should issue a <code class="literal">CREATE SCHEMA
            <em class="replaceable"><code>db_name</code></em></code> statement on
            the “<span class="quote">new</span>” MySQL server when it first accesses
            that MySQL Cluster. Once this has been done, the
            “<span class="quote">new</span>” <span><strong class="command">mysqld</strong></span> should be able
            to detect any tables in that database tables without errors.
          </p><p>
            This also means that online schema changes in
            <code class="literal">NDB</code> tables are now possible. That is, the
            result of operations such as <code class="literal">ALTER TABLE</code>
            and <code class="literal">CREATE INDEX</code> performed on one SQL
            node in the cluster are now visible to the cluster's other
            SQL nodes without any additional action being taken.
          </p></li><li><p><b>Backup and restore between architectures. </b>
              Beginning with MySQL 5.1.10, it is possible to perform a
              Cluster backup and restore between different
              architectures. Previously — for example — you
              could not back up a cluster running on a big-endian
              platform and then restore from that backup to a cluster
              running on a little-endian system. (<a href="http://bugs.mysql.com/19255" target="_top">Bug#19255</a>)
            </p></li><li><p><b>Character set directory. </b><a class="indexterm" name="id2383487"></a>
              Beginning with MySQL 5.1.10, it is possible to install
              MySQL with Cluster support to a non-default location and
              change the search path for font description files using
              either the <code class="option">--basedir</code> or
              <code class="option">--character-sets-dir</code> options.
              (Previously, <span><strong class="command">ndbd</strong></span> in MySQL 5.1 searched
              only the default path — typically
              <code class="filename">/usr/local/mysql/share/mysql/charsets</code>
              — for character sets.)
            </p></li><li><p>
            In MySQL 5.1, it is no longer necessary, when running
            multiple management servers, to restart all the cluster's
            data nodes to enable the management nodes to see one
            another.
          </p></li><li><p><b>Length of <code class="literal">CREATE TABLE</code> statements. </b><a class="indexterm" name="id2383551"></a>
              <code class="literal">CREATE TABLE</code> statements may be no more
              than 4096 characters in length. <span class="emphasis"><em>This limitation
              affects MySQL 5.1.6, 5.1.7, and 5.1.8 only</em></span>.
              (See <a href="http://bugs.mysql.com/17813" target="_top">Bug#17813</a>)
            </p></li><li><p><b><code class="literal">IGNORE</code> and <code class="literal">REPLACE</code> functionality. </b><a class="indexterm" name="id2383604"></a>
              In MySQL 5.1.7 and earlier, <code class="literal">INSERT
              IGNORE</code>, <code class="literal">UPDATE IGNORE</code>, and
              <code class="literal">REPLACE</code> were supported only for primary
              keys, but not for unique keys. It was possible to work
              around this issue by removing the constraint, then
              dropping the unique index, performing any inserts, and
              then adding the unique index again.
            </p><p>
            This limitation was removed for <code class="literal">INSERT
            IGNORE</code> and <code class="literal">REPLACE</code> in MySQL
            5.1.8. (See <a href="http://bugs.mysql.com/17431" target="_top">Bug#17431</a>.)
          </p></li><li><p><b><code class="literal">AUTO_INCREMENT</code> columns. </b>
              In MySQL 5.1.10 and earlier versions, the maximum number
              of tables having <code class="literal">AUTO_INCREMENT</code> columns
              — including those belonging to hidden primary keys
              — was 2048.
            </p><p>
            This limitation was lifted in MySQL 5.1.11.
          </p></li><li><p><b>Maximum number of cluster nodes. </b>
              Prior to MySQL Cluster NDB 6.1.1, the total maximum number
              of nodes in a MySQL Cluster was 63, including all SQL
              nodes (MySQL Servers), API nodes (applications accessing
              the cluster other than MySQL servers), data nodes, and
              management servers.
            </p><p>
            Starting with MySQL Cluster NDB 6.1.1, up to 255 API nodes
            (including MySQL servers acting as cluster SQL nodes) are
            supported by a single cluster. The total number of data
            nodes and management nodes beginning with this version is
            63, of which up to 48 can be data nodes.
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
              The limitation that a data node cannot have a node ID
              greater than 49 continues to apply.
            </p></div></li><li><p><b>Recovery of memory from deleted rows. </b>
              Beginning with MySQL Cluster NDB 6.3.7, memory can be
              reclaimed from an <code class="literal">NDB</code> table for reuse
              with any <code class="literal">NDB</code> table by employing
              <code class="literal">OPTIMIZE TABLE</code>, subject to the
              following limitations:

              </p><div class="itemizedlist"><ul type="circle"><li><p>
                    Only in-memory tables are supported; the
                    <code class="literal">OPTIMIZE TABLE</code> statement still
                    has no effect on MySQL Cluster Disk Data tables.
                  </p></li><li><p>
                    Only variable-length columns (such as those declared
                    as <code class="literal">VARCHAR</code>,
                    <code class="literal">TEXT</code>, or <code class="literal">BLOB</code>)
                    are supported.
                  </p><p>
                    However, you can force columns defined using
                    fixed-length data types (such as
                    <code class="literal">CHAR</code>) to be dynamic using the
                    <code class="literal">ROW_FORMAT</code> or
                    <code class="literal">COLUMN_FORMAT</code> option with a
                    <code class="literal">CREATE TABLE</code> or <code class="literal">ALTER
                    TABLE</code> statement.
                  </p><p>
                    See <a href="sql-syntax.html#create-table" title="12.1.10. CREATE TABLE Syntax">Section 12.1.10, “<code class="literal">CREATE TABLE</code> Syntax”</a>, and
                    <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax">Section 12.1.4, “<code class="literal">ALTER TABLE</code> Syntax”</a>, for information on
                    these options.
                  </p></li></ul></div><p>

              You can regulate the effects of
              <code class="literal">OPTIMIZE</code> on performance by adjusting
              the value of the global system variable
              <code class="literal">ndb_optimization_delay</code>, which sets the
              number of milliseconds to wait between batches of rows
              being processed by <code class="literal">OPTIMIZE</code>. The
              default value is 10 milliseconds. It is possible to set a
              lower value (to a minimum of <code class="literal">0</code>), but
              not recommended. The maximum is 100000 milliseconds (that
              is, 100 seconds).
            </p></li></ul></div><p>
    </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-roadmap"></a>20.15. MySQL Cluster Development Roadmap</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-changes-5-1">20.15.1. Features Added in MySQL 5.1 Cluster</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-changes-5-1-ndb-6-1">20.15.2. Features Added in MySQL Cluster NDB 6.1</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-changes-5-1-ndb-6-2">20.15.3. Features Added in MySQL Cluster NDB 6.2</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-changes-5-1-ndb-6-3">20.15.4. Features Added in MySQL Cluster NDB 6.3</a></span></dt></dl></div><a class="indexterm" name="id2383890"></a><a class="indexterm" name="id2383899"></a><a class="indexterm" name="id2383908"></a><p>
    In this section, we discuss changes in the implementation of MySQL
    Cluster in MySQL 5.1 and MySQL Cluster NDB as compared
    to MySQL 5.0.
  </p><p>
    There are a number of significant changes in the implementation of
    the <code class="literal">NDBCLUSTER</code> storage engine in mainline MySQL
    5.1 releases up to and including MySQL 5.1.23 as compared to that in
    MySQL 5.0; MySQL Cluster NDB makes further changes and improvements
    in MySQL Cluster in addition to these. The changes and features most
    likely to be of interest are shown in the following table:

    

    </p><div class="informaltable"><table border="1"><colgroup><col></colgroup><thead><tr><th><a href="mysql-cluster.html#mysql-cluster-changes-5-1" title="20.15.1. Features Added in MySQL 5.1 Cluster">MySQL 5.1 (through
              5.1.23)</a></th></tr></thead><tbody><tr><td>MySQL Cluster Replication</td></tr><tr><td>Disk Data storage</td></tr><tr><td>Variable-size columns</td></tr><tr><td>User-defined partitioning</td></tr><tr><td>Autodiscovery of table schema changes</td></tr><tr><td>Online adding and dropping of indexes</td></tr></tbody></table><table border="1"><colgroup><col></colgroup><thead><tr><th><a href="mysql-cluster.html#mysql-cluster-changes-5-1-ndb-6-1" title="20.15.2. Features Added in MySQL Cluster NDB 6.1">MySQL Cluster NDB
              6.1</a></th></tr></thead><tbody><tr><td>Greater number of cluster nodes</td></tr><tr><td>Disabling of arbitration</td></tr><tr><td>Additional <code class="literal">DUMP</code> commands</td></tr><tr><td>Faster Disk Data backups</td></tr><tr><td>Batched slave updates</td></tr></tbody></table><table border="1"><colgroup><col></colgroup><thead><tr><th><a href="mysql-cluster.html#mysql-cluster-changes-5-1-ndb-6-2" title="20.15.3. Features Added in MySQL Cluster NDB 6.2">MySQL Cluster NDB
              6.2</a></th></tr></thead><tbody><tr><td>Improved backup status reporting
              (<code class="literal">BackupReportFrequency</code>, <code class="literal">REPORT
              BackupStatus</code>)</td></tr><tr><td>Multiple connections per SQL node</td></tr><tr><td>Data access with <code class="literal">NdbRecord</code> (NDB API)</td></tr><tr><td><code class="literal">REPORT MemoryUsage</code> command</td></tr><tr><td>Memory allocation improvements</td></tr><tr><td>Management client connection control</td></tr><tr><td>Micro-GCPs</td></tr><tr><td>Online <code class="literal">ADD COLUMN</code>; improved online index creation</td></tr></tbody></table><table border="1"><colgroup><col></colgroup><thead><tr><th><a href="mysql-cluster.html#mysql-cluster-changes-5-1-ndb-6-3" title="20.15.4. Features Added in MySQL Cluster NDB 6.3">MySQL Cluster NDB
              6.3</a></th></tr></thead><tbody><tr><td>Conflict detection and resolution for multi-master replication</td></tr><tr><td>Compressed backups and local checkpoints</td></tr><tr><td>Support for <code class="literal">OPTIMIZE TABLE</code></td></tr><tr><td>Parallel data node recovery</td></tr><tr><td>Enhanced transaction coordinator selection</td></tr><tr><td>Improved SQL statement performance metrics</td></tr><tr><td>Transaction batching</td></tr><tr><td><span><strong class="command">ndb_restore</strong></span> attribute promotion</td></tr><tr><td>Support for <code class="literal">epoll</code> (Linux only)</td></tr><tr><td>Distribution awareness</td></tr><tr><td><code class="literal">NDB</code> thread locks; realtime extensions for multiple
              CPUs</td></tr></tbody></table></div><p>
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-changes-5-1"></a>20.15.1. Features Added in MySQL 5.1 Cluster</h3></div></div></div><a class="indexterm" name="id2384328"></a><p>
      A number of new features for MySQL Cluster have been implemented
      in MySQL 5.1 through MySQL 5.1.23, when support for MySQL Cluster
      was moved to MySQL Cluster NDB. All of the features in the
      following list are also available in all MySQL Cluster NDB (6.1
      and later) releases.
    </p><div class="itemizedlist"><ul type="disc"><li><p><b>Integration of MySQL Cluster into MySQL Replication. </b>
            MySQL Cluster Replication makes it possible to replicate
            from one MySQL Cluster to another. Updates on any SQL node
            (MySQL server) in the cluster acting as the master are
            replicated to the slave cluster; the state of the slave side
            remains consistent with the cluster acting as the master.
            This is sometimes referred to as <em class="firstterm">asynchronous
            replication</em> between clusters, providing
            <em class="firstterm">geographic redundancy</em>. It is also
            possible to replicate from a MySQL Cluster acting as the
            master to a standalone MySQL server acting as the slave, or
            from a standalone MySQL master server to to a slave cluster;
            in either of these cases, the standalone MySQL server uses a
            storage engine other than <code class="literal">NDBCLUSTER</code>.
            Multi-master replication setups such as circular replication
            are also supported.
          </p><p>
          See <a href="mysql-cluster.html#mysql-cluster-replication" title="20.11. MySQL Cluster Replication">Section 20.11, “MySQL Cluster Replication”</a>.
        </p></li><li><p><b>Support for storage of rows on disk. </b>
            Storage of <code class="literal">NDBCLUSTER</code> table data on disk
            is now supported. Indexed columns, including the primary key
            hash index, must still be stored in RAM; however, all other
            columns can be stored on disk.
          </p><p>
          See <a href="mysql-cluster.html#mysql-cluster-disk-data" title="20.12. MySQL Cluster Disk Data Tables">Section 20.12, “MySQL Cluster Disk Data Tables”</a>.
        </p></li><li><p><b>Variable-size columns. </b>
            In MySQL 5.0, an <code class="literal">NDBCLUSTER</code> table column
            defined as <code class="literal">VARCHAR(255)</code> used 260 bytes of
            storage independent of what was stored in any particular
            record. In MySQL 5.1 Cluster tables, only the portion of the
            column actually taken up by the record is stored. This makes
            possible a significant reduction in space requirements for
            such columns as compared to previous release series —
            by a factor of up to 5 in many cases.
          </p></li><li><p><b>User-defined partitioning. </b>
            Users can define partitions based on columns that are part
            of the primary key. It is possible to partition
            <code class="literal">NDB</code> tables based on
            <code class="literal">KEY</code> and <code class="literal">LINEAR KEY</code>
            schemes. This feature is also available for many other MySQL
            storage engines, which support additional partitioning types
            that are not available with <code class="literal">NDBCLUSTER</code>
            tables.
          </p><p>
          For additional general information about user-defined
          partitioning in MySQL 5.1, see
          <a href="partitioning.html" title="Chapter 21. Partitioning">Chapter 21, <i>Partitioning</i></a>. Specifics of partitioning
          types are discussed in <a href="partitioning.html#partitioning-types" title="21.2. Partition Types">Section 21.2, “Partition Types”</a>.
        </p><p>
          The MySQL Server can also determine whether it is possible to
          “<span class="quote">prune away</span>” some of the partitions from the
          <code class="literal">WHERE</code> clause, which can greatly speed up
          some queries. See <a href="partitioning.html#partitioning-pruning" title="21.4. Partition Pruning">Section 21.4, “Partition Pruning”</a>, for
          information about designing tables and queries to take
          advantage of partition pruning.
        </p></li><li><p><b>Autodiscovery of table schema changes. </b>
            In MySQL 5.0, it was necessary to issue a <code class="literal">FLUSH
            TABLES</code> statement or a “<span class="quote">dummy</span>”
            <code class="literal">SELECT</code> in order for new
            <code class="literal">NDBCLUSTER</code> tables or changes made to
            schemas of existing <code class="literal">NDBCLUSTER</code> tables on
            one SQL node to be visible on the cluster's other SQL
            nodes. In MySQL 5.1, this is no longer necessary; new
            Cluster tables and changes in the definitions of existing
            <code class="literal">NDBCLUSTER</code> tables made on one SQL node
            are immediately visible to all SQL nodes connected to the
            cluster.
          </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            When creating a new database, it is still necessary in MySQL
            5.1 to issue a <code class="literal">CREATE DATABASE</code> or
            <code class="literal">CREATE SCHEMA</code> statement on each SQL node
            in the cluster.
          </p></div></li><li><p><b>Distribution awareness (NDB API). </b>
            <em class="firstterm">Distribution awareness</em> is a mechanism
            by which the best data node is automatically selected to be
            queried for information. (Conceptually, it is similar in
            some ways to partition pruning (see
            <a href="partitioning.html#partitioning-pruning" title="21.4. Partition Pruning">Section 21.4, “Partition Pruning”</a>). To take advantage
            of distribution awareness, you should do the following:

            </p><div class="orderedlist"><ol type="1"><li><p>
                  Determine which table column is most likely to be used
                  for finding matching records.
                </p></li><li><p>
                  Make this column part of the table's primary key.
                </p></li><li><p>
                  Explicitly partition the table by
                  <code class="literal">KEY</code>, using this column as the
                  table' partitioning key.
                </p></li></ol></div><p>

            Following these steps causes records with the same value for
            the partitioning column to be stored on the same partition
            (that is, in the same node group). When reading data,
            transactions are begun on the data node actually having the
            desired rows instead of this node being determined by the
            usual round-robin mechanism.

            </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Important</h3><p>
                In order to see a measureable impact on performance, the
                cluster must have at least four data nodes, since, with
                only two data nodes, both data nodes have exactly the
                same data.
              </p></div><p>

            Using distribution awareness can yield performance increase
            of as great as 45% when using four data nodes, and possibly
            more when using a greater number of data nodes.

            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
                In mainline MySQL 5.1 releases, distribution awareness
                was supported only when using the NDB API; support was
                added for SQL and API nodes in MySQL Cluster NDB 6.3
                (see
                <a href="mysql-cluster.html#mysql-cluster-changes-5-1-ndb-6-3" title="20.15.4. Features Added in MySQL Cluster NDB 6.3">Section 20.15.4, “Features Added in MySQL Cluster NDB 6.3”</a>,
                which includes an example showing how to create a table
                in order to take advantage of distribution awareness).
              </p></div><p>
          </p></li></ul></div><p>
      See <a href="mysql-cluster.html#mysql-cluster-limitations-resolved" title="20.14.11. Previous MySQL Cluster Issues Resolved in MySQL 5.1">Section 20.14.11, “Previous MySQL Cluster Issues Resolved in MySQL 5.1”</a>, for more
      information.
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-changes-5-1-ndb-6-1"></a>20.15.2. Features Added in MySQL Cluster NDB 6.1</h3></div></div></div><p>
      The following list provides an overview of significant feature
      additions and changes made in MySQL Cluster NDB 6.1. All of the
      changes in this list are also available in MySQL Cluster NDB 6.2
      and 6.3 releases. For detailed information about all changes made
      in MySQL Cluster NDB 6.1, see
      <a href="mysql-cluster.html#mysql-cluster-news-6-1" title="20.17.3. Changes in MySQL Cluster NDB 6.1">Section 20.17.3, “Changes in MySQL Cluster NDB 6.1”</a>.

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Increased number of cluster nodes. </b>
              The maximum number of all nodes in a MySQL Cluster has
              been increased to 255. For more information, see
              <a href="mysql-cluster.html#mysql-cluster-limitations-multiple-nodes" title="20.14.10. Limitations Relating to Multiple Cluster Nodes">Section 20.14.10, “Limitations Relating to Multiple Cluster Nodes”</a>.
            </p></li><li><p><b>Disabling arbitration. </b>
              It is now possible to disable arbitration by setting
              <code class="literal">ArbitrationRank=0</code> on all cluster
              management and SQL nodes. For more information, see
              <a href="mysql-cluster.html#mysql-cluster-param-mgm-definition-arbitrationrank"><em class="citetitle">Defining
              the Management Server:
              <code class="literal">ArbitrationRank</code></em></a> and
              <a href="mysql-cluster.html#mysql-cluster-param-api-definition-arbitrationrank"><em class="citetitle">Defining
              SQL and Other API Nodes:
              <code class="literal">ArbitrationRank</code></em></a>.
            </p></li><li><p><b>Additional <code class="literal">DUMP</code> commands. </b>
              New management client <code class="literal">DUMP</code> commands
              provide help with tracking transactions, scan operations,
              and locks. See
              <a href="mysql-cluster.html#mysql-cluster-mgm-client-commands" title="20.7.2. Commands in the MySQL Cluster Management Client">Section 20.7.2, “Commands in the MySQL Cluster Management Client”</a>, and
              <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-dump-commands.html" target="_top"><code class="literal">DUMP</code> Commands</a>, for more
              information.
            </p></li><li><p><b>Faster Disk Data backups. </b>
              Improvements in backups of Disk Data tables can yield a 10
              to 15% increase in backup speed of Disk Data tables.
            </p></li><li><p><b>Batched slave updates. </b>
              Batching of updates on cluster replication slaves, enabled
              using the <code class="option">--slave-allow-batching</code> option
              for <span><strong class="command">mysqld</strong></span>, increases replication
              efficiency. For more information, see
              <a href="mysql-cluster.html#mysql-cluster-replication-starting" title="20.11.6. Starting Replication (Single Replication Channel)">Section 20.11.6, “Starting Replication (Single Replication Channel)”</a>.
            </p></li></ul></div><p>
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-changes-5-1-ndb-6-2"></a>20.15.3. Features Added in MySQL Cluster NDB 6.2</h3></div></div></div><p>
      The following list provides an overview of significant feature
      additions and changes made in MySQL Cluster NDB 6.2. All of the
      changes in this list are also available in MySQL Cluster NDB 6.3 .
      For more detailed information about all feature changes and
      bugfixes made in MySQL Cluster NDB 6.2, see
      <a href="mysql-cluster.html#mysql-cluster-news-6-2" title="20.17.2. Changes in MySQL Cluster NDB 6.2">Section 20.17.2, “Changes in MySQL Cluster NDB 6.2”</a>.

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Enhanced backup status reporting. </b>
              Backup status reporting has been improved, aided in part
              by the introduction of a
              <code class="literal">BackupReportFrequency</code> configuration
              parameter; see
              <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-backupreportfrequency"><em class="citetitle">Defining
              Data Nodes:
              <code class="literal">BackupReportFrequency</code></em></a>,
              for more information.
            </p></li><li><p><b>Multiple cluster connections per SQL node. </b>
              A single MySQL server acting as a MySQL Cluster SQL node
              can employ multiple connections to the cluster using the
              <code class="option">--ndb-cluster-connection-pool</code> startup
              option for <span><strong class="command">mysqld</strong></span>. This option is
              described in
              <a href="mysql-cluster.html#option_mysqld_ndb-cluster-connection-pool"><em class="citetitle">MySQL
              Cluster-Related Command Options for
              <span><strong class="command">mysqld</strong></span>:
              <code class="option">--ndb-cluster-connection-pool</code>
              option</em></a>.
            </p></li><li><p><b>New data access interface. </b>
              The <code class="literal">NdbRecord</code> interface provides a new
              and simplified data handler for use in NDB API
              applications. See <a href="http://dev.mysql.com/doc/ndbapi/en/interface-ndbrecord.html" target="_top">The <code class="literal">NdbRecord</code> Interface</a>,
              for more information.
            </p></li><li><p><b>New reporting commands. </b>
              The new management client <code class="literal">REPORT
              BackupStatus</code> and <code class="literal">REPORT
              MemoryUsage</code> commands provide better access to
              information about the status of MySQL Cluster backups and
              how much memory is being used by MySQL Cluster for data
              and index storage. See
              <a href="mysql-cluster.html#mysql-cluster-mgm-client-commands" title="20.7.2. Commands in the MySQL Cluster Management Client">Section 20.7.2, “Commands in the MySQL Cluster Management Client”</a>, for
              more information about the <code class="literal">REPORT</code>
              commands. In addition, in-progress status reporting is
              provided by the <span><strong class="command">ndb_restore</strong></span> utility;
              see <a href="mysql-cluster.html#mysql-cluster-restore" title="20.9.3. ndb_restore — Restore a Cluster Backup">Section 20.9.3, “<span><strong class="command">ndb_restore</strong></span> — Restore a Cluster Backup”</a>.
            </p></li><li><p><b>Improved memory allocation and configuration. </b>
              Memory is now allocated by the <code class="literal">NDB</code>
              kernel to tables on a page-by-page basis, which
              significantly reduces the memory overhead required for
              maintaining <code class="literal">NDBCLUSTER</code> tables. In
              addition, the <code class="literal">MaxAllocate</code> configuration
              parameter now makes it possible to set the maximum size of
              the allocation unit used for table memory; for more
              information about this configuration parameter, see
              <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxallocate"><em class="citetitle">Defining
              Data Nodes:
              <code class="literal">MaxAllocate</code></em></a>.
            </p></li><li><p><b>Choice of fixed-width or variable-width columns. </b>
              You can control whether fixed-width or variable-width
              storage is used for a given column of an
              <code class="literal">NDB</code> table by employing of the
              <code class="literal">COLUMN_FORMAT</code> specifier as part of the
              column's definition in a <code class="literal">CREATE
              TABLE</code> or <code class="literal">ALTER TABLE</code>
              statement. In addition, the ability to control whether a
              given column of an <code class="literal">NDB</code> table is stored
              in memory or on disk, using the <code class="literal">STORAGE</code>
              specifier as part of the column's definition in a
              <code class="literal">CREATE TABLE</code> or <code class="literal">ALTER
              TABLE</code> statement. For more information, see
              <a href="sql-syntax.html#create-table" title="12.1.10. CREATE TABLE Syntax">Section 12.1.10, “<code class="literal">CREATE TABLE</code> Syntax”</a>, and
              <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax">Section 12.1.4, “<code class="literal">ALTER TABLE</code> Syntax”</a>.
            </p></li><li><p><b>Controlling management client connections. </b>
              The <code class="option">--bind-address</code> cluster management
              server startup option makes it possible to restrict
              management client connections to
              <span><strong class="command">ndb_mgmd</strong></span> to a single host (IP address
              or hostname) and port, which can make MySQL Cluster
              management operations more secure. For more information
              about this option, see
              <a href="mysql-cluster.html#mysql-cluster-ndb-mgmd-command-options" title="20.6.5.2. Command Options for ndb_mgmd">Section 20.6.5.2, “Command Options for <span><strong class="command">ndb_mgmd</strong></span>”</a>.
            </p></li><li><p><b>Micro-GCPs. </b>
              Due to a change in the protocol for handling of global
              checkpoints (GCPs handled in this manner sometimes being
              referred to as “<span class="quote">micro-GCPs</span>”), it is now
              possible to control how often the GCI number is updated,
              and how often global checkpoints are written to disk,
              using the <code class="literal">TimeBetweenEpochs</code>
              configuration parameter. This improves the reliability and
              performance of MySQL Cluster Replication. For more
              information, see
              <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-timebetweenepochs"><em class="citetitle">Defining
              Data Nodes:
              <code class="literal">TimeBetweenEpochs</code></em></a>
              and
              <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-timebetweenepochstimeout"><em class="citetitle">Defining
              Data Nodes:
              <code class="literal">TimeBetweenEpochsTimeout</code></em></a>.
            </p></li><li><p><b>Core online schema change support. </b>
              Support for the online <code class="literal">ALTER TABLE</code>
              operations <code class="literal">ADD COLUMN</code>, <code class="literal">ADD
              INDEX</code>, and <code class="literal">DROP INDEX</code> is
              available. When the <code class="literal">ONLINE</code> keyword is
              used, the <code class="literal">ALTER TABLE</code> is non-copying,
              which means that indexes do not have to be re-created,
              which provides these benefits:

              </p><div class="itemizedlist"><ul type="circle"><li><p>
                    Single user mode is no longer required for
                    <code class="literal">ALTER TABLE</code> operations that can
                    be performed online.
                  </p></li><li><p>
                    Transactions can continue during <code class="literal">ALTER
                    TABLE</code> operations that can be performed
                    online.
                  </p></li><li><p>
                    Tables being altered online are not locked.
                  </p></li></ul></div><p>

              Online <code class="literal">CREATE INDEX</code> and <code class="literal">DROP
              INDEX</code> statements are also supported. Online
              changes can be suppressed using the
              <code class="literal">OFFLINE</code> key word. See
              <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax">Section 12.1.4, “<code class="literal">ALTER TABLE</code> Syntax”</a>,
              <a href="sql-syntax.html#create-index" title="12.1.7. CREATE INDEX Syntax">Section 12.1.7, “<code class="literal">CREATE INDEX</code> Syntax”</a>, and
              <a href="sql-syntax.html#drop-index" title="12.1.13. DROP INDEX Syntax">Section 12.1.13, “<code class="literal">DROP INDEX</code> Syntax”</a>, for more detailed
              information.
            </p></li><li><p><b><code class="literal">mysql.ndb_binlog_index</code> improvements. </b>
              More information has been added to the
              <code class="literal">mysql.ndb_binlog_index</code> table so that it
              is possible to determine which originating epochs have
              been applied inside an epoch. This is particularly useful
              for 3-way replication. See
              <a href="mysql-cluster.html#mysql-cluster-replication-schema" title="20.11.4. Cluster Replication Schema and Tables">Section 20.11.4, “Cluster Replication Schema and Tables”</a>, for
              more information.
            </p></li><li><p><b>Epoch lag control. </b>
              The <code class="literal">MaxBufferedEpochs</code> data node
              configuration parameter provides a means to control the
              maximum number of unprocessed epochs by which a
              subscribing node can lag. Subscribers which exceed this
              number are disconnected and forced to reconnect. For a
              discussion of this configuration parameter, see
              <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-maxbufferedepochs"><em class="citetitle">Defining
              Data Nodes:
              <code class="literal">MaxBufferedEpochs</code></em></a>.
            </p></li></ul></div><p>
    </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-changes-5-1-ndb-6-3"></a>20.15.4. Features Added in MySQL Cluster NDB 6.3</h3></div></div></div><p>
      The following list provides an overview of significant feature
      additions and changes first made in MySQL Cluster NDB 6.3. For
      more detailed information about all feature changes and bugfixes
      made in MySQL Cluster NDB 6.3, see
      <a href="mysql-cluster.html#mysql-cluster-news-6-3" title="20.17.1. Changes in MySQL Cluster NDB 6.3">Section 20.17.1, “Changes in MySQL Cluster NDB 6.3”</a>.

      </p><div class="itemizedlist"><ul type="disc"><li><p><b>Conflict detection and resolution. </b>
              It is now possible to detect and resolve conflicts that
              arise in multi-master replication scenarios, such as
              circular replication, when different masters may try to
              update the same row on the slave with different data. Both
              “<span class="quote">greatest timestamp wins</span>” and “<span class="quote">same
              timestamp wins</span>” scenarios are supported. For more
              information, see
              <a href="mysql-cluster.html#mysql-cluster-replication-conflict-resolution" title="20.11.10. MySQL Cluster Replication Conflict Resolution">Section 20.11.10, “MySQL Cluster Replication Conflict Resolution”</a>.
            </p></li><li><p><b>Recovery of “<span class="quote">one master, many slaves</span>” replication setups. </b>
              Recovery of multi-way replication setups (“<span class="quote">one
              master, many slaves</span>”) is now supported via the
              <code class="option">--ndb-log-orig</code> server option and changes
              in the <code class="literal">mysql.ndb_binlog_index</code> table.
              See <a href="mysql-cluster.html#mysql-cluster-replication-schema" title="20.11.4. Cluster Replication Schema and Tables">Section 20.11.4, “Cluster Replication Schema and Tables”</a>,
              for more information.
            </p></li><li><p><b>Enhanced selection options for transaction coordinator. </b>
              New values and behaviors are introduced for
              <code class="option">--ndb_optimized_node_selection</code> allowing
              for greater flexibility when an SQL node chooses a
              transaction coordinator. See
              <a href="mysql-cluster.html#option_mysqld_ndb_optimized_node_selection"><em class="citetitle">MySQL
              Cluster System Variables:
              <code class="literal">ndb_optimized_node_selection</code></em></a>,
              for more information.
            </p></li><li><p><b>Replication heartbeats. </b>
              Replication heartbeats facilitate the task of monitoring
              and detecting failures in master-slave connections in real
              time. This feature is implemented via a new
              <code class="literal">MASTER_HEARTBEAT_PERIOD =
              <em class="replaceable"><code>value</code></em></code> clause for the
              <code class="literal">CHANGE MASTER TO</code> statement and the
              addition of two status variables
              <code class="literal">Slave_heartbeat_period</code> and
              <code class="literal">Slave_received_heartbeats</code>. For more
              information, see <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax">Section 12.6.2.1, “<code class="literal">CHANGE MASTER TO</code> Syntax”</a>.
            </p></li><li><p><b><code class="literal">NDB</code> thread locks. </b>
              It is possible to lock <code class="literal">NDB</code> execution
              threads and maintenance threads (such as filesystem and
              other operating system threads) to specific CPUs on
              multiprocessor data node hosts, and to leverage real-time
              scheduling.
            </p></li><li><p><b>Improved performance of updates using primary keys or unique keys. </b>
              The number of unnecessary reads when performing a primary
              key or unique key update has been greatly reduced. Since
              it is seldom necessary to read a record prior to an
              update, this can yield a considerable improvement in
              performance. In addition, primary key columns are no
              longer written to when not needed during update
              operations.
            </p></li><li><p><b>Batching improvements. </b>
              Support of batched <code class="literal">DELETE</code> and
              <code class="literal">UPDATE</code> operations has been
              significantly improved. Batching of <code class="literal">UPDATE
              WHERE...</code> and multiple <code class="literal">DELETE</code>
              operations is also now implemented.
            </p></li><li><p><b>Improved SQL statement performance metrics. </b>
              The <code class="literal">Ndb_execute_count</code> system status
              variable measures the number of round trips made by SQL
              statements to the <code class="literal">NDB</code> kernel, providing
              an improved metric for determining efficiency with which
              statements are excuted. For more information, see
              <a href="mysql-cluster.html#option_mysqld_Ndb_execute_count"><em class="citetitle">MySQL
              Cluster Status Variables:
              <code class="literal">Ndb_execute_count</code></em></a>.
            </p></li><li><p><b>Compressed LCPs and backups. </b>
              Compressed local checkpoints and backups can save 50% or
              more of the disk space used by uncompressed LCPs and
              backups. These can be enabled using the two new data node
              configuration parameters <code class="literal">CompressedLCP</code>
              and <code class="literal">CompressedBackup</code>, respectively. See
              <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-compressedbackup"><em class="citetitle">MySQL
              Cluster Status Variables:
              <code class="literal">CompressedBackup</code></em></a>,
              and
              <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-compressedlcp"><em class="citetitle">MySQL
              Cluster Status Variables:
              <code class="literal">CompressedLCP</code></em></a>, for
              more information about these parameters.
            </p></li><li><p><b><code class="literal">OPTIMIZE TABLE</code> support with
              <code class="literal">NDBCLUSTER</code> tables. </b>
              <code class="literal">OPTIMIZE TABLE</code> is supported for dynamic
              columns of in-memory <code class="literal">NDB</code> tables. In
              such cases, it is no longer necessary to drop (and
              possibly to re-create) a table, or to perform a rolling
              restart, in order to recover memory from deleted rows for
              general re-use by Cluster. The performance of
              <code class="literal">OPTIMIZE</code> on Cluster tables can be tuned
              by adjusting the value of the
              <code class="literal">ndb_optimization_delay</code> system variable,
              which controls the number of milliseconds to wait between
              processing batches of rows by <code class="literal">OPTIMIZE
              TABLE</code>. In addition, <code class="literal">OPTIMIZE
              TABLE</code> on an <code class="literal">NDBCLUSTER</code> table
              can be interrupted by, for example, killing the SQL thread
              performing the <code class="literal">OPTIMIZE</code> operation.
            </p></li><li><p><b>Batching of transactions. </b>
              It is possible to cause statements occurring within the
              same transaction to be run as a batch by setting the
              session variable
              <code class="literal">transaction_allow_batching</code> to
              <code class="literal">1</code> or <code class="literal">ON</code>. To use this
              feature, <code class="literal">AUTOCOMMIT</code> must be set to
              <code class="literal">0</code> or <code class="literal">OFF</code>. Batch
              sizes can be controlled using the
              <code class="option">--ndb-batch-size</code> option for
              <span><strong class="command">mysqld</strong></span>. For more information, see
              <a href="mysql-cluster.html#mysql-cluster-mysqld-command-options" title="20.4.2. MySQL Cluster-Related Command Options for mysqld">Section 20.4.2, “MySQL Cluster-Related Command Options for <span><strong class="command">mysqld</strong></span>”</a>,
              and <a href="mysql-cluster.html#mysql-cluster-system-variables" title="20.4.3. MySQL Cluster System Variables">Section 20.4.3, “MySQL Cluster System Variables”</a>.
            </p></li><li><p><b>Attribute promotion with <span><strong class="command">ndb_restore</strong></span>. </b>
              It is possible using <span><strong class="command">ndb_restore</strong></span> to
              restore data reliably from a column of a given type to a
              column that uses a “<span class="quote">larger</span>” type. This is
              sometimes referred to as <em class="firstterm">attribute
              promotion</em>. For example, MySQL Cluster backup
              data that originated in a <code class="literal">SMALLINT</code>
              column can be restored to a <code class="literal">MEDIUMINT</code>,
              <code class="literal">INT</code>, or <code class="literal">BIGINT</code>
              column. See <a href="mysql-cluster.html#mysql-cluster-restore" title="20.9.3. ndb_restore — Restore a Cluster Backup">Section 20.9.3, “<span><strong class="command">ndb_restore</strong></span> — Restore a Cluster Backup”</a>, for
              more information.
            </p></li><li><p><b>Parallel data node recovery. </b>
              Recovery of multiple data nodes can now be done in
              parallel, rather than sequentially. In other words,
              several data nodes can be restored concurrently, which can
              often result in much faster recovery times than when they
              are restored one at a time.
            </p></li><li><p><b>Increased local checkpoint efficiency. </b>
              Only 2 local checkpoints are stored, rather than 3,
              lowering disk space requirements and the size and number
              of redo log files.
            </p></li><li><p><b><code class="literal">NDBCLUSTER</code> table persistence control. </b>
              Persistence of <code class="literal">NDB</code> tables can be
              controlled using the session variables
              <code class="literal">ndb_table_temporary</code> and
              <code class="literal">ndb_table_no_logging</code>.
              <code class="literal">ndb_table_no_logging</code> causes
              <code class="literal">NDB</code> tables not to be checkpointed to
              disk; <code class="literal">ndb_table_temporary</code> does the
              same, and in addition, no schema files are created. See
              <a href="mysql-cluster.html#mysql-cluster-option-tables" title="20.4.1. MySQL Cluster Server Option and Variable Reference">Section 20.4.1, “MySQL Cluster Server Option and Variable Reference”</a>.
            </p></li><li><p><b>Epoll support (<span class="emphasis"><em>Linux only</em></span>). </b>
              <em class="firstterm">Epoll</em> is an improved method for
              handling file descriptors, which is more efficient than
              scanning to determine whether a file descriptor has data
              to be read. (The term <em class="firstterm">epoll</em> is
              specific to Linux and equivalent functionality is known by
              other names on other platforms such as Solaris and
              FreeBSD.) Currently, MySQL Cluster supports this
              functionality on Linux only.
            </p></li><li><p><b>Distribution awareness (SQL nodes). </b>
              In MySQL Cluster NDB 6.3, SQL nodes can take advantage of
              <a href="mysql-cluster.html#mysql-cluster-changes-5-1-distribution-awareness">distribution
              awareness</a>. Here we provide a brief example showing
              how to design a table to make a given class of queries
              distrubtion-aware. Suppose an
              <code class="literal">NDBCLUSTER</code> table <code class="literal">t1</code>
              has the following schema:

</p><pre class="programlisting">CREATE TABLE t1 (
    userid INT NOT NULL,
    serviceid INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    data VARCHAR(255)
)   ENGINE=NDBCLUSTER;
</pre><p>

              Suppose further that most of the queries to be used in our
              application test values of the <code class="literal">userid</code>
              column of this table. The form of such a query looks
              something like this:

</p><pre class="programlisting">SELECT <em class="replaceable"><code>columns</code></em> FROM t1 
    WHERE userid <em class="replaceable"><code>relation</code></em> <em class="replaceable"><code>value</code></em>;  
</pre><p>

              In this query, <em class="replaceable"><code>relation</code></em>
              represents some relational operator, such as
              <code class="literal">=</code>, <code class="literal">&lt;</code>,
              <code class="literal">&gt;</code>, and so on. Queries using
              <code class="literal">IN</code> and a list of values can also be
              used:

</p><pre class="programlisting">SELECT <em class="replaceable"><code>columns</code></em> FROM t1 
    WHERE userid IN <em class="replaceable"><code>value_list</code></em>;  
</pre><p>

              In order to make use of distribution awareness, we need to
              make the <code class="literal">userid</code> column part of the
              table's primary key, then explicitly partition the
              table with this column being used as the partitioning key.
              (Recall that for a partitioned table having one or more
              unique keys, all columns of the table's partitioning
              key must also be part of all of the unique keys —
              for more information and examples, see
              <a href="partitioning.html#partitioning-limitations-partitioning-keys-unique-keys" title="21.5.1. Partitioning Keys, Primary Keys, and Unique Keys">Section 21.5.1, “Partitioning Keys, Primary Keys, and Unique Keys”</a>.)
              In other words, the table schema should be equivalent to
              the following <code class="literal">CREATE TABLE</code> statement:

</p><pre class="programlisting">CREATE TABLE t1 (
    userid INT NOT NULL,
    serviceid INT NOT NULL AUTO_INCREMENT,
    data VARCHAR(255),
    PRIMARY KEY p (userid,serviceid)
)   ENGINE=NDBCLUSTER
    PARTITION BY KEY(userid);
</pre><p>

              When the table is partitioned in this way, all rows having
              the same <code class="literal">userid</code> value are found on the
              same node group, and the MySQL Server can immediately
              select the optimal node to use as the transaction
              coordinator.
            </p></li><li><p><b>Realtime extensions for multiple CPUs. </b>
              When running MySQL Cluster data nodes on hosts with
              multiple processors, the realtime extensions make it
              possible to give priority to the data node process and
              control on which CPU cores it should operate. This can be
              done using the data node configuration parameters
              <code class="literal">RealtimeScheduler</code>,
              <code class="literal">SchedulerExecutionTimer</code> and
              <code class="literal">SchedulerSpinTimer</code>. Doing so properly
              can significantly lower response times and make them much
              more predictable response. For more information about
              using these parameters, see
              <a href="mysql-cluster.html#mysql-cluster-realtime-performance-parameters">Defining
              Data Nodes: Realtime Performance Parameters</a>
            </p></li></ul></div><p>
    </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-glossary"></a>20.16. MySQL Cluster Glossary</h2></div></div></div><a class="indexterm" name="id2386319"></a><a class="indexterm" name="id2386331"></a><p>
    The following terms are useful to an understanding of MySQL Cluster
    or have specialized meanings when used in relation to it.
  </p><div class="itemizedlist"><ul type="disc"><li><p><b>Cluster. </b>
          In its generic sense, a cluster is a set of computers
          functioning as a unit and working together to accomplish a
          single task.
        </p><p><b><code class="literal">NDBCLUSTER</code>. </b>
          This is the storage engine used in MySQL to implement data
          storage, retrieval, and management distributed among several
          computers.
        </p><p><b>MySQL Cluster. </b>
          This refers to a group of computers working together using the
          <code class="literal">NDB</code> storage engine to support a distributed
          MySQL database in a <span class="emphasis"><em>shared-nothing
          architecture</em></span> using <span class="emphasis"><em>in-memory
          storage</em></span>.
        </p></li><li><p><b>Configuration files. </b>
          Text files containing directives and information regarding the
          cluster, its hosts, and its nodes. These are read by the
          cluster's management nodes when the cluster is started. See
          <a href="mysql-cluster.html#mysql-cluster-config-file" title="20.3.4. Configuration File">Section 20.3.4, “Configuration File”</a>, for details.
        </p></li><li><p><b>Backup. </b>
          A complete copy of all cluster data, transactions and logs,
          saved to disk or other long-term storage.
        </p></li><li><p><b>Restore. </b>
          Returning the cluster to a previous state, as stored in a
          backup.
        </p></li><li><p><b>Checkpoint. </b>
          Generally speaking, when data is saved to disk, it is said
          that a checkpoint has been reached. More specific to Cluster,
          it is a point in time where all committed transactions are
          stored on disk. With regard to the <code class="literal">NDB</code>
          storage engine, there are two types of checkpoints which work
          together to ensure that a consistent view of the cluster's
          data is maintained:
        </p><div class="itemizedlist"><ul type="circle"><li><p><b>Local Checkpoint (LCP). </b>
              This is a checkpoint that is specific to a single node;
              however, LCP's take place for all nodes in the cluster
              more or less concurrently. An LCP involves saving all of a
              node's data to disk, and so usually occurs every few
              minutes. The precise interval varies, and depends upon the
              amount of data stored by the node, the level of cluster
              activity, and other factors.
            </p></li><li><p><b>Global Checkpoint (GCP). </b>
              A GCP occurs every few seconds, when transactions for all
              nodes are synchronized and the redo-log is flushed to
              disk.
            </p></li></ul></div></li><li><p><b>Cluster host. </b>
          A computer making up part of a MySQL Cluster. A cluster has
          both a <span class="emphasis"><em>physical</em></span> structure and a
          <span class="emphasis"><em>logical</em></span> structure. Physically, the
          cluster consists of a number of computers, known as
          <em class="firstterm">cluster hosts</em> (or more simply as
          <em class="firstterm">hosts</em>. See also
          <span class="bold"><strong>Node</strong></span> and
          <span class="bold"><strong>Node group</strong></span> below.
        </p></li><li><p><b>Node. </b>
          This refers to a logical or functional unit of MySQL Cluster,
          and is sometimes also referred to as a <em class="firstterm">cluster
          node</em>. In the context of MySQL Cluster, we use the
          term “<span class="quote">node</span>” to indicate a
          <span class="emphasis"><em>process</em></span> rather than a physical component
          of the cluster. There are three node types required to
          implement a working MySQL Cluster:
        </p><div class="itemizedlist"><ul type="circle"><li><p><b>Management nodes. </b>
              Manages the other nodes within the MySQL Cluster. It
              provides configuration data to the other nodes; starts and
              stops nodes; handles network partitioning; creates backups
              and restores from them, and so forth.
            </p></li><li><p><b>SQL nodes. </b>
              Instances of MySQL Server which serve as front ends to
              data kept in the cluster's <span class="bold"><strong>data
              nodes</strong></span>. Clients desiring to store, retrieve, or
              update data can access an SQL node just as they would any
              other MySQL Server, employing the usual MySQL
              authentication methods and APIs; the underlying
              distribution of data between node groups is transparent to
              users and applications. SQL nodes access the cluster's
              databases as a whole without regard to the data's
              distribution across different data nodes or cluster hosts.
            </p></li><li><p><b>Data nodes. </b>
              These nodes store the actual data. Table data fragments
              are stored in a set of node groups; each node group stores
              a different subset of the table data. Each of the nodes
              making up a node group stores a replica of the fragment
              for which that node group is responsible. Currently, a
              single cluster can support up to 48 data nodes total.
            </p></li></ul></div><p>
        It is possible for more than one node to co-exist on a single
        machine. (In fact, it is even possible to set up a complete
        cluster on one machine, although one would almost certainly
        <span class="emphasis"><em>not</em></span> want to do this in a production
        environment.) It may be helpful to remember that, when working
        with MySQL Cluster, the term <span class="emphasis"><em>host</em></span> refers to
        a physical component of the cluster whereas a
        <span class="emphasis"><em>node</em></span> is a logical or functional component
        (that is, a process).
      </p><p><b>Note Regarding Terms. </b>
          In older versions of the MySQL Cluster documentation, data
          nodes were sometimes referred to as “<span class="quote">database
          nodes</span>”. The term “<span class="quote">storage nodes</span>” has also
          been used. In addition, SQL nodes were sometimes known as
          “<span class="quote">client nodes</span>”. This older terminology has been
          deprecated to minimize confusion, and for this reason should
          be avoided. They are also often referred to as “<span class="quote">API
          nodes</span>” — an SQL node is actually an API node that
          provides an SQL interface to the cluster.
        </p></li><li><p><b>Node group. </b>
          A set of data nodes. All data nodes in a node group contain
          the same data (fragments), and all nodes in a single group
          should reside on different hosts. It is possible to control
          which nodes belong to which node groups.
        </p><p>
        For more information, see
        <a href="mysql-cluster.html#mysql-cluster-nodes-groups" title="20.1.2. MySQL Cluster Nodes, Node Groups, Replicas, and Partitions">Section 20.1.2, “MySQL Cluster Nodes, Node Groups, Replicas, and Partitions”</a>.
      </p></li><li><p><b>Node failure. </b>
          MySQL Cluster is not solely dependent upon the functioning of
          any single node making up the cluster; the cluster can
          continue to run if one or more nodes fail. The precise number
          of node failures that a given cluster can tolerate depends
          upon the number of nodes and the cluster's configuration.
        </p></li><li><p><b>Node restart. </b>
          The process of restarting a failed cluster node.
        </p></li><li><p><b>Initial node restart. </b>
          The process of starting a cluster node with its filesystem
          removed. This is sometimes used in the course of software
          upgrades and in other special circumstances.
        </p></li><li><p><b>System crash (or system failure). </b>
          This can occur when so many cluster nodes have failed that the
          cluster's state can no longer be guaranteed.
        </p></li><li><p><b>System restart. </b>
          The process of restarting the cluster and reinitializing its
          state from disk logs and checkpoints. This is required after
          either a planned or an unplanned shutdown of the cluster.
        </p></li><li><p><b>Fragment. </b>
          A portion of a database table; in the <code class="literal">NDB</code>
          storage engine, a table is broken up into and stored as a
          number of fragments. A fragment is sometimes also called a
          “<span class="quote">partition</span>”; however, “<span class="quote">fragment</span>” is
          the preferred term. Tables are fragmented in MySQL Cluster in
          order to facilitate load balancing between machines and nodes.
        </p></li><li><p><b>Replica. </b>
          Under the <code class="literal">NDB</code> storage engine, each table
          fragment has number of replicas stored on other data nodes in
          order to provide redundancy. Currently, there may be up four
          replicas per fragment.
        </p></li><li><p><b>Transporter. </b>
          A protocol providing data transfer between nodes. MySQL
          Cluster currently supports four different types of transporter
          connections:
        </p><div class="itemizedlist"><ul type="circle"><li><p><b>TCP/IP. </b>
              This is, of course, the familiar network protocol that
              underlies HTTP, FTP (and so on) on the Internet. TCP/IP
              can be used for both local and remote connections.
            </p></li><li><p><b>SCI. </b>
              <span class="bold"><strong>S</strong></span>calable
              <span class="bold"><strong>C</strong></span>oherent
              <span class="bold"><strong>I</strong></span>nterface is a high-speed
              protocol used in building multiprocessor systems and
              parallel-processing applications. Use of SCI with MySQL
              Cluster requires specialized hardware, as discussed in
              <a href="mysql-cluster.html#mysql-cluster-sci-sockets" title="20.13.1. Configuring MySQL Cluster to use SCI Sockets">Section 20.13.1, “Configuring MySQL Cluster to use SCI Sockets”</a>. For a basic
              introduction to SCI, see
              <a href="http://www.dolphinics.com/corporate/scitech.html" target="_top">this
              essay at dolphinics.com</a>.
            </p></li><li><p><b>SHM. </b>
              Unix-style <span class="bold"><strong>sh</strong></span>ared
              <span class="bold"><strong>m</strong></span>emory segments. Where
              supported, SHM is used automatically to connect nodes
              running on the same host. The
              <a href="http://www.scit.wlv.ac.uk/cgi-bin/mansec?2+shmop" target="_top">Unix
              man page for <code class="literal">shmop(2)</code></a> is a good
              place to begin obtaining additional information about this
              topic.
            </p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          The cluster transporter is internal to the cluster.
          Applications using MySQL Cluster communicate with SQL nodes
          just as they do with any other version of MySQL Server (via
          TCP/IP, or through the use of Unix socket files or Windows
          named pipes). Queries can be sent and results retrieved using
          the standard MySQL client APIs.
        </p></div></li><li><p><b><code class="literal">NDB</code>. </b>
          This stands for <span class="bold"><strong>N</strong></span>etwork
          <span class="bold"><strong>D</strong></span>ata<span class="bold"><strong>b</strong></span>ase,
          and refers to the storage engine used to enable MySQL Cluster.
          The <code class="literal">NDB</code> storage engine supports all the
          usual MySQL data types and SQL statements, and is
          ACID-compliant. This engine also provides full support for
          transactions (commits and rollbacks).
        </p></li><li><p><b>Shared-nothing architecture. </b>
          The ideal architecture for a MySQL Cluster. In a true
          shared-nothing setup, each node runs on a separate host. The
          advantage such an arrangement is that there no single host or
          node can act as single point of failure or as a performance
          bottle neck for the system as a whole.
        </p></li><li><p><b>In-memory storage. </b>
          All data stored in each data node is kept in memory on the
          node's host computer. For each data node in the cluster, you
          must have available an amount of RAM equal to the size of the
          database times the number of replicas, divided by the number
          of data nodes. Thus, if the database takes up 1GB of memory,
          and you want to set up the cluster with four replicas and
          eight data nodes, a minimum of 500MB memory will be required
          per node. Note that this is in addition to any requirements
          for the operating system and any other applications that might
          be running on the host.
        </p><p>
        In MySQL 5.1, it is also possible to create <em class="firstterm">Disk
        Data</em> tables where non-indexed columns are stored on
        disk, thus reducing the memory footprint required by the
        cluster. Note that indexes and indexed column data are still
        stored in RAM. See <a href="mysql-cluster.html#mysql-cluster-disk-data" title="20.12. MySQL Cluster Disk Data Tables">Section 20.12, “MySQL Cluster Disk Data Tables”</a>.
      </p></li><li><p><b>Table. </b>
          As is usual in the context of a relational database, the term
          “<span class="quote">table</span>” denotes a set of identically structured
          records. In MySQL Cluster, a database table is stored in a
          data node as a set of fragments, each of which is replicated
          on additional data nodes. The set of data nodes replicating
          the same fragment or set of fragments is referred to as a
          <span class="emphasis"><em>node group</em></span>.
        </p></li><li><p><b>Cluster programs. </b>
          These are command-line programs used in running, configuring,
          and administering MySQL Cluster. They include both server
          daemons:
        </p><div class="itemizedlist"><ul type="circle"><li><p>
            <span><strong class="command">ndbd</strong></span>:
          </p><p>
            The data node daemon (runs a data node process)
          </p></li><li><p>
            <span><strong class="command">ndb_mgmd</strong></span>:
          </p><p>
            The management server daemon (runs a management server
            process)
          </p></li></ul></div><p>
        and client programs:
      </p><div class="itemizedlist"><ul type="circle"><li><p>
            <span><strong class="command">ndb_mgm</strong></span>:
          </p><p>
            The management client (provides an interface for executing
            management commands)
          </p></li><li><p>
            <span><strong class="command">ndb_waiter</strong></span>:
          </p><p>
            Used to verify status of all nodes in a cluster
          </p></li><li><p>
            <span><strong class="command">ndb_restore</strong></span>:
          </p><p>
            Restores cluster data from backup
          </p></li></ul></div><p>
        For more about these programs and their uses, see
        <a href="mysql-cluster.html#mysql-cluster-process-management" title="20.6. Process Management in MySQL Cluster">Section 20.6, “Process Management in MySQL Cluster”</a>.
      </p></li><li><p><b>Event log. </b>
          MySQL Cluster logs events by category (startup, shutdown,
          errors, checkpoints, and so on), priority, and severity. A
          complete listing of all reportable events may be found in
          <a href="mysql-cluster.html#mysql-cluster-event-reports" title="20.7.3. Event Reports Generated in MySQL Cluster">Section 20.7.3, “Event Reports Generated in MySQL Cluster”</a>. Event logs are
          of two types:
        </p><div class="itemizedlist"><ul type="circle"><li><p><b>Cluster log. </b>
              Keeps a record of all desired reportable events for the
              cluster as a whole.
            </p></li><li><p><b>Node log. </b>
              A separate log which is also kept for each individual
              node.
            </p></li></ul></div><p>
        Under normal circumstances, it is necessary and sufficient to
        keep and examine only the cluster log. The node logs need be
        consulted only for application development and debugging
        purposes.
      </p></li><li><p><b>Angel process. </b>
          When a data node is started, <span><strong class="command">ndbd</strong></span> actually
          starts two processes. One of these is known as the
          “<span class="quote">angel</span>” process; its purpose is to check to make
          sure that the main <span><strong class="command">ndbd</strong></span> process continues
          to run, and to restart the main process if it should stop for
          any reason.
        </p></li><li><p><b>Watchdog thread. </b>
          Each <span><strong class="command">ndbd</strong></span> process has an internal
          <em class="firstterm">watchdog thread</em> which monitors the main
          worker thread, ensuring forward progress and a timely response
          to cluster protocols such as the cluster heartbeat. If the
          <span><strong class="command">ndbd</strong></span> process is not being woken up promptly
          by the operating system when its sleep time expires,
          <code class="literal">INFO</code> and <code class="literal">WARNING</code> events,
          which are identifiable because they contain
          “<span class="quote">Watchdog:...</span>”, are written to the cluster log.
          Such messages are usually a symptom of an overloaded system;
          you should see what else is running on the system, and whether
          the ndbd <span><strong class="command">process</strong></span> is being swapped out to
          disk. If <span><strong class="command">ndbd</strong></span> cannot wake up regularly then
          it cannot respond to heartbeat messages on time, and other
          nodes eventually consider it “<span class="quote">dead</span>” due to the
          missed heartbeats, causing it to be excluded from the cluster.
        </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="mysql-cluster-news"></a>20.17. Changes in MySQL Cluster 6.x</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-6-3">20.17.1. Changes in MySQL Cluster NDB 6.3</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-6-2">20.17.2. Changes in MySQL Cluster NDB 6.2</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-6-1">20.17.3. Changes in MySQL Cluster NDB 6.1</a></span></dt></dl></div><a class="indexterm" name="id2387386"></a><p>
    This section contains changelog information for MySQL Cluster that
    use version 6.1, 6.2, and 6.3 of the <code class="literal">NDBCLUSTER</code>
    storage engine.
  </p><p>
    Each MySQL Cluster release is based on a mainline MySQL 5.1 release
    and a particular version of the <code class="literal">NDBCLUSTER</code>
    storage engine, as shown in the version string returned by executing
    <code class="literal">SELECT VERSION()</code> in the <span><strong class="command">mysql</strong></span>
    client, or by executing the <span><strong class="command">ndb_mgm</strong></span> client
    <code class="literal">SHOW</code> or <code class="literal">STATUS</code> command; for
    more information, see <a href="mysql-cluster.html" title="Chapter 20. MySQL Cluster">Chapter 20, <i>MySQL Cluster</i></a>.
  </p><p>
    For general information about features added in MySQL Cluster, see
    <a href="mysql-cluster.html#mysql-cluster-roadmap" title="20.15. MySQL Cluster Development Roadmap">Section 20.15, “MySQL Cluster Development Roadmap”</a>. For a complete list of all
    bugfixes and feature changes in MySQL Cluster, please refer to the
    changelog section for each individual MySQL Cluster release.
  </p><p>
    An overview of features added in MySQL 5.1 not specific to MySQL
    Cluster can be found here: <a href="introduction.html#mysql-nutshell" title="1.5.1. What's New in MySQL 5.1">Section 1.5.1, “What's New in MySQL 5.1”</a>. For a
    complete list of all bugfixes and features changes made in MySQL 5.1
    that are not specific to MySQL Cluster, see
    <a href="news.html#news-5-1-x" title="C.1. Changes in release 5.1.x (Development)">Section C.1, “Changes in release 5.1.x (Development)”</a>.
  </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-news-6-3"></a>20.17.1. Changes in MySQL Cluster NDB 6.3</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-24-ndb-6-3-16">20.17.1.1. Changes in  MySQL Cluster NDB 6.3.16 (5.1.24-ndb-6.3.16) (27 June 2008)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-24-ndb-6-3-15">20.17.1.2. Changes in  MySQL Cluster NDB 6.3.15 (5.1.24-ndb-6.3.15) (30 May 2008)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-24-ndb-6-3-14">20.17.1.3. Changes in  MySQL Cluster NDB 6.3.14 (5.1.24-ndb-6.3.14) (11 May 2008)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-24-ndb-6-3-13">20.17.1.4. Changes in  MySQL Cluster NDB 6.3.13 (5.1.24-ndb-6.3.13) (10 April 2008)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-23-ndb-6-3-12">20.17.1.5. Changes in  MySQL Cluster NDB 6.3.12 (5.1.23-ndb-6.3.12) (05 April 2008)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-23-ndb-6-3-11">20.17.1.6. Changes in  MySQL Cluster NDB 6.3.11 (5.1.23-ndb-6.3.11) (28 March 2008)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-23-ndb-6-3-10">20.17.1.7. Changes in  MySQL Cluster NDB 6.3.10 (5.1.23-ndb-6.3.10) (17 February 2008)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-23-ndb-6-3-9">20.17.1.8. Changes in  MySQL Cluster NDB 6.3.9 (5.1.23-ndb-6.3.9) (12 February 2008)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-23-ndb-6-3-8">20.17.1.9. Changes in  MySQL Cluster NDB 6.3.8 (5.1.23-ndb-6.3.8) (29 January 2008)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-23-ndb-6-3-7">20.17.1.10. Changes in  MySQL Cluster NDB 6.3.7 (5.1.23-ndb-6.3.7) (19 December 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-22-ndb-6-3-6">20.17.1.11. Changes in  MySQL Cluster NDB 6.3.6 (5.1.22-ndb-6.3.6) (08 November 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-22-ndb-6-3-5">20.17.1.12. Changes in  MySQL Cluster NDB 6.3.5 (5.1.22-ndb-6.3.5) (17 October 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-22-ndb-6-3-4">20.17.1.13. Changes in  MySQL Cluster NDB 6.3.4 (5.1.22-ndb-6.3.4) (15 October 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-22-ndb-6-3-3">20.17.1.14. Changes in  MySQL Cluster NDB 6.3.3 (5.1.22-ndb-6.3.3) (20 September 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-22-ndb-6-3-2">20.17.1.15. Changes in  MySQL Cluster NDB 6.3.2 (5.1.22-ndb-6.3.2) (07 September 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-19-ndb-6-3-1">20.17.1.16. Changes in  MySQL Cluster NDB 6.3.1 (5.1.19-ndb-6.3.1) (04 July 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-19-ndb-6-3-0">20.17.1.17. Changes in  MySQL Cluster NDB 6.3.0 (5.1.19-ndb-6.3.0) (02 July 2007)</a></span></dt></dl></div><p>
      This section contains change history information for MySQL Cluster
      releases based on version 6.3 of the <code class="literal">NDBCLUSTER</code>
      storage engine.
    </p><p>
      For an overview of new features added in MySQL Cluster NDB 6.3,
      see <a href="mysql-cluster.html#mysql-cluster-changes-5-1-ndb-6-3" title="20.15.4. Features Added in MySQL Cluster NDB 6.3">Section 20.15.4, “Features Added in MySQL Cluster NDB 6.3”</a>.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-24-ndb-6-3-16"></a>20.17.1.1. Changes in  MySQL Cluster NDB 6.3.16 (5.1.24-ndb-6.3.16) (27 June 2008)</h4></div></div></div><p class="release-level">
        This is a new source release, fixing recently discovered bugs in
        previous MySQL Cluster NDB 6.3 releases.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.3. </b>
          MySQL Cluster NDB 6.3 releases are source-only releases which
          you must compile and install using the instructions found in
          <a href="installing.html#installing-source" title="2.9. MySQL Installation Using a Source Distribution">Section 2.9, “MySQL Installation Using a Source Distribution”</a>, and in
          <a href="mysql-cluster.html#mysql-cluster-building" title="20.3.1. Building MySQL Cluster from Source Code">Section 20.3.1, “Building MySQL Cluster from Source Code”</a>. You can download the
          GPL source tarball from the MySQL FTP site at
          <a href="ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/" target="_top">ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/</a>.
        </p><p>
        This release incorporates all bugfixes and changes made in the
        previous MySQL Cluster NDB 6.3 release, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.24 (see <a href="news.html#news-5-1-24" title="C.1.6. Changes in  MySQL 5.1.24 (08 April 2008)">Section C.1.6, “Changes in  MySQL 5.1.24 (08 April 2008)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Event buffer lag reports are now written to the cluster log.
       (<a href="http://bugs.mysql.com/37427" target="_top">Bug#37427</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Added the <code class="option">--no-binlog</code> option for
        <span><strong class="command">ndb_restore</strong></span>. When used, this option prevents
        information being written to SQL node binary logs from the
        restoration of a cluster backup.
       (<a href="http://bugs.mysql.com/30452" target="_top">Bug#30452</a>)</p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Cluster API</strong></span>: <span class="bold"><strong>MySQL Cluster</strong></span>: 
        Changing the system time on data nodes could cause MGM API
        applications to hang and the data nodes to crash.
       (<a href="http://bugs.mysql.com/35607" target="_top">Bug#35607</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Failure of a data node could sometimes cause mysqld to crash.
       (<a href="http://bugs.mysql.com/37628" target="_top">Bug#37628</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">DELETE ... WHERE
        <em class="replaceable"><code>unique_index_column</code></em>=<em class="replaceable"><code>value</code></em></code>
        deleted the wrong row from the table.
       (<a href="http://bugs.mysql.com/37516" target="_top">Bug#37516</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        If subscription was terminated while a node was down, the epoch
        was not properly acknowledged by that node.
       (<a href="http://bugs.mysql.com/37442" target="_top">Bug#37442</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">libmysqld</code> failed to wait for the cluster
        binlog thread to terminate before exiting.
       (<a href="http://bugs.mysql.com/37429" target="_top">Bug#37429</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        In rare circumstances, a connection followed by a disconnection
        could give rise to a “<span class="quote">stale</span>” connection where the
        connection still existed but was not seen by the transporter.
       (<a href="http://bugs.mysql.com/37338" target="_top">Bug#37338</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Queries against <code class="literal">NDBCLUSTER</code> tables were cached
        only if <code class="literal">AUTOCOMMIT</code> was in use.
       (<a href="http://bugs.mysql.com/36692" target="_top">Bug#36692</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Data was written to the binlog with
        <code class="option">--log-slave-updates</code> disabled.
       (<a href="http://bugs.mysql.com/37472" target="_top">Bug#37472</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Creating a table on an SQL node, then starting an NDB API
        application that listened for events from this table, then
        dropping the table from an SQL node, prevented data node
        restarts.
       (<a href="http://bugs.mysql.com/37279" target="_top">Bug#37279</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        When some operations succeeded and some failed following a call
        to <code class="literal">NdbTransaction::execute(Commit,
        AO_IgnoreOnError)</code>, a race condition could cause
        spurious occurrences of NDB API Error 4011 (<span class="errortext">Internal
        error</span>).
       (<a href="http://bugs.mysql.com/37158" target="_top">Bug#37158</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        A buffer overrun in <code class="literal">NdbBlob::setValue()</code>
        caused erroneous results on Mac OS X.
       (<a href="http://bugs.mysql.com/31284" target="_top">Bug#31284</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-24-ndb-6-3-15"></a>20.17.1.2. Changes in  MySQL Cluster NDB 6.3.15 (5.1.24-ndb-6.3.15) (30 May 2008)</h4></div></div></div><p class="release-level">
        This is a new source release, fixing recently discovered bugs in
        previous MySQL Cluster NDB 6.3 releases.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.3. </b>
          MySQL Cluster NDB 6.3 releases are source-only releases which
          you must compile and install using the instructions found in
          <a href="installing.html#installing-source" title="2.9. MySQL Installation Using a Source Distribution">Section 2.9, “MySQL Installation Using a Source Distribution”</a>, and in
          <a href="mysql-cluster.html#mysql-cluster-building" title="20.3.1. Building MySQL Cluster from Source Code">Section 20.3.1, “Building MySQL Cluster from Source Code”</a>. You can download the
          GPL source tarball from the MySQL FTP site at
          <a href="ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/" target="_top">ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/</a>.
        </p><p>
        This release incorporates all bugfixes and changes made in the
        previous MySQL Cluster NDB 6.3 release, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.24 (see <a href="news.html#news-5-1-24" title="C.1.6. Changes in  MySQL 5.1.24 (08 April 2008)">Section C.1.6, “Changes in  MySQL 5.1.24 (08 April 2008)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        In certain rare situations, <code class="filename">ndb_size.pl</code>
        could fail with the error <span class="errortext">Can't use string
        ("<em class="replaceable"><code>value</code></em>") as a HASH ref while "strict
        refs" in use</span>.
       (<a href="http://bugs.mysql.com/43022" target="_top">Bug#43022</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Under some circumstances, a failed <code class="literal">CREATE
        TABLE</code> could mean that subsequent <code class="literal">CREATE
        TABLE</code> statements caused node failures.
       (<a href="http://bugs.mysql.com/37092" target="_top">Bug#37092</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A fail attempt to create an <code class="literal">NDB</code> table could
        in some cases lead to resource leaks or cluster failures.
       (<a href="http://bugs.mysql.com/37072" target="_top">Bug#37072</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Attempting to create a native backup of <code class="literal">NDB</code>
        tables having a large number of <code class="literal">NULL</code> columns
        and data could lead to node failures.
       (<a href="http://bugs.mysql.com/37039" target="_top">Bug#37039</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Checking of API node connections was not efficiently handled.
       (<a href="http://bugs.mysql.com/36843" target="_top">Bug#36843</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Attempting to delete a non-existent row from a table containing
        a <code class="literal">TEXT</code> or <code class="literal">BLOB</code> column
        within a transaction caused the transaction to fail.
       (<a href="http://bugs.mysql.com/36756" target="_top">Bug#36756</a>)</p><p>See also <a href="http://bugs.mysql.com/36851" target="_top">Bug#36851</a></p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        If the combined total of tables and indexes in the cluster was
        greater than 4096, issuing <code class="literal">START BACKUP</code>
        caused data nodes to fail.
       (<a href="http://bugs.mysql.com/36044" target="_top">Bug#36044</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Where column values to be compared in a query were of the
        <code class="literal">VARCHAR</code> or <code class="literal">VARBINARY</code>
        types, <code class="literal">NDBCLUSTER</code> passed a value padded to
        the full size of the column, which caused unnecessary data to be
        sent to the data nodes. This also had the effect of wasting CPU
        and network bandwidth, and causing condition pushdown to be
        disabled where it could (and should) otherwise have been
        applied.
       (<a href="http://bugs.mysql.com/35393" target="_top">Bug#35393</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When dropping a table failed for any reason (such as when in
        single user mode) then the corresponding
        <code class="filename">.ndb</code> file was still removed.
      </p></li><li><p><span class="bold"><strong>Replication</strong></span>: 
        When flushing tables, there was a slight chance that the flush
        occurred between the processing of one table map event and the
        next. Since the tables were opened one by one, subsequent
        locking of tables would cause the slave to crash. This problem
        was observed when replicating <code class="literal">NDBCLUSTER</code> or
        <code class="literal">InnoDB</code> tables, when executing multi-table
        updates, and when a trigger or a stored routine performed an
        (additional) insert on a table so that two tables were
        effectively being inserted into in the same statement.
       (<a href="http://bugs.mysql.com/36197" target="_top">Bug#36197</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Ordered index scans were not pruned correctly where a
        partitioning key was specified with an EQ-bound.
       (<a href="http://bugs.mysql.com/36950" target="_top">Bug#36950</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        When an insert operation involving <code class="literal">BLOB</code> data
        was attempted on a row which already existed, no duplicate key
        error was correctly reported and the transaction is incorrectly
        aborted. In some cases, the existing row could also become
        corrupted.
       (<a href="http://bugs.mysql.com/36851" target="_top">Bug#36851</a>)</p><p>See also <a href="http://bugs.mysql.com/26756" target="_top">Bug#26756</a></p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        <code class="filename">NdbApi.hpp</code> depended on
        <code class="filename">ndb_global.h</code>, which was not actually
        installed, causing the compilation of programs that used
        <code class="filename">NdbApi.hpp</code> to fail.
       (<a href="http://bugs.mysql.com/35853" target="_top">Bug#35853</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-24-ndb-6-3-14"></a>20.17.1.3. Changes in  MySQL Cluster NDB 6.3.14 (5.1.24-ndb-6.3.14) (11 May 2008)</h4></div></div></div><p class="release-level">
        This is a new source release, fixing recently discovered bugs in
        previous MySQL Cluster NDB 6.3 releases.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.3. </b>
          MySQL Cluster NDB 6.3 releases are source-only releases which
          you must compile and install using the instructions found in
          <a href="installing.html#installing-source" title="2.9. MySQL Installation Using a Source Distribution">Section 2.9, “MySQL Installation Using a Source Distribution”</a>, and in
          <a href="mysql-cluster.html#mysql-cluster-building" title="20.3.1. Building MySQL Cluster from Source Code">Section 20.3.1, “Building MySQL Cluster from Source Code”</a>. You can download the
          GPL source tarball from the MySQL FTP site at
          <a href="ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/" target="_top">ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/</a>.
        </p><p>
        This release incorporates all bugfixes and changes made in the
        previous MySQL Cluster NDB 6.3 release, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.24 (see <a href="news.html#news-5-1-24" title="C.1.6. Changes in  MySQL 5.1.24 (08 April 2008)">Section C.1.6, “Changes in  MySQL 5.1.24 (08 April 2008)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">SET GLOBAL ndb_extra_logging</code> caused
        <span><strong class="command">mysqld</strong></span> to crash.
       (<a href="http://bugs.mysql.com/36547" target="_top">Bug#36547</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A race condition caused by a failure in epoll handling could
        cause data nodes to fail.
       (<a href="http://bugs.mysql.com/36537" target="_top">Bug#36537</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Under certain rare circumstances, the failure of the new master
        node while attempting a node takeover would cause takeover
        errors to repeat without being resolved.
       (<a href="http://bugs.mysql.com/36199" target="_top">Bug#36199</a>, <a href="http://bugs.mysql.com/36246" target="_top">Bug#36246</a>, <a href="http://bugs.mysql.com/36247" target="_top">Bug#36247</a>, <a href="http://bugs.mysql.com/36276" target="_top">Bug#36276</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When more than one SQL node connected to the cluster at the same
        time, creation of the <code class="literal">mysql.ndb_schema</code> table
        failed on one of them with an explicit <span class="errortext">Table
        exists</span> error, which was not necessary.
       (<a href="http://bugs.mysql.com/35943" target="_top">Bug#35943</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <span><strong class="command">mysqld</strong></span> failed to start after running
        <span><strong class="command">mysql_upgrade</strong></span>.
       (<a href="http://bugs.mysql.com/35708" target="_top">Bug#35708</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Notification of a cascading master node failures could sometimes
        not be transmitted correctly (that is, transmission of the
        <code class="literal">NF_COMPLETEREP</code> signal could fail), leading to
        transactions hanging and timing out (<code class="literal">NDB</code>
        error 4012), scans hanging, and failure of the management server
        process.
       (<a href="http://bugs.mysql.com/32645" target="_top">Bug#32645</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        If an API node disconnected and then reconnected during Start
        Phase 8, then the connection could be “<span class="quote">blocked</span>”
        — that is, the <code class="literal">QMGR</code> kernel block failed
        to detect that the API node was in fact connected to the
        cluster, causing issues with the <code class="literal">NDB</code>
        Subscription Manager (<code class="literal">SUMA</code>).
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">NDB</code> error 1427 (<span class="errortext">Api node died,
        when SUB_START_REQ reached node</span>) was incorrectly
        classified as a schema error rather than a temporary error.
      </p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Performing <code class="literal">SELECT ... FROM
        mysql.ndb_apply_status</code> before the
        <span><strong class="command">mysqld</strong></span> process had connected to the cluster
        failed, and caused this table never to be created.
       (<a href="http://bugs.mysql.com/36123" target="_top">Bug#36123</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Accesing the debug version of <code class="literal">libndbclient</code>
        via <code class="literal">dlopen()</code> resulted in a segmentation
        fault.
       (<a href="http://bugs.mysql.com/35927" target="_top">Bug#35927</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Attempting to pass a nonexistent column name to the
        <code class="literal">equal()</code> and <code class="literal">setValue()</code>
        methods of <code class="literal">NdbOperation</code> caused NDB API
        applications to crash. Now the column name is checked, and an
        error is returned in the event that the column is not found.
       (<a href="http://bugs.mysql.com/33747" target="_top">Bug#33747</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Relocation errors were encountered when trying to compile NDB
        API applications on a number of platforms, including 64-bit
        Linux. As a result, <code class="literal">libmysys</code>,
        <code class="literal">libmystrings</code>, and <code class="literal">libdbug</code>
        have been changed from normal libraries to “<span class="quote">noinst</span>”
        <span><strong class="command">libtool</strong></span> helper libraries. They are no longer
        installed as separate libraries; instead, all necessary symbols
        from these are added directly to
        <code class="literal">libndbclient</code>. This means that NDB API
        programs now need to be linked only using
        <code class="option">-lndbclient</code>.
       (<a href="http://bugs.mysql.com/29791" target="_top">Bug#29791</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-24-ndb-6-3-13"></a>20.17.1.4. Changes in  MySQL Cluster NDB 6.3.13 (5.1.24-ndb-6.3.13) (10 April 2008)</h4></div></div></div><p class="release-level">
        This is a new source release, fixing recently discovered bugs in
        previous MySQL Cluster NDB 6.3 releases.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.3. </b>
          MySQL Cluster NDB 6.3 releases are source-only releases which
          you must compile and install using the instructions found in
          <a href="installing.html#installing-source" title="2.9. MySQL Installation Using a Source Distribution">Section 2.9, “MySQL Installation Using a Source Distribution”</a>, and in
          <a href="mysql-cluster.html#mysql-cluster-building" title="20.3.1. Building MySQL Cluster from Source Code">Section 20.3.1, “Building MySQL Cluster from Source Code”</a>. You can download the
          GPL source tarball from the MySQL FTP site at
          <a href="ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/" target="_top">ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/</a>.
        </p><p>
        This release incorporates all bugfixes and changes made in the
        previous MySQL Cluster NDB 6.3 release, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.24 (see <a href="news.html#news-5-1-24" title="C.1.6. Changes in  MySQL 5.1.24 (08 April 2008)">Section C.1.6, “Changes in  MySQL 5.1.24 (08 April 2008)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p>
        The <span><strong class="command">ndbd</strong></span> and <span><strong class="command">ndb_mgmd</strong></span>
        manpages have been reclassified from volume 1 to volume 8.
       (<a href="http://bugs.mysql.com/34642" target="_top">Bug#34642</a>)</p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Important Change</strong></span>: <span class="bold"><strong>MySQL Cluster</strong></span>: 
        <span><strong class="command">mysqld_safe</strong></span> now traps Signal 13
        (<code class="literal">SIGPIPE</code>) so that this signal no longer kills
        the MySQL server process.
       (<a href="http://bugs.mysql.com/33984" target="_top">Bug#33984</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Node or system restarts could fail due an unitialized variable
        in the <code class="literal">DTUP</code> kernel block. This issue was
        found in MySQL Cluster NDB 6.3.11.
       (<a href="http://bugs.mysql.com/35797" target="_top">Bug#35797</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        If an error occured while executing a statement involving a
        <code class="literal">BLOB</code> or <code class="literal">TEXT</code> column of an
        <code class="literal">NDB</code> table, a memory leak could result.
       (<a href="http://bugs.mysql.com/35593" target="_top">Bug#35593</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        It was not possible to determine the value used for the
        <code class="option">--ndb-cluster-connection-pool</code> option in the
        <span><strong class="command">mysql</strong></span> client. Now this value is reported as a
        system status variable.
       (<a href="http://bugs.mysql.com/35573" target="_top">Bug#35573</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The <span><strong class="command">ndb_waiter</strong></span> utility wrongly calculated
        timeouts.
       (<a href="http://bugs.mysql.com/35435" target="_top">Bug#35435</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A <code class="literal">SELECT</code> on a table with a non-indexed, large
        <code class="literal">VARCHAR</code> column which resulted in condition
        pushdown on this column could cause <span><strong class="command">mysqld</strong></span> to
        crash.
       (<a href="http://bugs.mysql.com/35413" target="_top">Bug#35413</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <span><strong class="command">ndb_restore</strong></span> incorrectly handled some
        datatypes when applying log files from backups.
       (<a href="http://bugs.mysql.com/35343" target="_top">Bug#35343</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        In some circumstances, a stopped data node was handled
        incorrectly, leading to redo log space being exhausted following
        an initial restart of the node, or an initial or partial restart
        of the cluster (the wrong CGI might be used in such cases). This
        could happen, for example, when a node was stopped following the
        creation of a new table, but before a new LCP could be executed.
       (<a href="http://bugs.mysql.com/35241" target="_top">Bug#35241</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">SELECT ... LIKE ...</code> queries yielded incorrect
        results when used on <code class="literal">NDB</code> tables. As part of
        this fix, condition pushdown of such queries has been disabled;
        re-enabling it is expected to be done as part of a later,
        permanent fix for this issue.
       (<a href="http://bugs.mysql.com/35185" target="_top">Bug#35185</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <span><strong class="command">ndb_mgmd</strong></span> reported errors to
        <code class="literal">STDOUT</code> rather than to
        <code class="literal">STDERR</code>.
       (<a href="http://bugs.mysql.com/35169" target="_top">Bug#35169</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Nested multi-range reads failed when the second multi-range read
        released the first read's unprocessed operations, sometimes
        leading to an SQL node crash.
       (<a href="http://bugs.mysql.com/35137" target="_top">Bug#35137</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        In some situations, a problem with synchronizing checkpoints
        between nodes could cause a system restart or a node restart to
        fail with <span class="errortext">Error 630 during restore of TX</span>.
       (<a href="http://bugs.mysql.com/34756" target="_top">Bug#34756</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A node failure during an initial node restart followed by
        another node start could cause the master data node to fail,
        because it incorrectly gave the node permission to start even if
        the invalidated node's LCP was still running.
       (<a href="http://bugs.mysql.com/34702" target="_top">Bug#34702</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When a secondary index on a <code class="literal">DECIMAL</code> column
        was used to retrieve data from an <code class="literal">NDB</code> table,
        no results were returned even if the target table had a matched
        value in the column that was defined with the secondary index.
       (<a href="http://bugs.mysql.com/34515" target="_top">Bug#34515</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        An <code class="literal">UPDATE</code> on an <code class="literal">NDB</code> table
        that set a new value for a unique key column could cause
        subsequent queries to fail.
       (<a href="http://bugs.mysql.com/34208" target="_top">Bug#34208</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        If a data node in one node group was placed in the “<span class="quote">not
        started</span>” state (using
        <code class="literal"><em class="replaceable"><code>node_id</code></em> RESTART
        -n</code>), it was not possible to stop a data node in a
        different node group.
       (<a href="http://bugs.mysql.com/34201" target="_top">Bug#34201</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Numerous <code class="literal">NDBCLUSTER</code> test failures occurred in
        builds compiled using <span><strong class="command">icc</strong></span> on IA64 platforms.
       (<a href="http://bugs.mysql.com/31239" target="_top">Bug#31239</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        If a <code class="literal">START BACKUP</code> command was issued while
        <span><strong class="command">ndb_restore</strong></span> was running, the backup being
        restored could be overwritten.
       (<a href="http://bugs.mysql.com/26498" target="_top">Bug#26498</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">REPLACE</code> statements did not work correctly
        with <code class="literal">NDBCLUSTER</code> tables when all columns were
        not explicitly listed.
       (<a href="http://bugs.mysql.com/22045" target="_top">Bug#22045</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">CREATE TABLE</code> and <code class="literal">ALTER
        TABLE</code> statements using <code class="literal">ENGINE=NDB</code>
        or <code class="literal">ENGINE=NDBCLUSTER</code> caused
        <span><strong class="command">mysqld</strong></span> to fail on Solaris 10 for x86
        platforms.
       (<a href="http://bugs.mysql.com/19911" target="_top">Bug#19911</a>)</p></li><li><p><span class="bold"><strong>Replication</strong></span>: 
        A <code class="literal">CHANGE MASTER</code> statement with no
        <code class="literal">MASTER_HEARTBEAT_PERIOD</code> option failed to
        reset the heartbeat period to its default value.
       (<a href="http://bugs.mysql.com/34686" target="_top">Bug#34686</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        In some cases, when updating only one or some columns in a
        table, the complete row was written to the binary log instead of
        only the updated column or columns, even when
        <code class="literal">ndb_log_updated_only</code> was set to 1.
       (<a href="http://bugs.mysql.com/35208" target="_top">Bug#35208</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        The <code class="option">--ndb-wait-connected</code> option caused the
        server to wait for a partial connection plus an additional 3
        seconds for a complete connection to the cluster. This could
        lead to issues with setting up the binary log.
       (<a href="http://bugs.mysql.com/34757" target="_top">Bug#34757</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Closing a scan before it was executed caused the application to
        segfault.
       (<a href="http://bugs.mysql.com/36375" target="_top">Bug#36375</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Using NDB API applications from older MySQL Cluster versions
        with <code class="literal">libndbclient</code> from newer ones caused the
        cluster to fail.
       (<a href="http://bugs.mysql.com/36124" target="_top">Bug#36124</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Some ordered index scans could return tuples out of order.
       (<a href="http://bugs.mysql.com/35908" target="_top">Bug#35908</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Scans having no bounds set were handled incorrectly.
       (<a href="http://bugs.mysql.com/35876" target="_top">Bug#35876</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        <code class="literal">NdbScanFilter::getNdbOperation()</code>, which was
        inadvertently removed in MySQL Cluster NDB 6.3.11, has been
        restored.
       (<a href="http://bugs.mysql.com/35854" target="_top">Bug#35854</a>)</p></li><li><p>
        Enabling the <code class="literal">read_only</code> system variable while
        autocommit mode was enabled caused <code class="literal">SELECT</code>
        statements for transactional storage engines to fail.
       (<a href="http://bugs.mysql.com/35732" target="_top">Bug#35732</a>)</p></li><li><p>
        Executing a <code class="literal">FLUSH PRIVILEGES</code> statement after
        creating a temporary table in the <code class="literal">mysql</code>
        database with the same name as one of the MySQL system tables
        caused the server to crash.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
            While it is possible to shadow a system table in this way,
            the temporary table exists only for the current user and
            connection, and does not effect any user privileges.
          </p></div><p>
       (<a href="http://bugs.mysql.com/33275" target="_top">Bug#33275</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-23-ndb-6-3-12"></a>20.17.1.5. Changes in  MySQL Cluster NDB 6.3.12 (5.1.23-ndb-6.3.12) (05 April 2008)</h4></div></div></div><p class="release-level">
        MySQL Cluster NDB 6.3.12 was pulled due to issues discovered
        shortly after its release, and is no longer available. Users of
        MySQL Cluster NDB 6.3.10 and earlier MySQL Cluster NDB 6.3
        releases should upgrade to MySQL Cluster NDB 6.3.13 or later.
      </p><p>
        For information about bugfixes and feature enhancements that
        were originally scheduled to appear for the first time in this
        release, see
        <a href="mysql-cluster.html#mysql-cluster-news-5-1-24-ndb-6-3-13" title="20.17.1.4. Changes in  MySQL Cluster NDB 6.3.13 (5.1.24-ndb-6.3.13) (10 April 2008)">Section 20.17.1.4, “Changes in  MySQL Cluster NDB 6.3.13 (5.1.24-ndb-6.3.13) (10 April 2008)”</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-23-ndb-6-3-11"></a>20.17.1.6. Changes in  MySQL Cluster NDB 6.3.11 (5.1.23-ndb-6.3.11) (28 March 2008)</h4></div></div></div><p class="release-level">
        This release was pulled due to issues discovered shortly after
        its release, and is no longer available. Users of MySQL Cluster
        NDB 6.3.10 and earlier MySQL Cluster NDB 6.3 releases should
        upgrade to MySQL Cluster NDB 6.3.13 or later.
      </p><p>
        For information about bugfixes and feature enhancements that
        were originally scheduled to appear for the first time in this
        release, see
        <a href="mysql-cluster.html#mysql-cluster-news-5-1-24-ndb-6-3-13" title="20.17.1.4. Changes in  MySQL Cluster NDB 6.3.13 (5.1.24-ndb-6.3.13) (10 April 2008)">Section 20.17.1.4, “Changes in  MySQL Cluster NDB 6.3.13 (5.1.24-ndb-6.3.13) (10 April 2008)”</a>.
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-23-ndb-6-3-10"></a>20.17.1.7. Changes in  MySQL Cluster NDB 6.3.10 (5.1.23-ndb-6.3.10) (17 February 2008)</h4></div></div></div><p class="release-level">
        This is a new Beta development release, fixing recently
        discovered bugs in previous MySQL Cluster NDB 6.3 releases.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.3. </b>
          MySQL Cluster NDB 6.3 releases are source-only releases which
          you must compile and install using the instructions found in
          <a href="installing.html#installing-source" title="2.9. MySQL Installation Using a Source Distribution">Section 2.9, “MySQL Installation Using a Source Distribution”</a>, and in
          <a href="mysql-cluster.html#mysql-cluster-building" title="20.3.1. Building MySQL Cluster from Source Code">Section 20.3.1, “Building MySQL Cluster from Source Code”</a>. You can download the
          GPL source tarball from the MySQL FTP site at
          <a href="ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/" target="_top">ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/</a>.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        the previous MySQL Cluster NDB 6.3 release, as well as all
        bugfixes and feature changes which were added in mainline MySQL
        5.1 through MySQL 5.1.23 (see <a href="news.html#news-5-1-23" title="C.1.7. Changes in  MySQL 5.1.23 (29 January 2008)">Section C.1.7, “Changes in  MySQL 5.1.23 (29 January 2008)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Due to the reduction of the number of local checkpoints from 3
        to 2 in MySQL Cluster NDB 6.3.8, a data node using ndbd from
        MySQL Cluster NDB 6.3.8 or later started using a filesystem from
        an earlier version could incorrectly invalidate local
        checkpoints too early during the startup process, causing the
        node to fail.
       (<a href="http://bugs.mysql.com/34596" target="_top">Bug#34596</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-23-ndb-6-3-9"></a>20.17.1.8. Changes in  MySQL Cluster NDB 6.3.9 (5.1.23-ndb-6.3.9) (12 February 2008)</h4></div></div></div><p class="release-level">
        This is a new Beta development release, fixing recently
        discovered bugs in previous MySQL Cluster NDB 6.3 releases.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.3. </b>
          MySQL Cluster NDB 6.3 releases are source-only releases which
          you must compile and install using the instructions found in
          <a href="installing.html#installing-source" title="2.9. MySQL Installation Using a Source Distribution">Section 2.9, “MySQL Installation Using a Source Distribution”</a>, and in
          <a href="mysql-cluster.html#mysql-cluster-building" title="20.3.1. Building MySQL Cluster from Source Code">Section 20.3.1, “Building MySQL Cluster from Source Code”</a>. You can download the
          GPL source tarball from the MySQL FTP site at
          <a href="ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/" target="_top">ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/</a>.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        the previous MySQL Cluster NDB 6.3 release, as well as all
        bugfixes and feature changes which were added in mainline MySQL
        5.1 through MySQL 5.1.23 (see <a href="news.html#news-5-1-23" title="C.1.7. Changes in  MySQL 5.1.23 (29 January 2008)">Section C.1.7, “Changes in  MySQL 5.1.23 (29 January 2008)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p>
        Beginning with this version, MySQL Cluster NDB
        6.3.<em class="replaceable"><code>x</code></em> releases once again include the
        <code class="literal">InnoDB</code> storage engine. In order to enable
        <code class="literal">InnoDB</code>, you must configure the build using
        <code class="option">--with-innodb</code>.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Cluster failures could sometimes occur when performing more than
        three parallel takeovers during node restarts or system
        restarts. This affected MySQL Cluster NDB
        6.3.<em class="replaceable"><code>x</code></em> releases only.
       (<a href="http://bugs.mysql.com/34445" target="_top">Bug#34445</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Upgrades of a cluster using while a
        <code class="literal">DataMemory</code> setting in excess of 16 GB caused
        data nodes to fail.
       (<a href="http://bugs.mysql.com/34378" target="_top">Bug#34378</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Performing many SQL statements on <code class="literal">NDB</code> tables
        while in <code class="literal">AUTOCOMMIT</code> mode caused a memory leak
        in <span><strong class="command">mysqld</strong></span>.
       (<a href="http://bugs.mysql.com/34275" target="_top">Bug#34275</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        In certain rare circumstances, a race condition could occur
        between an aborted insert and a delete leading a data node
        crash.
       (<a href="http://bugs.mysql.com/34260" target="_top">Bug#34260</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Multi-table updates using ordered indexes during handling of
        node failures could cause other data nodes to fail.
       (<a href="http://bugs.mysql.com/34216" target="_top">Bug#34216</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When configured with <code class="literal">NDB</code> support, MySQL
        failed to compile using <span><strong class="command">gcc</strong></span> 4.3 on 64bit
        FreeBSD systems.
       (<a href="http://bugs.mysql.com/34169" target="_top">Bug#34169</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The failure of a DDL statement could sometimes lead to node
        failures when attempting to execute subsequent DDL statements.
       (<a href="http://bugs.mysql.com/34160" target="_top">Bug#34160</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Extremely long <code class="literal">SELECT</code> statements (where the
        text of the statement was in excess of 50000 characters) against
        <code class="literal">NDB</code> tables returned empty results.
       (<a href="http://bugs.mysql.com/34107" target="_top">Bug#34107</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When configured with <code class="literal">NDB</code> support, MySQL
        failed to compile on 64bit FreeBSD systems.
       (<a href="http://bugs.mysql.com/34046" target="_top">Bug#34046</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Statements executing multiple inserts performed poorly on
        <code class="literal">NDB</code> tables having
        <code class="literal">AUTO_INCREMENT</code> columns.
       (<a href="http://bugs.mysql.com/33534" target="_top">Bug#33534</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The <span><strong class="command">ndb_waiter</strong></span> utility polled
        <span><strong class="command">ndb_mgmd</strong></span> excessively when obtaining the
        status of cluster data nodes.
       (<a href="http://bugs.mysql.com/32025" target="_top">Bug#32025</a>)</p><p>See also <a href="http://bugs.mysql.com/32023" target="_top">Bug#32023</a></p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Transaction atomicity was sometimes not preserved between reads
        and inserts under high loads.
       (<a href="http://bugs.mysql.com/31477" target="_top">Bug#31477</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Having tables with a great many columns could cause Cluster
        backups to fail.
       (<a href="http://bugs.mysql.com/30172" target="_top">Bug#30172</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: <span class="bold"><strong>Disk Data</strong></span>: 
        Statements violating unique keys on Disk Data tables (such as
        attempting to insert <code class="literal">NULL</code> into a <code class="literal">NOT
        NULL</code> column) could cause data nodes to fail. When the
        statement was executed from the binlog, this could also result
        in failure of the slave cluster.
       (<a href="http://bugs.mysql.com/34118" target="_top">Bug#34118</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        Updating in-memory columns of one or more rows of Disk Data
        table, followed by deletion of these rows and re-insertion of
        them, caused data node failures.
       (<a href="http://bugs.mysql.com/33619" target="_top">Bug#33619</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Setting <code class="option">--replicate-ignore-db=mysql</code> caused the
        <code class="literal">mysql.ndb_apply_status</code> table not to be
        replicated, breaking Cluster Replication.
       (<a href="http://bugs.mysql.com/28170" target="_top">Bug#28170</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-23-ndb-6-3-8"></a>20.17.1.9. Changes in  MySQL Cluster NDB 6.3.8 (5.1.23-ndb-6.3.8) (29 January 2008)</h4></div></div></div><p class="release-level">
        This is a new Beta development release, fixing recently
        discovered bugs in previous MySQL Cluster NDB 6.3 releases.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.3. </b>
          MySQL Cluster NDB 6.3 releases are source-only releases which
          you must compile and install using the instructions found in
          <a href="installing.html#installing-source" title="2.9. MySQL Installation Using a Source Distribution">Section 2.9, “MySQL Installation Using a Source Distribution”</a>, and in
          <a href="mysql-cluster.html#mysql-cluster-building" title="20.3.1. Building MySQL Cluster from Source Code">Section 20.3.1, “Building MySQL Cluster from Source Code”</a>. You can download the
          GPL source tarball from the MySQL FTP site at
          <a href="ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/" target="_top">ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/</a>.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        the previous MySQL Cluster NDB 6.3 release, as well as all
        bugfixes and feature changes which were added in mainline MySQL
        5.1 through MySQL 5.1.23 (see <a href="news.html#news-5-1-23" title="C.1.7. Changes in  MySQL 5.1.23 (29 January 2008)">Section C.1.7, “Changes in  MySQL 5.1.23 (29 January 2008)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Cluster API</strong></span>: <span class="bold"><strong>Important Change</strong></span>: 
        Because <code class="literal">NDB_LE_MemoryUsage.page_size_kb</code> shows
        memory page sizes in bytes rather than kilobytes, it has been
        renamed to <code class="literal">page_size_bytes</code>. The name
        <code class="literal">page_size_kb</code> is now deprecated and thus
        subject to removal in a future release, although it currently
        remains supported for reasons of backward compatibility. See
        <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-logevent-type.html" target="_top">The <code class="literal">Ndb_logevent_type</code> Type</a>, for more information about
        <code class="literal">NDB_LE_MemoryUsage</code>.
       (<a href="http://bugs.mysql.com/30271" target="_top">Bug#30271</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <span><strong class="command">ndb_restore</strong></span> now supports basic
        <em class="firstterm">attribute promotion</em>; that is, data from a
        column of a given type can be restored to a column using a
        “<span class="quote">larger</span>” type. For example, Cluster backup data
        taken from a <code class="literal">SMALLINT</code> column can be restored
        to a <code class="literal">MEDIUMINT</code>, <code class="literal">INT</code>, or
        <code class="literal">BIGINT</code> column.
      </p><p>
        For more information, see
        <a href="mysql-cluster.html#mysql-cluster-restore" title="20.9.3. ndb_restore — Restore a Cluster Backup">Section 20.9.3, “<span><strong class="command">ndb_restore</strong></span> — Restore a Cluster Backup”</a>.
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Now only 2 local checkpoints are stored, rather than 3 as in
        previous MySQL Cluster versions. This lowers disk space
        requirements and reduces the size and number of redo log files
        needed.
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The <span><strong class="command">mysqld</strong></span> option
        <code class="option">--ndb-batch-size</code> has been added. This allows
        for controlling the size of batches used for running
        transactions.
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Node recovery can now be done in parallel, rather than
        sequentially, which can result in much faster recovery times.
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Persistence of <code class="literal">NDB</code> tables can now be
        controlled using the session variables
        <code class="literal">ndb_table_temporary</code> and
        <code class="literal">ndb_table_no_logging</code>.
        <code class="literal">ndb_table_no_logging</code> causes
        <code class="literal">NDB</code> tables not to be checkpointed to disk;
        <code class="literal">ndb_table_temporary</code> does the same, and in
        addition, no schema files are created.
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">OPTIMIZE TABLE</code> can now be interrupted. This
        can be done, for example, by killing the SQL thread performing
        the <code class="literal">OPTIMIZE</code> operation.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Disk Data</strong></span>: <span class="bold"><strong>Important Change</strong></span>: 
        It is no longer possible on 32-bit systems to issue statements
        appearing to create Disk Data log files or data files greater
        than 4 GB in size. (Trying to create log files or data files
        larger than 4 GB on 32-bit systems led to unrecoverable data
        node failures; such statements now fail with
        <code class="literal">NDB</code> error 1515.)
       (<a href="http://bugs.mysql.com/29186" target="_top">Bug#29186</a>)</p></li><li><p><span class="bold"><strong>Replication</strong></span>: <span class="bold"><strong>MySQL Cluster</strong></span>: 
        The code implementing heartbeats did not check for possible
        errors in some circumstances; this kept the dump thread hanging
        while waiting for heartbeats loop even though the slave was no
        longer connected.
       (<a href="http://bugs.mysql.com/33332" target="_top">Bug#33332</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        High numbers of insert operations, delete operations, or both
        could cause <code class="literal">NDB</code> error 899 (<span class="errortext">Rowid
        already allocated</span>) to occur unnecessarily.
       (<a href="http://bugs.mysql.com/34033" target="_top">Bug#34033</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A periodic failure to flush the send buffer by the
        <code class="literal">NDB</code> TCP transporter could cause a unnecessary
        delay of 10 ms between operations.
       (<a href="http://bugs.mysql.com/34005" target="_top">Bug#34005</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">DROP TABLE</code> did not free all data memory. This
        bug was observed in MySQL Cluster NDB 6.3.7 only.
       (<a href="http://bugs.mysql.com/33802" target="_top">Bug#33802</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A race condition could occur (very rarely) when the release of a
        GCI was followed by a data node failure.
       (<a href="http://bugs.mysql.com/33793" target="_top">Bug#33793</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Some tuple scans caused the wrong memory page to be accessed,
        leading to invalid results. This issue could affect both
        in-memory and Disk Data tables.
       (<a href="http://bugs.mysql.com/33739" target="_top">Bug#33739</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A failure to initialize an internal variable led to sporadic
        crashes during cluster testing.
       (<a href="http://bugs.mysql.com/33715" target="_top">Bug#33715</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The server failed to reject properly the creation of an
        <code class="literal">NDB</code> table having an unindexed
        <code class="literal">AUTO_INCREMENT</code> column.
       (<a href="http://bugs.mysql.com/30417" target="_top">Bug#30417</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Issuing an <code class="literal">INSERT ... ON DUPLICATE KEY UPDATE</code>
        concurrently with or following a <code class="literal">TRUNCATE</code>
        statement on an <code class="literal">NDB</code> table failed with
        <code class="literal">NDB</code> error 4350 <span class="errortext">Transaction already
        aborted</span>.
       (<a href="http://bugs.mysql.com/29851" target="_top">Bug#29851</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The Cluster backup process could not detect when there was no
        more disk space and instead continued to run until killed
        manually. Now the backup fails with an appropriate error when
        disk space is exhausted.
       (<a href="http://bugs.mysql.com/28647" target="_top">Bug#28647</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        It was possible in <code class="filename">config.ini</code> to define
        cluster nodes having node IDs greater than the maximum allowed
        value.
       (<a href="http://bugs.mysql.com/28298" target="_top">Bug#28298</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Under some circumstances, a recovering data node did not use its
        own data, instead copying data from another node even when this
        was not required. This in effect bypassed the optimized node
        recovery protocol and caused recovery times to be unnecessarily
        long.
       (<a href="http://bugs.mysql.com/26913" target="_top">Bug#26913</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Consecutive DDL statements involving tables (<code class="literal">CREATE
        TABLE</code>, <code class="literal">ALTER TABLE</code>, and
        <code class="literal">DROP TABLE</code>) could be executed so quickly that
        previous DDL statements upon which they depended were not yet
        written in the binary log.
      </p><p>
        For example, if <code class="literal">DROP TABLE foo</code> was issued
        immediately following <code class="literal">CREATE TABLE foo</code>, the
        <code class="literal">DROP</code> statement could fail because the
        <code class="literal">CREATE</code> had not yet been recorded.
       (<a href="http://bugs.mysql.com/34006" target="_top">Bug#34006</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        <span><strong class="command">ndb_restore -e</strong></span> restored excessively large
        values to the <code class="literal">ndb_apply_status</code> table's
        <code class="literal">epoch</code> column when restoring to a MySQL
        Cluster version supporting Micro-GCPs from an older version that
        did not support these.
      </p><p>
        A workaround when restoring to MySQL Cluster releases supporting
        micro-GCPs previous to MySQL Cluster NDB 6.3.8 is to perform a
        32-bit shift on the <code class="literal">epoch</code> column values to
        reduce them to their proper size.
       (<a href="http://bugs.mysql.com/33406" target="_top">Bug#33406</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Transactions containing inserts or reads would hang during
        <code class="literal">NdbTransaction::execute()</code> calls made from NDB
        API applications built against a MySQL Cluster version that did
        not support micro-GCPs accessing a later version that supported
        micro-GCPs. This issue was observed while upgrading from MySQL
        Cluster NDB 6.1.23 to MySQL Cluster NDB 6.2.10 when the API
        application built against the earlier version attempted to
        access a data node already running the later version, even after
        disabling micro-GCPs by setting
        <code class="literal">TimeBetweenEpochs</code> equal to 0.
       (<a href="http://bugs.mysql.com/33895" target="_top">Bug#33895</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        When reading a <code class="literal">BIT(64)</code> value using
        <code class="literal">NdbOperation:getValue()</code>, 12 bytes were
        written to the buffer rather than the expected 8 bytes.
       (<a href="http://bugs.mysql.com/33750" target="_top">Bug#33750</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-23-ndb-6-3-7"></a>20.17.1.10. Changes in  MySQL Cluster NDB 6.3.7 (5.1.23-ndb-6.3.7) (19 December 2007)</h4></div></div></div><p class="release-level">
        This is a new Beta development release, fixing recently
        discovered bugs in previous MySQL Cluster NDB 6.3 releases.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.3. </b>
          MySQL Cluster NDB 6.3 releases are source-only releases which
          you must compile and install using the instructions found in
          <a href="installing.html#installing-source" title="2.9. MySQL Installation Using a Source Distribution">Section 2.9, “MySQL Installation Using a Source Distribution”</a>, and in
          <a href="mysql-cluster.html#mysql-cluster-building" title="20.3.1. Building MySQL Cluster from Source Code">Section 20.3.1, “Building MySQL Cluster from Source Code”</a>. You can download the
          GPL source tarball from the MySQL FTP site at
          <a href="ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/" target="_top">ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/</a>.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        the previous MySQL Cluster NDB 6.3 release, as well as all
        bugfixes and feature changes which were added in mainline MySQL
        5.1 through MySQL 5.1.23 (see <a href="news.html#news-5-1-23" title="C.1.7. Changes in  MySQL 5.1.23 (29 January 2008)">Section C.1.7, “Changes in  MySQL 5.1.23 (29 January 2008)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Compressed local checkpoints and backups are now supported,
        resulting in a space savings of 50% or more over uncompressed
        LCPs and backups. Cmpression of these can be enabled in the
        <code class="filename">config.ini</code> file using the two new data node
        configuration parameters <code class="literal">CompressedLCP</code> and
        <code class="literal">CompressedBackup</code>, respectively.
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">OPTIMIZE TABLE</code> is now supported for
        <code class="literal">NDB</code> tables, subject to the following
        limitations:
        </p><div class="itemizedlist"><ul type="circle"><li><p>
              Only in-memory tables are supported.
              <code class="literal">OPTIMIZE</code> still has no effect on Disk
              Data tables.
            </p></li><li><p>
              Only variable-length columns are supported. However, you
              can force columns defined using fixed-length data types to
              be dynamic using the <code class="literal">ROW_FORMAT</code> or
              <code class="literal">COLUMN_FORMAT</code> option with a
              <code class="literal">CREATE TABLE</code> or <code class="literal">ALTER
              TABLE</code> statement.
            </p></li></ul></div><p>
        Memory reclaimed from an <code class="literal">NDB</code> table using
        <code class="literal">OPTIMIZE</code> is generally available to the
        cluster, and not confined to the table from which it was
        recovered, unlike the case with memory freed using
        <code class="literal">DELETE</code>.
      </p><p>
        The performance of <code class="literal">OPTIMIZE</code> on
        <code class="literal">NDB</code> tables can be regulated by adjusting the
        value of the <code class="literal">ndb_optimization_delay</code> system
        variable.
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        It is now possible to cause statements occurring within the same
        transaction to be run as a batch by setting the session variable
        <code class="literal">transaction_allow_batching</code> to
        <code class="literal">1</code> or <code class="literal">ON</code>.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          To use this feature, autocommit must be disabled.
        </p></div></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Partitioning</strong></span>: <span class="bold"><strong>MySQL Cluster</strong></span>: 
        When partition pruning on an <code class="literal">NDB</code> table
        resulted in an ordered index scan spanning only one partition,
        any descending flag for the scan was wrongly discarded, causing
        <code class="literal">ORDER BY DESC</code> to be treated as <code class="literal">ORDER
        BY ASC</code>, <code class="literal">MAX()</code> to be handled
        incorrectly, and similar problems.
       (<a href="http://bugs.mysql.com/33061" target="_top">Bug#33061</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When all data and SQL nodes in the cluster were shut down
        abnormally (that is, other than by using <code class="literal">STOP</code>
        in the cluster management client), <span><strong class="command">ndb_mgm</strong></span>
        used excessive amounts of CPU.
       (<a href="http://bugs.mysql.com/33237" target="_top">Bug#33237</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When using micro-GCPs, if a node failed while preparing for a
        global checkpoint, the master node would use the wrong GCI.
       (<a href="http://bugs.mysql.com/32922" target="_top">Bug#32922</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Under some conditions, performing an <code class="literal">ALTER
        TABLE</code> on an <code class="literal">NDBCLUSTER</code> table failed
        with a <span class="errortext">Table is full</span> error, even when
        only 25% of <code class="literal">DataMemory</code> was in use and the
        result should have been a table using less memory (for example,
        changing a <code class="literal">VARCHAR(100)</code> column to
        <code class="literal">VARCHAR(80)</code>).
       (<a href="http://bugs.mysql.com/32670" target="_top">Bug#32670</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Creating the <code class="literal">mysql.ndb_replication</code> table with
        the wrong number of columns for the primary key caused
        <span><strong class="command">mysqld</strong></span> to crash. Now a <code class="literal">CREATE TABLE
        [mysql.]ndb_replication</code> statement that is invalid for
        this reason fails with the error <span class="errortext">Bad schema for
        mysql.ndb_replication table. Message: Wrong number of primary
        keys, expected <em class="replaceable"><code>number</code></em></span>.
       (<a href="http://bugs.mysql.com/33159" target="_top">Bug#33159</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Where a table being replicated had a <code class="literal">TEXT</code> or
        <code class="literal">BLOB</code> column, an <code class="literal">UPDATE</code> on
        the master that did not refer explicitly to this column in the
        <code class="literal">WHERE</code> clause stopped the SQL thread on the
        slave with <span class="errortext">Error in Write_rows event: row application
        failed. Got error 4288 'Blob handle for column not available'
        from NDBCLUSTER</span>.
       (<a href="http://bugs.mysql.com/30674" target="_top">Bug#30674</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-22-ndb-6-3-6"></a>20.17.1.11. Changes in  MySQL Cluster NDB 6.3.6 (5.1.22-ndb-6.3.6) (08 November 2007)</h4></div></div></div><p class="release-level">
        This is a new Beta development release, fixing recently
        discovered bugs in previous MySQL Cluster NDB 6.3 releases.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.3. </b>
          MySQL Cluster NDB 6.3 releases are source-only releases which
          you must compile and install using the instructions found in
          <a href="installing.html#installing-source" title="2.9. MySQL Installation Using a Source Distribution">Section 2.9, “MySQL Installation Using a Source Distribution”</a>, and in
          <a href="mysql-cluster.html#mysql-cluster-building" title="20.3.1. Building MySQL Cluster from Source Code">Section 20.3.1, “Building MySQL Cluster from Source Code”</a>. You can download the
          GPL source tarball from the MySQL FTP site at
          <a href="ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/" target="_top">ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/</a>.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        the previous MySQL Cluster NDB 6.3 release, as well as all
        bugfixes and feature changes which were added in mainline MySQL
        5.1 through MySQL 5.1.22 (see <a href="news.html#news-5-1-22" title="C.1.8. Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)">Section C.1.8, “Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Important Note</strong></span>: 
        MySQL Cluster NDB 6.2 and 6.3 source archives are now available
        in separate commercial and GPL versions. Due to licensing
        concerns, previous MySQL Cluster NDB 6.2 and 6.3 source archives
        were removed from the FTP site.
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Unnecessary reads when performing a primary key or unique key
        update have been reduced, and in some cases, eliminated. (It is
        almost never necessary to read a record prior to an update, the
        lone exception to this being when a primary key is updated,
        since this requires a delete followed by an insert, which must
        be prepared by reading the record.) Depending on the number of
        primary key and unique key lookups that are performed per
        transaction, this can yield a considerable improvement in
        performance.
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Batched operations are now better supported for
        <code class="literal">DELETE</code> and <code class="literal">UPDATE</code>.
        (<code class="literal">UPDATE WHERE...</code> and muliple
        <code class="literal">DELETE</code>.)
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Introduced the <code class="literal">Ndb_execute_count</code> status
        variable, which measures the number of round trips made by
        queries to the <code class="literal">NDB</code> kernel.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        An insert or update with combined range and equality constraints
        failed when run against an <code class="literal">NDB</code> table with the
        error <span class="errortext">Got unknown error from NDB</span>. An
        example of such a statement would be <code class="literal">UPDATE t1 SET b =
        5 WHERE a IN (7,8) OR a &gt;= 10;</code>.
       (<a href="http://bugs.mysql.com/31874" target="_top">Bug#31874</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        An error with an <code class="literal">if</code> statement in
        <code class="filename">sql/ha_ndbcluster.cc</code> could potentially lead
        to an infinite loop in case of failure when working with
        <code class="literal">AUTO_INCREMENT</code> columns in
        <code class="literal">NDB</code> tables.
       (<a href="http://bugs.mysql.com/31810" target="_top">Bug#31810</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The <code class="literal">NDB</code> storage engine code was not safe for
        strict-alias optimization in <span><strong class="command">gcc</strong></span> 4.2.1.
       (<a href="http://bugs.mysql.com/31761" target="_top">Bug#31761</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <span><strong class="command">ndb_restore</strong></span> displayed incorrect backup file
        version information. This meant (for example) that, when
        attempting to restore a backup made from a MySQL 5.1.22 cluster
        to a MySQL Cluster NDB 6.3.3 cluster, the restore process failed
        with the error <span class="errortext">Restore program older than backup
        version. Not supported. Use new restore program.</span>
       (<a href="http://bugs.mysql.com/31723" target="_top">Bug#31723</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Following an upgrade, <span><strong class="command">ndb_mgmd</strong></span> would fail
        with an <span class="errortype">ArbitrationError</span>.
       (<a href="http://bugs.mysql.com/31690" target="_top">Bug#31690</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The <code class="literal">NDB</code> management client command
        <code class="literal"><em class="replaceable"><code>node_id</code></em> REPORT
        MEMORY</code> provided no output when
        <em class="replaceable"><code>node_id</code></em> was the node ID of a
        management or API node. Now, when this occurs, the management
        client responds with <code class="literal">Node
        <em class="replaceable"><code>node_id</code></em>: is not a data
        node</code>.
       (<a href="http://bugs.mysql.com/29485" target="_top">Bug#29485</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Performing <code class="literal">DELETE</code> operations after a data
        node had been shut down could lead to inconsistent data
        following a restart of the node.
       (<a href="http://bugs.mysql.com/26450" target="_top">Bug#26450</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">UPDATE IGNORE</code> could sometimes fail on
        <code class="literal">NDB</code> tables due to the use of unitialized data
        when checking for duplicate keys to be ignored.
       (<a href="http://bugs.mysql.com/25817" target="_top">Bug#25817</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Updates performed unnecessary writes to the primary keys of the
        rows being updated.
       (<a href="http://bugs.mysql.com/31841" target="_top">Bug#31841</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Slave batching did not work correctly with
        <code class="literal">UPDATE</code> statements.
       (<a href="http://bugs.mysql.com/31787" target="_top">Bug#31787</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        A node failure during replication could lead to buckets out of
        order; now active subscribers are checked for, rather than empty
        buckets.
       (<a href="http://bugs.mysql.com/31701" target="_top">Bug#31701</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        When the master <span><strong class="command">mysqld</strong></span> crashed or was
        restarted, no <code class="literal">LOST_EVENTS</code> entry was made in
        the binlog.
       (<a href="http://bugs.mysql.com/31484" target="_top">Bug#31484</a>)</p><p>See also <a href="http://bugs.mysql.com/21494" target="_top">Bug#21494</a></p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-22-ndb-6-3-5"></a>20.17.1.12. Changes in  MySQL Cluster NDB 6.3.5 (5.1.22-ndb-6.3.5) (17 October 2007)</h4></div></div></div><p class="release-level">
        This is a new Beta development release, fixing recently
        discovered bugs in previous MySQL Cluster NDB 6.3 releases.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.3. </b>
          MySQL Cluster NDB 6.3 releases are source-only releases which
          you must compile and install using the instructions found in
          <a href="installing.html#installing-source" title="2.9. MySQL Installation Using a Source Distribution">Section 2.9, “MySQL Installation Using a Source Distribution”</a>, and in
          <a href="mysql-cluster.html#mysql-cluster-building" title="20.3.1. Building MySQL Cluster from Source Code">Section 20.3.1, “Building MySQL Cluster from Source Code”</a>. You can download the
          GPL source tarball from the MySQL FTP site at
          <a href="ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/" target="_top">ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/</a>.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        the previous MySQL Cluster NDB 6.3 release, as well as all
        bugfixes and feature changes which were added in mainline MySQL
        5.1 through MySQL 5.1.22 (see <a href="news.html#news-5-1-22" title="C.1.8. Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)">Section C.1.8, “Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A query against a table with <code class="literal">TEXT</code> or
        <code class="literal">BLOB</code> columns that would return more than a
        certain amount of data failed with <span class="errortext">Got error 4350
        'Transaction already aborted' from NDBCLUSTER</span>.
       (<a href="http://bugs.mysql.com/31482" target="_top">Bug#31482</a>)</p><p>This regression was introduced by <a href="http://bugs.mysql.com/29102" target="_top">Bug#29102</a></p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        In some cases, not all tables were properly initialized before
        the binlog thread was started.
       (<a href="http://bugs.mysql.com/31618" target="_top">Bug#31618</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-22-ndb-6-3-4"></a>20.17.1.13. Changes in  MySQL Cluster NDB 6.3.4 (5.1.22-ndb-6.3.4) (15 October 2007)</h4></div></div></div><p class="release-level">
        This is a new Beta development release, fixing recently
        discovered bugs in previous MySQL Cluster NDB 6.3 releases.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.3. </b>
          MySQL Cluster NDB 6.3 releases are source-only releases which
          you must compile and install using the instructions found in
          <a href="installing.html#installing-source" title="2.9. MySQL Installation Using a Source Distribution">Section 2.9, “MySQL Installation Using a Source Distribution”</a>, and in
          <a href="mysql-cluster.html#mysql-cluster-building" title="20.3.1. Building MySQL Cluster from Source Code">Section 20.3.1, “Building MySQL Cluster from Source Code”</a>. You can download the
          GPL source tarball from the MySQL FTP site at
          <a href="ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/" target="_top">ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/</a>.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        the previous MySQL Cluster NDB 6.3 release, as well as all
        bugfixes and feature changes which were added in mainline MySQL
        5.1 through MySQL 5.1.22 (see <a href="news.html#news-5-1-22" title="C.1.8. Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)">Section C.1.8, “Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The <code class="option">--ndb_optimized_node_selection</code> startup
        option for <span><strong class="command">mysqld</strong></span> now allows a wider range of
        values and corresponding behaviors for SQL nodes when selecting
        a transaction coordinator. See
        <a href="server-administration.html#server-system-variables" title="5.1.3. System Variables">Section 5.1.3, “System Variables”</a>, for more information.
      </p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: <span class="bold"><strong>Replication</strong></span>: 
        A replication heartbeat mechanism has been added to facilitate
        monitoring. This provides an alternative to checking log files,
        making it possible to detect in real time when a slave has
        failed.
      </p><p>
        Configuration of heartbeats is done via a new
        <code class="literal">MASTER_HEARTBEAT_PERIOD =
        <em class="replaceable"><code>interval</code></em></code> clause for the
        <code class="literal">CHANGE MASTER TO</code> statement (see
        <a href="sql-syntax.html#change-master-to" title="12.6.2.1. CHANGE MASTER TO Syntax">Section 12.6.2.1, “<code class="literal">CHANGE MASTER TO</code> Syntax”</a>); monitoring can be
        done by checking the values of the status variables
        <code class="literal">Slave_heartbeat_period</code> and
        <code class="literal">Slave_received_heartbeats</code> (see
        <a href="server-administration.html#server-status-variables" title="5.1.6. Status Variables">Section 5.1.6, “Status Variables”</a>).
      </p><p>
        The addition of replication heartbeats addresses a number of
        issues:
        </p><div class="itemizedlist"><ul type="circle"><li><p>
              Relay logs were rotated every
              <code class="literal">slave_net_timeout</code> seconds even if no
              statements were being replicated.
            </p></li><li><p>
              <code class="literal">SHOW SLAVE STATUS</code> displayed an
              incorrect value for
              <code class="literal">seconds_behind_master</code> following a
              <code class="literal">FLUSH LOGS</code> statement.
            </p></li><li><p>
              Replication master-slave connections used
              <code class="literal">slave_net_timeout</code> for connection
              timeouts.
            </p></li></ul></div><p>
       (<a href="http://bugs.mysql.com/20435" target="_top">Bug#20435</a>, <a href="http://bugs.mysql.com/29309" target="_top">Bug#29309</a>, <a href="http://bugs.mysql.com/30932" target="_top">Bug#30932</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        A new configuration parameter
        <code class="literal">TimeBetweenEpochsTimeout</code> allows a timeout to
        be set for time between epochs. For more information, see
        <a href="mysql-cluster.html#mysql-cluster-ndbd-definition" title="20.3.4.5. Defining Data Nodes">Section 20.3.4.5, “Defining Data Nodes”</a>.
       (<a href="http://bugs.mysql.com/31276" target="_top">Bug#31276</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Support for a new conflict resolution function
        <code class="literal">NDB$OLD()</code> has been added for handling
        simultaneous updates in multi-master and circular replication
        setups. A new status variable
        <code class="literal">Ndb_conflict_fn_old</code> tracks the number of
        times that updates are prevented from being applied due to this
        type of conflict resolution. See
        <a href="mysql-cluster.html#mysql-cluster-replication-conflict-resolution" title="20.11.10. MySQL Cluster Replication Conflict Resolution">Section 20.11.10, “MySQL Cluster Replication Conflict Resolution”</a>,
        for more information.
      </p></li><li><p>
        On MySQL replication slaves having multiple network interfaces,
        it is now possible to set which interface to use for connecting
        to the master. This can be done by using either the
        <span><strong class="command">mysqld</strong></span> startup option
        <code class="option">--master-bind</code> or the
        <code class="literal">MASTER_BIND='<em class="replaceable"><code>interface</code></em>'</code>
        clause in a <code class="literal">CHANGE MASTER</code> statement.
       (<a href="http://bugs.mysql.com/25939" target="_top">Bug#25939</a>)</p></li><li><p>
        Additional checks were implemented to catch unsupported online
        <code class="literal">ALTER TABLE</code> operations. Currently it is not
        possible to reorder columns or to change the storage engine used
        for a table via online <code class="literal">ALTER TABLE</code>.
      </p><p>
        Some redundant checks made during online creation of indexes
        were removed.
      </p></li><li><p>
        A <code class="option">--bind-address</code> option has been added to a
        number of MySQL client programs: <span><strong class="command">mysql</strong></span>,
        <span><strong class="command">mysqldump</strong></span>, <span><strong class="command">mysqladmin</strong></span>,
        <span><strong class="command">mysqlbinlog</strong></span>, <span><strong class="command">mysqlcheck</strong></span>,
        <span><strong class="command">mysqlimport</strong></span>, and
        <span><strong class="command">mysqlshow</strong></span>. This is for use on a computer
        having multiple network interfaces, and allows you to choose
        which interface is used to connect to the MySQL server.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        It was possible in some cases for a node group to be
        “<span class="quote">lost</span>” due to missed local checkpoints following a
        system restart.
       (<a href="http://bugs.mysql.com/31525" target="_top">Bug#31525</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">NDB</code> tables having names containing
        non-alphanumeric characters (such as “<span class="quote">
        <code class="literal">$</code> </span>”) were not discovered correctly.
       (<a href="http://bugs.mysql.com/31470" target="_top">Bug#31470</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A node failure during a local checkpoint could lead to a
        subsequent failure of the cluster during a system restart.
       (<a href="http://bugs.mysql.com/31257" target="_top">Bug#31257</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A cluster restart could sometimes fail due to an issue with
        table IDs.
       (<a href="http://bugs.mysql.com/30975" target="_top">Bug#30975</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Transaction timeouts were not handled well in some
        circumstances, leading to excessive number of transactions being
        aborted unnecessarily.
       (<a href="http://bugs.mysql.com/30379" target="_top">Bug#30379</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        In some cases, the cluster managment server logged entries
        multiple times following a restart of <span><strong class="command">mgmd</strong></span>.
       (<a href="http://bugs.mysql.com/29565" target="_top">Bug#29565</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <span><strong class="command">ndb_mgm <code class="option">--help</code> </strong></span> did not
        display any information about the <code class="option">-a</code> option.
       (<a href="http://bugs.mysql.com/29509" target="_top">Bug#29509</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        An interpreted program of sufficient size and complexity could
        cause all cluster data nodes to shut down due to buffer
        overruns.
       (<a href="http://bugs.mysql.com/29390" target="_top">Bug#29390</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The cluster log was formatted inconsistently and contained
        extraneous newline characters.
       (<a href="http://bugs.mysql.com/25064" target="_top">Bug#25064</a>)</p></li><li><p>
        A transaction was not aborted following the failure of
        statement.
       (<a href="http://bugs.mysql.com/31320" target="_top">Bug#31320</a>)</p></li><li><p>
        Online <code class="literal">ALTER</code> operations involving a column
        whose data type has an implicit default value left behind
        temporary <code class="filename">.FRM</code> files, causing subsequent
        <code class="literal">DROP DATABASE</code> statements to fail.
       (<a href="http://bugs.mysql.com/31097" target="_top">Bug#31097</a>)</p></li><li><p>
        Errors could sometimes occur during an online <code class="literal">ADD
        COLUMN</code> under load.
       (<a href="http://bugs.mysql.com/31082" target="_top">Bug#31082</a>)</p></li><li><p>
        Transactions were committed prematurely when <code class="literal">LOCK
        TABLE</code> and <code class="literal">SET AUTOCOMMIT=OFF</code> were
        used together.
       (<a href="http://bugs.mysql.com/30996" target="_top">Bug#30996</a>)</p></li><li><p>
        The <span><strong class="command">mysqld_safe</strong></span> script contained a syntax
        error.
       (<a href="http://bugs.mysql.com/30624" target="_top">Bug#30624</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-22-ndb-6-3-3"></a>20.17.1.14. Changes in  MySQL Cluster NDB 6.3.3 (5.1.22-ndb-6.3.3) (20 September 2007)</h4></div></div></div><p class="release-level">
        This is a new Beta development release, fixing recently
        discovered bugs in previous MySQL Cluster NDB 6.3 releases.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.3. </b>
          MySQL Cluster NDB 6.3 releases are source-only releases which
          you must compile and install using the instructions found in
          <a href="installing.html#installing-source" title="2.9. MySQL Installation Using a Source Distribution">Section 2.9, “MySQL Installation Using a Source Distribution”</a>, and in
          <a href="mysql-cluster.html#mysql-cluster-building" title="20.3.1. Building MySQL Cluster from Source Code">Section 20.3.1, “Building MySQL Cluster from Source Code”</a>. You can download the
          GPL source tarball from the MySQL FTP site at
          <a href="ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/" target="_top">ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/</a>.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        the previous MySQL Cluster NDB 6.3 release, as well as all
        bugfixes and feature changes which were added in mainline MySQL
        5.1 through MySQL 5.1.22 (see <a href="news.html#news-5-1-22" title="C.1.8. Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)">Section C.1.8, “Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Mapping of <code class="literal">NDB</code> error codes to MySQL storage
        engine error codes has been improved.
       (<a href="http://bugs.mysql.com/28423" target="_top">Bug#28423</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        A server status variable <code class="literal">ndb_conflict_fn_max</code>
        now provides a count of the number of times that conflict
        resolution for MySQL Cluster Replication has been applied.
      </p><p>
        See
        <a href="mysql-cluster.html#mysql-cluster-replication-conflict-resolution" title="20.11.10. MySQL Cluster Replication Conflict Resolution">Section 20.11.10, “MySQL Cluster Replication Conflict Resolution”</a>,
        for more information.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Partitioning</strong></span>: <span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">EXPLAIN PARTITIONS</code> reported partition usage
        by queries on <code class="literal">NDB</code> tables according to the
        standard MySQL hash function than the hash function used in the
        <code class="literal">NDB</code> storage engine.
       (<a href="http://bugs.mysql.com/29550" target="_top">Bug#29550</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Attempting to restore a backup made on a cluster host using one
        endian to a machine using the other endian could cause the
        cluster to fail.
       (<a href="http://bugs.mysql.com/29674" target="_top">Bug#29674</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The description of the <code class="option">--print</code> option provided
        in the output from <span><strong class="command">ndb_restore <code class="option">--help</code>
        </strong></span> was incorrect.
       (<a href="http://bugs.mysql.com/27683" target="_top">Bug#27683</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Restoring a backup made on a cluster host using one endian to a
        machine using the other endian failed for
        <code class="literal">BLOB</code> and <code class="literal">DATETIME</code> columns.
       (<a href="http://bugs.mysql.com/27543" target="_top">Bug#27543</a>, <a href="http://bugs.mysql.com/30024" target="_top">Bug#30024</a>)</p></li><li><p>
        Errors could sometimes occur during an online <code class="literal">ADD
        COLUMN</code> under load.
       (<a href="http://bugs.mysql.com/31082" target="_top">Bug#31082</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-22-ndb-6-3-2"></a>20.17.1.15. Changes in  MySQL Cluster NDB 6.3.2 (5.1.22-ndb-6.3.2) (07 September 2007)</h4></div></div></div><p class="release-level">
        This is a new Beta development release, fixing recently
        discovered bugs in previous MySQL Cluster NDB 6.3 releases.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.3. </b>
          MySQL Cluster NDB 6.3 releases are source-only releases which
          you must compile and install using the instructions found in
          <a href="installing.html#installing-source" title="2.9. MySQL Installation Using a Source Distribution">Section 2.9, “MySQL Installation Using a Source Distribution”</a>, and in
          <a href="mysql-cluster.html#mysql-cluster-building" title="20.3.1. Building MySQL Cluster from Source Code">Section 20.3.1, “Building MySQL Cluster from Source Code”</a>. You can download the
          GPL source tarball from the MySQL FTP site at
          <a href="ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/" target="_top">ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/</a>.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        the previous MySQL Cluster NDB 6.3 release, as well as all
        bugfixes and feature changes which were added in mainline MySQL
        5.1 through MySQL 5.1.22 (see <a href="news.html#news-5-1-22" title="C.1.8. Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)">Section C.1.8, “Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Online <code class="literal">ADD COLUMN</code>, <code class="literal">ADD
        INDEX</code>, and <code class="literal">DROP INDEX</code> operations
        can now be performed explicitly for <code class="literal">NDB</code>
        tables, as well as online renaming of tables and columns for
        <code class="literal">NDB</code> and <code class="literal">MyISAM</code> tables
        — that is, without copying or locking of the affected
        tables — using <code class="literal">ALTER ONLINE TABLE</code>.
      </p><p>
        Indexes can also be created and dropped online using
        <code class="literal">CREATE INDEX</code> and <code class="literal">DROP
        INDEX</code>, respectively, using the
        <code class="literal">ONLINE</code> keyword.
      </p><p>
        You can force operations that would otherwise be performed
        online to be done offline using the <code class="literal">OFFLINE</code>
        keyword.
      </p><p>
        See <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax">Section 12.1.4, “<code class="literal">ALTER TABLE</code> Syntax”</a>,
        <a href="sql-syntax.html#create-index" title="12.1.7. CREATE INDEX Syntax">Section 12.1.7, “<code class="literal">CREATE INDEX</code> Syntax”</a>, and
        <a href="sql-syntax.html#drop-index" title="12.1.13. DROP INDEX Syntax">Section 12.1.13, “<code class="literal">DROP INDEX</code> Syntax”</a>, for more information.
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        It is now possible to control whether fixed-width or
        variable-width storage is used for a given column of an
        <code class="literal">NDB</code> table by means of the
        <code class="literal">COLUMN_FORMAT</code> specifier as part of the
        column's definition in a <code class="literal">CREATE TABLE</code> or
        <code class="literal">ALTER TABLE</code> statement.
      </p><p>
        It is also possible to control whether a given column of an
        <code class="literal">NDB</code> table is stored in memory or on disk,
        using the <code class="literal">STORAGE</code> specifier as part of the
        column's definition in a <code class="literal">CREATE TABLE</code> or
        <code class="literal">ALTER TABLE</code> statement.
      </p><p>
        For permitted values and other information about
        <code class="literal">COLUMN_FORMAT</code> and <code class="literal">STORAGE</code>,
        see <a href="sql-syntax.html#create-table" title="12.1.10. CREATE TABLE Syntax">Section 12.1.10, “<code class="literal">CREATE TABLE</code> Syntax”</a>.
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A new cluster management server startup option
        <code class="option">--bind-address</code> makes it possible to restrict
        management client connections to <span><strong class="command">ndb_mgmd</strong></span> to
        a single host and port. For more information, see
        <a href="mysql-cluster.html#mysql-cluster-ndb-mgmd-command-options" title="20.6.5.2. Command Options for ndb_mgmd">Section 20.6.5.2, “Command Options for <span><strong class="command">ndb_mgmd</strong></span>”</a>.
      </p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Multi-way replication failover and recovery for
        <code class="literal">NDB</code> is facilitated with the introduction of
        the <code class="option">--ndb-log-orig</code> option. When
        <span><strong class="command">mysqld</strong></span> is started with this option, the
        originating server ID and epoch of each binlog event is recorded
        in the <code class="literal">mysql.ndb_binlog_index</code> table, which
        now contains two additional columns
        <code class="literal">orig_server_id</code> and
        <code class="literal">orig_epoch</code> for storing this information. In
        such cases, a single epoch on a slave may be represented by
        multiple rows in the slave's
        <code class="literal">ndb_binlog_index</code> table, one for each epoch as
        it originated from a master.
      </p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        The protocol for handling global checkpoints has been changed.
        It is now possible to control how often the GCI number is
        updated, and how often global checkpoints are written to disk,
        using the <code class="literal">TimeBetweenEpochs</code> configuration
        parameter. This improves the reliability and performance of
        MySQL Cluster Replication.
      </p><p>
        GCPs handled using the new protocol are sometimes referred to as
        “<span class="quote">micro-GCPs</span>”.
      </p><p>
        For more information, see <code class="literal">
        <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-timebetweenepochs">TimeBetweenEpochs</a>
        </code>.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When an <code class="literal">NDB</code> event was left behind but the
        corresponding table was later recreated and received a new table
        ID, the event could not be dropped.
       (<a href="http://bugs.mysql.com/30877" target="_top">Bug#30877</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        An insufficiently descriptive and potentially misleading Error
        4006 (<span class="errortext">Connect failure - out of connection
        objects...</span>) was produced when either of the
        following two conditions occurred:
        </p><div class="orderedlist"><ol type="1"><li><p>
              There were no more transaction records in the transaction
              coordinator
            </p></li><li><p>
              an <code class="literal">Ndb</code> object in the NDB API was
              initialized with insufficient parallellism
            </p></li></ol></div><p>
        Separate error messages are now generated for each of these two
        cases.
       (<a href="http://bugs.mysql.com/11313" target="_top">Bug#11313</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        An <code class="literal">Ndb</code> object in the NDB API was initialized
        with insufficient parallellism.
      </p></li><li><p>
        For micro-GCPs, the assignment of “<span class="quote">fake</span>” CGI events
        no longer cause buckets to be sent out of order. Now, when
        assigning a GCI to a non-GCI event (that is, creating a
        pseudo-GCI or “<span class="quote">fake</span>” CGI), the GCI that is to
        arrive is always initiated, even if no known GCI exists, which
        could occur in the event of a node failure.
       (<a href="http://bugs.mysql.com/30884" target="_top">Bug#30884</a>)</p></li><li><p>
        There were no more transaction records in the transaction
        coordinator
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-19-ndb-6-3-1"></a>20.17.1.16. Changes in  MySQL Cluster NDB 6.3.1 (5.1.19-ndb-6.3.1) (04 July 2007)</h4></div></div></div><p class="release-level">
        This is a new Beta development release, fixing recently
        discovered bugs in the previous MySQL Cluster NDB 6.3 release.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.3. </b>
          MySQL Cluster NDB 6.3 releases are source-only releases which
          you must compile and install using the instructions found in
          <a href="installing.html#installing-source" title="2.9. MySQL Installation Using a Source Distribution">Section 2.9, “MySQL Installation Using a Source Distribution”</a>, and in
          <a href="mysql-cluster.html#mysql-cluster-building" title="20.3.1. Building MySQL Cluster from Source Code">Section 20.3.1, “Building MySQL Cluster from Source Code”</a>. You can download the
          GPL source tarball from the MySQL FTP site at
          <a href="ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/" target="_top">ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/</a>.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        the previous MySQL Cluster NDB 6.3 release, as well as all
        bugfixes and feature changes which were added in mainline MySQL
        5.1 through MySQL 5.1.19 (see <a href="news.html#news-5-1-19" title="C.1.11. Changes in  MySQL 5.1.19 (25 May 2007)">Section C.1.11, “Changes in  MySQL 5.1.19 (25 May 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p>
        Batching of transactions was not handled correctly in some
        cases.
       (<a href="http://bugs.mysql.com/29525" target="_top">Bug#29525</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-19-ndb-6-3-0"></a>20.17.1.17. Changes in  MySQL Cluster NDB 6.3.0 (5.1.19-ndb-6.3.0) (02 July 2007)</h4></div></div></div><p class="release-level">
        This is the first development release for MySQL Cluster NDB 6.3,
        based on version 6.3 of the <code class="literal">NDBCLUSTER</code>
        storage engine.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.3. </b>
          MySQL Cluster NDB 6.3 releases are source-only releases which
          you must compile and install using the instructions found in
          <a href="installing.html#installing-source" title="2.9. MySQL Installation Using a Source Distribution">Section 2.9, “MySQL Installation Using a Source Distribution”</a>, and in
          <a href="mysql-cluster.html#mysql-cluster-building" title="20.3.1. Building MySQL Cluster from Source Code">Section 20.3.1, “Building MySQL Cluster from Source Code”</a>. You can download the
          GPL source tarball from the MySQL FTP site at
          <a href="ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/" target="_top">ftp://ftp.mysql.com/pub/mysql/download/cluster_telco/</a>.
        </p><p>
        This Beta release incorporates all bugfixes and feature changes
        made in previous MySQL Cluster releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.19 (see <a href="news.html#news-5-1-19" title="C.1.11. Changes in  MySQL 5.1.19 (25 May 2007)">Section C.1.11, “Changes in  MySQL 5.1.19 (25 May 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Reporting functionality has been significantly enhanced in this
        release:
        </p><div class="itemizedlist"><ul type="circle"><li><p>
              A new configuration parameter
              <code class="literal">BackupReportFrequency</code> now makes it
              possible to cause the management client to provide status
              reports at regular intervals as well as for such reports
              to be written to the cluster log (depending on cluster
              event logging levels). See
              <a href="mysql-cluster.html#mysql-cluster-ndbd-definition" title="20.3.4.5. Defining Data Nodes">Section 20.3.4.5, “Defining Data Nodes”</a>,
              for more information about this parameter.
            </p></li><li><p>
              A new <code class="literal">REPORT</code> command has been added in
              the cluster management client. <code class="literal">REPORT
              BackupStatus</code> allows you to obtain a backup
              status report at any time during a backup. <code class="literal">REPORT
              MemoryUsage</code> reports the current data memory and
              index memory used by each data node. For more about the
              <code class="literal">REPORT</code> command, see
              <a href="mysql-cluster.html#mysql-cluster-mgm-client-commands" title="20.7.2. Commands in the MySQL Cluster Management Client">Section 20.7.2, “Commands in the MySQL Cluster Management Client”</a>.
            </p></li><li><p>
              <span><strong class="command">ndb_restore</strong></span> now provides running
              reports of its progress when restoring a backup. In
              addition, a complete report status report on the backup is
              written to the cluster log.
            </p></li></ul></div><p>
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A new configuration parameter <code class="literal">ODirect</code> causes
        <code class="literal">NDB</code> to attempt using
        <code class="literal">O_DIRECT</code> writes for LCP, backups, and redo
        logs, often lowering CPU usage.
      </p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        This release implements conflict resolution, which makes it
        possible to determine on a per-table basis whether or not an
        update to a given row on the master should be applied on the
        slave. For more information, see
        <a href="mysql-cluster.html#mysql-cluster-replication-conflict-resolution" title="20.11.10. MySQL Cluster Replication Conflict Resolution">Section 20.11.10, “MySQL Cluster Replication Conflict Resolution”</a>.
      </p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-news-6-2"></a>20.17.2. Changes in MySQL Cluster NDB 6.2</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-24-ndb-6-2-16">20.17.2.1. Changes in  MySQL Cluster NDB 6.2.16 (5.1.24-ndb-6.2.16) (Not yet released)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-23-ndb-6-2-15">20.17.2.2. Changes in  MySQL Cluster NDB 6.2.15 (5.1.23-ndb-6.2.15) (22 May 2008)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-23-ndb-6-2-14">20.17.2.3. Changes in  MySQL Cluster NDB 6.2.14 (5.1.23-ndb-6.2.14) (05 March 2008)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-23-ndb-6-2-13">20.17.2.4. Changes in  MySQL Cluster NDB 6.2.13 (5.1.23-ndb-6.2.13) (22 February 2008)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-23-ndb-6-2-12">20.17.2.5. Changes in  MySQL Cluster NDB 6.2.12 (5.1.23-ndb-6.2.12) (12 February 2008)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-23-ndb-6-2-11">20.17.2.6. Changes in  MySQL Cluster NDB 6.2.11 (5.1.23-ndb-6.2.11) (28 January 2008)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-23-ndb-6-2-10">20.17.2.7. Changes in  MySQL Cluster NDB 6.2.10 (5.1.23-ndb-6.2.10) (19 December 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-22-ndb-6-2-9">20.17.2.8. Changes in  MySQL Cluster NDB 6.2.9 (5.1.22-ndb-6.2.9) (22 November 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-22-ndb-6-2-8">20.17.2.9. Changes in  MySQL Cluster NDB 6.2.8 (5.1.22-ndb-6.2.8) (08 November 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-22-ndb-6-2-7">20.17.2.10. Changes in  MySQL Cluster NDB 6.2.7 (5.1.22-ndb-6.2.7) (10 October 2008)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-22-ndb-6-2-6">20.17.2.11. Changes in  MySQL Cluster NDB 6.2.6 (5.1.22-ndb-6.2.6) (20 September 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-22-ndb-6-2-5">20.17.2.12. Changes in  MySQL Cluster NDB 6.2.5 (5.1.22-ndb-6.2.5) (06 September 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-19-ndb-6-2-4">20.17.2.13. Changes in  MySQL Cluster NDB 6.2.4 (5.1.19-ndb-6.2.4) (04 July 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-19-ndb-6-2-3">20.17.2.14. Changes in  MySQL Cluster NDB 6.2.3 (5.1.19-ndb-6.2.3) (02 July 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-18-ndb-6-2-2">20.17.2.15. Changes in  MySQL Cluster NDB 6.2.2 (5.1.18-ndb-6.2.2) (07 May 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-18-ndb-6-2-1">20.17.2.16. Changes in  MySQL Cluster NDB 6.2.1 (5.1.18-ndb-6.2.1) (30 April 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-16-ndb-6-2-0">20.17.2.17. Changes in  MySQL Cluster NDB 6.2.0 (5.1.16-ndb-6.2.0) (03 March 2007)</a></span></dt></dl></div><p>
      This section contains change history information for MySQL Cluster
      releases based on version 6.2 of the <code class="literal">NDBCLUSTER</code>
      storage engine.
    </p><p>
      For an overview of new features added in MySQL Cluster NDB 6.2,
      see <a href="mysql-cluster.html#mysql-cluster-changes-5-1-ndb-6-2" title="20.15.3. Features Added in MySQL Cluster NDB 6.2">Section 20.15.3, “Features Added in MySQL Cluster NDB 6.2”</a>.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-24-ndb-6-2-16"></a>20.17.2.1. Changes in  MySQL Cluster NDB 6.2.16 (5.1.24-ndb-6.2.16) (Not yet released)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.2 release.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.2. </b>
          You can download the latest MySQL Cluster NDB 6.2 source code
          and binaries for supported platforms from
          http://dev.mysql.com/downloads/cluster.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.2 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.24 (see <a href="news.html#news-5-1-24" title="C.1.6. Changes in  MySQL 5.1.24 (08 April 2008)">Section C.1.6, “Changes in  MySQL 5.1.24 (08 April 2008)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Event buffer lag reports are now written to the cluster log.
       (<a href="http://bugs.mysql.com/37427" target="_top">Bug#37427</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Added the <code class="option">--no-binlog</code> option for
        <span><strong class="command">ndb_restore</strong></span>. When used, this option prevents
        information being written to SQL node binary logs from the
        restoration of a cluster backup.
       (<a href="http://bugs.mysql.com/30452" target="_top">Bug#30452</a>)</p></li><li><p>
        The <span><strong class="command">ndbd</strong></span> and <span><strong class="command">ndb_mgmd</strong></span>
        manpages have been reclassified from volume 1 to volume 8.
       (<a href="http://bugs.mysql.com/34642" target="_top">Bug#34642</a>)</p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Disk Data</strong></span>: <span class="bold"><strong>Important Change</strong></span>: 
        It is no longer possible on 32-bit systems to issue statements
        appearing to create Disk Data log files or data files greater
        than 4 GB in size. (Trying to create log files or data files
        larger than 4 GB on 32-bit systems led to unrecoverable data
        node failures; such statements now fail with
        <code class="literal">NDB</code> error 1515.)
       (<a href="http://bugs.mysql.com/29186" target="_top">Bug#29186</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: <span class="bold"><strong>MySQL Cluster</strong></span>: 
        Changing the system time on data nodes could cause MGM API
        applications to hang and the data nodes to crash.
       (<a href="http://bugs.mysql.com/35607" target="_top">Bug#35607</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        In certain rare situations, <code class="filename">ndb_size.pl</code>
        could fail with the error <span class="errortext">Can't use string
        ("<em class="replaceable"><code>value</code></em>") as a HASH ref while "strict
        refs" in use</span>.
       (<a href="http://bugs.mysql.com/43022" target="_top">Bug#43022</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Failure of a data node could sometimes cause mysqld to crash.
       (<a href="http://bugs.mysql.com/37628" target="_top">Bug#37628</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        If subscription was terminated while a node was down, the epoch
        was not properly acknowledged by that node.
       (<a href="http://bugs.mysql.com/37442" target="_top">Bug#37442</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        In rare circumstances, a connection followed by a disconnection
        could give rise to a “<span class="quote">stale</span>” connection where the
        connection still existed but was not seen by the transporter.
       (<a href="http://bugs.mysql.com/37338" target="_top">Bug#37338</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Under some circumstances, a failed <code class="literal">CREATE
        TABLE</code> could mean that subsequent <code class="literal">CREATE
        TABLE</code> statements caused node failures.
       (<a href="http://bugs.mysql.com/37092" target="_top">Bug#37092</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A fail attempt to create an <code class="literal">NDB</code> table could
        in some cases lead to resource leaks or cluster failures.
       (<a href="http://bugs.mysql.com/37072" target="_top">Bug#37072</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Checking of API node connections was not efficiently handled.
       (<a href="http://bugs.mysql.com/36843" target="_top">Bug#36843</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Attempting to delete a non-existent row from a table containing
        a <code class="literal">TEXT</code> or <code class="literal">BLOB</code> column
        within a transaction caused the transaction to fail.
       (<a href="http://bugs.mysql.com/36756" target="_top">Bug#36756</a>)</p><p>See also <a href="http://bugs.mysql.com/36851" target="_top">Bug#36851</a></p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Queries against <code class="literal">NDBCLUSTER</code> tables were cached
        only if <code class="literal">AUTOCOMMIT</code> was in use.
       (<a href="http://bugs.mysql.com/36692" target="_top">Bug#36692</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">SET GLOBAL ndb_extra_logging</code> caused
        <span><strong class="command">mysqld</strong></span> to crash.
       (<a href="http://bugs.mysql.com/36547" target="_top">Bug#36547</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        If the combined total of tables and indexes in the cluster was
        greater than 4096, issuing <code class="literal">START BACKUP</code>
        caused data nodes to fail.
       (<a href="http://bugs.mysql.com/36044" target="_top">Bug#36044</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When more than one SQL node connected to the cluster at the same
        time, creation of the <code class="literal">mysql.ndb_schema</code> table
        failed on one of them with an explicit <span class="errortext">Table
        exists</span> error, which was not necessary.
       (<a href="http://bugs.mysql.com/35943" target="_top">Bug#35943</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <span><strong class="command">mysqld</strong></span> failed to start after running
        <span><strong class="command">mysql_upgrade</strong></span>.
       (<a href="http://bugs.mysql.com/35708" target="_top">Bug#35708</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        If an error occured while executing a statement involving a
        <code class="literal">BLOB</code> or <code class="literal">TEXT</code> column of an
        <code class="literal">NDB</code> table, a memory leak could result.
       (<a href="http://bugs.mysql.com/35593" target="_top">Bug#35593</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        It was not possible to determine the value used for the
        <code class="option">--ndb-cluster-connection-pool</code> option in the
        <span><strong class="command">mysql</strong></span> client. Now this value is reported as a
        system status variable.
       (<a href="http://bugs.mysql.com/35573" target="_top">Bug#35573</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The <span><strong class="command">ndb_waiter</strong></span> utility wrongly calculated
        timeouts.
       (<a href="http://bugs.mysql.com/35435" target="_top">Bug#35435</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Where column values to be compared in a query were of the
        <code class="literal">VARCHAR</code> or <code class="literal">VARBINARY</code>
        types, <code class="literal">NDBCLUSTER</code> passed a value padded to
        the full size of the column, which caused unnecessary data to be
        sent to the data nodes. This also had the effect of wasting CPU
        and network bandwidth, and causing condition pushdown to be
        disabled where it could (and should) otherwise have been
        applied.
       (<a href="http://bugs.mysql.com/35393" target="_top">Bug#35393</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <span><strong class="command">ndb_restore</strong></span> incorrectly handled some
        datatypes when applying log files from backups.
       (<a href="http://bugs.mysql.com/35343" target="_top">Bug#35343</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        In some circumstances, a stopped data node was handled
        incorrectly, leading to redo log space being exhausted following
        an initial restart of the node, or an initial or partial restart
        of the cluster (the wrong CGI might be used in such cases). This
        could happen, for example, when a node was stopped following the
        creation of a new table, but before a new LCP could be executed.
       (<a href="http://bugs.mysql.com/35241" target="_top">Bug#35241</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">SELECT ... LIKE ...</code> queries yielded incorrect
        results when used on <code class="literal">NDB</code> tables. As part of
        this fix, condition pushdown of such queries has been disabled;
        re-enabling it is expected to be done as part of a later,
        permanent fix for this issue.
       (<a href="http://bugs.mysql.com/35185" target="_top">Bug#35185</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <span><strong class="command">ndb_mgmd</strong></span> reported errors to
        <code class="literal">STDOUT</code> rather than to
        <code class="literal">STDERR</code>.
       (<a href="http://bugs.mysql.com/35169" target="_top">Bug#35169</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Nested multi-range reads failed when the second multi-range read
        released the first read's unprocessed operations, sometimes
        leading to an SQL node crash.
       (<a href="http://bugs.mysql.com/35137" target="_top">Bug#35137</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        In some situations, a problem with synchronizing checkpoints
        between nodes could cause a system restart or a node restart to
        fail with <span class="errortext">Error 630 during restore of TX</span>.
       (<a href="http://bugs.mysql.com/34756" target="_top">Bug#34756</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When a secondary index on a <code class="literal">DECIMAL</code> column
        was used to retrieve data from an <code class="literal">NDB</code> table,
        no results were returned even if the target table had a matched
        value in the column that was defined with the secondary index.
       (<a href="http://bugs.mysql.com/34515" target="_top">Bug#34515</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        An <code class="literal">UPDATE</code> on an <code class="literal">NDB</code> table
        that set a new value for a unique key column could cause
        subsequent queries to fail.
       (<a href="http://bugs.mysql.com/34208" target="_top">Bug#34208</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        If a data node in one node group was placed in the “<span class="quote">not
        started</span>” state (using
        <code class="literal"><em class="replaceable"><code>node_id</code></em> RESTART
        -n</code>), it was not possible to stop a data node in a
        different node group.
       (<a href="http://bugs.mysql.com/34201" target="_top">Bug#34201</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When configured with <code class="literal">NDB</code> support, MySQL
        failed to compile on 64bit FreeBSD systems.
       (<a href="http://bugs.mysql.com/34046" target="_top">Bug#34046</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Numerous <code class="literal">NDBCLUSTER</code> test failures occurred in
        builds compiled using <span><strong class="command">icc</strong></span> on IA64 platforms.
       (<a href="http://bugs.mysql.com/31239" target="_top">Bug#31239</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">CREATE TABLE</code> and <code class="literal">ALTER
        TABLE</code> statements using <code class="literal">ENGINE=NDB</code>
        or <code class="literal">ENGINE=NDBCLUSTER</code> caused
        <span><strong class="command">mysqld</strong></span> to fail on Solaris 10 for x86
        platforms.
       (<a href="http://bugs.mysql.com/19911" target="_top">Bug#19911</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        If an API node disconnected and then reconnected during Start
        Phase 8, then the connection could be “<span class="quote">blocked</span>”
        — that is, the <code class="literal">QMGR</code> kernel block failed
        to detect that the API node was in fact connected to the
        cluster, causing issues with the <code class="literal">NDB</code>
        Subscription Manager (<code class="literal">SUMA</code>).
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">NDB</code> error 1427 (<span class="errortext">Api node died,
        when SUB_START_REQ reached node</span>) was incorrectly
        classified as a schema error rather than a temporary error.
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When dropping a table failed for any reason (such as when in
        single user mode) then the corresponding
        <code class="filename">.ndb</code> file was still removed.
      </p></li><li><p><span class="bold"><strong>Replication</strong></span>: 
        When flushing tables, there was a slight chance that the flush
        occurred between the processing of one table map event and the
        next. Since the tables were opened one by one, subsequent
        locking of tables would cause the slave to crash. This problem
        was observed when replicating <code class="literal">NDBCLUSTER</code> or
        <code class="literal">InnoDB</code> tables, when executing multi-table
        updates, and when a trigger or a stored routine performed an
        (additional) insert on a table so that two tables were
        effectively being inserted into in the same statement.
       (<a href="http://bugs.mysql.com/36197" target="_top">Bug#36197</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Performing <code class="literal">SELECT ... FROM
        mysql.ndb_apply_status</code> before the
        <span><strong class="command">mysqld</strong></span> process had connected to the cluster
        failed, and caused this table never to be created.
       (<a href="http://bugs.mysql.com/36123" target="_top">Bug#36123</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        In some cases, when updating only one or some columns in a
        table, the complete row was written to the binary log instead of
        only the updated column or columns, even when
        <code class="literal">ndb_log_updated_only</code> was set to 1.
       (<a href="http://bugs.mysql.com/35208" target="_top">Bug#35208</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Creating a table on an SQL node, then starting an NDB API
        application that listened for events from this table, then
        dropping the table from an SQL node, prevented data node
        restarts.
       (<a href="http://bugs.mysql.com/37279" target="_top">Bug#37279</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        When some operations succeeded and some failed following a call
        to <code class="literal">NdbTransaction::execute(Commit,
        AO_IgnoreOnError)</code>, a race condition could cause
        spurious occurrences of NDB API Error 4011 (<span class="errortext">Internal
        error</span>).
       (<a href="http://bugs.mysql.com/37158" target="_top">Bug#37158</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Ordered index scans were not pruned correctly where a
        partitioning key was specified with an EQ-bound.
       (<a href="http://bugs.mysql.com/36950" target="_top">Bug#36950</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        When an insert operation involving <code class="literal">BLOB</code> data
        was attempted on a row which already existed, no duplicate key
        error was correctly reported and the transaction is incorrectly
        aborted. In some cases, the existing row could also become
        corrupted.
       (<a href="http://bugs.mysql.com/36851" target="_top">Bug#36851</a>)</p><p>See also <a href="http://bugs.mysql.com/26756" target="_top">Bug#26756</a></p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        <code class="filename">NdbApi.hpp</code> depended on
        <code class="filename">ndb_global.h</code>, which was not actually
        installed, causing the compilation of programs that used
        <code class="filename">NdbApi.hpp</code> to fail.
       (<a href="http://bugs.mysql.com/35853" target="_top">Bug#35853</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Attempting to pass a nonexistent column name to the
        <code class="literal">equal()</code> and <code class="literal">setValue()</code>
        methods of <code class="literal">NdbOperation</code> caused NDB API
        applications to crash. Now the column name is checked, and an
        error is returned in the event that the column is not found.
       (<a href="http://bugs.mysql.com/33747" target="_top">Bug#33747</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        A buffer overrun in <code class="literal">NdbBlob::setValue()</code>
        caused erroneous results on Mac OS X.
       (<a href="http://bugs.mysql.com/31284" target="_top">Bug#31284</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Relocation errors were encountered when trying to compile NDB
        API applications on a number of platforms, including 64-bit
        Linux. As a result, <code class="literal">libmysys</code>,
        <code class="literal">libmystrings</code>, and <code class="literal">libdbug</code>
        have been changed from normal libraries to “<span class="quote">noinst</span>”
        <span><strong class="command">libtool</strong></span> helper libraries. They are no longer
        installed as separate libraries; instead, all necessary symbols
        from these are added directly to
        <code class="literal">libndbclient</code>. This means that NDB API
        programs now need to be linked only using
        <code class="option">-lndbclient</code>.
       (<a href="http://bugs.mysql.com/29791" target="_top">Bug#29791</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-23-ndb-6-2-15"></a>20.17.2.2. Changes in  MySQL Cluster NDB 6.2.15 (5.1.23-ndb-6.2.15) (22 May 2008)</h4></div></div></div><p class="release-level">
        This is re-release of MySQL Cluster NDB 6.2.14 providing
        binaries for supported platforms. For more information, see
        <a href="mysql-cluster.html#mysql-cluster-news-5-1-23-ndb-6-2-14" title="20.17.2.3. Changes in  MySQL Cluster NDB 6.2.14 (5.1.23-ndb-6.2.14) (05 March 2008)">Section 20.17.2.3, “Changes in  MySQL Cluster NDB 6.2.14 (5.1.23-ndb-6.2.14) (05 March 2008)”</a>.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.2. </b>
          You can download the latest MySQL Cluster NDB 6.2 source code
          and binaries for supported platforms from
          http://dev.mysql.com/downloads/cluster.
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-23-ndb-6-2-14"></a>20.17.2.3. Changes in  MySQL Cluster NDB 6.2.14 (5.1.23-ndb-6.2.14) (05 March 2008)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.2 release.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.2. </b>
          You can download the latest MySQL Cluster NDB 6.2 source code
          and binaries for supported platforms from
          http://dev.mysql.com/downloads/cluster.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.2 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.23 (see <a href="news.html#news-5-1-23" title="C.1.7. Changes in  MySQL 5.1.23 (29 January 2008)">Section C.1.7, “Changes in  MySQL 5.1.23 (29 January 2008)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Added the <code class="literal">MaxBufferedEpochs</code> data node
        configuration parameter, which controls the maximum number of
        unprocessed epochs by which a subscribing node can lag.
        Subscribers which exceed this number are disconnected and forced
        to reconnect.
      </p><p>
        See <a href="mysql-cluster.html#mysql-cluster-ndbd-definition" title="20.3.4.5. Defining Data Nodes">Section 20.3.4.5, “Defining Data Nodes”</a>, for more
        information.
      </p></li><li><p><span class="bold"><strong>Replication</strong></span>: 
        Introduced the <code class="literal">slave_exec_mode</code> system
        variable to control whether idempotent or strict mode is used
        for replication conflict resolution. Idempotent mode suppresses
        duplicate-key, no-key-found, and some other errors, and is
        needed for circular replication, multi-master replication, and
        some other complex replication setups when using MySQL Cluster.
        Strict mode is the default.
       (<a href="http://bugs.mysql.com/31609" target="_top">Bug#31609</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        <code class="literal">RESET MASTER</code> now uses
        <code class="literal">TRUNCATE</code> rather than
        <code class="literal">DELETE</code> to clear the
        <code class="literal">mysql.ndb_binlog_index</code> table. This improves
        the performance of the statement and is less likely to leave the
        table in a fragmented state.
       (<a href="http://bugs.mysql.com/34356" target="_top">Bug#34356</a>)</p></li><li><p>
        Formerly, when the MySQL server crashed, the generated stack
        dump was numeric and required external tools to properly resolve
        the names of functions. This is not very helpful to users having
        a limited knowledge of debugging techniques. In addition, the
        generated stack trace contained only the names of functions and
        was formatted differently for each platform due to different
        stack layouts.
      </p><p>
        Now it is possible to take advantage of newer versions of the
        GNU C Library provide a set of functions to obtain and
        manipulate stack traces from within the program. On systems that
        use the ELF binary format, the stack trace contains important
        information such as the shared object where the call was
        generated, an offset into the function, and the actual return
        address. Having the function name also makes possible the name
        demangling of C++ functions.
      </p><p>
        The library generates meaningful stack traces on the following
        platforms: i386, x86_64, PowerPC, IA64, Alpha, and S390. On
        other platforms, a numeric stack trace is still produced, and
        the use of the <span><strong class="command">resolve_stack_dump</strong></span> utility is
        still required.
       (<a href="http://bugs.mysql.com/31891" target="_top">Bug#31891</a>)</p></li><li><p>
        <span><strong class="command">mysqltest</strong></span> now has <code class="literal">mkdir</code>
        and <code class="literal">rmdir</code> commands for creating and removing
        directories.
       (<a href="http://bugs.mysql.com/31004" target="_top">Bug#31004</a>)</p></li><li><p>
        Added the <code class="literal">Uptime_since_flush_status</code> status
        variable, which indicates the number of seconds since the most
        recent <code class="literal">FLUSH STATUS</code> statement. (From Jeremy
        Cole)
       (<a href="http://bugs.mysql.com/24822" target="_top">Bug#24822</a>)</p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Important Change</strong></span>: <span class="bold"><strong>Replication</strong></span>: 
        When the master crashed during an update on a transactional
        table while in <code class="literal">AUTOCOMMIT</code> mode, the slave
        failed. This fix causes every transaction (including
        <code class="literal">AUTOCOMMIT</code> transactions) to be recorded in
        the binlog as starting with a <code class="literal">BEGIN</code> and
        ending with a <code class="literal">COMMIT</code> or
        <code class="literal">ROLLBACK</code>.
       (<a href="http://bugs.mysql.com/26395" target="_top">Bug#26395</a>)</p></li><li><p><span class="bold"><strong>Replication</strong></span>: <span class="bold"><strong>Important Note</strong></span>: 
        Network timeouts between the master and the slave could result
        in corruption of the relay log. This fix rectifies a
        long-standing replication issue when using unreliable networks,
        including replication over wide area networks such as the
        Internet. If you experience reliability issues and see many
        <span class="errortext">You have an error in your SQL syntax</span>
        errors on replication slaves, we strongly recommend that you
        upgrade to a MySQL version which includes this fix.
       (<a href="http://bugs.mysql.com/26489" target="_top">Bug#26489</a>)</p></li><li><p><span class="bold"><strong>Replication</strong></span>: 
        When the Windows version of <span><strong class="command">mysqlbinlog</strong></span> read
        4.1 binlogs containing <code class="literal">LOAD DATA INFILE</code>
        statements, it output backslashes as path separators, causing
        problems for client programs expecting forward slashes. In such
        cases, it now converts <code class="literal">\\</code> to
        <code class="literal">/</code> in directory paths.
       (<a href="http://bugs.mysql.com/34355" target="_top">Bug#34355</a>)</p></li><li><p><span class="bold"><strong>Replication</strong></span>: 
        <code class="literal">SHOW SLAVE STATUS</code> failed when slave I/O was
        about to terminate.
       (<a href="http://bugs.mysql.com/34305" target="_top">Bug#34305</a>)</p></li><li><p><span class="bold"><strong>Replication</strong></span>: 
        <span><strong class="command">mysqlbinlog</strong></span> from a 5.1 or later MySQL
        distribution could not read binary logs generated by a 4.1
        server when the logs contained <code class="literal">LOAD DATA
        INFILE</code> statements.
       (<a href="http://bugs.mysql.com/34141" target="_top">Bug#34141</a>)</p><p>This regression was introduced by <a href="http://bugs.mysql.com/32407" target="_top">Bug#32407</a></p></li><li><p><span class="bold"><strong>Replication</strong></span>: 
        A <code class="literal">CREATE USER</code>, <code class="literal">DROP USER</code>,
        or <code class="literal">RENAME USER</code> statement that fails on the
        master, or that is a duplicate of any of these statements, is no
        longer written to the binlog; previously, either of these
        occurrences could cause the slave to fail.
      </p><p> (<a href="http://bugs.mysql.com/33862" target="_top">Bug#33862</a>)</p><p>See also <a href="http://bugs.mysql.com/29749" target="_top">Bug#29749</a></p></li><li><p><span class="bold"><strong>Replication</strong></span>: 
        <span><strong class="command">mysqlbinlog</strong></span> failed to release all of its
        memory after terminating abnormally.
       (<a href="http://bugs.mysql.com/33247" target="_top">Bug#33247</a>)</p></li><li><p><span class="bold"><strong>Replication</strong></span>: 
        The error message generated due to lack of a default value for
        an extra column was not sufficiently informative.
       (<a href="http://bugs.mysql.com/32971" target="_top">Bug#32971</a>)</p></li><li><p><span class="bold"><strong>Replication</strong></span>: 
        When a user variable was used inside an
        <code class="literal">INSERT</code> statement, the corresponding binlog
        event was not written to the binlog correctly.
       (<a href="http://bugs.mysql.com/32580" target="_top">Bug#32580</a>)</p></li><li><p><span class="bold"><strong>Replication</strong></span>: 
        When using row-based replication, deletes from a table with a
        foreign key constraint failed on the slave.
       (<a href="http://bugs.mysql.com/32468" target="_top">Bug#32468</a>)</p></li><li><p><span class="bold"><strong>Replication</strong></span>: 
        SQL statements containing comments using <code class="literal">--</code>
        syntax were not replayable by <span><strong class="command">mysqlbinlog</strong></span>,
        even though such statements replicated correctly.
       (<a href="http://bugs.mysql.com/32205" target="_top">Bug#32205</a>)</p></li><li><p><span class="bold"><strong>Replication</strong></span>: 
        When using row-based replication from a master running MySQL
        5.1.21 or earlier to a slave running 5.1.22 or later, updates of
        integer columns failed on the slave with <span class="errortext">Error in
        Unknown event: row application failed</span>.
       (<a href="http://bugs.mysql.com/31583" target="_top">Bug#31583</a>)</p><p>This regression was introduced by <a href="http://bugs.mysql.com/21842" target="_top">Bug#21842</a></p></li><li><p><span class="bold"><strong>Replication</strong></span>: 
        Replicating write, update, or delete events from a master
        running MySQL 5.1.15 or earlier to a slave running 5.1.16 or
        later caused the slave to crash.
       (<a href="http://bugs.mysql.com/31581" target="_top">Bug#31581</a>)</p></li><li><p><span class="bold"><strong>Replication</strong></span>: 
        When using row-based replication, the slave stopped when
        attempting to delete non-existent rows from a slave table
        without a primary key. In addition, no error was reported when
        this occurred.
       (<a href="http://bugs.mysql.com/31552" target="_top">Bug#31552</a>)</p></li><li><p><span class="bold"><strong>Replication</strong></span>: 
        Issuing a <code class="literal">DROP VIEW</code> statement caused
        replication to fail if the view did not actually exist.
       (<a href="http://bugs.mysql.com/30998" target="_top">Bug#30998</a>)</p></li><li><p><span class="bold"><strong>Replication</strong></span>: 
        Setting <code class="literal">server_id</code> did not update its value
        for the current session.
       (<a href="http://bugs.mysql.com/28908" target="_top">Bug#28908</a>)</p></li><li><p><span class="bold"><strong>Replication</strong></span>: 
        Some older servers wrote events to the binary log using
        different numbering from what is currently used, even though the
        file format number in the file is the same. Slaves running MySQL
        5.1.18 and later could not read these binary logs properly.
        Binary logs from these older versions now are recognized and
        event numbers are mapped to the current numbering so that they
        can be interpreted properly.
       (<a href="http://bugs.mysql.com/27779" target="_top">Bug#27779</a>, <a href="http://bugs.mysql.com/32434" target="_top">Bug#32434</a>)</p><p>This regression was introduced by <a href="http://bugs.mysql.com/22583" target="_top">Bug#22583</a></p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        The <code class="option">--ndb-wait-connected</code> option caused the
        server to wait for a partial connection plus an additional 3
        seconds for a complete connection to the cluster. This could
        lead to issues with setting up the binary log.
       (<a href="http://bugs.mysql.com/34757" target="_top">Bug#34757</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Closing a scan before it was executed caused the application to
        segfault.
       (<a href="http://bugs.mysql.com/36375" target="_top">Bug#36375</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Using NDB API applications from older MySQL Cluster versions
        with <code class="literal">libndbclient</code> from newer ones caused the
        cluster to fail.
       (<a href="http://bugs.mysql.com/36124" target="_top">Bug#36124</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Scans having no bounds set were handled incorrectly.
       (<a href="http://bugs.mysql.com/35876" target="_top">Bug#35876</a>)</p></li><li><p>
        Use of stored functions in the <code class="literal">WHERE</code> clause
        for <code class="literal">SHOW OPEN TABLES</code> caused a server crash.
       (<a href="http://bugs.mysql.com/34166" target="_top">Bug#34166</a>)</p></li><li><p>
        Large unsigned integers were improperly handled for prepared
        statements, resulting in truncation or conversion to negative
        numbers.
       (<a href="http://bugs.mysql.com/33798" target="_top">Bug#33798</a>)</p></li><li><p>
        The server crashed when executing a query that had a subquery
        containing an equality X=Y where Y referred to a named select
        list expression from the parent select. The server crashed when
        trying to use the X=Y equality for <code class="literal">ref</code>-based
        access.
       (<a href="http://bugs.mysql.com/33794" target="_top">Bug#33794</a>)</p></li><li><p>
        The UPDATE statement allowed <code class="literal">NULL</code> to be
        assigned to <code class="literal">NOT NULL</code> columns (the default
        data type value was assigned). An error occurs now.
       (<a href="http://bugs.mysql.com/33699" target="_top">Bug#33699</a>)</p></li><li><p>
        <code class="literal">ORDER BY ... DESC</code> sorts could produce
        misordered results.
       (<a href="http://bugs.mysql.com/33697" target="_top">Bug#33697</a>)</p></li><li><p>
        The server could crash when <code class="literal">REPEAT</code> or another
        control instruction was used in conjunction with labels and a
        <code class="literal">LEAVE</code> instruction.
       (<a href="http://bugs.mysql.com/33618" target="_top">Bug#33618</a>)</p></li><li><p>
        <code class="literal">SET GLOBAL myisam_max_sort_file_size=DEFAULT</code>
        set <code class="literal">myisam_max_sort_file_size</code> to an incorrect
        value.
       (<a href="http://bugs.mysql.com/33382" target="_top">Bug#33382</a>)</p><p>See also <a href="http://bugs.mysql.com/31177" target="_top">Bug#31177</a></p></li><li><p>
        Granting the <code class="literal">UPDATE</code> privilege on one column
        of a view caused the server to crash.
       (<a href="http://bugs.mysql.com/33201" target="_top">Bug#33201</a>)</p></li><li><p>
        For <code class="literal">DECIMAL</code> columns used with the
        <a href="functions.html#function_round"><code class="literal">ROUND(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>D</code></em>)</code></a>
        or
        <a href="functions.html#function_truncate"><code class="literal">TRUNCATE(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>D</code></em>)</code></a>
        function with a non-constant value of
        <em class="replaceable"><code>D</code></em>, adding an <code class="literal">ORDER
        BY</code> for the function result produced misordered output.
       (<a href="http://bugs.mysql.com/33143" target="_top">Bug#33143</a>)</p><p>See also <a href="http://bugs.mysql.com/33402" target="_top">Bug#33402</a>, <a href="http://bugs.mysql.com/30617" target="_top">Bug#30617</a></p></li><li><p>
        The <code class="literal">SHOW ENGINE INNODB STATUS</code> and
        <code class="literal">SHOW ENGINE INNODB MUTEX</code> statements
        incorrectly required the <code class="literal">SUPER</code> privilege
        rather than the <code class="literal">PROCESS</code> privilege.
       (<a href="http://bugs.mysql.com/32710" target="_top">Bug#32710</a>)</p></li><li><p>
        Tables in the <code class="literal">mysql</code> database that stored the
        current <code class="literal">sql_mode</code> value as part of stored
        program definitions were not updated with newer mode values
        (<code class="literal">NO_ENGINE_SUBSTITUTION</code>,
        <code class="literal">PAD_CHAR_TO_FULL_LENGTH</code>). This causes various
        problems defining stored programs if those modes were included
        in the current <code class="literal">sql_mode</code> value.
       (<a href="http://bugs.mysql.com/32633" target="_top">Bug#32633</a>)</p></li><li><p>
        <a href="functions.html#function_round"><code class="literal">ROUND(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>D</code></em>)</code></a>
        or
        <a href="functions.html#function_truncate"><code class="literal">TRUNCATE(<em class="replaceable"><code>X</code></em>,<em class="replaceable"><code>D</code></em>)</code></a>
        for non-constant values of <em class="replaceable"><code>D</code></em> could
        crash the server if these functions were used in an
        <code class="literal">ORDER BY</code> that was resolved using
        <code class="literal">filesort</code>.
       (<a href="http://bugs.mysql.com/30889" target="_top">Bug#30889</a>)</p></li><li><p>
        Resetting the query cache by issuing a <code class="literal">SET GLOBAL
        query_cache_size=0</code> statement caused the server to
        crash if it concurrently was saving a new result set to the
        query cache.
       (<a href="http://bugs.mysql.com/30887" target="_top">Bug#30887</a>)</p></li><li><p>
        Replication of <code class="literal">LOAD DATA INFILE</code> could fail
        when <code class="literal">read_buffer_size</code> was larger than
        <code class="literal">max_allowed_packet</code>.
       (<a href="http://bugs.mysql.com/30435" target="_top">Bug#30435</a>)</p></li><li><p>
        The <code class="literal">Table_locks_waited</code> waited variable was
        not incremented in the cases that a lock had to be waited for
        but the waiting thread was killed or the request was aborted.
       (<a href="http://bugs.mysql.com/30331" target="_top">Bug#30331</a>)</p></li><li><p>
        The <code class="literal">Com_create_function</code> status variable was
        not incremented properly.
       (<a href="http://bugs.mysql.com/30252" target="_top">Bug#30252</a>)</p></li><li><p>
        <span><strong class="command">mysqld</strong></span> displayed the
        <code class="option">--enable-pstack</code> option in its help message even
        if MySQL was configured without <code class="option">--with-pstack</code>.
       (<a href="http://bugs.mysql.com/29836" target="_top">Bug#29836</a>)</p></li><li><p>
        Replication crashed with the <code class="literal">NDB</code> storage
        engine when <span><strong class="command">mysqld</strong></span> was started with
        <code class="option">--character-set-server=ucs2</code>.
       (<a href="http://bugs.mysql.com/29562" target="_top">Bug#29562</a>)</p></li><li><p>
        Views were treated as insertable even if some base table columns
        with no default value were omitted from the view definition.
        (This is contrary to the condition for insertability that a view
        must contain all columns in the base table that do not have a
        default value.)
       (<a href="http://bugs.mysql.com/29477" target="_top">Bug#29477</a>)</p></li><li><p>
        Previously, the parser accepted the ODBC <code class="literal">{ OJ ... LEFT
        OUTER JOIN ...}</code> syntax for writing left outer joins.
        The parser now allows <code class="literal">{ OJ ... }</code> to be used
        to write other types of joins, such as <code class="literal">INNER
        JOIN</code> or <code class="literal">RIGHT OUTER JOIN</code>. This
        helps with compatibility with some third-party applications, but
        is not official ODBC syntax.
       (<a href="http://bugs.mysql.com/28317" target="_top">Bug#28317</a>)</p></li><li><p>
        The parser rules for the <code class="literal">SHOW PROFILE</code>
        statement were revised to work with older versions of
        <span><strong class="command">bison</strong></span>.
       (<a href="http://bugs.mysql.com/27433" target="_top">Bug#27433</a>)</p></li><li><p>
        <span><strong class="command">resolveip</strong></span> failed to produce correct results
        for hostnames that begin with a digit.
       (<a href="http://bugs.mysql.com/27427" target="_top">Bug#27427</a>)</p></li><li><p>
        <span><strong class="command">mysqlcheck -A -r</strong></span> did not correctly identify
        all tables that needed repairing.
       (<a href="http://bugs.mysql.com/25347" target="_top">Bug#25347</a>)</p></li><li><p>
        <code class="literal">InnoDB</code> exhibited thread thrashing with more
        than 50 concurrent connections under an update-intensive
        workload.
       (<a href="http://bugs.mysql.com/22868" target="_top">Bug#22868</a>)</p></li><li><p>
        Warnings for deprecated syntax constructs used in stored
        routines make sense to report only when the routine is being
        created, but they were also being reported when the routine was
        parsed for loading into the execution cache. Now they are
        reported only at routine creation time.
       (<a href="http://bugs.mysql.com/21801" target="_top">Bug#21801</a>)</p></li><li><p>
        <code class="literal">CREATE ... SELECT</code> did not always set
        <code class="literal">DEFAULT</code> column values in the new table.
       (<a href="http://bugs.mysql.com/21380" target="_top">Bug#21380</a>)</p></li><li><p>
        If a <code class="literal">SELECT</code> calls a stored function in a
        transaction, and a statement within the function fails, that
        statement should roll back. Furthermore, if
        <code class="literal">ROLLBACK</code> is executed after that, the entire
        transaction should be rolled back. Before this fix, the failed
        statement did not roll back when it failed (even though it might
        ultimately get rolled back by a <code class="literal">ROLLBACK</code>
        later that rolls back the entire transaction).
       (<a href="http://bugs.mysql.com/12713" target="_top">Bug#12713</a>)</p><p>See also <a href="http://bugs.mysql.com/34655" target="_top">Bug#34655</a></p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-23-ndb-6-2-13"></a>20.17.2.4. Changes in  MySQL Cluster NDB 6.2.13 (5.1.23-ndb-6.2.13) (22 February 2008)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.2 release.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.2. </b>
          You can download the latest MySQL Cluster NDB 6.2 source code
          and binaries for supported platforms from
          http://dev.mysql.com/downloads/cluster.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.2 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.23 (see <a href="news.html#news-5-1-23" title="C.1.7. Changes in  MySQL 5.1.23 (29 January 2008)">Section C.1.7, “Changes in  MySQL 5.1.23 (29 January 2008)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A node failure during an initial node restart followed by
        another node start could cause the master data node to fail,
        because it incorrectly gave the node permission to start even if
        the invalidated node's LCP was still running.
       (<a href="http://bugs.mysql.com/34702" target="_top">Bug#34702</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-23-ndb-6-2-12"></a>20.17.2.5. Changes in  MySQL Cluster NDB 6.2.12 (5.1.23-ndb-6.2.12) (12 February 2008)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.2 release.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.2. </b>
          You can download the latest MySQL Cluster NDB 6.2 source code
          and binaries for supported platforms from
          http://dev.mysql.com/downloads/cluster.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.2 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.23 (see <a href="news.html#news-5-1-23" title="C.1.7. Changes in  MySQL 5.1.23 (29 January 2008)">Section C.1.7, “Changes in  MySQL 5.1.23 (29 January 2008)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p>
        Beginning with this version, MySQL Cluster NDB
        6.3.<em class="replaceable"><code>x</code></em> releases once again include the
        <code class="literal">InnoDB</code> storage engine. In order to enable
        <code class="literal">InnoDB</code>, you must configure the build using
        <code class="option">--with-innodb</code>.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Upgrades of a cluster using while a
        <code class="literal">DataMemory</code> setting in excess of 16 GB caused
        data nodes to fail.
       (<a href="http://bugs.mysql.com/34378" target="_top">Bug#34378</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Performing many SQL statements on <code class="literal">NDB</code> tables
        while in <code class="literal">AUTOCOMMIT</code> mode caused a memory leak
        in <span><strong class="command">mysqld</strong></span>.
       (<a href="http://bugs.mysql.com/34275" target="_top">Bug#34275</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        In certain rare circumstances, a race condition could occur
        between an aborted insert and a delete leading a data node
        crash.
       (<a href="http://bugs.mysql.com/34260" target="_top">Bug#34260</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Multi-table updates using ordered indexes during handling of
        node failures could cause other data nodes to fail.
       (<a href="http://bugs.mysql.com/34216" target="_top">Bug#34216</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When configured with <code class="literal">NDB</code> support, MySQL
        failed to compile using <span><strong class="command">gcc</strong></span> 4.3 on 64bit
        FreeBSD systems.
       (<a href="http://bugs.mysql.com/34169" target="_top">Bug#34169</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The failure of a DDL statement could sometimes lead to node
        failures when attempting to execute subsequent DDL statements.
       (<a href="http://bugs.mysql.com/34160" target="_top">Bug#34160</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Extremely long <code class="literal">SELECT</code> statements (where the
        text of the statement was in excess of 50000 characters) against
        <code class="literal">NDB</code> tables returned empty results.
       (<a href="http://bugs.mysql.com/34107" target="_top">Bug#34107</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Statements executing multiple inserts performed poorly on
        <code class="literal">NDB</code> tables having
        <code class="literal">AUTO_INCREMENT</code> columns.
       (<a href="http://bugs.mysql.com/33534" target="_top">Bug#33534</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The <span><strong class="command">ndb_waiter</strong></span> utility polled
        <span><strong class="command">ndb_mgmd</strong></span> excessively when obtaining the
        status of cluster data nodes.
       (<a href="http://bugs.mysql.com/32025" target="_top">Bug#32025</a>)</p><p>See also <a href="http://bugs.mysql.com/32023" target="_top">Bug#32023</a></p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Transaction atomicity was sometimes not preserved between reads
        and inserts under high loads.
       (<a href="http://bugs.mysql.com/31477" target="_top">Bug#31477</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Having tables with a great many columns could cause Cluster
        backups to fail.
       (<a href="http://bugs.mysql.com/30172" target="_top">Bug#30172</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: <span class="bold"><strong>Disk Data</strong></span>: 
        Statements violating unique keys on Disk Data tables (such as
        attempting to insert <code class="literal">NULL</code> into a <code class="literal">NOT
        NULL</code> column) could cause data nodes to fail. When the
        statement was executed from the binlog, this could also result
        in failure of the slave cluster.
       (<a href="http://bugs.mysql.com/34118" target="_top">Bug#34118</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        Updating in-memory columns of one or more rows of Disk Data
        table, followed by deletion of these rows and re-insertion of
        them, caused data node failures.
       (<a href="http://bugs.mysql.com/33619" target="_top">Bug#33619</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Setting <code class="option">--replicate-ignore-db=mysql</code> caused the
        <code class="literal">mysql.ndb_apply_status</code> table not to be
        replicated, breaking Cluster Replication.
       (<a href="http://bugs.mysql.com/28170" target="_top">Bug#28170</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-23-ndb-6-2-11"></a>20.17.2.6. Changes in  MySQL Cluster NDB 6.2.11 (5.1.23-ndb-6.2.11) (28 January 2008)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.2 release.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.2. </b>
          You can download the latest MySQL Cluster NDB 6.2 source code
          and binaries for supported platforms from
          http://dev.mysql.com/downloads/cluster.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.2 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.23 (see <a href="news.html#news-5-1-23" title="C.1.7. Changes in  MySQL 5.1.23 (29 January 2008)">Section C.1.7, “Changes in  MySQL 5.1.23 (29 January 2008)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Cluster API</strong></span>: <span class="bold"><strong>Important Change</strong></span>: 
        Because <code class="literal">NDB_LE_MemoryUsage.page_size_kb</code> shows
        memory page sizes in bytes rather than kilobytes, it has been
        renamed to <code class="literal">page_size_bytes</code>. The name
        <code class="literal">page_size_kb</code> is now deprecated and thus
        subject to removal in a future release, although it currently
        remains supported for reasons of backward compatibility. See
        <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-logevent-type.html" target="_top">The <code class="literal">Ndb_logevent_type</code> Type</a>, for more information about
        <code class="literal">NDB_LE_MemoryUsage</code>.
       (<a href="http://bugs.mysql.com/30271" target="_top">Bug#30271</a>)</p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        High numbers of insert operations, delete operations, or both
        could cause <code class="literal">NDB</code> error 899 (<span class="errortext">Rowid
        already allocated</span>) to occur unnecessarily.
       (<a href="http://bugs.mysql.com/34033" target="_top">Bug#34033</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A periodic failure to flush the send buffer by the
        <code class="literal">NDB</code> TCP transporter could cause a unnecessary
        delay of 10 ms between operations.
       (<a href="http://bugs.mysql.com/34005" target="_top">Bug#34005</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A race condition could occur (very rarely) when the release of a
        GCI was followed by a data node failure.
       (<a href="http://bugs.mysql.com/33793" target="_top">Bug#33793</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Some tuple scans caused the wrong memory page to be accessed,
        leading to invalid results. This issue could affect both
        in-memory and Disk Data tables.
       (<a href="http://bugs.mysql.com/33739" target="_top">Bug#33739</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The server failed to reject properly the creation of an
        <code class="literal">NDB</code> table having an unindexed
        <code class="literal">AUTO_INCREMENT</code> column.
       (<a href="http://bugs.mysql.com/30417" target="_top">Bug#30417</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Issuing an <code class="literal">INSERT ... ON DUPLICATE KEY UPDATE</code>
        concurrently with or following a <code class="literal">TRUNCATE</code>
        statement on an <code class="literal">NDB</code> table failed with
        <code class="literal">NDB</code> error 4350 <span class="errortext">Transaction already
        aborted</span>.
       (<a href="http://bugs.mysql.com/29851" target="_top">Bug#29851</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The Cluster backup process could not detect when there was no
        more disk space and instead continued to run until killed
        manually. Now the backup fails with an appropriate error when
        disk space is exhausted.
       (<a href="http://bugs.mysql.com/28647" target="_top">Bug#28647</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        It was possible in <code class="filename">config.ini</code> to define
        cluster nodes having node IDs greater than the maximum allowed
        value.
       (<a href="http://bugs.mysql.com/28298" target="_top">Bug#28298</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        <span><strong class="command">ndb_restore -e</strong></span> restored excessively large
        values to the <code class="literal">ndb_apply_status</code> table's
        <code class="literal">epoch</code> column when restoring to a MySQL
        Cluster version supporting Micro-GCPs from an older version that
        did not support these.
      </p><p>
        A workaround when restoring to MySQL Cluster releases supporting
        micro-GCPs previous to MySQL Cluster NDB 6.3.8 is to perform a
        32-bit shift on the <code class="literal">epoch</code> column values to
        reduce them to their proper size.
       (<a href="http://bugs.mysql.com/33406" target="_top">Bug#33406</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Transactions containing inserts or reads would hang during
        <code class="literal">NdbTransaction::execute()</code> calls made from NDB
        API applications built against a MySQL Cluster version that did
        not support micro-GCPs accessing a later version that supported
        micro-GCPs. This issue was observed while upgrading from MySQL
        Cluster NDB 6.1.23 to MySQL Cluster NDB 6.2.10 when the API
        application built against the earlier version attempted to
        access a data node already running the later version, even after
        disabling micro-GCPs by setting
        <code class="literal">TimeBetweenEpochs</code> equal to 0.
       (<a href="http://bugs.mysql.com/33895" target="_top">Bug#33895</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        When reading a <code class="literal">BIT(64)</code> value using
        <code class="literal">NdbOperation:getValue()</code>, 12 bytes were
        written to the buffer rather than the expected 8 bytes.
       (<a href="http://bugs.mysql.com/33750" target="_top">Bug#33750</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-23-ndb-6-2-10"></a>20.17.2.7. Changes in  MySQL Cluster NDB 6.2.10 (5.1.23-ndb-6.2.10) (19 December 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.2 release.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.2. </b>
          You can download the latest MySQL Cluster NDB 6.2 source code
          and binaries for supported platforms from
          http://dev.mysql.com/downloads/cluster.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.2 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.23 (see <a href="news.html#news-5-1-23" title="C.1.7. Changes in  MySQL 5.1.23 (29 January 2008)">Section C.1.7, “Changes in  MySQL 5.1.23 (29 January 2008)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Partitioning</strong></span>: <span class="bold"><strong>MySQL Cluster</strong></span>: 
        When partition pruning on an <code class="literal">NDB</code> table
        resulted in an ordered index scan spanning only one partition,
        any descending flag for the scan was wrongly discarded, causing
        <code class="literal">ORDER BY DESC</code> to be treated as <code class="literal">ORDER
        BY ASC</code>, <code class="literal">MAX()</code> to be handled
        incorrectly, and similar problems.
       (<a href="http://bugs.mysql.com/33061" target="_top">Bug#33061</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When all data and SQL nodes in the cluster were shut down
        abnormally (that is, other than by using <code class="literal">STOP</code>
        in the cluster management client), <span><strong class="command">ndb_mgm</strong></span>
        used excessive amounts of CPU.
       (<a href="http://bugs.mysql.com/33237" target="_top">Bug#33237</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When using micro-GCPs, if a node failed while preparing for a
        global checkpoint, the master node would use the wrong GCI.
       (<a href="http://bugs.mysql.com/32922" target="_top">Bug#32922</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Under some conditions, performing an <code class="literal">ALTER
        TABLE</code> on an <code class="literal">NDBCLUSTER</code> table failed
        with a <span class="errortext">Table is full</span> error, even when
        only 25% of <code class="literal">DataMemory</code> was in use and the
        result should have been a table using less memory (for example,
        changing a <code class="literal">VARCHAR(100)</code> column to
        <code class="literal">VARCHAR(80)</code>).
       (<a href="http://bugs.mysql.com/32670" target="_top">Bug#32670</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-22-ndb-6-2-9"></a>20.17.2.8. Changes in  MySQL Cluster NDB 6.2.9 (5.1.22-ndb-6.2.9) (22 November 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.2 release.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.2. </b>
          You can download the latest MySQL Cluster NDB 6.2 source code
          and binaries for supported platforms from
          http://dev.mysql.com/downloads/cluster.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.2 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.22 (see <a href="news.html#news-5-1-22" title="C.1.8. Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)">Section C.1.8, “Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Added the <span><strong class="command">ndb_mgm</strong></span> client command
        <code class="literal">DUMP 8011</code>, which dumps all subscribers to the
        cluster log. See
        <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-dump-command-8011.html" target="_top"><code class="literal">DUMP 8011</code></a>, for more
        information.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A local checkpoint could sometimes be started before the
        previous LCP was restorable from a global checkpoint.
       (<a href="http://bugs.mysql.com/32519" target="_top">Bug#32519</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        High numbers of API nodes on a slow or congested network could
        cause connection negotiation to time out prematurely, leading to
        the following issues:
        </p><div class="itemizedlist"><ul type="circle"><li><p>
              Excessive retries
            </p></li><li><p>
              Excessive CPU usage
            </p></li><li><p>
              Partially connected API nodes
            </p></li></ul></div><p>
       (<a href="http://bugs.mysql.com/32359" target="_top">Bug#32359</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The failure of a master node could lead to subsequent failures
        in local checkpointing.
       (<a href="http://bugs.mysql.com/32160" target="_top">Bug#32160</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Adding a new <code class="literal">TINYTEXT</code> column to an
        <code class="literal">NDB</code> table which used <code class="literal">COLUMN_FORMAT =
        DYNAMIC</code>, and when binary logging was enabled, caused
        all cluster <span><strong class="command">mysqld</strong></span> processes to crash.
       (<a href="http://bugs.mysql.com/30213" target="_top">Bug#30213</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        After adding a new column of one of the <code class="literal">TEXT</code>
        or <code class="literal">BLOB</code> types to an <code class="literal">NDB</code>
        table which used <code class="literal">COLUMN_FORMAT = DYNAMIC</code>, it
        was no longer possible to access or drop the table using SQL.
       (<a href="http://bugs.mysql.com/30205" target="_top">Bug#30205</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A restart of the cluster failed when more than 1 REDO phase was
        in use.
       (<a href="http://bugs.mysql.com/22696" target="_top">Bug#22696</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Under certain conditions, the slave stopped processing relay
        logs. This resulted in the logs never being cleared and the
        slave eventually running out of disk space.
       (<a href="http://bugs.mysql.com/31958" target="_top">Bug#31958</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Where a table being replicated had a <code class="literal">TEXT</code> or
        <code class="literal">BLOB</code> column, an <code class="literal">UPDATE</code> on
        the master that did not refer explicitly to this column in the
        <code class="literal">WHERE</code> clause stopped the SQL thread on the
        slave with <span class="errortext">Error in Write_rows event: row application
        failed. Got error 4288 'Blob handle for column not available'
        from NDBCLUSTER</span>.
       (<a href="http://bugs.mysql.com/30674" target="_top">Bug#30674</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-22-ndb-6-2-8"></a>20.17.2.9. Changes in  MySQL Cluster NDB 6.2.8 (5.1.22-ndb-6.2.8) (08 November 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.2 release.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.2. </b>
          You can download the latest MySQL Cluster NDB 6.2 source code
          and binaries for supported platforms from
          http://dev.mysql.com/downloads/cluster.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.2 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.22 (see <a href="news.html#news-5-1-22" title="C.1.8. Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)">Section C.1.8, “Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Important Note</strong></span>: 
        MySQL Cluster NDB 6.2 and 6.3 source archives are now available
        in separate commercial and GPL versions. Due to licensing
        concerns, previous MySQL Cluster NDB 6.2 and 6.3 source archives
        were removed from the FTP site.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        In a cluster running in diskless mode and with arbitration
        disabled, the failure of a data node during an insert operation
        caused other data node to fail.
       (<a href="http://bugs.mysql.com/31980" target="_top">Bug#31980</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        An insert or update with combined range and equality constraints
        failed when run against an <code class="literal">NDB</code> table with the
        error <span class="errortext">Got unknown error from NDB</span>. An
        example of such a statement would be <code class="literal">UPDATE t1 SET b =
        5 WHERE a IN (7,8) OR a &gt;= 10;</code>.
       (<a href="http://bugs.mysql.com/31874" target="_top">Bug#31874</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        An error with an <code class="literal">if</code> statement in
        <code class="filename">sql/ha_ndbcluster.cc</code> could potentially lead
        to an infinite loop in case of failure when working with
        <code class="literal">AUTO_INCREMENT</code> columns in
        <code class="literal">NDB</code> tables.
       (<a href="http://bugs.mysql.com/31810" target="_top">Bug#31810</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The <code class="literal">NDB</code> storage engine code was not safe for
        strict-alias optimization in <span><strong class="command">gcc</strong></span> 4.2.1.
       (<a href="http://bugs.mysql.com/31761" target="_top">Bug#31761</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Following an upgrade, <span><strong class="command">ndb_mgmd</strong></span> would fail
        with an <span class="errortype">ArbitrationError</span>.
       (<a href="http://bugs.mysql.com/31690" target="_top">Bug#31690</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The <code class="literal">NDB</code> management client command
        <code class="literal"><em class="replaceable"><code>node_id</code></em> REPORT
        MEMORY</code> provided no output when
        <em class="replaceable"><code>node_id</code></em> was the node ID of a
        management or API node. Now, when this occurs, the management
        client responds with <code class="literal">Node
        <em class="replaceable"><code>node_id</code></em>: is not a data
        node</code>.
       (<a href="http://bugs.mysql.com/29485" target="_top">Bug#29485</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Performing <code class="literal">DELETE</code> operations after a data
        node had been shut down could lead to inconsistent data
        following a restart of the node.
       (<a href="http://bugs.mysql.com/26450" target="_top">Bug#26450</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">UPDATE IGNORE</code> could sometimes fail on
        <code class="literal">NDB</code> tables due to the use of unitialized data
        when checking for duplicate keys to be ignored.
       (<a href="http://bugs.mysql.com/25817" target="_top">Bug#25817</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        A node failure during replication could lead to buckets out of
        order; now active subscribers are checked for, rather than empty
        buckets.
       (<a href="http://bugs.mysql.com/31701" target="_top">Bug#31701</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        When the master <span><strong class="command">mysqld</strong></span> crashed or was
        restarted, no <code class="literal">LOST_EVENTS</code> entry was made in
        the binlog.
       (<a href="http://bugs.mysql.com/31484" target="_top">Bug#31484</a>)</p><p>See also <a href="http://bugs.mysql.com/21494" target="_top">Bug#21494</a></p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-22-ndb-6-2-7"></a>20.17.2.10. Changes in  MySQL Cluster NDB 6.2.7 (5.1.22-ndb-6.2.7) (10 October 2008)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.2 release.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.2. </b>
          You can download the latest MySQL Cluster NDB 6.2 source code
          and binaries for supported platforms from
          http://dev.mysql.com/downloads/cluster.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.2 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.22 (see <a href="news.html#news-5-1-22" title="C.1.8. Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)">Section C.1.8, “Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        A new configuration parameter
        <code class="literal">TimeBetweenEpochsTimeout</code> allows a timeout to
        be set for time between epochs. For more information, see
        <a href="mysql-cluster.html#mysql-cluster-ndbd-definition" title="20.3.4.5. Defining Data Nodes">Section 20.3.4.5, “Defining Data Nodes”</a>.
       (<a href="http://bugs.mysql.com/31276" target="_top">Bug#31276</a>)</p></li><li><p>
        Additional checks were implemented to catch unsupported online
        <code class="literal">ALTER TABLE</code> operations. Currently it is not
        possible to reorder columns or to change the storage engine used
        for a table via online <code class="literal">ALTER TABLE</code>.
      </p><p>
        Some redundant checks made during online creation of indexes
        were removed.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        It was possible in some cases for a node group to be
        “<span class="quote">lost</span>” due to missed local checkpoints following a
        system restart.
       (<a href="http://bugs.mysql.com/31525" target="_top">Bug#31525</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">NDB</code> tables having names containing
        non-alphanumeric characters (such as “<span class="quote">
        <code class="literal">$</code> </span>”) were not discovered correctly.
       (<a href="http://bugs.mysql.com/31470" target="_top">Bug#31470</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A node failure during a local checkpoint could lead to a
        subsequent failure of the cluster during a system restart.
       (<a href="http://bugs.mysql.com/31257" target="_top">Bug#31257</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A cluster restart could sometimes fail due to an issue with
        table IDs.
       (<a href="http://bugs.mysql.com/30975" target="_top">Bug#30975</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Transaction timeouts were not handled well in some
        circumstances, leading to excessive number of transactions being
        aborted unnecessarily.
       (<a href="http://bugs.mysql.com/30379" target="_top">Bug#30379</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        In some cases, the cluster managment server logged entries
        multiple times following a restart of <span><strong class="command">mgmd</strong></span>.
       (<a href="http://bugs.mysql.com/29565" target="_top">Bug#29565</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <span><strong class="command">ndb_mgm <code class="option">--help</code> </strong></span> did not
        display any information about the <code class="option">-a</code> option.
       (<a href="http://bugs.mysql.com/29509" target="_top">Bug#29509</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The cluster log was formatted inconsistently and contained
        extraneous newline characters.
       (<a href="http://bugs.mysql.com/25064" target="_top">Bug#25064</a>)</p></li><li><p>
        Online <code class="literal">ALTER</code> operations involving a column
        whose data type has an implicit default value left behind
        temporary <code class="filename">.FRM</code> files, causing subsequent
        <code class="literal">DROP DATABASE</code> statements to fail.
       (<a href="http://bugs.mysql.com/31097" target="_top">Bug#31097</a>)</p></li><li><p>
        Transactions were committed prematurely when <code class="literal">LOCK
        TABLE</code> and <code class="literal">SET AUTOCOMMIT=OFF</code> were
        used together.
       (<a href="http://bugs.mysql.com/30996" target="_top">Bug#30996</a>)</p></li><li><p>
        The <span><strong class="command">mysqld_safe</strong></span> script contained a syntax
        error.
       (<a href="http://bugs.mysql.com/30624" target="_top">Bug#30624</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-22-ndb-6-2-6"></a>20.17.2.11. Changes in  MySQL Cluster NDB 6.2.6 (5.1.22-ndb-6.2.6) (20 September 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.2 release.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.2. </b>
          You can download the latest MySQL Cluster NDB 6.2 source code
          and binaries for supported platforms from
          http://dev.mysql.com/downloads/cluster.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.2 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.22 (see <a href="news.html#news-5-1-22" title="C.1.8. Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)">Section C.1.8, “Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Mapping of <code class="literal">NDB</code> error codes to MySQL storage
        engine error codes has been improved.
       (<a href="http://bugs.mysql.com/28423" target="_top">Bug#28423</a>)</p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Partitioning</strong></span>: <span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">EXPLAIN PARTITIONS</code> reported partition usage
        by queries on <code class="literal">NDB</code> tables according to the
        standard MySQL hash function than the hash function used in the
        <code class="literal">NDB</code> storage engine.
       (<a href="http://bugs.mysql.com/29550" target="_top">Bug#29550</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When an <code class="literal">NDB</code> event was left behind but the
        corresponding table was later recreated and received a new table
        ID, the event could not be dropped.
       (<a href="http://bugs.mysql.com/30877" target="_top">Bug#30877</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Attempting to restore a backup made on a cluster host using one
        endian to a machine using the other endian could cause the
        cluster to fail.
       (<a href="http://bugs.mysql.com/29674" target="_top">Bug#29674</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The description of the <code class="option">--print</code> option provided
        in the output from <span><strong class="command">ndb_restore <code class="option">--help</code>
        </strong></span> was incorrect.
       (<a href="http://bugs.mysql.com/27683" target="_top">Bug#27683</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Restoring a backup made on a cluster host using one endian to a
        machine using the other endian failed for
        <code class="literal">BLOB</code> and <code class="literal">DATETIME</code> columns.
       (<a href="http://bugs.mysql.com/27543" target="_top">Bug#27543</a>, <a href="http://bugs.mysql.com/30024" target="_top">Bug#30024</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        An insufficiently descriptive and potentially misleading Error
        4006 (<span class="errortext">Connect failure - out of connection
        objects...</span>) was produced when either of the
        following two conditions occurred:
        </p><div class="orderedlist"><ol type="1"><li><p>
              There were no more transaction records in the transaction
              coordinator
            </p></li><li><p>
              an <code class="literal">Ndb</code> object in the NDB API was
              initialized with insufficient parallellism
            </p></li></ol></div><p>
        Separate error messages are now generated for each of these two
        cases.
       (<a href="http://bugs.mysql.com/11313" target="_top">Bug#11313</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        An <code class="literal">Ndb</code> object in the NDB API was initialized
        with insufficient parallellism.
      </p></li><li><p>
        For micro-GCPs, the assignment of “<span class="quote">fake</span>” CGI events
        no longer cause buckets to be sent out of order. Now, when
        assigning a GCI to a non-GCI event (that is, creating a
        pseudo-GCI or “<span class="quote">fake</span>” CGI), the GCI that is to
        arrive is always initiated, even if no known GCI exists, which
        could occur in the event of a node failure.
       (<a href="http://bugs.mysql.com/30884" target="_top">Bug#30884</a>)</p></li><li><p>
        There were no more transaction records in the transaction
        coordinator
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-22-ndb-6-2-5"></a>20.17.2.12. Changes in  MySQL Cluster NDB 6.2.5 (5.1.22-ndb-6.2.5) (06 September 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.2 release.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.2. </b>
          You can download the latest MySQL Cluster NDB 6.2 source code
          and binaries for supported platforms from
          http://dev.mysql.com/downloads/cluster.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.2 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.22 (see <a href="news.html#news-5-1-22" title="C.1.8. Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)">Section C.1.8, “Changes in  MySQL 5.1.22 (24 September 2007: Release Candidate)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The following improvements have been made in the
        <span><strong class="command">ndb_size.pl</strong></span> utility:
      </p><div class="itemizedlist"><ul type="circle"><li><p>
            The script can now be used with multiple databases; lists of
            databases and tables can also be excluded from analysis.
          </p></li><li><p>
            Schema name information has been added to index table
            calculations.
          </p></li><li><p>
            The database name is now an optional parameter, the
            exclusion of which causes all databases to be examined.
          </p></li><li><p>
            If selecting from <code class="literal">INFORMATION_SCHEMA</code>
            fails, the script now attempts to fall back to <code class="literal">SHOW
            TABLES</code>.
          </p></li><li><p>
            A <code class="option">--real_table_name</code> option has been added;
            this designates a table to handle unique index size
            calculations.
          </p></li><li><p>
            The report title has been amended to cover cases where more
            than one database is being analyzed.
          </p></li></ul></div><p>
        Support for a <code class="option">--socket</code> option was also added.
      </p><p>
        For more information, see
        <a href="mysql-cluster.html#mysql-cluster-utilities-ndb-size" title="20.10.15. ndb_size.pl — NDBCLUSTER Size Requirement Estimator">Section 20.10.15, “<span><strong class="command">ndb_size.pl</strong></span> — NDBCLUSTER Size Requirement Estimator”</a>.
       (<a href="http://bugs.mysql.com/28683" target="_top">Bug#28683</a>, <a href="http://bugs.mysql.com/28253" target="_top">Bug#28253</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Online <code class="literal">ADD COLUMN</code>, <code class="literal">ADD
        INDEX</code>, and <code class="literal">DROP INDEX</code> operations
        can now be performed explicitly for <code class="literal">NDB</code>
        tables, as well as online renaming of tables and columns for
        <code class="literal">NDB</code> and <code class="literal">MyISAM</code> tables
        — that is, without copying or locking of the affected
        tables — using <code class="literal">ALTER ONLINE TABLE</code>.
      </p><p>
        Indexes can also be created and dropped online using
        <code class="literal">CREATE INDEX</code> and <code class="literal">DROP
        INDEX</code>, respectively, using the
        <code class="literal">ONLINE</code> keyword.
      </p><p>
        You can force operations that would otherwise be performed
        online to be done offline using the <code class="literal">OFFLINE</code>
        keyword.
      </p><p>
        See <a href="sql-syntax.html#alter-table" title="12.1.4. ALTER TABLE Syntax">Section 12.1.4, “<code class="literal">ALTER TABLE</code> Syntax”</a>,
        <a href="sql-syntax.html#create-index" title="12.1.7. CREATE INDEX Syntax">Section 12.1.7, “<code class="literal">CREATE INDEX</code> Syntax”</a>, and
        <a href="sql-syntax.html#drop-index" title="12.1.13. DROP INDEX Syntax">Section 12.1.13, “<code class="literal">DROP INDEX</code> Syntax”</a>, for more information.
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        It is now possible to control whether fixed-width or
        variable-width storage is used for a given column of an
        <code class="literal">NDB</code> table by means of the
        <code class="literal">COLUMN_FORMAT</code> specifier as part of the
        column's definition in a <code class="literal">CREATE TABLE</code> or
        <code class="literal">ALTER TABLE</code> statement.
      </p><p>
        It is also possible to control whether a given column of an
        <code class="literal">NDB</code> table is stored in memory or on disk,
        using the <code class="literal">STORAGE</code> specifier as part of the
        column's definition in a <code class="literal">CREATE TABLE</code> or
        <code class="literal">ALTER TABLE</code> statement.
      </p><p>
        For permitted values and other information about
        <code class="literal">COLUMN_FORMAT</code> and <code class="literal">STORAGE</code>,
        see <a href="sql-syntax.html#create-table" title="12.1.10. CREATE TABLE Syntax">Section 12.1.10, “<code class="literal">CREATE TABLE</code> Syntax”</a>.
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A new cluster management server startup option
        <code class="option">--bind-address</code> makes it possible to restrict
        management client connections to <span><strong class="command">ndb_mgmd</strong></span> to
        a single host and port. For more information, see
        <a href="mysql-cluster.html#mysql-cluster-ndb-mgmd-command-options" title="20.6.5.2. Command Options for ndb_mgmd">Section 20.6.5.2, “Command Options for <span><strong class="command">ndb_mgmd</strong></span>”</a>.
      </p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        The protocol for handling global checkpoints has been changed.
        It is now possible to control how often the GCI number is
        updated, and how often global checkpoints are written to disk,
        using the <code class="literal">TimeBetweenEpochs</code> configuration
        parameter. This improves the reliability and performance of
        MySQL Cluster Replication.
      </p><p>
        GCPs handled using the new protocol are sometimes referred to as
        “<span class="quote">micro-GCPs</span>”.
      </p><p>
        For more information, see <code class="literal">
        <a href="mysql-cluster.html#mysql-cluster-param-ndbd-definition-timebetweenepochs">TimeBetweenEpochs</a>
        </code>.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When handling <code class="literal">BLOB</code> columns, the addition of
        read locks to the lock queue was not handled correctly.
       (<a href="http://bugs.mysql.com/30764" target="_top">Bug#30764</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Discovery of <code class="literal">NDB</code> tables did not work
        correctly with <code class="literal">INFORMATION_SCHEMA</code>.
       (<a href="http://bugs.mysql.com/30667" target="_top">Bug#30667</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A filesystem close operation could fail during a node or system
        restart.
       (<a href="http://bugs.mysql.com/30646" target="_top">Bug#30646</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Using the <code class="option">--ndb-cluster-connection-pool</code> option
        for <span><strong class="command">mysqld</strong></span> caused DDL statements to be
        executed twice.
       (<a href="http://bugs.mysql.com/30598" target="_top">Bug#30598</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <span><strong class="command">ndb_size.pl</strong></span> failed on tables with
        <code class="literal">FLOAT</code> columns whose definitions included
        commas (for example, <code class="literal">FLOAT(6,2)</code>).
       (<a href="http://bugs.mysql.com/29228" target="_top">Bug#29228</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Reads on <code class="literal">BLOB</code> columns were not locked when
        they needed to be to guarantee consistency.
       (<a href="http://bugs.mysql.com/29102" target="_top">Bug#29102</a>)</p><p>See also <a href="http://bugs.mysql.com/31482" target="_top">Bug#31482</a></p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A query using joins between several large tables and requiring
        unique index lookups failed to complete, eventually returning
        <span class="errortext">Uknown Error</span> after a very long period of
        time. This occurred due to inadequate handling of instances
        where the Transaction Coordinator ran out of
        <code class="literal">TransactionBufferMemory</code>, when the cluster
        should have returned NDB error code 4012 (<span class="errortext">Request
        ndbd time-out</span>).
       (<a href="http://bugs.mysql.com/28804" target="_top">Bug#28804</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        An attempt to perform a <code class="literal">SELECT ... FROM
        INFORMATION_SCHEMA.TABLES</code> whose result included
        information about <code class="literal">NDB</code> tables for which the
        user had no privileges crashed the MySQL Server on which the
        query was performed.
       (<a href="http://bugs.mysql.com/26793" target="_top">Bug#26793</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Cluster replication did not handle large
        <code class="literal">VARCHAR</code> columns correctly.
       (<a href="http://bugs.mysql.com/29904" target="_top">Bug#29904</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        An issue with the <code class="literal">mysql.ndb_apply_status</code>
        table could cause <code class="literal">NDB</code> schema autodiscovery to
        fail in certain rare circumstances.
       (<a href="http://bugs.mysql.com/20872" target="_top">Bug#20872</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        A call to <code class="literal">CHECK_TIMEDOUT_RET()</code> in
        <code class="filename">mgmapi.cpp</code> should have been a call to
        <code class="literal">DBUG_CHECK_TIMEDOUT_RET()</code>.
       (<a href="http://bugs.mysql.com/30681" target="_top">Bug#30681</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-19-ndb-6-2-4"></a>20.17.2.13. Changes in  MySQL Cluster NDB 6.2.4 (5.1.19-ndb-6.2.4) (04 July 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.2 release.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.2. </b>
          You can download the latest MySQL Cluster NDB 6.2 source code
          and binaries for supported platforms from
          http://dev.mysql.com/downloads/cluster.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.2 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.19 (see <a href="news.html#news-5-1-19" title="C.1.11. Changes in  MySQL 5.1.19 (25 May 2007)">Section C.1.11, “Changes in  MySQL 5.1.19 (25 May 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When restarting a data node, queries could hang during that
        node's start phase 5, and continue only after the node had
        entered phase 6.
       (<a href="http://bugs.mysql.com/29364" target="_top">Bug#29364</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Replica redo logs were inconsistently handled during a system
        restart.
       (<a href="http://bugs.mysql.com/29354" target="_top">Bug#29354</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        Performing Disk Data schema operations during a node restart
        could cause forced shutdowns of other data nodes.
       (<a href="http://bugs.mysql.com/29501" target="_top">Bug#29501</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        Disk data meta-information that existed in
        <span><strong class="command">ndbd</strong></span> might not be visible to
        <span><strong class="command">mysqld</strong></span>.
       (<a href="http://bugs.mysql.com/28720" target="_top">Bug#28720</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        The number of free extents was incorrectly reported for some
        tablespaces.
       (<a href="http://bugs.mysql.com/28642" target="_top">Bug#28642</a>)</p></li><li><p>
        Batching of transactions was not handled correctly in some
        cases.
       (<a href="http://bugs.mysql.com/29525" target="_top">Bug#29525</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-19-ndb-6-2-3"></a>20.17.2.14. Changes in  MySQL Cluster NDB 6.2.3 (5.1.19-ndb-6.2.3) (02 July 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.2 release.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.2. </b>
          You can download the latest MySQL Cluster NDB 6.2 source code
          and binaries for supported platforms from
          http://dev.mysql.com/downloads/cluster.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.2 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.18 (see <a href="news.html#news-5-1-18" title="C.1.12. Changes in  MySQL 5.1.18 (08 May 2007)">Section C.1.12, “Changes in  MySQL 5.1.18 (08 May 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When restarting a data node, queries could hang during that
        node's start phase 5, and continue only after the node had
        entered phase 6.
       (<a href="http://bugs.mysql.com/29364" target="_top">Bug#29364</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Replica redo logs were inconsistently handled during a system
        restart.
       (<a href="http://bugs.mysql.com/29354" target="_top">Bug#29354</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        Performing Disk Data schema operations during a node restart
        could cause forced shutdowns of other data nodes.
       (<a href="http://bugs.mysql.com/29501" target="_top">Bug#29501</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        Disk data meta-information that existed in
        <span><strong class="command">ndbd</strong></span> might not be visible to
        <span><strong class="command">mysqld</strong></span>.
       (<a href="http://bugs.mysql.com/28720" target="_top">Bug#28720</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        The number of free extents was incorrectly reported for some
        tablespaces.
       (<a href="http://bugs.mysql.com/28642" target="_top">Bug#28642</a>)</p></li><li><p>
        Batching of transactions was not handled correctly in some
        cases.
       (<a href="http://bugs.mysql.com/29525" target="_top">Bug#29525</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-18-ndb-6-2-2"></a>20.17.2.15. Changes in  MySQL Cluster NDB 6.2.2 (5.1.18-ndb-6.2.2) (07 May 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.2 release.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.2. </b>
          You can download the latest MySQL Cluster NDB 6.2 source code
          and binaries for supported platforms from
          http://dev.mysql.com/downloads/cluster.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.2 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.18 (see <a href="news.html#news-5-1-18" title="C.1.12. Changes in  MySQL 5.1.18 (08 May 2007)">Section C.1.12, “Changes in  MySQL 5.1.18 (08 May 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        New cluster management client <code class="literal">DUMP</code> commands
        were added to aid in tracking transactions, scan operations, and
        locks. See <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-dump-command-2350.html" target="_top"><code class="literal">DUMP 2350</code></a>,
        <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-dump-command-2352.html" target="_top"><code class="literal">DUMP 2352</code></a>, and
        <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-dump-command-2550.html" target="_top"><code class="literal">DUMP 2550</code></a>, for
        more information.
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Added the <span><strong class="command">mysqld</strong></span> option
        <code class="option">--ndb-cluster-connection-pool</code> that allows a
        single MySQL server to use multiple connections to the cluster.
        This allows for scaling out using multiple MySQL clients per SQL
        node instead of or in addition to using multiple SQL nodes with
        the cluster.
      </p><p>
        For more information about this option, see
        <a href="mysql-cluster.html#mysql-cluster-options-variables" title="20.4. MySQL Cluster Options and Variables">Section 20.4, “MySQL Cluster Options and Variables”</a>.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-18-ndb-6-2-1"></a>20.17.2.16. Changes in  MySQL Cluster NDB 6.2.1 (5.1.18-ndb-6.2.1) (30 April 2007)</h4></div></div></div><p class="release-level">
        This is a Beta development release, fixing recently discovered
        bugs in the previous MySQL Cluster NDB 6.2 release.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.2. </b>
          You can download the latest MySQL Cluster NDB 6.2 source code
          and binaries for supported platforms from
          http://dev.mysql.com/downloads/cluster.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        the previous MySQL Cluster NDB 6.2 release, as well as all
        bugfixes and feature changes which were added in mainline MySQL
        5.1 through MySQL 5.1.18 (see <a href="news.html#news-5-1-18" title="C.1.12. Changes in  MySQL 5.1.18 (08 May 2007)">Section C.1.12, “Changes in  MySQL 5.1.18 (08 May 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Multiple operations involving deletes followed by reads were not
        handled correctly.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          This issue could also affect MySQL Cluster Replication.
        </p></div><p>(<a href="http://bugs.mysql.com/28276" target="_top">Bug#28276</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Using <code class="literal">NdbBlob::writeData()</code> to write data in
        the middle of an existing blob value (that is, updating the
        value) could overwrite some data past the end of the data to be
        changed.
       (<a href="http://bugs.mysql.com/27018" target="_top">Bug#27018</a>)</p></li><li><p>
        Incorrect handling of fragmentation in a node takeover during a
        restart could cause stale data to be copied to the starting
        node, leading eventually to failure of the node.
       (<a href="http://bugs.mysql.com/27434" target="_top">Bug#27434</a>)</p></li><li><p>
        An incorrect assertion was made when sending a
        <code class="literal">TCKEYFAILREF</code> or <code class="literal">TCKEYCONF</code>
        message to a failed data node.
       (<a href="http://bugs.mysql.com/26814" target="_top">Bug#26814</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-16-ndb-6-2-0"></a>20.17.2.17. Changes in  MySQL Cluster NDB 6.2.0 (5.1.16-ndb-6.2.0) (03 March 2007)</h4></div></div></div><p class="release-level">
        This is the first MySQL Cluster NDB 6.2 development release,
        based on version 6.2 of the <code class="literal">NDBCLUSTER</code>
        storage engine.
      </p><p class="download-location"><b>Obtaining MySQL Cluster NDB 6.2. </b>
          You can download the latest MySQL Cluster NDB 6.2 source code
          and binaries for supported platforms from
          http://dev.mysql.com/downloads/cluster.
        </p><p>
        This Beta release incorporates bugfixes and changes made in
        previous MySQL Cluster releases, as well as all bugfixes and
        feature changes which were added in mainline MySQL 5.1 through
        MySQL 5.1.16 (see <a href="news.html#news-5-1-16" title="C.1.14. Changes in  MySQL 5.1.16 (26 February 2007)">Section C.1.14, “Changes in  MySQL 5.1.16 (26 February 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        An <code class="option">--ndb-wait-connected</code> option has been added
        for <span><strong class="command">mysqld</strong></span>, which causes
        <span><strong class="command">mysqld</strong></span> to wait for the specified amount of
        time to connect to the cluster before starting to accept MySQL
        client connections.
      </p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        The <code class="literal">Ndb::startTransaction()</code> method now
        provides an alternative interface for starting a transaction.
        See <a href="http://dev.mysql.com/doc/ndbapi/en/class-ndb-starttransaction.html" target="_top"><code class="literal">Ndb::startTransaction()</code></a>, for
        more information.
      </p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Methods were added to the
        <code class="literal">Ndb_cluster_connection</code> class to faciliate
        iterating over existing <code class="literal">Ndb</code> objects. See
        <a href="http://dev.mysql.com/doc/ndbapi/en/class-ndb-cluster-connection-get-next-ndb-object.html" target="_top"><code class="literal">ndb_cluster_connection::get_next_ndb_object()</code></a>,
        for more information.
      </p></li><li><p>
        It is now possible to disable arbitration by setting
        <code class="literal">ArbitrationRank</code> equal to <code class="literal">0</code>
        on all nodes.
      </p></li><li><p>
        A new <code class="literal">TcpBind_INADDR_ANY</code> configuration
        parameter allows data nodes node to bind
        <code class="literal">INADDR_ANY</code> instead of a hostname or IP
        address in the <code class="filename">config.ini</code> file.
      </p></li><li><p>
        Memory allocation has been improved on 32-bit architectures that
        enables using close to 3GB for <code class="literal">DataMemory</code> and
        <code class="literal">IndexMemory</code> combined.
      </p></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="mysql-cluster-news-6-1"></a>20.17.3. Changes in MySQL Cluster NDB 6.1</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-23">20.17.3.1. Changes in  MySQL Cluster NDB 6.1.23 (5.1.15-ndb-6.1.23) (20 November 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-22">20.17.3.2. Changes in  MySQL Cluster NDB 6.1.22 (5.1.15-ndb-6.1.22) (19 October 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-21">20.17.3.3. Changes in  MySQL Cluster NDB 6.1.21 (5.1.15-ndb-6.1.21) (01 October 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-20">20.17.3.4. Changes in  MySQL Cluster NDB 6.1.20 (5.1.15-ndb-6.1.20) (14 September 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-19">20.17.3.5. Changes in  MySQL Cluster NDB 6.1.19 (5.1.15-ndb-6.1.19) (01 August 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-18">20.17.3.6. Changes in  MySQL Cluster NDB 6.1.18 (5.1.15-ndb-6.1.18) (Not released)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-17">20.17.3.7. Changes in  MySQL Cluster NDB 6.1.17 (5.1.15-ndb-6.1.17) (03 July 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-16">20.17.3.8. Changes in  MySQL Cluster NDB 6.1.16 (5.1.15-ndb-6.1.16) (29 June 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-15">20.17.3.9. Changes in  MySQL Cluster NDB 6.1.15 (5.1.15-ndb-6.1.15) (20 June 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-14">20.17.3.10. Changes in  MySQL Cluster NDB 6.1.14 (5.1.15-ndb-6.1.14) (19 June 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-13">20.17.3.11. Changes in  MySQL Cluster NDB 6.1.13 (5.1.15-ndb-6.1.13) (15 June 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-12">20.17.3.12. Changes in  MySQL Cluster NDB 6.1.12 (5.1.15-ndb-6.1.12) (13 June 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-11">20.17.3.13. Changes in  MySQL Cluster NDB 6.1.11 (5.1.15-ndb-6.1.11) (06 June 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-10">20.17.3.14. Changes in  MySQL Cluster NDB 6.1.10 (5.1.15-ndb-6.1.10) (30 May 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-9">20.17.3.15. Changes in  MySQL Cluster NDB 6.1.9 (5.1.15-ndb-6.1.9) (24 May 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-8">20.17.3.16. Changes in  MySQL Cluster NDB 6.1.8 (5.1.15-ndb-6.1.8) (05 May 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-7">20.17.3.17. Changes in  MySQL Cluster NDB 6.1.7 (5.1.15-ndb-6.1.7) (05 May 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-6">20.17.3.18. Changes in  MySQL Cluster NDB 6.1.6 (5.1.15-ndb-6.1.6) (Not released)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-5">20.17.3.19. Changes in  MySQL Cluster NDB 6.1.5 (5.1.15-ndb-6.1.5) (15 March 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-4">20.17.3.20. Changes in  MySQL Cluster NDB 6.1.4 (5.1.15-ndb-6.1.4) (09 March 2007))</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-3">20.17.3.21. Changes in  MySQL Cluster NDB 6.1.3 (5.1.15-ndb-6.1.3) (25 February 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-2">20.17.3.22. Changes in  MySQL Cluster NDB 6.1.2 (5.1.15-ndb-6.1.2) (07 February 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-15-ndb-6-1-1">20.17.3.23. Changes in  MySQL Cluster NDB 6.1.1 (5.1.15-ndb-6.1.1) (01 February 2007)</a></span></dt><dt><span class="section"><a href="mysql-cluster.html#mysql-cluster-news-5-1-14-ndb-6-1-0">20.17.3.24. Changes in  MySQL Cluster NDB 6.1.0 (5.1.14-ndb-6.1.0) (20 December 2006)</a></span></dt></dl></div><p>
      This section contains change history information for MySQL Cluster
      releases based on version 6.1 of the <code class="literal">NDBCLUSTER</code>
      storage engine.
    </p><p>
      For an overview of new features added in MySQL Cluster NDB 6.1,
      see <a href="mysql-cluster.html#mysql-cluster-changes-5-1-ndb-6-1" title="20.15.2. Features Added in MySQL Cluster NDB 6.1">Section 20.15.2, “Features Added in MySQL Cluster NDB 6.1”</a>.
    </p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-23"></a>20.17.3.1. Changes in  MySQL Cluster NDB 6.1.23 (5.1.15-ndb-6.1.23) (20 November 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The <code class="literal">NDB</code> storage engine code was not safe for
        strict-alias optimization in <span><strong class="command">gcc</strong></span> 4.2.1.
       (<a href="http://bugs.mysql.com/31761" target="_top">Bug#31761</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Under certain conditions, the slave stopped processing relay
        logs. This resulted in the logs never being cleared and the
        slave eventually running out of disk space.
       (<a href="http://bugs.mysql.com/31958" target="_top">Bug#31958</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-22"></a>20.17.3.2. Changes in  MySQL Cluster NDB 6.1.22 (5.1.15-ndb-6.1.22) (19 October 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        It was possible in some cases for a node group to be
        “<span class="quote">lost</span>” due to missed local checkpoints following a
        system restart.
       (<a href="http://bugs.mysql.com/31525" target="_top">Bug#31525</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        A node failure during replication could lead to buckets out of
        order; now active subscribers are checked for, rather than empty
        buckets.
       (<a href="http://bugs.mysql.com/31701" target="_top">Bug#31701</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-21"></a>20.17.3.3. Changes in  MySQL Cluster NDB 6.1.21 (5.1.15-ndb-6.1.21) (01 October 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A node failure during a local checkpoint could lead to a
        subsequent failure of the cluster during a system restart.
       (<a href="http://bugs.mysql.com/31257" target="_top">Bug#31257</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A cluster restart could sometimes fail due to an issue with
        table IDs.
       (<a href="http://bugs.mysql.com/30975" target="_top">Bug#30975</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-20"></a>20.17.3.4. Changes in  MySQL Cluster NDB 6.1.20 (5.1.15-ndb-6.1.20) (14 September 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Incorrect handling of <code class="literal">INSERT</code> plus
        <code class="literal">DELETE</code> operations with regard to local
        checkpoints caused data node failures in multi-master
        replication setups.
       (<a href="http://bugs.mysql.com/30914" target="_top">Bug#30914</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-19"></a>20.17.3.5. Changes in  MySQL Cluster NDB 6.1.19 (5.1.15-ndb-6.1.19) (01 August 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Whenever a TCP send buffer is over 80% full, temporary error
        1218 (<span class="errortext">Send Buffers overloaded in NDB
        kernel</span>) is now returned. See
        <a href="mysql-cluster.html#mysql-cluster-param-tcp-definition-sendbuffermemory">SendBufferMemory</a>
        for more information.
      </p></li><li><p>
        An <code class="literal">INFO</code> event is now sent if the time between
        global checkpoints is excessive, or if <code class="literal">DUMP
        7901</code> is issued in the management client.
      </p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-18"></a>20.17.3.6. Changes in  MySQL Cluster NDB 6.1.18 (5.1.15-ndb-6.1.18) (Not released)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When restarting a data node, queries could hang during that
        node's start phase 5, and continue only after the node had
        entered phase 6.
       (<a href="http://bugs.mysql.com/29364" target="_top">Bug#29364</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        Disk data meta-information that existed in
        <span><strong class="command">ndbd</strong></span> might not be visible to
        <span><strong class="command">mysqld</strong></span>.
       (<a href="http://bugs.mysql.com/28720" target="_top">Bug#28720</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        The number of free extents was incorrectly reported for some
        tablespaces.
       (<a href="http://bugs.mysql.com/28642" target="_top">Bug#28642</a>)</p></li><li><p>
        Storage engine error conditions in row-based replication were
        not correctly reported to the user.
       (<a href="http://bugs.mysql.com/29570" target="_top">Bug#29570</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-17"></a>20.17.3.7. Changes in  MySQL Cluster NDB 6.1.17 (5.1.15-ndb-6.1.17) (03 July 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Batching of updates on cluster replication slaves, enabled using
        the <code class="option">--slave-allow-batching</code> option for
        <span><strong class="command">mysqld</strong></span>.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Replica redo logs were inconsistently handled during a system
        restart.
       (<a href="http://bugs.mysql.com/29354" target="_top">Bug#29354</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-16"></a>20.17.3.8. Changes in  MySQL Cluster NDB 6.1.16 (5.1.15-ndb-6.1.16) (29 June 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When a node failed to respond to a <code class="literal">COPY_GCI</code>
        signal as part of a global checkpoint, the master node was
        killed instead of the node that actually failed.
       (<a href="http://bugs.mysql.com/29331" target="_top">Bug#29331</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        An invalid comparison made during <code class="literal">REDO</code>
        validation that could lead to an <span class="errortext">Error while reading
        REDO log</span> condition.
       (<a href="http://bugs.mysql.com/29118" target="_top">Bug#29118</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The wrong data pages were sometimes invalidated following a
        global checkpoint.
       (<a href="http://bugs.mysql.com/29067" target="_top">Bug#29067</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        If at least 2 files were involved in <code class="literal">REDO</code>
        invalidation, then file 0 of page 0 was not updated and so
        pointed to an invalid part of the redo log.
       (<a href="http://bugs.mysql.com/29057" target="_top">Bug#29057</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        When dropping a page, the stack's bottom entry could sometime be
        left “<span class="quote">cold</span>” rather than “<span class="quote">hot</span>”,
        violating the rules for stack pruning.
       (<a href="http://bugs.mysql.com/29176" target="_top">Bug#29176</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-15"></a>20.17.3.9. Changes in  MySQL Cluster NDB 6.1.15 (5.1.15-ndb-6.1.15) (20 June 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Memory corruption could occur due to a problem in the
        <code class="literal">DBTUP</code> kernel block.
       (<a href="http://bugs.mysql.com/29229" target="_top">Bug#29229</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-14"></a>20.17.3.10. Changes in  MySQL Cluster NDB 6.1.14 (5.1.15-ndb-6.1.14) (19 June 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        In the event that two data nodes in the same node group and
        participating in a GCP crashed before they had written their
        respective <code class="filename">P0.sysfile</code> files,
        <code class="literal">QMGR</code> could refuse to start, issuing an
        invalid <span class="errortext">Insufficient nodes for restart</span>
        error instead.
       (<a href="http://bugs.mysql.com/29167" target="_top">Bug#29167</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-13"></a>20.17.3.11. Changes in  MySQL Cluster NDB 6.1.13 (5.1.15-ndb-6.1.13) (15 June 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p>
        Read ahead was implemented for backups of Disk Data tables,
        resulting in a 10 to 15% increase in backup speed of Disk Data
        tables.
       (<a href="http://bugs.mysql.com/29099" target="_top">Bug#29099</a>)</p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        <code class="filename">NdbApi.hpp</code> depended on
        <code class="filename">ndb_global.h</code>, which was not actually
        installed, causing the compilation of programs that used
        <code class="filename">NdbApi.hpp</code> to fail.
       (<a href="http://bugs.mysql.com/35853" target="_top">Bug#35853</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-12"></a>20.17.3.12. Changes in  MySQL Cluster NDB 6.1.12 (5.1.15-ndb-6.1.12) (13 June 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        New cluster management client <code class="literal">DUMP</code> commands
        were added to aid in tracking transactions, scan operations, and
        locks. See <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-dump-command-2350.html" target="_top"><code class="literal">DUMP 2350</code></a>,
        <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-dump-command-2352.html" target="_top"><code class="literal">DUMP 2352</code></a>, and
        <a href="http://dev.mysql.com/doc/ndbapi/en/ndb-internals-dump-command-2550.html" target="_top"><code class="literal">DUMP 2550</code></a>.
      </p></li><li><p>
        Backup dump output was extended to provide more information.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        It is now possible to set the maximum size of the allocation
        unit for table memory using the <code class="literal">MaxAllocate</code>
        configuration parameter.
       (<a href="http://bugs.mysql.com/29044" target="_top">Bug#29044</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-11"></a>20.17.3.13. Changes in  MySQL Cluster NDB 6.1.11 (5.1.15-ndb-6.1.11) (06 June 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Important Change</strong></span>: <span class="bold"><strong>MySQL Cluster</strong></span>: 
        The <code class="literal">TimeBetweenWatchdogCheckInitial</code>
        configuration parameter was added to allow setting of a separate
        watchdog timeout for memory allocation during startup of the
        data nodes. See <a href="mysql-cluster.html#mysql-cluster-ndbd-definition" title="20.3.4.5. Defining Data Nodes">Section 20.3.4.5, “Defining Data Nodes”</a>,
        for more information.
       (<a href="http://bugs.mysql.com/28899" target="_top">Bug#28899</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A new configuration parameter <code class="literal">ODirect</code> causes
        <code class="literal">NDB</code> to attempt using
        <code class="literal">O_DIRECT</code> writes for LCP, backups, and redo
        logs, often lowering CPU usage.
      </p></li><li><p>
        It is now possible to set the size of redo log files (fragment
        log files) using the <code class="literal">FragmentLogFileSize</code>
        configuration parameter.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Having large amounts of memory locked caused swapping to disk.
       (<a href="http://bugs.mysql.com/28751" target="_top">Bug#28751</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        LCP files were not removed following an initial system restart.
       (<a href="http://bugs.mysql.com/28726" target="_top">Bug#28726</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        Repeated <code class="literal">INSERT</code> and <code class="literal">DELETE</code>
        operations on a Disk Data table having one or more large
        <code class="literal">VARCHAR</code> columns could cause data nodes to
        fail.
       (<a href="http://bugs.mysql.com/20612" target="_top">Bug#20612</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-10"></a>20.17.3.14. Changes in  MySQL Cluster NDB 6.1.10 (5.1.15-ndb-6.1.10) (30 May 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A new <code class="literal">times</code> printout was added in the
        <span><strong class="command">ndbd</strong></span> watchdog thread.
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Some unneeded printouts in the <span><strong class="command">ndbd</strong></span> out file
        were removed.
      </p></li><li><p>
        The names of some log and other files were changed to avoid
        issues with the <span><strong class="command">tar</strong></span> command's 99-character
        filename limit.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A regression in the heartbeat monitoring code could lead to node
        failure under high load. This issue affected MySQL 5.1.19 and
        MySQL Cluster NDB 6.1.10 only.
       (<a href="http://bugs.mysql.com/28783" target="_top">Bug#28783</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A corrupt schema file could cause a <span class="errortext">File already
        open</span> error.
       (<a href="http://bugs.mysql.com/28770" target="_top">Bug#28770</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Setting <code class="literal">InitialNoOpenFiles</code> equal to
        <code class="literal">MaxNoOfOpenFiles</code> caused an error. This was
        due to the fact that the actual value of
        <code class="literal">MaxNoOfOpenFiles</code> as used by the cluster was
        offset by 1 from the value set in
        <code class="filename">config.ini</code>.
       (<a href="http://bugs.mysql.com/28749" target="_top">Bug#28749</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A race condition could result when non-master nodes (in addition
        to the master node) tried to update active status due to a local
        checkpoint (that is, between <code class="literal">NODE_FAILREP</code> and
        <code class="literal">COPY_GCIREQ</code> events). Now only the master
        updates the active status.
       (<a href="http://bugs.mysql.com/28717" target="_top">Bug#28717</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A fast global checkpoint under high load with high usage of the
        redo buffer caused data nodes to fail.
       (<a href="http://bugs.mysql.com/28653" target="_top">Bug#28653</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        When loading data into a cluster following a version upgrade,
        the data nodes could forcibly shut down due to page and buffer
        management failures (that is, <code class="literal">ndbrequire</code>
        failures in <code class="literal">PGMAN</code>).
       (<a href="http://bugs.mysql.com/28525" target="_top">Bug#28525</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-9"></a>20.17.3.15. Changes in  MySQL Cluster NDB 6.1.9 (5.1.15-ndb-6.1.9) (24 May 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When an API node sent more than 1024 signals in a single batch,
        <code class="literal">NDB</code> would process only the first 1024 of
        these, and then hang.
       (<a href="http://bugs.mysql.com/28443" target="_top">Bug#28443</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        The cluster backup process scanned in <code class="literal">ACC</code>
        index order, which had bad effects for disk data.
       (<a href="http://bugs.mysql.com/28593" target="_top">Bug#28593</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-8"></a>20.17.3.16. Changes in  MySQL Cluster NDB 6.1.8 (5.1.15-ndb-6.1.8) (05 May 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Local checkpoint files relating to dropped
        <code class="literal">NDB</code> tables were not removed.
       (<a href="http://bugs.mysql.com/28348" target="_top">Bug#28348</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Repeated insertion of data generated by
        <span><strong class="command">mysqldump</strong></span> into <code class="literal">NDB</code> tables
        could eventually lead to failure of the cluster.
       (<a href="http://bugs.mysql.com/27437" target="_top">Bug#27437</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        Extremely large inserts into Disk Data tables could lead to data
        node failure in some circumstances.
       (<a href="http://bugs.mysql.com/27942" target="_top">Bug#27942</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        In a multi-operation transaction, a delete operation followed by
        the insertion of an implicit <code class="literal">NULL</code> failed to
        overwrite an existing value.
       (<a href="http://bugs.mysql.com/20535" target="_top">Bug#20535</a>)</p></li><li><p>
        Setting <code class="literal">MaxNoOfTables</code> very low and relative
        to <code class="literal">DataMemory</code> caused <span class="errortext">Out of memory
        in Ndb Kernel</span> errors when inserting relatively small
        amounts of data into NDB tables.
       (<a href="http://bugs.mysql.com/24173" target="_top">Bug#24173</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-7"></a>20.17.3.17. Changes in  MySQL Cluster NDB 6.1.7 (5.1.15-ndb-6.1.7) (05 May 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Cluster Replication</strong></span>: <span class="bold"><strong>Incompatible Change</strong></span>: 
        The schema for the <code class="literal">ndb_apply_status</code> table in
        the <code class="literal">mysql</code> system database has changed. When
        upgrading to this release from a previous MySQL Cluster NDB 6.x
        or mainline MySQL 5.1 release, you must drop the
        <code class="literal">mysql.ndb_apply_status</code> table, then restart
        the server in order for the table to be re-created with the new
        schema.
      </p><p>
        See <a href="mysql-cluster.html#mysql-cluster-replication-schema" title="20.11.4. Cluster Replication Schema and Tables">Section 20.11.4, “Cluster Replication Schema and Tables”</a>, for
        additional information.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The cluster waited 30 seconds instead of 30 milliseconds before
        reading table statistics.
       (<a href="http://bugs.mysql.com/28093" target="_top">Bug#28093</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Under certain rare circumstances, <span><strong class="command">ndbd</strong></span> could
        get caught in an infinite loop when one transaction took a read
        lock and then a second transaction attempted to obtain a write
        lock on the same tuple in the lock queue.
       (<a href="http://bugs.mysql.com/28073" target="_top">Bug#28073</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Under some circumstances, a node restart could fail to update
        the Global Checkpoint Index (GCI).
       (<a href="http://bugs.mysql.com/28023" target="_top">Bug#28023</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        An <code class="literal">INSERT</code> followed by a delete
        <code class="literal">DELETE</code> on the same <code class="literal">NDB</code>
        table caused a memory leak.
       (<a href="http://bugs.mysql.com/27756" target="_top">Bug#27756</a>)</p><p>This regression was introduced by <a href="http://bugs.mysql.com/20612" target="_top">Bug#20612</a></p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Under certain rare circumstances performing a <code class="literal">DROP
        TABLE</code> or <code class="literal">TRUNCATE</code> on an
        <code class="literal">NDB</code> table could cause a node failure or
        forced cluster shutdown.
       (<a href="http://bugs.mysql.com/27581" target="_top">Bug#27581</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Memory usage of a <span><strong class="command">mysqld</strong></span> process grew even
        while idle.
       (<a href="http://bugs.mysql.com/27560" target="_top">Bug#27560</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Performing a delete followed by an insert during a local
        checkpoint could cause a <span class="errortext">Rowid already
        allocated</span> error.
       (<a href="http://bugs.mysql.com/27205" target="_top">Bug#27205</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: <span class="bold"><strong>Disk Data</strong></span>: 
        An issue with replication of Disk Data tables could in some
        cases lead to node failure.
       (<a href="http://bugs.mysql.com/28161" target="_top">Bug#28161</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        Changes to a Disk Data table made as part of a transaction could
        not be seen by the client performing the changes until the
        transaction had been committed.
       (<a href="http://bugs.mysql.com/27757" target="_top">Bug#27757</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        When restarting a data node following the creation of a large
        number of Disk Data objects (approximately 200 such objects),
        the cluster could not assign a node ID to the restarting node.
       (<a href="http://bugs.mysql.com/25741" target="_top">Bug#25741</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        Changing a column specification or issuing a
        <code class="literal">TRUNCATE</code> statement on a Disk Data table
        caused the table to become an in-memory table.
      </p><p>
        This fix supersedes an incomplete fix that was made for this
        issue in MySQL 5.1.15.
       (<a href="http://bugs.mysql.com/24667" target="_top">Bug#24667</a>, <a href="http://bugs.mysql.com/25296" target="_top">Bug#25296</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Some queries that updated multiple tables were not backed up
        correctly.
       (<a href="http://bugs.mysql.com/27748" target="_top">Bug#27748</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        It was possible for API nodes to begin interacting with the
        cluster subscription manager before they were fully connected to
        the cluster.
       (<a href="http://bugs.mysql.com/27728" target="_top">Bug#27728</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Under very high loads, checkpoints could be read or written with
        checkpoint indexes out of order.
       (<a href="http://bugs.mysql.com/27651" target="_top">Bug#27651</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        An issue with the way in which the
        <code class="literal">NdbDictionary::Dictionary::listEvents()</code>
        method freed resources could sometimes lead to memory
        corruption.
       (<a href="http://bugs.mysql.com/27663" target="_top">Bug#27663</a>)</p></li><li><p>
        <span><strong class="command">mysqldump</strong></span> could not dump log tables.
       (<a href="http://bugs.mysql.com/26121" target="_top">Bug#26121</a>)</p></li><li><p>
        The <code class="option">--with-readline</code> option for
        <span><strong class="command">configure</strong></span> did not work for commercial source
        packages, but no error message was printed to that effect. Now a
        message is printed.
       (<a href="http://bugs.mysql.com/25530" target="_top">Bug#25530</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-6"></a>20.17.3.18. Changes in  MySQL Cluster NDB 6.1.6 (5.1.15-ndb-6.1.6) (Not released)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Cluster Replication</strong></span>: <span class="bold"><strong>Incompatible Change</strong></span>: 
        The schema for the <code class="literal">ndb_apply_status</code> table in
        the <code class="literal">mysql</code> system database has changed. When
        upgrading to this release from a previous MySQL Cluster NDB 6.x
        or mainline MySQL 5.1 release, you must drop the
        <code class="literal">mysql.ndb_apply_status</code> table, then restart
        the server in order for the table to be re-created with the new
        schema.
      </p><p>
        See <a href="mysql-cluster.html#mysql-cluster-replication-schema" title="20.11.4. Cluster Replication Schema and Tables">Section 20.11.4, “Cluster Replication Schema and Tables”</a>, for
        additional information.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A data node failing while another data node was restarting could
        leave the cluster in an inconsistent state. In certain rare
        cases, this could lead to a race condition and the eventual
        forced shutdown of the cluster.
       (<a href="http://bugs.mysql.com/27466" target="_top">Bug#27466</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        It was not possible to set
        <code class="literal">LockPagesInMainMemory</code> equal to
        <code class="literal">0</code>.
       (<a href="http://bugs.mysql.com/27291" target="_top">Bug#27291</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A race condition could sometimes occur if the node acting as
        master failed while node IDs were still being allocated during
        startup.
       (<a href="http://bugs.mysql.com/27286" target="_top">Bug#27286</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When a data node was taking over as the master node, a race
        condition could sometimes occur as the node was assuming
        responsibility for handling of global checkpoints.
       (<a href="http://bugs.mysql.com/27283" target="_top">Bug#27283</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <span><strong class="command">mysqld</strong></span> could crash shortly after a data node
        failure following certain DML operations.
       (<a href="http://bugs.mysql.com/27169" target="_top">Bug#27169</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The same failed request from an API node could be handled by the
        cluster multiple times, resulting in reduced performance.
       (<a href="http://bugs.mysql.com/27087" target="_top">Bug#27087</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The failure of a data node while restarting could cause other
        data nodes to hang or crash.
       (<a href="http://bugs.mysql.com/27003" target="_top">Bug#27003</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <span><strong class="command">mysqld</strong></span> processes would sometimes crash under
        high load.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          This fix improves on and replaces a fix for this bug that was
          made in MySQL Cluster NDB 6.1.5.
        </p></div><p>(<a href="http://bugs.mysql.com/26825" target="_top">Bug#26825</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        <code class="literal">DROP INDEX</code> on a Disk Data table did not
        always move data from memory into the tablespace.
       (<a href="http://bugs.mysql.com/25877" target="_top">Bug#25877</a>)</p></li><li><p><span class="bold"><strong>Cluster Replication</strong></span>: 
        Trying to replicate a large number of frequent updates with a
        relatively small relay log
        (<code class="literal">max-relay-log-size</code> set to 1M or less) could
        cause the slave to crash.
       (<a href="http://bugs.mysql.com/27529" target="_top">Bug#27529</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        An issue with the way in which the
        <code class="literal">NdbDictionary::Dictionary::listEvents()</code>
        method freed resources could sometimes lead to memory
        corruption.
       (<a href="http://bugs.mysql.com/27663" target="_top">Bug#27663</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        A delete operation using a scan followed by an insert using a
        scan could cause a data node to fail.
       (<a href="http://bugs.mysql.com/27203" target="_top">Bug#27203</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-5"></a>20.17.3.19. Changes in  MySQL Cluster NDB 6.1.5 (5.1.15-ndb-6.1.5) (15 March 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>Cluster Replication</strong></span>: <span class="bold"><strong>Incompatible Change</strong></span>: 
        The schema for the <code class="literal">ndb_apply_status</code> table in
        the <code class="literal">mysql</code> system database has changed. When
        upgrading to this release from a previous MySQL Cluster NDB 6.x
        or mainline MySQL 5.1 release, you must drop the
        <code class="literal">mysql.ndb_apply_status</code> table, then restart
        the server in order for the table to be re-created with the new
        schema.
      </p><p>
        See <a href="mysql-cluster.html#mysql-cluster-replication-schema" title="20.11.4. Cluster Replication Schema and Tables">Section 20.11.4, “Cluster Replication Schema and Tables”</a>, for
        additional information.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Creating a table on one SQL node while in single user mode
        caused other SQL nodes to crash.
       (<a href="http://bugs.mysql.com/26997" target="_top">Bug#26997</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <span><strong class="command">mysqld</strong></span> processes would sometimes crash under
        high load.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          This fix was reverted in MySQL Cluster NDB 6.1.6.
        </p></div><p>(<a href="http://bugs.mysql.com/26825" target="_top">Bug#26825</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        An infinite loop in an internal logging function could cause
        trace logs to fill up with <span class="errortext">Unknown Signal
        type</span> error messages and thus grow to unreasonable
        sizes.
       (<a href="http://bugs.mysql.com/26720" target="_top">Bug#26720</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        When creating a log file group, setting
        <code class="literal">INITIAL_SIZE</code> to less than
        <code class="literal">UNDO_BUFFER_SIZE</code> caused data nodes to crash.
       (<a href="http://bugs.mysql.com/25743" target="_top">Bug#25743</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-4"></a>20.17.3.20. Changes in  MySQL Cluster NDB 6.1.4 (5.1.15-ndb-6.1.4) (09 March 2007))</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        An <code class="option">--ndb-wait-connected</code> option has been added
        for <span><strong class="command">mysqld</strong></span>. It causes
        <span><strong class="command">mysqld</strong></span> wait a specified amount of time to be
        connected to the cluster before accepting client connections.
        See
        <a href="mysql-cluster.html#option_mysqld_ndb_wait_connected">here</a>,
        for more information.
      </p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        It is now possible to specify the transaction coordinator when
        starting a transaction. See
        <a href="http://dev.mysql.com/doc/ndbapi/en/class-ndb-starttransaction.html" target="_top"><code class="literal">Ndb::startTransaction()</code></a>, for more
        information.
      </p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        It is now possible to iterate over all existing
        <code class="literal">Ndb</code> objects using three new methods of the
        <code class="literal">Ndb_cluster_connection</code> class:
        </p><div class="itemizedlist"><ul type="circle"><li><p>
              <code class="literal">lock_ndb_objects()</code>
            </p></li><li><p>
              <code class="literal">get_next_ndb_object()</code>
            </p></li><li><p>
              <code class="literal">unlock_ndb_objects()</code>
            </p></li></ul></div><p>
        For more information about these methods and their use, see
        <a href="http://dev.mysql.com/doc/ndbapi/en/class-ndb-cluster-connection-get-next-ndb-object.html" target="_top"><code class="literal">ndb_cluster_connection::get_next_ndb_object()</code></a>,
        in the MySQL Cluster API Guide.
      </p></li><li><p>
        Data node memory allocation has been improved. On 32-bit
        platforms, it should now be possible to use close to 3GB RAM for
        <code class="literal">IndexMemory</code> and <code class="literal">DataMemory</code>
        combined.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Using only the <code class="option">--print_data</code> option (and no
        other options) with <span><strong class="command">ndb_restore</strong></span> caused
        <span><strong class="command">ndb_restore</strong></span> to fail.
       (<a href="http://bugs.mysql.com/26741" target="_top">Bug#26741</a>)</p><p>This regression was introduced by <a href="http://bugs.mysql.com/14612" target="_top">Bug#14612</a></p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        An inadvertent use of unaligned data caused
        <span><strong class="command">ndb_restore</strong></span> to fail on some 64-bit platforms,
        including Sparc and Itanium-2.
       (<a href="http://bugs.mysql.com/26739" target="_top">Bug#26739</a>)</p></li><li><p>
        Assigning a node ID greater than 63 to an SQL node caused an out
        of bounds error in <span><strong class="command">mysqld</strong></span>. It should now be
        possible to assign to SQL nodes node IDs up to 255.
       (<a href="http://bugs.mysql.com/26663" target="_top">Bug#26663</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-3"></a>20.17.3.21. Changes in  MySQL Cluster NDB 6.1.3 (5.1.15-ndb-6.1.3) (25 February 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The <span><strong class="command">ndbd_redo_log_reader</strong></span> utility is now part
        of the default build. For more information, see
        <a href="mysql-cluster.html#mysql-cluster-utilities-ndbd-redo-log-reader" title="20.10.11. ndbd_redo_log_reader — Check and Print Content of Cluster Redo Log">Section 20.10.11, “<span><strong class="command">ndbd_redo_log_reader</strong></span> — Check and Print Content of Cluster Redo Log”</a>.
      </p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The <span><strong class="command">ndb_show_tables</strong></span> utility now displays
        information about table events. See
        <a href="mysql-cluster.html#mysql-cluster-utilities-ndb-show-tables" title="20.10.14. ndb_show_tables — Display List of NDB Tables">Section 20.10.14, “<span><strong class="command">ndb_show_tables</strong></span> — Display List of NDB Tables”</a>,
        for more information.
      </p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        A new <code class="literal">listEvents()</code> method has been added to
        the <code class="literal">Dictionary</code> class. See
        <a href="http://dev.mysql.com/doc/ndbapi/en/class-dictionary-listevents.html" target="_top"><code class="literal">Dictionary::listEvents()</code></a>, for
        more information.
      </p></li><li><p>
        It is now possible to disable arbitration by setting
        <code class="literal">ArbitrationRank=0</code> on all management and SQL
        nodes.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        An invalid pointer was returned following a
        <code class="literal">FSCLOSECONF</code> signal when accessing the REDO
        logs during a node restart or system restart.
       (<a href="http://bugs.mysql.com/26515" target="_top">Bug#26515</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The <span class="errorname">InvalidUndoBufferSize</span> error used the
        same error code (<span class="errorcode">763</span>) as the
        <span class="errorname">IncompatibleVersions</span> error.
        <span class="errorname">InvalidUndoBufferSize</span> now uses its own
        error code (<span class="errorcode">779</span>).
       (<a href="http://bugs.mysql.com/26490" target="_top">Bug#26490</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The failure of a data node when restarting it with
        <code class="option">--initial</code> could lead to failures of subsequent
        data node restarts.
       (<a href="http://bugs.mysql.com/26481" target="_top">Bug#26481</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Takeover for local checkpointing due to multiple failures of
        master nodes was sometimes incorrectly handled.
       (<a href="http://bugs.mysql.com/26457" target="_top">Bug#26457</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The <code class="literal">LockPagesInMainMemory</code> parameter was not
        read until after distributed communication had already started
        between cluster nodes. When the value of this parameter was
        <code class="literal">1</code>, this could sometimes result in data node
        failure due to missed heartbeats.
       (<a href="http://bugs.mysql.com/26454" target="_top">Bug#26454</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Under some circumstances, following the restart of a management
        node, all data nodes would connect to it normally, but some of
        them subsequently failed to log any events to the management
        node.
       (<a href="http://bugs.mysql.com/26293" target="_top">Bug#26293</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        No appropriate error message was provided when there was
        insufficient REDO log file space for the cluster to start.
       (<a href="http://bugs.mysql.com/25801" target="_top">Bug#25801</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A memory allocation failure in <code class="literal">SUMA</code> (the
        cluster Subscription Manager) could cause the cluster to crash.
       (<a href="http://bugs.mysql.com/25239" target="_top">Bug#25239</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        The message <span class="errortext">Error 0 in readAutoIncrementValue(): no
        Error</span> was written to the error log whenever
        <code class="literal">SHOW TABLE STATUS</code> was performed on a Cluster
        table that did not have an <code class="literal">AUTO_INCREMENT</code>
        column.
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>
          This improves on and supersedes an earlier fix that was made
          for this issue in MySQL 5.1.12.
        </p></div><p>(<a href="http://bugs.mysql.com/21033" target="_top">Bug#21033</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        A memory overflow could occur with tables having a large amount
        of data stored on disk, or with queries using a very high degree
        of parallelism on Disk Data tables.
       (<a href="http://bugs.mysql.com/26514" target="_top">Bug#26514</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        Use of a tablespace whose <code class="literal">INITIAL_SIZE</code> was
        greater than 1 GB could cause the cluster to crash.
       (<a href="http://bugs.mysql.com/26487" target="_top">Bug#26487</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-2"></a>20.17.3.22. Changes in  MySQL Cluster NDB 6.1.2 (5.1.15-ndb-6.1.2) (07 February 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        previous MySQL Cluster NDB 6.1 releases, as well as all bugfixes
        and feature changes which were added in mainline MySQL 5.1
        through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        Using node IDs greater than 48 could sometimes lead to incorrect
        memory access and a subsequent forced shutdown of the cluster.
       (<a href="http://bugs.mysql.com/26267" target="_top">Bug#26267</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-15-ndb-6-1-1"></a>20.17.3.23. Changes in  MySQL Cluster NDB 6.1.1 (5.1.15-ndb-6.1.1) (01 February 2007)</h4></div></div></div><p class="release-level">
        This is a bugfix release, fixing recently discovered bugs in the
        previous MySQL Cluster NDB 6.1 release.
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><p>
        This Beta release incorporates all bugfixes and changes made in
        the previous MySQL Cluster NDB 6.1 release, as well as all
        bugfixes and feature changes which were added in mainline MySQL
        5.1 through MySQL 5.1.15 (see <a href="news.html#news-5-1-15" title="C.1.15. Changes in  MySQL 5.1.15 (25 January 2007)">Section C.1.15, “Changes in  MySQL 5.1.15 (25 January 2007)”</a>).
      </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A single cluster can now support up to 255 API nodes, including
        MySQL servers acting as SQL nodes. See
        <a href="mysql-cluster.html#mysql-cluster-limitations-exclusive-to-cluster" title="20.14.8. Issues Exclusive to MySQL Cluster">Section 20.14.8, “Issues Exclusive to MySQL Cluster”</a>,
        for more information.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A memory leak could cause problems during a node or cluster
        shutdown or failure.
       (<a href="http://bugs.mysql.com/25997" target="_top">Bug#25997</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: <span class="bold"><strong>Disk Data</strong></span>: 
        A delete and a read performed in the same operation could cause
        one or more data nodes to crash. This could occur when the
        operation affected more than 5 columns concurrently, or when one
        or more of the columns was of the <code class="literal">VARCHAR</code>
        type and was stored on disk.
       (<a href="http://bugs.mysql.com/25794" target="_top">Bug#25794</a>)</p></li><li><p>
        An element could sometimes be inserted twice into the hash
        table, causing a data node to crash.
       (<a href="http://bugs.mysql.com/25286" target="_top">Bug#25286</a>)</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="mysql-cluster-news-5-1-14-ndb-6-1-0"></a>20.17.3.24. Changes in  MySQL Cluster NDB 6.1.0 (5.1.14-ndb-6.1.0) (20 December 2006)</h4></div></div></div><p class="release-level">
        This is the first MySQL Cluster NDB 6.1 release, incorporating
        new features and bugfixes made for the
        <code class="literal">NDBCLUSTER</code> storage engine made since
        branching from MySQL 5.1.14 standard (see
        <a href="news.html#news-5-1-14" title="C.1.16. Changes in  MySQL 5.1.14 (05 December 2006)">Section C.1.16, “Changes in  MySQL 5.1.14 (05 December 2006)”</a>).
      </p><p class="download-location"><b>MySQL Cluster NDB 6.1 no longer in development. </b>
          MySQL Cluster NDB 6.1 (formerly known as “<span class="quote">MySQL Cluster
          Carrier Grade Edition 6.1.x</span>”) is no longer being
          developed or maintained; if you are using a MySQL Cluster NDB
          6.1 release, you should consider upgrading to MySQL Cluster
          NDB 6.2 or 6.3.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p class="release-non-production">
          Please refer to our bug database at
          <a href="http://bugs.mysql.com/" target="_top">http://bugs.mysql.com/</a> for more details about
          the individual bugs fixed in this version.
        </p></div><p>Functionality added or changed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        A new configuration parameter
        <code class="literal">MemReportFrequency</code> allows for additional
        control of data node memory usage. Previously, only warnings at
        predetermined percentages of memory allocation were given;
        setting this parameter allows for that behavior to be
        overridden. For more information, see
        <a href="mysql-cluster.html#mysql-cluster-ndbd-definition" title="20.3.4.5. Defining Data Nodes">Section 20.3.4.5, “Defining Data Nodes”</a>.
      </p></li></ul></div><p>Bugs fixed:</p><div class="itemizedlist"><ul type="disc"><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        When a data node was shut down using the management client
        <code class="literal">STOP</code> command, a connection event
        (<code class="literal">NDB_LE_Connected</code>) was logged instead of a
        disconnection event (<code class="literal">NDB_LE_Disconnected</code>).
       (<a href="http://bugs.mysql.com/22773" target="_top">Bug#22773</a>)</p></li><li><p><span class="bold"><strong>MySQL Cluster</strong></span>: 
        <code class="literal">SELECT</code> statements with a
        <code class="literal">BLOB</code> or <code class="literal">TEXT</code> column in the
        selected column list and a <code class="literal">WHERE</code> condition
        including a primary key lookup on a <code class="literal">VARCHAR</code>
        primary key produced empty result sets.
       (<a href="http://bugs.mysql.com/19956" target="_top">Bug#19956</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        <code class="literal">MEDIUMTEXT</code> columns of Disk Data tables were
        stored in memory rather than on disk, even if the columns were
        not indexed.
       (<a href="http://bugs.mysql.com/25001" target="_top">Bug#25001</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        Performing a node restart with a newly dropped Disk Data table
        could lead to failure of the node during the restart.
       (<a href="http://bugs.mysql.com/24917" target="_top">Bug#24917</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        When restoring from backup a cluster containing any Disk Data
        tables with hidden primary keys, a node failure resulted which
        could lead to a crash of the cluster.
       (<a href="http://bugs.mysql.com/24166" target="_top">Bug#24166</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        Repeated <code class="literal">CREATE</code>, <code class="literal">DROP</code>, or
        <code class="literal">TRUNCATE</code> in various combinations with system
        restarts between these operations could lead to the eventual
        failure of a system restart.
       (<a href="http://bugs.mysql.com/21948" target="_top">Bug#21948</a>)</p></li><li><p><span class="bold"><strong>Disk Data</strong></span>: 
        Extents that should have been available for re-use following a
        <code class="literal">DROP TABLE</code> operation were not actually made
        available again until after the cluster had performed a local
        checkpoint.
       (<a href="http://bugs.mysql.com/17605" target="_top">Bug#17605</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Invoking the <code class="literal">NdbTransaction::execute()</code> method
        using execution type <code class="literal">Commit</code> and abort option
        <code class="literal">AO_IgnoreError</code> could lead to a crash of the
        transaction coordinator (<code class="literal">DBTC</code>).
       (<a href="http://bugs.mysql.com/25090" target="_top">Bug#25090</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        A unique index lookup on a non-existent tuple could lead to a
        data node timeout (error 4012).
       (<a href="http://bugs.mysql.com/25059" target="_top">Bug#25059</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        When using the <code class="literal">NdbTransaction::execute()</code>
        method, a very long timeout (greater than 5 minutes) could
        result if the last data node being polled was disconnected from
        the cluster.
       (<a href="http://bugs.mysql.com/24949" target="_top">Bug#24949</a>)</p></li><li><p><span class="bold"><strong>Cluster API</strong></span>: 
        Due to an error in the computation of table fragment arrays,
        some transactions were not executed from the correct starting
        point.
       (<a href="http://bugs.mysql.com/24914" target="_top">Bug#24914</a>)</p></li><li><p>
        Under certain rare circumstances, local checkpoints were not
        performed properly, leading to an inability to restart one or
        more data nodes.
       (<a href="http://bugs.mysql.com/24664" target="_top">Bug#24664</a>)</p></li></ul></div></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="replication.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="partitioning.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 19. Replication </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Chapter 21. Partitioning</td></tr></table></div></body></html>
