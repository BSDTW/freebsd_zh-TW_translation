<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>A. 互動式輸入編輯及代換過去的內容</title>
  
  <meta name="description" content="A. 互動式輸入編輯及代換過去的內容 ">
 
  <meta name="keywords" content="tut">
 
  <meta name="resource-type" content="document">
 
  <meta name="distribution" content="global">
 
  <meta http-equiv="Content-Type" content="text/html; charset=Big5">
 
  <link rel="STYLESHEET" href="tut.css">
 
  <link rel="next" href="node14.html">
 
  <link rel="previous" href="node12.html">
 
  <link rel="up" href="tut.html">
 
  <link rel="next" href="node14.html">
</head>
 <body>
 
<div class="navigation">
<p></p>
<hr>
<table align="Center" width="100%" cellpadding="0" cellspacing="2">
 <tbody>
    <tr>
 <td><a href="node12.html"><img src="previous.gif" border="0" height="32" alt="Previous Page" width="32"></a></td>
 <td><a href="tut.html"><img src="up.gif" border="0" height="32" alt="Up One Level" width="32"></a></td>
 <td><a href="node14.html"><img src="next.gif" border="0" height="32" alt="Next Page" width="32"></a></td>
 <td align="Center" width="100%">Python 教學文件</td>
 <td><a href="node2.html"><img src="contents.gif" border="0" height="32" alt="Contents" width="32"></a></td>
 <td><img src="blank.gif" border="0" height="32" alt="" width="32"></td>
 <td><img src="blank.gif" border="0" height="32" alt="" width="32"></td>
 </tr>
  </tbody>
</table>
 <b class="navlabel">Previous:</b> <a class="sectref" href="node12.html">
10. 現在呢? </a> <b class="navlabel">Up:</b> <a class="sectref" href="tut.html">
Python 教學文件</a> <b class="navlabel">Next:</b> <a class="sectref" href="node14.html">
關於此文件&hellip;</a> </div>
 <!--End of Navigation Panel--> <!--Table of Child-Links--> <a name="CHILD_LINKS"><strong>
小段落 </strong></a>  
<ul>
 
  <li><a name="tex2html391" href="node13.html#SECTION0013100000000000000000">
A.1 整行編輯 </a> </li>
  <li><a name="tex2html392" href="node13.html#SECTION0013200000000000000000">
A.2 代換過去的內容 </a> </li>
  <li><a name="tex2html393" href="node13.html#SECTION0013300000000000000000">
A.3 鍵盤連結 </a> </li>
  <li><a name="tex2html394" href="node13.html#SECTION0013400000000000000000">
A.4 評注 </a> </li>
</ul>
 <!--End of Table of Child-Links--> 
<hr>  
<h1> <br>
 A. 互動式輸入編輯及代換過去的內容           </h1>
  
<p> 有些的Python的直譯器版本有支援目前所在行的編輯，以及過去輸入內容的代換，這跟在Korn Shell以及GNU Bash shell裡面的一些功能有點像。這個功能是用
 <i>GNU Readline</i> 的程式庫做出來的，提供了類似Emacs以及類似vi的編輯功能。這個程式庫本身有自己的參考文件，所以我在此不再重複，我只是簡單的介紹基本的功能。這裡所介紹的互動模式輸入編輯及代換過去內容的功能通常在Unix以及CygWin的直譯器版本都可以見得到。
  </p>
<p> 本章 <i>沒有</i> 包含在Mark Hammond的PythonWin package裡的編輯功能，也沒有包含在標準Python distribution裡面的Tk之類的環境，或是IDLE的編輯功能。在DOS以及NT及其他類似的環境下，也有命令列過去內容記憶的功能，但是也不在本文的內容之中。 
 </p>
<p>  </p>
<h1> <br>
 A.1 整行編輯  </h1>
  
<p> 如果有支援整行編輯的話，當直譯器印出primary prompt或是secondary prompt的時候，整行編輯的功能就會被啟動起來。你可以用一般的Emacs控制字元來編輯目前所在的行。其中常見的有這些：
<kbd>C-A</kbd> (Control-A)會移動cursor到目前行的最開頭的地方， <kbd>C-E</kbd> 會移動到最尾端， 
<kbd>C-B</kbd> 會往左移動一個位置， <kbd>C-F</kbd> 會往右邊一個位置。Backspace鍵會消去目前cursor所在處左邊的一個字元，
<kbd>C-D</kbd> 會消去右邊的一個字元，  <kbd>C-K</kbd> 會殺掉 (消去)本行在游標之後的所有字元， <kbd>C-Y</kbd>
 會把剛剛所殺掉的字串再次貼回來，  <kbd>C-underscore</kbd> 會取消剛才所做的最後一個動作，這個功能也可以重複多次的使用。
  </p>
<p>  </p>
<h1> <br>
 A.2 代換過去的內容  </h1>
  
<p> 要取代過去的內容其方法如下：所有的非空白行都會被儲存在一個儲存過去內容的緩衝區(history buffer)裡面，當prompt出現的時候，你所在的位置就是在這個buffer的最底下，使用
<kbd>C-P</kbd> 會使得在buffer裡面往上移動一行，  <kbd>C-N</kbd> 會往下移動一行。任何在buffer裡面的行都可以被編輯，若是在prompt之前出現星號的話就代表這個行已經被修改過了。當你按下
<kbd>Return</kbd> 鍵的時候就是把目前這一行送給直譯器了。 <kbd>C-R</kbd> 會開始一個逐漸往上的搜尋，按下  <kbd>
C-S</kbd> 會開始往前的搜尋。   </p>
<p>  </p>
<h1> <br>
 A.3 鍵盤連結  </h1>
  
<p> 鍵盤的連結以及一些其他有關Readline library的參數都可以被修改，其方法是在一個叫做  <span class="file">
~/.inputrc</span> 的初始化檔案中打入一些指令。鍵盤的連結有以下的幾種形式：   </p>
<p> </p>
<dl>
<dd><pre class="verbatim">key-name: function-name<br></pre>
  </dd>
  </dl>
  
  <p> 或是   </p>
  <p> </p>
  <dl>
  <dd><pre class="verbatim">"string": function-name<br></pre>
    </dd>
    </dl>
  
    <p> 你也可以設定一些選項：   </p>
    <p> </p>
    <dl>
    <dd><pre class="verbatim">set option-name value<br></pre>
      </dd>
      </dl>
  
      <p> 請看下面的例子：   </p>
      <p> </p>
      <dl>
      <dd><pre class="verbatim"># I prefer vi-style editing:<br>set editing-mode vi<br><br># Edit using a single line:<br>set horizontal-scroll-mode On<br><br># Rebind some keys:<br>Meta-h: backward-kill-word<br>"\C-u": universal-argument<br>"\C-x\C-r": re-read-init-file<br></pre>
        </dd>
        </dl>
  
        <p> 注意的是在Python裡面預設的 <kbd>Tab</kbd> 鍵所連結的是輸入一個  <kbd>Tab</kbd> 字元，而非Readline
程式庫裡面預設的檔名自動完成的功能。如果你堅持的話，你也可以這樣子設定來蓋過Python的預設：   </p>
        <p> </p>
        <dl>
        <dd><pre class="verbatim">Tab: complete<br></pre>
          </dd>
          </dl>
  
          <p> 這應該在你的 <span class="file">~/.inputrc</span> 裡面。(當然如果你這樣做的話，你在縮排連續行的時候就費力一些了。)
  </p>
          <p> 自動完成變數及module的名稱的功能是可以自由選擇要或不要的。如果你要在互動模式下啟動這一個功能的話，可以在啟動檔裡面加入底下的指令：
          <a name="tex2html6" href="#foot1328"><sup>A.1</sup></a>  </p>
          <p> </p>
          <dl>
          <dd><pre class="verbatim">import rlcompleter, readline<br>readline.parse_and_bind('tab: complete')<br></pre>
            </dd>
            </dl>
  
            <p> 這樣做的話會使TAB 鍵連結到完成的功能，所以按下TAB鍵兩次就會建議一些完整的名稱。其所搜尋的是Python的敘述名稱，目前的local變數，以及可用的module名稱。對於像
            <code>string.a</code> 這樣帶有點的expression，這項功能會先是著先evaluate到最後一個點的意思，然後再從所得的物件中建議可用的變數名稱。注意的是，如果這個物件含有的
 <tt class="method">__getattr__()</tt> 這個method是這個expression的一部份的話，就會執行一些特定的程式碼。
  </p>
            <p>  </p>
            <h1> <br>
 A.4 評注   </h1>
  
            <p> 這個功能跟其他之前的直譯器版本比起來是很大的一個進步，但是我們還有很多希望有的功能。如果在連續行的時候可以建議適當的縮排距離(分析器(parser)應該知道何時需要縮排)。自動完成的功能應該也能夠使用直譯器的symbol
table。應該也要有一個指令可以檢查(甚至是建議)何時應該要有結束的括弧，括號等等。  </p>
            <p> <br>
            </p>
            <hr>
            <h4>註腳</h4>
 
            <dl>
            <dt><a name="foot1328">... 底下的指令：</a><a name="foot1328" href="node13.html#tex2html6"><sup>
A.1</sup></a> </dt>
              <dd>   當你啟動一個Python的互動式直譯器時，Python會自動執行在     <a class="envvar" name="l2h-24">
$PYTHONSTARTUP</a> 這個系統環境變數所代表的檔案裡面的指令。  </dd>
                </dl>
 
                <div class="navigation">
                <p></p>
                <hr>
                <table align="Center" width="100%" cellpadding="0" cellspacing="2">
 <tbody>
                    <tr>
 <td><a href="node12.html"><img src="previous.gif" border="0" height="32" alt="Previous Page" width="32"></a></td>
 <td><a href="tut.html"><img src="up.gif" border="0" height="32" alt="Up One Level" width="32"></a></td>
 <td><a href="node14.html"><img src="next.gif" border="0" height="32" alt="Next Page" width="32"></a></td>
 <td align="Center" width="100%">Python 教學文件</td>
 <td><a href="node2.html"><img src="contents.gif" border="0" height="32" alt="Contents" width="32"></a></td>
 <td><img src="blank.gif" border="0" height="32" alt="" width="32"></td>
 <td><img src="blank.gif" border="0" height="32" alt="" width="32"></td>
 </tr>
                  </tbody>
                </table>
 <b class="navlabel">Previous:</b> <a class="sectref" href="node12.html">
10. 現在呢? </a> <b class="navlabel">Up:</b> <a class="sectref" href="tut.html">
Python 教學文件</a> <b class="navlabel">Next:</b> <a class="sectref" href="node14.html">
關於此文件&hellip;</a> </div>
 <!--End of Navigation Panel--> 
                <address> </address>
                <hr>請看<i><a href="about.html">關於此文件&hellip;</a></i> 裡面有關如何給我們建議的說明。 
 
                </body>
                </html>
