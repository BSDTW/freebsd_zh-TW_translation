<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
<HTML
><HEAD
><TITLE
>進階變數設定</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.76b+
"><LINK
REL="HOME"
TITLE="Shell 設計入門"
HREF="book1.html"><LINK
REL="UP"
TITLE="5.設定變數"
HREF="c557.html"><LINK
REL="PREVIOUS"
TITLE="Here Document"
HREF="x620.html"><LINK
REL="NEXT"
TITLE="亂數產生"
HREF="x634.html"></HEAD
><BODY
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
SUMMARY="Header navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Shell 設計入門: </TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="x620.html"
ACCESSKEY="P"
>&#60;&#60;&#60; Previous</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>5.設定變數</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="x634.html"
ACCESSKEY="N"
>Next &#62;&#62;&#62;</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="SPECIAL-VAR">進階變數設定</H1
><P
>Bash shell 可以讓您對變數設定做預先的條件判斷，變數設定的結果視該變數的初始狀況而定。</P
><P
>共有四種常用的進階變數設定：</P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>第 1 種：
result=${str:-value}

若 $str 不空，則 result 的內容為 str
若 $str 為空，則 result 的內容為 value

例:
str="/home/ols3"
result=${str:-/bin/sh}
echo $result

結果為：/home/ols3

例:
str=
result=${str:-/bin/sh}
echo $result

結果為：/bin/sh

=====================

第 2 種：
result=${str:=value}

若 $str 為空，則 result 的內容為 value，且同時把 $str 也設為 value !

例:
str="/home/ols3"
result=${str:=/bin/sh}
echo "\$result is $result"
echo "\$str is $str"

結果為：
$result is /home/ols3
$str is /home/ols3

例:
str=
result=${str:=/bin/sh}
echo "\$result is $result"
echo "\$str is $str"


結果為：
$result is /bin/sh
$str is /bin/sh

=====================

第 3 種：
result=${str:?msg}

若 $str 不空，則 result 的內容為 str
若 $str 為空，則 顯示錯誤訊息 msg


=====================

第 4 種：
result=${str:+value}

若 $str 不空，則 result 的內容為 value
若 $str 為空，則不做取代</PRE
></TD
></TR
></TABLE
></P
><P
>另，Bash 有以下截取設定變數之法：</P
><P
><TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>&#13;r="/usr/local/bin/sftp"

m=${r##*/}

上式是說把 r 中符合 */ 這種目錄結構最長的部份刪去，把其右方剩下的部份設定給 m
即 m=sftp
其中 ## 代表 "符合最長的" 之意， */ 代表以 / 結束的任意字串。

m=${r#*/}
上式是說把 r 中符合 */ 的部份予以刪除(最短的)
此時 m=usr/local/bin/sftp

m=${r%/*}

上式是說把 r 中符合 /* 這種目錄結構的右方部份刪除
即 m=/usr/local/bin
其中 % 代表 "符合的" 之意， /* 代表以 / 開始的任意字串。

m=${r%%/*}
上式 %% 是說把 r 中符合 /* 的最長的部份的右方予以刪除
此時 m 為空&#13;</PRE
></TD
></TR
></TABLE
></P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
SUMMARY="Footer navigation table"
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="x620.html"
ACCESSKEY="P"
>&#60;&#60;&#60; Previous</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="book1.html"
ACCESSKEY="H"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="x634.html"
ACCESSKEY="N"
>Next &#62;&#62;&#62;</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Here Document</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="c557.html"
ACCESSKEY="U"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>亂數產生</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>