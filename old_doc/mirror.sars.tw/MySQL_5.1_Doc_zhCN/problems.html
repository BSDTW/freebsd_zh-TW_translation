<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Appendix A. Problems and Common Errors</title><meta name="generator" content="DocBook XSL Stylesheets V1.69.1"><link rel="start" href="index.html" title="MySQL 5.1 Reference Manual"><link rel="up" href="index.html" title="MySQL 5.1 Reference Manual"><link rel="prev" href="extending-mysql.html" title="Chapter 27. Extending MySQL"><link rel="next" href="error-handling.html" title="Appendix B. Error Codes and Messages">
<style>
<!--
 table.MsoNormalTable
	{mso-style-parent:"";
	font-size:10.0pt;
	
	}
span.quote
	{}
-->
</style>
</head><body><div class="appendix"><div class="titlepage"><div><div><h2 class="title"><a name="problems"></a>
	附錄A：問題和常見錯誤</h2></div></div></div><div class="toc"><p><b>
	目錄</b></p><dl><dt><span class="section"><a href="problems.html#what-is-crashing">
			A.1. 如何確定導致問題的原因</a></span></dt><dt><span class="section"><a href="problems.html#common-errors">
			A.2. 使用MySQL程式時的常見錯誤</a></span></dt><dd><dl><dt><span class="section"><a href="problems.html#error-access-denied">A.2.1. 
				拒絕訪問</a></span></dt><dt><span class="section"><a href="problems.html#can-not-connect-to-server">A.2.2. 
				無法連接到[local] MySQL伺服器</a></span></dt><dt><span class="section"><a href="problems.html#old-client">A.2.3. 
				客戶端不支援鑒定協議</a></span></dt><dt><span class="section"><a href="problems.html#password-too-long">
				A.2.4. 輸入密碼時出現密碼錯誤</a></span></dt><dt><span class="section"><a href="problems.html#blocked-host">A.2.5. 
				主機的hos<em class="replaceable">t_name被屏蔽</em></a></span></dt><dt><span class="section"><a href="problems.html#too-many-connections">A.2.6. 
				連接數過多</a></span></dt><dt><span class="section"><a href="problems.html#out-of-memory">A.2.7. 
				內存溢出</a></span></dt><dt><span class="section"><a href="problems.html#gone-away">A.2.8. 
				MySQL伺服器不可用</a></span></dt><dt><span class="section"><a href="problems.html#packet-too-large">A.2.9. 
				訊息包過大</a></span></dt><dt><span class="section"><a href="problems.html#communication-errors">
				A.2.10. 通信錯誤和失效連接</a></span></dt><dt><span class="section"><a href="problems.html#full-table">A.2.11. 
				資料表已滿</a></span></dt><dt><span class="section"><a href="problems.html#cannot-create">A.2.12. 
				無法建立檔案／寫入檔案</a></span></dt><dt><span class="section"><a href="problems.html#commands-out-of-sync">A.2.13. 
				命令不同步</a></span></dt><dt><span class="section"><a href="problems.html#ignoring-user">A.2.14. 
				忽略用戶</a></span></dt><dt><span class="section"><a href="problems.html#cannot-find-table">A.2.15. 
				資料表tbl_na<em class="replaceable">me不存在</em></a></span></dt><dt><span class="section"><a href="problems.html#cannot-initialize-character-set">A.2.16. 
				無法初始化字元編碼</a></span></dt><dt><span class="section"><a href="problems.html#not-enough-file-handles">
				A.2.17. 檔案未找到</a></span></dt></dl></dd><dt><span class="section"><a href="problems.html#installation-issues">A.3. 
			與安裝有關的事宜</a></span></dt><dd><dl><dt><span class="section"><a href="problems.html#link-errors">
				A.3.1. 與MySQL客戶端庫的連結問題</a></span></dt><dt><span class="section"><a href="problems.html#changing-mysql-user">
				A.3.2. 如何以普通用戶身份運行MySQL</a></span></dt><dt><span class="section"><a href="problems.html#file-permissions">
				A.3.3. 與檔案授權有關的問題</a></span></dt></dl></dd><dt><span class="section"><a href="problems.html#administration-issues">
			A.4. 與管理有關的事宜</a></span></dt><dd><dl><dt><span class="section"><a href="problems.html#resetting-permissions">
				A.4.1. 如何復位根用戶密碼</a></span></dt><dt><span class="section"><a href="problems.html#crashing">
				A.4.2. 如果MySQL依然崩潰，應作些什麼</a></span></dt><dt><span class="section"><a href="problems.html#full-disk">
				A.4.3. MySQL處理磁盤滿的方式</a></span></dt><dt><span class="section"><a href="problems.html#temporary-files">
				A.4.4. MySQL將臨時檔案儲存在哪裡</a></span></dt><dt><span class="section"><a href="problems.html#problems-with-mysql-sock">
				A.4.5. 如何保護或更改MySQL套接字檔案/tmp/mysql.sock<code class="filename"></code></a></span></dt><dt><span class="section"><a href="problems.html#timezone-problems">
				A.4.6. 時區問題</a></span></dt></dl></dd><dt><span class="section"><a href="problems.html#query-issues">
			A.5. 與查詢有關的事宜</a></span></dt><dd><dl><dt><span class="section"><a href="problems.html#case-sensitivity">
				A.5.1. 搜索中的大小寫敏感性</a></span></dt><dt><span class="section"><a href="problems.html#using-date">
				A.5.2. 使用DATE列方面的問題<code class="literal"></code></a></span></dt><dt><span class="section"><a href="problems.html#problems-with-null">
				A.5.3. 與NULL值有關的問題<code class="literal"></code></a></span></dt><dt><span class="section"><a href="problems.html#problems-with-alias">
				A.5.4. 與列別名有關的問題</a></span></dt><dt><span class="section"><a href="problems.html#non-transactional-tables">
				A.5.5. 非事務資料表回滾失敗</a></span></dt><dt><span class="section"><a href="problems.html#deleting-from-related-tables">
				A.5.6. 從相關資料表刪除行</a></span></dt><dt><span class="section"><a href="problems.html#no-matching-rows">
				A.5.7. 解決與不匹配行有關的問題</a></span></dt><dt><span class="section"><a href="problems.html#problems-with-float">
				A.5.8. 與浮點比較有關的問題</a></span></dt></dl></dd><dt><span class="section"><a href="problems.html#optimizer-issues">
			A.6. 與最佳化器有關的事宜</a></span></dt><dt><span class="section"><a href="problems.html#table-definition-issues">
			A.7. 與資料表定義有關的事宜</a></span></dt><dd><dl><dt><span class="section"><a href="problems.html#alter-table-problems">
				A.7.1. 與ALTER TABLE有關的問題</a></span></dt><dt><span class="section"><a href="problems.html#change-column-order">
				A.7.2. 如何更改資料表中的列順序</a></span></dt><dt><span class="section"><a href="problems.html#temporary-table-problems">A.7.3. 
				TEMPORARY TABLE問題</a></span></dt></dl></dd><dt><span class="section"><a href="problems.html#bugs">
			A.8. MySQL中的已知事宜</a></span></dt><dd><dl><dt><span class="section"><a href="problems.html#open-bugs">
				A.8.1. MySQL中的打開事宜</a></span></dt></dl></dd></dl></div><a class="indexterm" name="id3073248"></a><a class="indexterm" name="id3073258"></a><div class="section"><div class="titlepage"><div><div>
		在本附錄中，列出了一些您可能會遇到的常見問題和錯誤消息。並介紹了確定故障原因的方法，以及為解決問題所應採取的措施。<h2 class="title"><a name="what-is-crashing"></a>
		A.1.&nbsp;如何確定導致問題的原因</h2></div></div></div>
		<p>當您遇到問題時，首先要做的是找出導致問題的程式和設備部件：</p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>如果遇到下述徵兆之一，或許是因為硬件問題（如內存、主板、<span>CPU</span>或硬盤）或內核問題：</p>
		<p><span>1.<span>&nbsp;&nbsp;&nbsp;
		</span></span>鍵盤不工作。正常情況下可通過按<span>Caps Lock</span>建進行檢查。如果<span>Caps 
		Lock</span>的點亮狀態未改變，就需要更換鍵盤（在此之前，應嘗試重啟計算機，並檢查與鍵盤相連的所有電纜）。</p>
		<p><span>2.<span>&nbsp;&nbsp;&nbsp;
		</span></span>鼠標指針不移動。</p>
		<p><span>3.<span>&nbsp;&nbsp;&nbsp;
		</span></span>機器未對遠程機器的<span>Ping</span>命令做出應答。</p>
		<p><span>4.<span>&nbsp;&nbsp;&nbsp;
		</span></span>與<span>MySQL</span>無關的其他程式工作不正常。</p>
		<p><span>5.<span>&nbsp;&nbsp;&nbsp;
		</span></span>系統意外重啟（有問題的用戶級程式應不能使系統出現嚴重問題）。</p>
		<p>
		在該情況下，應檢查所有的電纜並運行某些診斷工具，對您的硬件進行檢查！此外，還應檢查是否有能夠解決問題的、適用於您的作業系統的補丁、更新或服務包。請檢查所有的庫（如<span><span>glibc</span>）是否是最新的。</span></p>
		<p>使用配備<span>ECC</span>內存的機器以便盡早發現問題總是個好主意。</p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>如果鍵盤已鎖定，可從另一台機器登錄到您的機器，並執行<span><span>kbd_mode 
		–a</span>，或許能恢復。</span></p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>請檢查系統的日誌檔案（<span>/var/log/messages</span>或類似物）以找出問題的原因。如果您認為問題出在<span>MySQL</span>中，應檢查<span>MySQL</span>的日誌檔案。請參見<a href="database-administration.html#log-files" title="5.11. The MySQL Log Files">5.11節，「MySQL日誌檔案」</a>。</p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>如果您不認為存在硬件問題，應嘗試找出導致問題的原因。請使用<strong><span>top</span></strong>、<strong><span>ps</span></strong>、任務管理器或類似程式，以檢查哪個程式佔用了所有<span>CPU</span>時間或鎖定了機器。</p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>使用<strong><span>top</span></strong>、<strong><span>df</span></strong>或類似程式檢查是否內存不夠、磁盤空間不足、檔案描述符缺乏、或其他關鍵資源缺少。</p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>如果問題是失去控制的程序，應嘗試殺死它。如果殺不死程序，或許是因為作業系統中存在問題。</p>
		<p>如果在檢查了所有其他可能性之後，並得出結論問題是由<span>MySQL</span>伺服器或<span>MySQL</span>客戶端導致的，應建立提供給我方的郵件列資料表或支援團隊的問題報告。在問題報告中，請詳細描述系統的行為，以及您認為發生了什麼情況。<span>+3.</span></p>
		<p>還應闡明為什麼您認為是<span>MySQL</span>導致了問題。請考慮本章介紹的所有情況。準確闡明當您檢查系統時問題是如何出現的。對於程式和日誌檔案的任何輸出和錯誤消息，請使用「複製和粘貼」方法。</p>
		<p>盡量詳細描述不工作的程式，以及您所見到的所有徵兆。我們過去收到過很多僅說明「系統不工作」的問題報告。這不會為我們提供有助於解決問題的訊息。</p>
		<p>如果程式失敗，瞭解下述訊息總是有用的：</p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>有嫌疑的程式是否出現了分段故障（是否轉儲內核）？</p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>程式是否佔用了所有可用的<span>CPU</span>時間？用<strong><span>top</span></strong><span>.</span>進行檢查。讓程式運行一段時間，或許能簡單地評估某些事是否是計算密集性的。</p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>如果問題是因<strong><span>mysqld</span></strong>伺服器導致的，使用<strong><span>mysqladmin 
		-u root ping</span></strong>或<strong><span>mysqladmin 
		-u root processlist</span></strong>是否能獲得伺服器的響應？</p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>當您嘗試連接到<span>MySQL</span>伺服器（例如，<span>mysql</span>）時，客戶端程式給出的訊息是什麼？客戶端是否堵塞？是否獲得了來自程式的任何輸出？</p>
		<p>發送問題報告時，請遵循<a href="introduction.html#asking-questions" title="1.7.1.2. Asking Questions or Reporting Bugs">1.7.1.2節，「請教問題或通報問題」</a>中給出的說明。</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="common-errors"></a>
		A.2.&nbsp;使用MySQL程式時的常見錯誤</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="problems.html#error-access-denied">A.2.1. 
			拒絕訪問</a></span></dt><dt><span class="section"><a href="problems.html#can-not-connect-to-server">A.2.2. 
			無法連接到[local] MySQL伺服器</a></span></dt><dt><span class="section"><a href="problems.html#old-client">A.2.3. 
			客戶端不支援鑒定協議</a></span></dt><dt><span class="section"><a href="problems.html#password-too-long">
			A.2.4. 輸入密碼時出現密碼錯誤</a></span></dt><dt><span class="section"><a href="problems.html#blocked-host">A.2.5. 
			主機的hos<em class="replaceable">t_name被屏蔽</em></a></span></dt><dt><span class="section"><a href="problems.html#too-many-connections">A.2.6. 
			連接數過多</a></span></dt><dt><span class="section"><a href="problems.html#out-of-memory">A.2.7. 
			內存溢出</a></span></dt><dt><span class="section"><a href="problems.html#gone-away">A.2.8. 
			MySQL伺服器不可用</a></span></dt><dt><span class="section"><a href="problems.html#packet-too-large">A.2.9. 
			訊息包過大</a></span></dt><dt><span class="section"><a href="problems.html#communication-errors">
			A.2.10. 通信錯誤和失效連接</a></span></dt><dt><span class="section"><a href="problems.html#full-table">A.2.11. 
			資料表已滿</a></span></dt><dt><span class="section"><a href="problems.html#cannot-create">A.2.12. 
			無法建立檔案／寫入檔案</a></span></dt><dt><span class="section"><a href="problems.html#commands-out-of-sync">A.2.13. 
			命令不同步</a></span></dt><dt><span class="section"><a href="problems.html#ignoring-user">A.2.14. 
			忽略用戶</a></span></dt><dt><span class="section"><a href="problems.html#cannot-find-table">A.2.15. 
			資料表tbl_na<em class="replaceable">me不存在</em></a></span></dt><dt><span class="section"><a href="problems.html#cannot-initialize-character-set">A.2.16. 
			無法初始化字元編碼</a></span></dt><dt><span class="section"><a href="problems.html#not-enough-file-handles">
			A.2.17. 檔案未找到</a></span></dt></dl></div><a class="indexterm" name="id3073561"></a>
		<p>本節列出了用戶運行<span>MySQL</span>伺服器時常會遇到的一些錯誤。儘管問題是在您嘗試運行客戶端時出現的，但對很多問題的解決方案來說，需要更改<span>MySQL</span>伺服器的配置。</p>
		<div class="section">
			<div class="titlepage">
				<div>
					<div>
						<h3 class="title"><a name="error-access-denied"></a>A.2.1. 拒絕訪問</h3></div></div></div><a class="indexterm" name="id3073591"></a><a class="indexterm" name="id3073601"></a><a class="indexterm" name="id3073611"></a><p>
        <span>
		導致拒絕訪問錯誤的原因很多。該錯誤常與連接時伺服器允許客戶端使用的<span>MySQL</span>帳號有關。請參見</span><a href="database-administration.html#access-denied" title="5.7.8. Causes of Access denied Errors">5.7.8節，「拒絕訪問錯誤的原因<code class="literal"></code>」</a><span>。請參見</span><a href="database-administration.html#privileges" title="5.7.2. How the Privilege System Works">5.7.2節，「權限系統工作原理」</a>。
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="can-not-connect-to-server"></a>A.2.2. 無法連接到[local] 
			MySQL伺服器</h3></div></div></div><div class="toc"><dl><dt><span class="section"><a href="problems.html#can-not-connect-to-server-on-windows">A.2.2.1. 
				在Windows上與MySQL伺服器的連接失敗</a></span></dt></dl></div>
			<p><span>Unix</span>平台上的<span>MySQL</span>客戶端能夠以兩種不同的方式連接到<strong><span>mysqld</span></strong>伺服器：通過檔案系統中的檔案（預設為<span><span>/tmp/mysql.sock</span>）使用<span>Unix</span>套接字進行連接，或通過端口號使用</span><span>TCP/IP</span>進行連接。<span>Unix</span>套接字檔案的連接速度比<span>TCP/IP</span>快，但僅能在與相同計算機上的伺服器相連時使用。如果未指定指定主機名或指定了特殊的主機名<span>localhost</span>，將使用<span>Unix</span>套接字。</p>
			<p>如果<span>MySQL</span>伺服器運行在<span>Windows 9x</span>或<span>Me</span>上，僅能通過<span>TCP/IP</span>進行連接。如伺服器運行在<span>Windows 
			NT</span>、<span>2000</span>、<span>XP</span>或<span>2003</span>上，而且使用<span><span>--enable-named-pipe</span>選項啟動，如果在運行伺服器的機器上運行客戶端，也能使用命名管道進行連接。</span>預設情況下，命名管道的名稱為<span>MySQL</span>。如果在連接到<span>mysqld</span>時未給定主機名，<span>MySQL</span>客戶端首先會嘗試連接到命名管道。如果不能工作，將連接到<span>TCP/IP</span>端口。使用「<span>.</span>」作為主機名，可在<span>Windows</span>平台上強制使用命名管道。</p>
			<p>錯誤<span>(2002)</span>「無法連接到…」<span>通常意味著在系統沒有運行的<span>MySQL</span>伺服器，或在連接到伺服器時使用了不正確的<span>Unix</span>套接字檔案名或<span>TCP/IP</span>端口號。</span></p>
			<p>首先檢查伺服器主機上是否有名為<span>mysqld</span>的程序（在<span>Unix</span>平台上使用<strong><span>ps 
			xa | grep mysqld</span></strong>，或在<span>Windows</span>平台上使用任務管理器）。如果沒有這類程序，應啟動伺服器。請參見<a href="installing.html#starting-server" title="2.9.2.3. Starting and Troubleshooting the MySQL Server">2.9.2.3節，「啟動MySQL伺服器以及其故障診斷和排除」</a>。</p>
			<p>如果<strong><span>mysqld</span></strong>程序正在運行，可使用下述命令檢查。在您的具體設置中，端口號或<span>Unix</span>套接字檔案名可能會有所不同。<span><span>host_ip</span>代資料表運行伺服器的機器的<span>IP</span>編號。</span></p>
			<pre><span>shell&gt; <span><b>mysqladmin version</b></span></span></pre>
			<pre><span>shell&gt; <span><b>mysqladmin variables</b></span></span></pre>
			<pre><span>shell&gt; <span><b>mysqladmin -h `hostname` version variables</b></span></span></pre>
			<pre><span>shell&gt; <span><b>mysqladmin -h `hostname` --port=3306 version</b></span></span></pre>
			<pre><span>shell&gt; <span><b>mysqladmin -h host_ip version</b></span></span></pre>
			<pre><span>shell&gt; <span><b>mysqladmin --protocol=socket --socket=/tmp/mysql.sock version</b></span></span></pre>
			<p>注意，應與主機名命令一起使用「<span>`</span>」而不是「』」，這會使主機名輸出（當前主機名）被代入<strong><span>mysqladmin</span></strong>命令。如果沒有主機名命令或正運行在<span>Windows</span>平台上，應以手動方式輸入機器的主機名（無「<span>`</span>」符號），後跟<span><span>-h</span>選項。</span>也可以使用<span>TCP/IP</span>協議用<span>-h 
			127.0.0.1</span>連接到本地主機。</p>
			<p>下面給出了一些「無法連接到本地<span>MySQL</span>伺服器」錯誤的可能原因：</p>
			<p>
			<span>1.<span>&nbsp;&nbsp;&nbsp;
			</span></span><strong><span>Mysqld</span></strong>未運行。請檢查作業系統的程序列資料表以確保<strong><span>mysqld</span></strong>程序正在運行。</p>
			<p>
			<span>2.<span>&nbsp;&nbsp;&nbsp;
			</span></span>您正在具有很多<span>TCP/IP</span>連接的<span>Windows</span>平台上運行<span>MySQL</span>伺服器。如果您的客戶端經常出現錯誤，請參見<a href="problems.html#can-not-connect-to-server-on-windows" title="A.2.2.1. Connection to MySQL Server Failing on Windows">A.2.2.1節，「在Windows上與MySQL伺服器的連接失敗」</a>，以找出規避方法。</p>
			<p>
			<span>3.<span>&nbsp;&nbsp;&nbsp;
			</span></span>您正在使用<span>MIT-pthreads</span>的系統上運行。如果您正在運行不具有固有線程的作業系統，<strong><span>mysqld</span></strong>將使用<span>MIT-pthreads</span>軟件包。請參見<a href="installing.html#which-os" title="2.1.1. Operating Systems Supported by MySQL">2.1.1節，「MySQL支援的作業系統」</a>。但是，並非所有的<span>MIT-pthreads</span>版本均支援<span>Unix</span>套接字檔案。在不支援套接字檔案的系統上，連接到伺服器時，必須明確指定主機名。請使用下述命令來檢查是否連接到了伺服器：</p>
			<pre><span>4.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>shell&gt; <span><b>mysqladmin -h `hostname` version</b></span></span></pre>
			<p>
			<span>5.<span>&nbsp;&nbsp;&nbsp;
			</span></span>某人移動了<strong><span>mysqld</span><span>使用的</span></strong><span>Unix</span>套接字檔案（預設為<span>/tmp/mysql.sock</span>）。例如，您可能執行了將舊檔案從<span><span>/tmp</span>目錄刪除的</span><strong><span>cron</span></strong>任務。您總能執行<strong><span>mysqladmin 
			version</span></strong>來檢查<strong><span>mysqladmin</span><span>試圖</span></strong>使用的<span>Unix</span>套接字檔案是否的確存在。在該情況下，更正方式是更改<strong><span>cron</span></strong>任務，不刪除<span><span>mysql.sock</span>檔案，或將套接字檔案置於其他地方。</span>請參見<a href="problems.html#problems-with-mysql-sock" title="A.4.5. How to Protect or Change the MySQL Socket File /tmp/mysql.sock">A.4.5節，「如何保護或更改MySQL套接字檔案/tmp/mysql.sock<code class="filename"></code>」</a>。</p>
			<p>
			<span>6.<span>&nbsp;&nbsp;&nbsp;
			</span></span>您使用<span><span>--socket=/path/to/socket</span>選項啟動了</span><strong><span>mysqld</span></strong>伺服器，當忘記將套接字檔案的新名稱通知客戶端程式<span>。如果更改了關於伺服器的套接字路徑，也必須通知</span><span>MySQL</span>客戶端。可在運行客戶端程式時使用相同的<span><span>—socket</span>選項來完成該任務。此外，您還應確保客戶端具有訪問</span>檔案<span><span>mysql.sock</span>的權限。要想找出套接字檔案的位置，可使用：</span></p>
			<pre><span>7.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span>shell&gt; <span><b>netstat -ln | grep mysql</b></span></span></pre>
			<p>請參見<a href="problems.html#problems-with-mysql-sock" title="A.4.5. How to Protect or Change the MySQL Socket File /tmp/mysql.sock">A.4.5節，「如何保護或更改MySQL套接字檔案/tmp/mysql.sock<code class="filename"></code>」</a>。</p>
			<p>
			<span>8.<span>&nbsp;&nbsp;&nbsp;
			</span></span>您正在使用<span>Linux</span>而且<span>1</span>個伺服器線程已死亡（內核已清除）。在此情況下，在重啟<span>MySQL</span>伺服器之前，必須殺死其他<strong><span>mysqld</span></strong>線程（例如，使用<span>kill</span>或<span><span>mysql_zap</span>指令）。</span>請參見<a href="problems.html#crashing" title="A.4.2. What to Do If MySQL Keeps Crashing">A.4.2節，「如果MySQL依然崩潰，應作些什麼」</a>。</p>
			<p>
			<span>9.<span>&nbsp;&nbsp;&nbsp;
			</span></span>伺服器或客戶端程式不具有訪問包含<span>Unix</span>套接字檔案的目錄或套接字檔案本身的恰當權限。在該情況下，必須更改目錄或套接字檔案的訪問權限，以便伺服器或客戶端程式能夠訪問它們，或用<span><span>–socket</span>選項重啟</span><strong><span>mysqld</span></strong>，在該選項中指定伺服器能建立、而且客戶端可訪問的目錄下的套接字檔案名。</p>
			<p>如果遇到錯誤消息「無法連接到<span><span>some_host</span>上的<span>MySQL</span>伺服器</span>」，可嘗試採取下述步驟以找出問題所在：</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>執行「<span><span>telnet 
			some_host 3306<span>」</span></span>並按兩次回車鍵，檢查伺服器是否運行在該主機上（</span><span>3306</span>是預設的<span>MySQL</span>端口號。如果您的伺服器正在監聽不同的端口，請更改該值）。如果有<span>1</span>個<span>MySQL</span>伺服器正在運行並監聽該端口，您應收到包含伺服器版本號的回應。如果遇到錯誤，如「<span><span>telnet:</span>無法連接到遠程主機<span>:</span>拒絕連接<span>」</span>，資料表示在該定端口上沒有運行的伺服器。</span></p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>如果伺服器正運行在本地主機上，請使用<span>Unix</span>套接字檔案，並使用<strong><span>mysqladmin 
			-h localhost variables</span></strong>進行連接。驗證伺服器監聽的<span>TCP/IP</span>端口號（它是<span>port</span>變數的值）。</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>確保您的<strong><span>mysqld</span></strong>伺服器未用<span><span>--skip-networking</span>選項啟動。</span>如果使用了該選項，將無法使用<span>TCP/IP</span>連接到它。</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>檢查並確認不存在屏蔽了對<span>MySQL</span>訪問的防火牆。需要配置諸如<span>ZoneAlarm</span>和<span>Windows 
			XP</span>個人防火牆等應用程式，以允許對<span>MySQL</span>伺服器的外部訪問。</p>
			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="can-not-connect-to-server-on-windows"></a>A.2.2.1. 在Windows上與MySQL伺服器的連接失敗</h4></div></div></div></div></div><div class="section"><div class="titlepage"><div><div>
		當您在具有很多<span>TCP/IP</span>連接的<span>Windows</span>上運行<span>MySQL</span>伺服器，並經常在客戶端上遇到「無法連接到<span>MySQL</span>伺服器」錯誤時，可能是因為<span>Windows</span>不允許足夠的臨時（短命）端口用於這類連接。<p>
		預設情況下，<span>Windows</span>允許用於使用<span>5000</span>個臨時（短命）<span>TCP</span>端口。任何端口關閉後，它將在<span><span>TIME_WAIT</span>狀態保持<span>120</span>秒。與重新初始化全新的連接相比，該狀態允許以更低的開銷重新使用連接。</span>但是，在該時間逝去前，無法再次使用該端口。</p>
		<p>對於小的可用<span>TCP</span>端口堆棧（<span>5000</span>），以及具有<span><span>TIME_WAIT</span>狀態的大量在短時間內打開和關閉的</span><span>TCP</span>端口，您很可能遇到端口耗盡問題。處理該問題的方法有兩種：</p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>通過調查連接池以及可能的持久連接，減少快速消耗的<span>TCP</span>端口數。</p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>調整<span>Windows</span>註冊資料表中的某些設置（請參見下面）。</p>
		<p><strong><span>要點：下述步驟涉及更改<span>Windows
		</span>註冊資料表。更改註冊資料表之前，請備份註冊資料表，並確認您已掌握在出現問題時恢復註冊資料表的方法。關於備份年、恢復和編輯註冊資料表的更多訊息，請請參見<span>Microsoft</span>知識庫中的下述文獻：<span><a target="_top"  href="http://support.microsoft.com/kb/256986/EN-US/">http://support.microsoft.com/kb/256986/EN-US/</a></span>。</span></strong></p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>啟動註冊資料表編輯器（<span>Regedt32.exe</span>）。</p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>在註冊資料表中確定下述鍵值的位置：</p>
		<pre><span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters</span></pre>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>在「編輯」菜單上點擊「新增值」，然後增加下述註冊值：</p>
		<pre><span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span>Value Name: MaxUserPort</span></pre>
		<pre><span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span>Data Type: REG_DWORD</span></pre>
		<pre><span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span>Value: 65534</span></pre>
		<p>它用於設置為任何用戶提供的臨時端口數。有效範圍介於<span>5000</span>和<span>65534</span>之間（十進制）。預設值為<span>0x1388</span>（<span>5000</span>，十進制）。</p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>在「編輯」菜單上點擊「新增值」，然後增加下述註冊值：</p>
		<pre><span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span>Value Name: TcpTimedWaitDelay</span></pre>
		<pre><span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span>Data Type: REG_DWORD</span></pre>
		<pre><span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span>Value: 30</span></pre>
		<p>它用於設置關閉之前將<span>TCP</span>端口連接保持在<span><span>TIME_WAIT</span>狀態的秒數。</span>有效範圍介於<span>0</span>秒和<span>300</span>秒之間。預設值為<span>0x78</span>（<span>120</span>秒）。</p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>退出註冊資料表編輯器。</p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>重新引導機器。</p>
		<p>註釋：撤銷上述設置十分簡單，就像刪除您建立的註冊資料表一樣。</p>
		<h3 class="title"><a name="old-client"></a>A.2.3. 客戶端不支援鑒定協議</h3></div></div></div>
		<p><span>MySQL 5.1</span>採用了基於密碼混編算法的鑒定協議，它與早期客戶端（<span>4.1</span>之前）使用的協議不兼容。如果您將伺服器升級到<span>4.1</span>之上，用早期的客戶端進行連接可能失敗，並給出下述消息：</p>
		<pre><span>shell&gt; <span><b>mysql</b></span></span></pre>
		<pre>客戶端不支援伺服器請求的鑒定協議：請考慮升級<span>MySQL</span>客戶端。</pre>
		<p>要想解決該問題，應使用下述方法之一：</p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>升級所有的客戶端程式，以使用<span>4.1.1</span>或更新的客戶端庫。</p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>用<span>4.1</span>版之前的客戶端連接到伺服器時，請使用仍具有<span>4.1</span>版之前風格密碼的帳號。</p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>對於需要使用<span>4.1</span>版之前的客戶端的每位用戶，將密碼恢復為<span>4.1</span>版之前的風格。可以使用<span><span>SET 
		PASSWORD</span>語句和<span>OLD_PASSWORD()</span>函數完成該任務：</span></p>
		<pre><span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span>mysql&gt; <span><b>SET PASSWORD FOR</b></span></span></pre>
		<pre><span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span><b>&#39;<i>some_user</i>&#39;@&#39;<i>some_host</i>&#39; = OLD_PASSWORD(&#39;<i>newpwd</i>&#39;);</b></span></span></pre>
		<p>也可以使用<span>UPDATE</span>和<span>FLUSH 
		PRIVILEGES</span>：</p>
		<pre><span>mysql&gt; <span><b>UPDATE mysql.user SET Password = OLD_PASSWORD(&#39;<i>newpwd</i>&#39;)</b></span></span></pre>
		<pre><span>&nbsp;&nbsp;&nbsp; -&gt; <span><b>WHERE Host = &#39;<i>some_host</i>&#39; AND User = &#39;<i>some_user</i>&#39;;</b></span></span></pre>
		<pre><span>mysql&gt; <span><b>FLUSH PRIVILEGES;</b></span></span></pre>
		<p>用您打算使用的密碼替換前例中的「<span><i><span>newpwd</span></i></span>」。<span>MySQL</span>不能告訴您原來的密碼是什麼，因此，您需要選擇新的密碼。</p>
		<p>
		<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
		</span></span>通知伺服器使用舊的密碼混編算法：</p>
		<p><span>1.<span>&nbsp;&nbsp;&nbsp;
		</span></span>使用「<span>--old-passwords</span>」選項啟動<strong><span>mysqld</span></strong>。</p>
		<p><span>2.<span>&nbsp;&nbsp;&nbsp;
		</span></span>對於已將密碼更新為較長<span>4.1</span>格式的每個帳號，為其指定具有舊格式的密碼。可以使用下述查詢確定這些帳號：</p>
		<pre><span>3.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>mysql&gt; <span><b>SELECT Host, User, Password FROM mysql.user</b></span></span></pre>
		<pre><span>4.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span><b>WHERE LENGTH(Password) &gt; 16;</b></span></span></pre>
		<p>對於查詢顯示的每個帳號記錄，請使用<span>Host</span>和<span><span>User</span>值，並使用<span>OLD_PASSWORD()</span>函數以及<span>SET 
		PASSWORD</span></span>或<span><span>UPDATE</span>之一指定密碼，如前面所介紹的那樣。</span></p>
		<p><strong><span>註釋：</span></strong>在早期的<span>PHP</span>版本中，<span><span>mysql</span>延伸不支援</span><span>MySQL 
		4.1.1</span>和更高版中的鑒定協議。無論使用的<span>PHP</span>版本是什麼，它均是正確的。如果您打算與<span>MySQL 
		4.1</span>或更高版本一起使用<span><span>mysql</span>延伸，需要使用前面介紹的選項之一，配置</span><span>MySQL</span>，以便與較早的客戶端一起使用。<span><span>mysqli</span>延伸（支援<span>「</span>改進的<span>MySQL」</span>，在</span><span>PHP 
		5</span>中增加）與<span>MySQL 4.1</span>和更高版本中使用的改進的密碼混編算法兼容，不需要對<span>MySQL</span>進行特殊配置就能使用該<span>MySQL</span>客戶端庫。關於<span>mysqli</span>延伸的更多訊息，請參見<span><a target="_top"  href="http://php.net/mysqli">http://php.net/mysqli</a></span>。</p>
		<p>關於密碼混編和鑒定功能的額外背景知識，請參見<a href="database-administration.html#password-hashing" title="5.7.9. Password Hashing in MySQL 4.1">5.7.9節，「MySQL 4.1中的密碼哈希處理」</a>。</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="password-too-long"></a>
			A.2.4.&nbsp;輸入密碼時出現密碼錯誤</h3></div></div></div></div><div class="section"><div class="titlepage"><div><div>
			使用無下述密碼值的「<span><span>—password」</span>或</span>「<span>-p」</span>選項使用時，<span>MySQL</span>客戶端程式將提示輸入密碼：<pre><span>shell&gt; <span><b>mysql -u <i>user_name</i> -p</b></span></span></pre>
			<pre><span>Enter password:</span></pre>
			<p>在某些系統上，當您在選項檔案或命令行上指定時，您可能會發現密碼能夠工作，但是當您在「<span>Enter 
			password:</span>」提示下以交互方式輸入密碼時，您可能會發現輸入的密碼不工作。當系統所提供的用於讀取密碼的庫將密碼值限定在少數字元時（典型情況下為<span>8</span>個），就會出現該問題。這是與系統庫有關的問題，與<span>MySQL</span>無關。要想處理該問題，可將<span>MySQL</span>密碼更改為由<span>8</span>個字元或更少字元構成的值，或將密碼置於選項檔案中。</p>
			<h3 class="title"><a name="blocked-host"></a>A.2.5. 主機的hos<em class="replaceable">t_name被屏蔽</em></h3></div></div></div>
			<p>如果遇到下述錯誤，資料表示<strong><span>mysqld</span></strong>已收到來來自主機「<span><i><span>host_name</span></i></span>」的很多連接請求，但該主機卻在中途中斷。</p>
			<pre>由於出現很多連接錯誤，主機<span>&#39;<span><i>host_name</i></span>&#39;</span>被屏蔽。</pre>
			<pre>可使用<span>&#39;mysqladmin flush-hosts&#39;</span>解除屏蔽。</pre>
			<p>允許的中斷連接請求的數目由<span><span>max_connect_errors</span>系統變數的值決定。</span>當超出<span><span>max_connect_errors</span>規定的連接請求時，</span><strong><span>mysqld</span></strong>將認為某處出錯（例如，某人正試圖插入），並屏蔽主機的進一步連接請求，直至執行了<strong><span>mysqladmin 
			flush-hosts</span></strong>命令，或發出了<span><span>FLUSH 
			HOSTS</span>語句為止</span>。請參見<a href="database-administration.html#server-system-variables" title="5.3.3. Server System Variables">5.3.3節，「伺服器系統變數」</a>。</p>
			<p>在預設情況下，<strong><span>mysqld</span></strong>會在<span>10</span>次連接錯誤後屏蔽主機。您可以通過下述方式啟動伺服器來調整該值：</p>
			<pre><span>shell&gt; <span><b>mysqld_safe --max_connect_errors=10000 &amp;</b></span></span></pre>
			<p>如果在給定主機上遇到該錯誤，首先應核實該主機的<span>TCP/IP</span>連接是否正確。如果存在網絡問題，增加<span><span>max_connect_errors</span>變數的值不會有任何好處。</span></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="too-many-connections"></a>A.2.6. 連接數過多</h3></div></div></div>
			<p>當您試圖連接到<strong><span>mysqld</span></strong>伺服器時遇到「過多連接」錯誤，這資料表示所有可用的連接均已被其他客戶端使用。</p>
			<p>允許的連接數由<span><span>max_connections</span>系統變數控制。</span>預設值為<span>100</span>。如果需要支援更多的連接，應使用該變數的較大值重啟<strong><span>mysqld</span></strong>。</p>
			<p><strong><span>mysqld</span></strong>實際上允許<span><span>max_connections+1</span>個客戶端進行連接。</span>額外的連接保留給具有<span><span>SUPER</span>權限的帳號。通過為系統管理員而不是普通用戶授予<span>SUPER</span>權限（普通用戶不應具有該權限），系統管理員能夠連接到伺服器，</span>並使用<span><span>SHOW 
			PROCESSLIST</span>來診斷問題，即使已連接的無特權客戶端數已達到最大值也同樣。</span>請參見<a href="sql-syntax.html#show-processlist" title="13.5.4.16. SHOW PROCESSLIST Syntax">13.5.4.16節，「SHOW 
		PROCESSLIST語法」</a>。</p>
			<p><span>MySQL</span>能支援的最大連接數取決於給定平台上線程庫的質量。<span>Linux</span>或<span>Solaris</span>應能支援<span>500-1000</span>個並發連接，具體情況取決於<span>RAM</span>容量，以及客戶端正在作什麼。<span>MySQL 
			AB</span>提供的靜態<span>Linux</span>庫能支援高達<span>4000</span>個連接。</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="out-of-memory"></a>A.2.7. 內存溢出</h3></div></div></div>
			<p>如果使用<strong><span>mysql</span></strong>客戶端程式發出了查詢，並收到下述錯誤之一，則資料表示<strong><span>mysql</span></strong>沒有足夠內存來保存全部查詢結果：</p>
			<pre><span>mysql: Out of memory at line 42, &#39;malloc.c&#39;</span></pre>
			<pre><span>mysql: needed 8136 byte (8k), memory in use: 12481367 bytes (12189k)</span></pre>
			<pre>錯誤<span>2008: MySQL client ran out of memory</span></pre>
			<p>要想更正該問題，首先應檢查查詢是否正確。返回這麼多行是否合理？如果不合理，更正查詢並再次嘗試。否則，應使用「<span>--quick</span>」選項使用<strong><span>mysql</span></strong>。這樣，將使用<span>mysql_use_result()</span><span> 
			C API</span>函數來檢索結果集，這類函數能夠降低客戶端上的負載（但會加重伺服器上的負載）。</p>
			<div class="titlepage">
				<div>
					<div>
						<h3 class="title"><a name="gone-away"></a>A.2.8. MySQL伺服器不可用</h3>
					</div></div></div><a class="indexterm" name="id3074891"></a>
			<a class="indexterm" name="id3074900"></a>
			<p>在本節中，還介紹了出現查詢錯誤期間，與丟失了伺服器連接有關的事宜。</p>
			<p><span>MySQL</span>伺服器不可用錯誤的最常見原因是伺服器超時以及連接已關閉。在該情況下，通常能見到下述錯誤代碼之一（具體的錯誤代碼與作業系統有關）：</p>
			<table border="1" cellpadding="0" id="table1">
				<tr>
					<td>
					<p><strong><span>
					錯誤代碼</span></strong></td>
					<td>
					<p><strong><span>
					描述</span></strong></td>
				</tr>
				<tr>
					<td>
					<p>
					<span>CR_SERVER_GONE_ERROR</span></td>
					<td>
					<p>客戶端無法將問題發送至伺服器。</td>
				</tr>
				<tr>
					<td>
					<p>
					<span>CR_SERVER_LOST</span></td>
					<td>
					<p>寫入伺服器時客戶端未收到錯誤，但也未獲得問題的完整答案（或任何答案）。</td>
				</tr>
			</table>
			<p>在預設情況下，如果未發生任何事，<span>8</span>小時後伺服器將關閉連接。也可以在啟動<strong><span>mysqld</span></strong>時，通過設置<span><span>wait_timeout</span>變數更改時間限制</span>。請參見<a href="database-administration.html#server-system-variables" title="5.3.3. Server System Variables">5.3.3節，「伺服器系統變數」</a><span>. </span></p>
			<p>如果有<span>1</span>個指令，您僅需要再次發出查詢，讓客戶端再次進行自動連接即可。其中，假定在客戶端中啟用了自動再連接功能（對於<span>mysql</span>命令行客戶端，這是預設設置）。</p>
			<p><span>MySQL</span>伺服器不可用錯誤的一些其他常見原因如下：</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>您（或<span>db</span>系統管理員）使用<span>KILL</span>語句或<strong><span>mysqladmin 
			kill</span></strong>命令殺死了正在運行的線程。</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>您試圖在關閉了與伺服器的連接後運行查詢。這表明應更正應用程式中的邏輯錯誤。</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>您在客戶端一側遇到<span>TCP/IP</span>連接超時錯誤。如果您使用了命令：<span>mysql_options(..., 
			MYSQL_OPT_READ_TIMEOUT,...)</span>或<span><span>mysql_options(..., 
			MYSQL_OPT_WRITE_TIMEOUT,...)</span>，就可能出現該問題。</span>在該情況下，增加超時值可能有助於問題的解決。</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>您在伺服器端遇到超時錯誤，而且禁止了客戶端中的自動再連接功能（<span><span>MYSQL</span>結構中的再連接標誌等於<span>0</span>）。</span></p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>您正在使用<span>Windows</span>客戶端，而且在發出命令之前伺服器撤銷了連接（或許是因為已超過<span><span>wait_timeout</span>）</span>。</p>
			<p>在<span>Windows</span>平台上出現問題的原因，在某些情況下，將<span>TCP/IP</span>連接寫入伺服器時，<span>MySQL</span>未收到來自作業系統的錯誤，但當試圖從連接讀取答案時出現錯誤。</p>
			<p>在該情況下，即使<span><span>MYSQL</span>結構中的再連接標誌等於<span>1</span>，</span><span>MySQL</span>也不會執行自動再連接並再次發出查詢，這是因為它不知道伺服器是否收到原始查詢。</p>
			<p>對此的解決方式是：如果自上一次查詢以來經過了較長時間，在連接上執行<span>mysql_ping</span>（正是<span><span>MyODBC</span>所作的）；或在</span><strong><span>mysqld</span></strong>伺服器上將<span><span>wait_timeout</span>設置得很高，使之實際上不存在超時。</span></p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>如果您向伺服器發出了不正確或過大的查詢，也會遇到這類問題。如果<strong><span>mysqld</span></strong>收到過大或無序的訊息包，它會認為客戶端出錯，並關閉連接。如果需要執行較大的查詢（例如，正在處理大的<span><span>BLOB</span>列），</span>可通過設置伺服器的<span><span>max_allowed_packet</span>變數，增加查詢限制值，該變數的預設值為</span><span>1MB</span>。或許，您還需增加客戶端上的最大訊息包大小。關於設置訊息包大小的更多訊息，請參見<a href="problems.html#packet-too-large" title="A.2.9. Packet too large">A.2.9節，「訊息包過大」</a>。</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>如果您的客戶端低於<span>4.0.8</span>而且您的伺服器高於<span>4.0.8</span>，當您接收<span>16MB</span>或更大的訊息包時，可能會丟失連接。</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>如果<span>MySQL</span>是用「<span>--skip-networking</span>」選項啟動的，也會見到<span>MySQL</span>伺服器不可用錯誤。</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>您遇到了執行查詢時伺服器宕機的問題。</p>
			<p>通過執行<strong><span>mysqladmin 
			version</span></strong>並檢查伺服器的正常工作時間，可檢查伺服器是否宕機並重啟。如果客戶端連接是因<strong><span>mysqld</span></strong>崩潰和重啟而中斷的，應將重點放在搜尋崩潰您方面。首先應再次檢查發出的查詢是否再次殺死了伺服器。請參見<a href="problems.html#crashing" title="A.4.2. What to Do If MySQL Keeps Crashing">A.4.2節，「如果MySQL依然崩潰，應作些什麼」</a>。</p>
			<p>用「<span><span>--log-warnings=2<span>」</span></span>選項啟動</span><span>mysqld</span>，可獲得關於連接的更多訊息。這樣，就能將某些中斷連接錯誤記錄到<span><span>hostname.err</span>檔案中</span>。請參見<a href="database-administration.html#error-log" title="5.11.1. The Error Log">5.11.1節，「錯誤日誌」</a>。</p>
			<p>如果您打算建立與該問題有關的問題報告，務必包含下述訊息：</p>
			<p>
			<span>1.<span>&nbsp;&nbsp;&nbsp;
			</span></span>指明<span>MySQL</span>伺服器是否宕機。通過伺服器錯誤日誌可發現這方面的訊息。請參見<a href="problems.html#crashing" title="A.4.2. What to Do If MySQL Keeps Crashing">A.4.2節，「如果MySQL依然崩潰，應作些什麼」</a>。</p>
			<p>
			<span>2.<span>&nbsp;&nbsp;&nbsp;
			</span></span>如果特定查詢殺死了<strong><span>mysqld</span></strong>，而且在運行查詢前用<span><span>CHECK 
			TABLE</span>檢查了涉及的資料表，您是否能提供可重複的測試範例？</span>請參見<a href="porting.html#reproduceable-test-case" title="E.1.6. Making a Test Case If You Experience Table Corruption">E.1.6節，「如果出現資料表崩潰，請生成測試案例」</a>。</p>
			<p>
			<span>3.<span>&nbsp;&nbsp;&nbsp;
			</span></span>在<span>MySQL</span>伺服器中，系統變數<span><span>wait_timeout</span>的值是什麼？</span>（<strong><span>mysqladmin 
			variables</span></strong>給出了該變數的值）。</p>
			<p>
			<span>4.<span>&nbsp;&nbsp;&nbsp;
			</span></span>您是否嘗試使用「<span>--log</span>」選項來運行<strong><span>mysqld</span></strong>，以確定是否在日誌中出現問題？</p>
			<p>另請參見<a href="problems.html#communication-errors" title="A.2.10. Communication Errors and Aborted Connections">A.2.10節，「通信錯誤和失效連接」</a>。</p>
			<p>請參見<a href="introduction.html#asking-questions" title="1.7.1.2. Asking Questions or Reporting Bugs">1.7.1.2節，「請教問題或通報問題」</a>。</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="packet-too-large"></a>A.2.9. 訊息包過大</h3></div></div></div>
			<p>通信訊息包是發送至<span>MySQL</span>伺服器的單個<span>SQL</span>語句，或發送至客戶端的單一行。</p>
			<p>在<span>MySQL 5.1</span>伺服器和客戶端之間最大能發送的可能訊息包為<span>1GB</span>。</p>
			<p>當<span>MySQL</span>客戶端或<strong><span>mysqld</span></strong>伺服器收到大於<span><span>max_allowed_packet</span>字節的訊息包時，將發出<span>「</span>訊息包過大<span>」</span>錯誤，並關閉連接。對於某些客戶端，如果通信訊息包過大，在執行查詢期間，了能回遇到<span>「</span>丟失與<span>MySQL</span>伺服器的連接<span>」</span>錯誤。</span></p>
			<p>客戶端和伺服器均有自己的<span><span>max_allowed_packet</span>變數，</span>因此，如您打算處理大的訊息包，必須增加客戶端和伺服器上的該變數。</p>
			<p>如果您正在使用<strong><span>mysql</span></strong>客戶端程式，其<span><span>max_allowed_packet</span>變數的預設值為</span><span>16MB</span>。要想設置較大的值，可用下述方式啟動<strong><span>mysql</span></strong>：</p>
			<pre><span>mysql&gt; <span><b>mysql --max_allowed_packet=32M</b></span></span></pre>
			<p>它將訊息包的大小設置為<span>32MB</span>。</p>
			<p>伺服器的預設<span><span>max_allowed_packet</span>值為</span><span>1MB</span>。如果伺服器需要處理大的查詢，可增加該值（例如，如果準備處理大的<span>BLOB</span>列）。例如，要想將該設置為<span>16MB</span>，可採用下述方式啟動伺服器：</p>
			<pre><span>mysql&gt; <span><b>mysqld --max_allowed_packet=16M</b></span></span></pre>
			<p>也能使用選項檔案來設置<span><span>max_allowed_packet</span>。</span>要想將伺服器的該變數設置為<span>16MB</span>，可在選項檔案中增加下行內容：</p>
			<pre><span>[mysqld]</span></pre>
			<pre><span>max_allowed_packet=16M</span></pre>
			<p>增加該變數的值十分安全，這是因為僅當需要時才會分配額外內存。例如，僅當您發出長查詢或<strong><span>mysqld</span></strong>必須返回大的結果行時<strong><span>mysqld</span></strong>才會分配更多內存。該變數之所以取較小預設值是一種預防措施，以捕獲客戶端和伺服器之間的錯誤訊息包，並確保不會因偶然使用大的訊息包而導致內存溢出。</p>
			<p>如果您正是用大的<span>BLOB</span>值，而且未為<strong><span>mysqld</span></strong>授予為處理查詢而訪問足夠內存的權限，也會遇到與大訊息包有關的奇怪問題。如果懷疑出現了該情況，請嘗試在<strong><span>mysqld_safe</span></strong>指令開始增加<strong><span>ulimit 
			-d 256000</span></strong>，並重啟<strong><span>mysqld</span></strong>。</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="communication-errors"></a>
			A.2.10.&nbsp;通信錯誤和失效連接</h3></div></div></div><a class="indexterm" name="id3075540"></a><a class="indexterm" name="id3075546"></a><a class="indexterm" name="id3075553"></a>
			<p>對於連接問題，伺服器錯誤日誌是有用的資訊來源。請參見<a href="database-administration.html#error-log" title="5.11.1. The Error Log">5.11.1節，「錯誤日誌」</a>。如果伺服器是用「<span>--log-warnings</span>」選項啟動的，在錯誤日誌中可能會發現下述消息：</p>
			<pre><span>010301 14:38:23&nbsp; Aborted connection 854 to db: &#39;users&#39; user: &#39;josh&#39;</span></pre>
			<p>如果「<span><span>Aborted 
			connections」</span>（放棄連接）消息出現在錯誤日誌中，可能的原因是：</span></p>
			<p>
			<span>1.<span>&nbsp;&nbsp;&nbsp;
			</span></span>客戶端程式在退出之前未使用<span><span>mysql_close()</span>。</span></p>
			<p>
			<span>2.<span>&nbsp;&nbsp;&nbsp;
			</span></span>客戶端的空閒時間超過<span><span>wait_timeout</span>或<span>interactive_timeout</span>秒，未向伺服器發出任何請求。</span>請參見<a href="database-administration.html#server-system-variables" title="5.3.3. Server System Variables">5.3.3節，「伺服器系統變數」</a>。</p>
			<p>
			<span>3.<span>&nbsp;&nbsp;&nbsp;
			</span></span>客戶端在數據傳輸中途突然結束。</p>
			<p>出現這類情況時，伺服器將增加「<span><span>Aborted_clients」</span>（放棄客戶端）狀態變數。</span></p>
			<p>出現下述情況時，伺服器將增加「<span><span>Aborted_clients」</span>（放棄客戶端）狀態變數。</span></p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>客戶端不具有連接至資料庫的權限。</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>客戶端採用了不正確的密碼。</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>連接訊息包不含正確訊息。</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>獲取連接訊息包的時間超過<span><span>connect_timeout</span>秒。</span>請參見<a href="database-administration.html#server-system-variables" title="5.3.3. Server System Variables">5.3.3節，「伺服器系統變數」</a>。</p>
			<p>如果出現這類情況，可能表明某人正試圖侵入您的伺服器！</p>
			<p>對於放棄客戶端或放棄連接問題，其他可能的源應包括：</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>與<span>Linux</span>一起使用以太網協議，半雙工或全雙工。很多<span>Linux</span>以太網驅動均存在該問題。應通過<span>FTP</span>在客戶端和伺服器機器之間傳輸大檔案來測試該問題。如果傳輸處於<span>burst-pause-burst-pause</span>（爆發<span>-</span>暫停<span>-</span>爆發<span>-</span>暫停）模式，表明您遇到了<span>Linux</span>雙工故障。唯一的解決方法是，將網卡和<span>Hub/</span>交換器的雙工模式切換為全雙工或半雙工，並對結果進行測試以確定最佳設置。</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>與線程庫有關的某些問題導致讀取中斷。</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>配置不良的<span>TCP/IP</span>。</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>有問題的以太網、<span>Hub</span>、交換器、電纜等。僅能通過更換硬件才能恰當診斷。</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>變數<span><span>max_allowed_packet</span>過小或</span>查詢要求的內存超過為<strong><span>mysqld</span></strong>分配的內存。請參見<a href="problems.html#packet-too-large" title="A.2.9. Packet too large">A.2.9節，「訊息包過大」</a>。</p>
			<p>另請參見<a href="problems.html#gone-away" title="A.2.8. MySQL server has gone away">A.2.8節，「MySQL伺服器不可用」</a>。</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="full-table"></a>A.2.11. 資料表已滿</h3></div></div></div><a class="indexterm" name="id3075795"></a>
			<p>資料表已滿錯誤出現的方式有數種：</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>您正在使用低於<span>3.23</span>版的<span>MySQL</span>伺服器，而且「內存中」臨時資料表超過了<span><span>tmp_table_size</span>字節。</span>要想避免該問題，可使用「<span>-O 
			tmp_table_size=<i>val</i></span>」選項以便<strong><span>mysqld</span></strong>增加臨時資料表的大小，或在發出有問題的查詢之前，使用<span>SQL</span>選項<span><span>SQL_BIG_TABLES</span>。</span>請參見<a href="sql-syntax.html#set-option" title="13.5.3. SET Syntax">13.5.3節，「SET語法」</a>。</p>
			<p>也可以使用「<span>--big-tables</span>」選項啟動<strong><span>mysqld</span></strong>。它與使用針對所有查詢的<span><span>SQL_BIG_TABLES</span>完全相同。</span></p>
			<p>自<span>MySQL 3.23</span>起，該問題應不再出現。如果「內存中」臨時資料表超過<span>tmp_table_size</span>，伺服器會自動將其轉換為基於磁盤的<span>MyISAM</span>資料表。</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>您正在使用<span><span>InnoDB</span>資料表，</span>並超出了<span><span>InnoDB</span>資料表空間。</span>在該情況下，解決方法是增加<span>InnoDB</span>資料表空間。請參見<a href="storage-engines.html#adding-and-removing" title="15.2.7. Adding and Removing InnoDB Data and Log Files">15.2.7節，「新增和刪除InnoDB數據和日誌檔案<code class="literal"></code>」</a>。</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>您正在僅支援<span>2GB</span>檔案的作業系統上使用<span>ISAM</span>或<span><span>MyISAM</span>資料表，數據檔案或索引檔案達到了該限制值。</span></p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>您正在使用<span><span>MyISAM</span>資料表，而且資料表所需的空間超過內部指針允許的大小。如果在建立資料表時未指定<span>MAX_ROWS</span>資料表，</span><span>MySQL</span>將使用<span><span>myisam_data_pointer_size</span>系統變數。</span>預設值為<span>6</span>字節，它足以容納<span>65536TB</span>數據。請參見<a href="database-administration.html#server-system-variables" title="5.3.3. Server System Variables">5.3.3節，「伺服器系統變數」</a>。</p>
			<p>使用該語句，可檢查最大數據<span>/</span>索引大小：</p>
			<pre><span>SHOW TABLE STATUS FROM database LIKE &#39;<span><i>tbl_name</i></span>&#39;;</span></pre>
			<p>也可以使用<strong><span>myisamchk 
			-dv /path/to/table-index-file</span></strong>。</p>
			<p>如果指針大小過小，可使用<span>ALTER 
			TABLE</span>更正該問題：</p>
			<pre><span>ALTER TABLE <span><i>tbl_name</i></span> MAX_ROWS=1000000000 AVG_ROW_LENGTH=<span><i>nnn</i></span>;</span></pre>
			<p>僅應為具有<span>BLOB</span>或<span><span>TEXT</span>列的資料表指定<span>AVG_ROW_LENGTH</span>。</span>在該情況下，<span>MySQL</span>不能僅根據行數最佳化所需的空間。</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="cannot-create"></a>A.2.12. 無法建立檔案／寫入檔案</h3></div></div></div><a class="indexterm" name="id3076019"></a>
			<p>如果對某些查詢遇到下述類型的錯誤，它意味著<span>MySQL</span>不能為臨時目錄下的結果集建立臨時檔案：</p>
			<pre>無法建立<span>/</span>寫入檔案<span>&#39;\\sqla3fe_0.ism&#39;</span>。</pre>
			<p>前述錯誤是<span>Windows</span>平台上的典型消息，<span>Unix</span>平台上的消息與之類似。</p>
			<p>一種更正方式是使用「<span>--tmpdir</span>」選項啟動<strong><span>mysqld</span></strong>，或在選項檔案的<span><span>[mysqld]</span>部分增加該選項。</span>例如，要想指定目錄<span>C:\temp</span>，可使用：</p>
			<pre><span>[mysqld]</span></pre>
			<pre><span>tmpdir=C:/temp</span></pre>
			<p>目錄<span><span>C:\temp</span>必須存在，</span>並有足夠的空間允許<span>MySQL</span>寫入它。請參見<a href="using-mysql-programs.html#option-files" title="4.3.2. Using Option Files">4.3.2節，「使用選項檔案」</a>。</p>
			<p>該錯誤的另一個原因可能是授權事宜。請確認<span>MySQL</span>伺服器能夠寫入<span>tmpdir</span>目錄。</p>
			<p>此外，還用使用<strong><span>perror</span></strong>檢查錯誤代碼。伺服器無法寫入資料表的一個原因是檔案系統已滿。</p>
			<pre><span>shell&gt; <span><b>perror 28</b></span></span></pre>
			<pre>錯誤代碼<span>28</span>：磁盤上無剩餘空間。</pre>
		</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="commands-out-of-sync"></a>A.2.13. 命令不同步</h3></div></div></div><a class="indexterm" name="id3076120"></a></div><div class="section"><div class="titlepage"><div><div>
		如果遇到「命令不同步」錯誤，將無法在您的客戶端代碼中運行該命令，您正在以錯誤順序使用客戶端函數。<p>例如，如果您正使用<span><span>mysql_use_result()</span>，並打算在使用<span>mysql_free_result()</span>之前執行新查詢，就會出現該問題。如果您試圖執行兩次查詢，但並未在兩次查詢之間使用<span>mysql_use_result()</span></span>或<span><span>mysql_store_result()</span>，也會出現該問題。</span></p>
		<h3 class="title"><a name="ignoring-user"></a>A.2.14. 忽略用戶</h3></div></div></div>
		<p>如果遇到下述錯誤，資料表示當啟動<strong><span>mysqld</span></strong>時或重新加載授權資料表時，在用戶資料表中發現具有非法密碼的帳號。</p>
		<p><span>發現用戶<span>&#39;<i>some_user</i>&#39;@&#39;<i>some_host</i>&#39;</span>密碼錯誤：忽略用戶。</span></p>
		<p>作為其結果，授權系統將簡單忽略帳號。</p>
		<p>在下面的介紹中，指明了可能的原因和問題的更正措施：</p>
		<p>
		<span>1.<span>&nbsp;&nbsp;&nbsp;
		</span></span>或許，您正打算用舊的用戶資料表運行新版本的<strong><span>mysqld</span></strong>。執行<strong><span>mysqlshow 
		mysql user</span></strong>檢查<span>Password</span>（密碼）列是否短於<span>16</span>個字元，通過該方式可檢查該問題。如果結果是肯定的，可運行指令<span><span>/add_long_password</span>指令更正該問題。</span></p>
		<p><span>
		2.<span>&nbsp;&nbsp;&nbsp; </span>
		</span>帳號具有舊的密碼（<span>8</span>字元長），而且未使用「<span>--old-protocol</span>」選項啟動<strong><span>mysqld</span></strong>。更新用戶資料表中的帳號，使之具有新的密碼，或使用「<span>--old-protocol</span>」選項重啟<strong><span>mysqld</span></strong>。</p>
		<p>
		<span>3.<span>&nbsp;&nbsp;&nbsp;
		</span></span>
            <a class="indexterm" name="id3081907"></a>

            在用戶資料表中未使用<span><span>PASSWORD()</span>函數指定了密碼。</span>使用<strong><span>mysql</span></strong>用新密碼更新用戶資料表中的帳號，務必使用<span><span>PASSWORD()</span>函數：</span></p>
		<pre><span>4.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span>mysql&gt; <span><b>UPDATE user SET Password=PASSWORD(&#39;<i>newpwd</i>&#39;)</b></span></span></pre>
		<pre><span>5.<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&nbsp;&nbsp;&nbsp;&nbsp;-&gt; <span><b>WHERE User=&#39;<i>some_user</i>&#39; AND Host=&#39;<i>some_host</i>&#39;;</b></span></span></pre>
		</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="cannot-find-table"></a>A.2.15. 資料表tbl_na<em class="replaceable">me不存在</em></h3></div></div></div>
			<p>如果遇到下述錯誤之一，通常意味著當前資料庫中不存在具有給定名稱的資料表：</p>
			<pre>資料表<span>&#39;<span><i>tbl_name</i></span>&#39;</span>不存在</pre>
			<pre>無法找到檔案：<span>&#39;<span><i>tbl_name</i></span>&#39; (errno: 2)</span></pre>
			<p>在某些情況下，資料表或許存在，但未正確引用它：</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>由於<span>MySQL</span>使用目錄和檔案來保存資料庫和資料表，如果它們位於區分檔案名大小寫的檔案系統上，資料庫和資料表名也區分檔案大小寫。</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>即使對於不區分大小寫的檔案系統，如<span>Windows</span>，在查詢內對給定資料表的所有引用必須使用相同的大小寫。</p>
			<p>可以使用<span><span>SHOW TABLES</span>檢查位於當前資料庫中的資料表</span>。請參見<a href="sql-syntax.html#show" title="13.5.4. SHOW Syntax">13.5.4節，「SHOW語法」</a>。</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="cannot-initialize-character-set"></a>A.2.16. 無法初始化字元編碼</h3></div></div></div><a class="indexterm" name="id3076423"></a>
			<p>如果存在字元編碼問題，可能會遇到下述錯誤：</p>
			<pre><span>MySQL</span>連接失敗：無法初始化字元編碼<span>charset_name</span>。</pre>
			<p>導致該錯誤的原因：</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>字元編碼為多字節字元編碼，但客戶端不支援該字元編碼。在該情況下，需要使用「<span>--with-charset=<i>charset_name</i></span>」或「<span>--with-extra-charsets=<i>charset_name</i></span>」選項運行<strong><span>configure</span></strong>以重新編譯客戶端。請參見<a href="installing.html#configure-options" title="2.8.2. Typical configure Options">2.8.2節，「典型配置選項<span><strong class="command"></strong></span>」</a>。</p>
			<p>所有的標準<span>MySQL</span>二進制檔案均是採用「<span>--with-extra-character-sets=complex</span>」編譯的，能夠支援所有的多字節字元編碼。請參見<a href="database-administration.html#character-sets" title="5.10.1. The Character Set Used for Data and Sorting">5.10.1節，「數據和排序用字元編碼」</a>。</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>字元編碼是未編譯到<strong><span>mysqld</span></strong>中的簡單字元編碼，而且字元編碼定義檔案不在客戶端預期的位置。</p>
			<p>在該情況下，需要採取下述方法之一解決問題：</p>
			<p>
			<span>1.<span>&nbsp;&nbsp;&nbsp;
			</span></span>重新編譯客戶端，使之支援字元編碼。請參見<a href="installing.html#configure-options" title="2.8.2. Typical configure Options">2.8.2節，「典型配置選項<span><strong class="command"></strong></span>」</a>。</p>
			<p>
			<span>2.<span>&nbsp;&nbsp;&nbsp;
			</span></span>為客戶端指定字元編碼定義檔案所在的目錄。對於很多客戶端，可使用「<span>--character-sets-dir</span>」選項完成該任務。</p>
			<p>
			<span>3.<span>&nbsp;&nbsp;&nbsp;
			</span></span>將字元編碼定義檔案複製到客戶端預期的位置。</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="not-enough-file-handles"></a>
			A.2.17.&nbsp;檔案未找到</h3></div></div></div>
			<p>如果遇到「<span><span>ERROR &#39;...&#39;</span>未發現<span>(errno: 
			23)」</span>，<span>「</span>無法打開檔案：<span>... (errno: 
			24)」</span>，或來自<span>MySQL</span>的具有<span>errno 
			23</span></span>或<span><span>errno 
			24</span>的其它錯誤，它資料表示未為<span>MySQL</span>伺服器分配足夠的檔案描述符</span>。您可以使用<strong><span>perror</span></strong>實用工具來瞭解錯誤編號的含義：</p>
			<pre><span>shell&gt; <span><b>perror 23</b></span></span></pre>
			<pre>錯誤代碼<span>23</span>：檔案資料表溢出</pre>
			<pre><span>shell&gt; <span><b>perror 24</b></span></span></pre>
			<pre>錯誤代碼<span>24</span>：打開檔案過多</pre>
			<pre><span>shell&gt; <span><b>perror 11</b></span></span></pre>
			<pre>錯誤代碼<span>11</span>：資源暫時不可用</pre>
			<p>這裡的問題是，<strong><span>mysqld</span></strong>正試圖同時打開過多的檔案。您可以通知<strong><span>mysqld</span></strong>不要一次打開過多檔案，或增加<strong><span>mysqld</span></strong>可用檔案描述符的數目。</p>
			<p>要想通知<strong><span>mysqld</span></strong>將一次打開的檔案控制在較小的數目上，可降低<span><span>table_cache</span>系統變數的值（），從而減少資料表高速緩衝（預設值為<span>64</span>）。降低<span>max_connections</span>的值也能降低</span>打開檔案的數目（預設值為<span>100</span>）。</p>
			<p>要想更改<strong><span>mysqld</span></strong>可用的檔案描述符的數目，可在<strong><span>mysqld_safe</span></strong>上使用「<span><span>--open-files-limit」</span>選項或設置</span>（自<span>MySQL 
			3.23.30<span>開始）</span><span>open_files_limit</span></span>系統變數。請參見<a href="database-administration.html#server-system-variables" title="5.3.3. Server System Variables">5.3.3節，「伺服器系統變數」</a>。設置這些值的最簡單方式是在選項檔案中增加<span>1</span>個選項。請參見<a href="using-mysql-programs.html#option-files" title="4.3.2. Using Option Files">4.3.2節，「使用選項檔案」</a>。如果<strong><span>mysqld</span></strong>的版本較低，不支援設置打開檔案的數目，可編輯<strong><span>mysqld_safe</span></strong>指令。在指令中有<span>1</span>個註釋掉的行<strong><span>ulimit 
			-n 256</span><span>。您可以刪除</span></strong>『<span>#</span>』字元取消對該行的註釋，更改數值<span><span>256</span>，以設置</span><strong><span>mysqld</span></strong>可用的檔案描述符數目。</p>
			<p><span><span>
			「--open-files-limit」</span>和</span><strong><span>ulimit</span></strong>能夠增加檔案描述符的數目，但最高不能超過作業系統限制的數目。此外還有<span>1</span>個「硬」限制，僅當以根用戶身份啟動<strong><span>mysqld_safe</span></strong>或<strong><span>mysqld</span></strong>時才能覆蓋它（請記住，在該情況下，還需使用「<span>--user</span>」選項啟動伺服器，以便在啟動後不再以根用戶身份繼續運行）。如果需要增加作業系統限制的對各程序可用檔案描述符的數目，請參閱系統文檔。</p>
			<p><strong><span>註釋：</span></strong>如果運行<strong><span>tcsh</span></strong><span> 
			shell</span>，<strong><span>ulimit</span></strong>不工作！請求當前限制值時，<strong><span>tcsh</span></strong>還能通報不正確的值。在該情況下，應使用<strong><span>sh</span></strong>啟動<strong><span>mysqld_safe</span><span>。</span></strong></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="installation-issues"></a>A.3. 與安裝有關的事宜</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="problems.html#link-errors">
		A.3.1. 與MySQL客戶端庫的連結問題</a></span></dt><dt><span class="section"><a href="problems.html#changing-mysql-user">
		A.3.2. 如何以普通用戶身份運行MySQL</a></span></dt><dt><span class="section"><a href="problems.html#file-permissions">
		A.3.3. 與檔案授權有關的問題</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="link-errors"></a>
			A.3.1.&nbsp;與MySQL客戶端庫的連結問題</h3></div></div></div><a class="indexterm" name="id3076813"></a><a class="indexterm" name="id3076823"></a><a class="indexterm" name="id3076833"></a>
			<p>當您連結到應用程式以使用<span>MySQL</span>客戶端庫時，可能會遇到以<span><span>mysql_</span>開始的未定義引用錯誤，如下所示：</span></p>
			<pre><span>/tmp/ccFKsdPa.o: </span>在函數<span>`main&#39;</span>中<span>:</span></pre>
			<pre><span>/tmp/ccFKsdPa.o(.text+0xb): </span>對<span>`mysql_init&#39;</span>的未定義引用。</pre>
			<pre><span>/tmp/ccFKsdPa.o(.text+0x31): </span>對<span>`mysql_real_connect&#39;</span>的未定義引用。</pre>
			<pre><span>/tmp/ccFKsdPa.o(.text+0x57): </span>對<span>`mysql_real_connect&#39;</span>的未定義引用。</pre>
			<pre><span>/tmp/ccFKsdPa.o(.text+0x69): </span>對<span>`mysql_error&#39;</span>的未定義引用。</pre>
			<pre><span>/tmp/ccFKsdPa.o(.text+0x9a): </span>對<span>`mysql_close&#39;</span>的未定義引用。</pre>
			<p>通過在連結命令後增加「<span>-Ldir_path 
			-lmysqlclient</span>」選項，應能解決該問題，其中，<span>dir_path</span>代資料表客戶端庫所在目錄的路徑名。要想確定正確的目錄，可嘗試下述命令：</p>
			<pre><span>shell&gt; <span><b>mysql_config --libs</b></span></span></pre>
			<p>來自<strong><span>mysql_config</span></strong>的輸出可能會指明應在連結命令上指定的其他庫。</p>
			<p>對於非壓縮或壓縮函數，如果遇到未定義引用錯誤，可在連結命令後新增<span><span>-lz</span>，並再次嘗試。</span></p>
			<p>對於應在系統上存在的函數（如<span>connect</span>），如果遇到未定義引用錯誤，請檢查相關函數的手冊頁，以便確定應在連結命令上增加哪些庫。</p>
			<p>對於系統上不存在的函數，可能會遇到未定義引用錯誤，如下所示：</p>
			<pre><span>mf_format.o(.text+0x201): </span>對<span>`__lxstat&#39;</span>的未定義引用。</pre>
			<p>它通常意味著您的<span>MySQL</span>客戶端庫是在與您的系統不<span>100</span>％兼容的系統上編譯的。在該情況下，應下載最新的<span>MySQL</span>原始碼分發版，並自己編譯<span>MySQL</span>。請參見<a href="installing.html#installing-source" title="2.8. MySQL Installation Using a Source Distribution">2.8節，「使用原始碼分發版安裝MySQL」</a>。</p>
			<p>當您試圖執行<span>MySQL</span>程式時，可能會遇到運行時未定義引用錯誤。如果這類錯誤指明了以<span><span>mysql_</span>開始的符號，</span>或指明未發現<span><span>mysqlclient</span>庫</span>，這意味著您的系統無法找到共享的<span><span>libmysqlclient.so</span>庫。</span>對其的更正方式是，通知系統在庫所在位置搜索共享庫。請使用與系統相適應的下述方法：</p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>將<span><span>libmysqlclient.so</span>所在目錄的路徑新增到<span>LD_LIBRARY_PATH</span>環境變數中。</span></p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>將<span><span>libmysqlclient.so</span>所在目錄的路徑新增到<span>LD_LIBRARY</span>環境變數中。</span></p>
			<p>
			<span>·<span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			</span></span>將<span><span>libmysqlclient.so</span>拷貝到可被系統搜索的目錄下，如<span>/lib</span></span>，然後通過執行<span>ldconfig</span>更新共享庫訊息。</p>
			<p>解決該問題的另一種方法是，以靜態方式將您的程式與「<span>-static</span>」選項連結在一起，或在連結代碼之前刪除動態<span>MySQL</span>庫。使用第<span>2</span>種方法之前，應確保沒有使用動態庫的其它程式。</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="changing-mysql-user"></a>
			A.3.2.&nbsp;如何以普通用戶身份運行MySQL</h3></div></div></div><a class="indexterm" name="id3077058"></a><a class="indexterm" name="id3077070"></a>
			<p>在<span>Windows</span>平台上，能夠使用普通用戶帳號以<span>Windows</span>服務方式運行伺服器。</p>
			<p>在<span>Unix</span>平台上，不是任何用戶都能啟動並運行<span>MySQL</span>伺服器<strong><span>mysqld</span><span>的</span></strong>。但是，處於安全方面的原因，應避免以<span>Unix</span>根用戶身份運行伺服器。要想更改<strong><span>mysqld</span></strong>，使之能以正常的無特權<span>Unix</span>用戶<span><i><span>user_name</span></i></span>身份運行，必須採取下述步驟：</p>
			<p>如果伺服器正在運行，停止它（使用<strong><span>mysqladmin 
			shutdown</span></strong>）。</p>
			<p>更改資料庫目錄和檔案，允許<span><i><span>user_name</span></i></span>讀寫其中的檔案（可能需要以<span>Unix</span>根用戶身份完成這類設置）：</p>
			<pre><span>shell&gt; <span><b>chown -R <i>user_name</i> <i>/path/to/mysql/datadir</i></b></span></span></pre>
			<p>如果未這樣做，當以<span><i><span>user_name</span></i></span>身份運行時，伺服器無法訪問資料庫或資料表。</p>
			<p>如果<span>MySQL</span>數據目錄下的目錄或檔案採用的是符號連結，還需跟蹤這些連結，並更改它們指向的目錄和檔案。<span><span>chown 
			–R</span>可幫助您跟蹤符號連結。</span></p>
			<p>以<span><i><span>user_name</span></i></span>身份啟動伺服器。如果您正在使用<span>MySQL 
			3.22</span>或更高版本，另一種可選方式是，以<span>Unix</span>根用戶身份啟動<strong><span>mysqld</span></strong>，並使用<span>--user=<i>user_name</i></span>選項。<strong><span>mysqld</span></strong>啟動，然後在接受任何連接前，切換至<span>Unix</span>用戶<span><i><span>user_name</span></i></span>並以該用戶身份運行。</p>
			<p>要想在系統啟動時自動以給定的用戶身份啟動伺服器，可在伺服器數據目錄下的<span>/etc/my.cnf</span>選項檔案或<span><span>my.cnf</span>選項檔案的<span>[mysqld]</span>組中，通過增加用戶選項來指定帳號。</span>。例如：</p>
			<pre><span>[mysqld]</span></pre>
			<pre><span>user=<span><i>user_name</i></span></span></pre>
			<p>如果您的<span>Unix</span>機器本身並不安全，應在授權資料表中為<span>MySQL</span>根帳號指定密碼。如不然，任何在該機器上具有登錄帳號的用戶都能使用「<span>--user=root</span>」選項運行<strong><span>mysql</span></strong>客戶端，並執行任何操作。在任何情況下均應為<span>MySQL</span>帳號指定密碼，這是個好主意，尤其是在伺服器主機上存在其他登錄帳號時，更是如此。請參見<a href="installing.html#post-installation" title="2.9. Post-Installation Setup and Testing">2.9節，「安裝後的設置和測試」</a>。</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="file-permissions"></a>
			A.3.3.&nbsp;與檔案授權有關的問題</h3></div></div></div><a class="indexterm" name="id3077282"></a><a class="indexterm" name="id3077292"></a><a class="indexterm" name="id3077303"></a><a class="indexterm" name="id3077313"></a><a class="indexterm" name="id3077322"></a>
			<p>如果遇到與檔案授權有關的問題，可能數啟動<span>mysqld</span>時<span><span>UMASK</span>環境變數設置得不正確。例如，</span>當您建立資料表時，<span>MySQL</span>可能會發出下述錯誤消息：</p>
			<pre><span>ERROR: </span>無法找到檔案：<span>&#39;path/with/filename.frm&#39; (Errcode: 13)</span></pre>
			<p><span><span>UMASK</span>的預設值是<span>0660</span></span>。通過下述方式啟動<strong><span>mysqld_safe</span></strong>，可改變該情況：</p>
			<pre><span>shell&gt; <span><b>UMASK=384&nbsp; # = 600 in octal</b></span></span></pre>
			<pre><span>shell&gt; <span><b>export UMASK</b></span></span></pre>
			<pre><span>shell&gt; <span><b>mysqld_safe &amp;</b></span></span></pre>
			<p>在預設情況下，<span>MySQL</span>用<span>0700</span>的授權建立資料庫和<span><span>RAID</span>目錄。您可以通過設置<span>UMASK_DIR</span>變數更改該行為。如果您設置了它的值，將使用組合的<span>UMASK</span></span>和<span><span>UMASK_DIR</span>值建立新目錄。例如</span>，如果您打算為所有新的目錄授予組訪問權限，可：</p>
			<pre><span>shell&gt; <span><b>UMASK_DIR=504&nbsp; # = 770 in octal</b></span></span></pre>
			<pre><span>shell&gt; <span><b>export UMASK_DIR</b></span></span></pre>
			<pre><span>shell&gt; <span><b>mysqld_safe &amp;</b></span></span></pre>
			<p>在<span>MySQL 3.23.25</span>和更高版本中，如果是以<span>0</span>開始的，<span>MySQL</span>將認為<span>UMASK</span>和<span><span>UMASK_DIR</span>的值均採用八進制形式。</span></p>
			<p>請參見<a href="environment-variables.html">附錄F：</a><a href="environment-variables.html" title="Appendix F. Environment Variables"><i>環境變數</i></a>。</p>
			<div>
				<div>
					<h2 class="title">
					<a name="administration-issues"></a>A.4.&nbsp;與管理有關的事宜</h2>
				</div></div></div>
		<div class="toc">
			<dl>
				<dt><span class="section">
				<a href="problems.html#resetting-permissions">A.4.1. 如何復位根用戶密碼</a></span></dt>
				<dt><span class="section"><a href="problems.html#crashing">A.4.2. 如果MySQL依然崩潰，應作些什麼</a></span></dt>
				<dt><span class="section"><a href="problems.html#full-disk">A.4.3. MySQL處理磁盤滿的方式</a></span></dt>
				<dt><span class="section">
				<a href="problems.html#temporary-files">A.4.4. MySQL將臨時檔案儲存在哪裡</a></span></dt>
				<dt><span class="section">
				<a href="problems.html#problems-with-mysql-sock">A.4.5. 如何保護或更改MySQL套接字檔案/tmp/mysql.sock<code class="filename"></code></a></span></dt>
				<dt><span class="section">
				<a href="problems.html#timezone-problems">A.4.6. 時區問題</a></span></dt>
			</dl></div>
		<div class="section">
			<div class="titlepage">
				<div>
					<div>
						<h3 class="title"><a name="resetting-permissions"></a>A.4.1.&nbsp;如何復位根用戶密碼</h3>
					</div></div></div><a class="indexterm" name="id3077496"></a>
			<a class="indexterm" name="id3077507"></a>
			<a class="indexterm" name="id3077517"></a>
			<a class="indexterm" name="id3077527"></a>
			<p>如果您從未為<span>MySQL</span>設置根用戶密碼，伺服器在以根用戶身份進行連接時不需要密碼。但是，建議您為每個帳號設置密碼。請參見<a href="database-administration.html#security-guidelines" title="5.6.1. General Security Guidelines">5.6.1節，「通用安全指南」</a>。</p>
			<p>如果您以前設置了根用戶密碼，但卻忘記了該密碼，可設置新的密碼。下述步驟是針對<span>Windows</span>平台的。在本節後面的內容中，介紹了針對<span>Unix</span>平台的步驟。</p>
			<p>在<span>Windows</span>平台下，該步驟是：</p>
			<p>以系統管理員身份登錄到系統。</p>
			<p>如果<span>MySQL</span>伺服器正在運行，停止它。對於作為<span>Windows</span>服務運行的伺服器，進入服務管理器：</p>
			<pre>開始菜單<span>-&gt;</span>控制面板<span>-&gt;</span>管理工具<span>-&gt;</span>服務</pre>
			<p>然後在列資料表中找出<span>MySQL</span>伺服器，並停止它。</p>
			<p>如果伺服器不是作為服務而運行的，可能需要使用任務管理器來強制停止它。</p>
			<p>建立<span>1</span>個文本檔案，並將下述命令置於單一行中：</p>
			<pre><span>SET PASSWORD FOR &#39;root&#39;@&#39;localhost&#39; = PASSWORD(&#39;MyNewPassword&#39;);</span></pre>
			<p>用任意名稱保存該檔案。在本例中，該檔案為<span>C:\mysql-init.txt</span>。</p>
			<p>打開控制台窗口，進入<span>DOS</span>命令提示：</p>
			<pre>開始菜單<span>-&gt;</span>運行<span>-&gt; cmd</span></pre>
			<p>假定您已將<span>MySQL</span>安裝到<span>C:\mysql</span>。如果您將<span>MySQL</span>安裝到了另一位置，請對下述命令進行相應的調整。</p>
			<p>在<span>DOS</span>命令提示符下，執行命令：</p>
			<pre><span>C:\&gt; <span><b>C:\mysql\bin\mysqld-nt --init-file=C:\mysql-init.txt</b></span></span></pre>
			<p>在伺服器啟動時，執行由「<span>--init-file</span>」選項命名的檔案的內容，更改根用戶密碼。當伺服器成功啟動後，應刪除<span>C:\mysql-init.txt</span>。</p>
			<p>如果您使用<span>MySQL</span>安裝嚮導安裝了<span>MySQL</span>，或許需要指定「<span><span>--defaults-file」</span>選項：</span></p>
			<pre><span>C:\&gt; <span><b>C:\Program Files\MySQL\MySQL Server 5.1\bin\mysqld-nt.exe</b></span></span></pre>
			<pre><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --defaults-file=&quot;C:\Program Files\MySQL\MySQL Server 5.1\my.ini&quot;</span></pre>
			<pre><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --init-file=C:\mysql-init.txt</span></pre>
			<p>使用服務管理器，可找到恰當的「<span><span>--defaults-file」</span>設置：</span></p>
			<pre>開始菜單<span>-&gt;</span>控制面板<span>-&gt;</span>管理工具<span>-&gt;</span>服務</pre>
			<p>在列資料表中找出<span>MySQL</span>服務，右擊，並選擇「屬性」選項。在可執行字段的<span><span>Path</span>（路徑）中包含<span>「--defaults-file」</span>設置。</span></p>
			<p>停止<span>MySQL</span>伺服器，然後在正常模式下重啟它。如果以服務方式運行伺服器，應從<span>Windows</span>服務窗口啟動它。如果以手動方式啟動了伺服器，能夠像正常情形下一樣使用命令。</p>
			<p>應能使用新密碼進行連接。</p>
			<p>在<span>Unix</span>環境下，重置根用戶密碼的步驟如下：</p>
			<p>以<span>Unix</span>根用戶身份、或以運行<span>mysqld</span>伺服器的相同身份登錄到系統。</p>
			<p>找到包含伺服器程序<span>ID</span>的<span><span>.pid</span>檔案。該檔案的準確位置和名稱取決於您的分發版、主機名和配置。常見位置是<span>/var/lib/mysql/</span></span>、<span>/var/run/mysqld/</span>和<span><span>/usr/local/mysql/data/</span>。</span>一般情況下，檔案名的延伸名為<span><span>.pid</span>，並以<span>mysqld</span></span>或系統的主機名開始。</p>
			<p>在下述命令中使用<span>.pid</span>檔案的路徑名，向<strong><span>mysqld</span></strong>程序發出正常的<span>kill</span>（而不是<span>kill 
			-9</span>），可停止<span>MySQL</span>伺服器：</p>
			<pre><span>shell&gt; <span><b>kill `cat /mysql-data-directory/host_name.pid`</b></span></span></pre>
			<p>注意，<span>cat</span>命令使用符號「<span>`</span>」而不是「』」：這會使<span>cat</span>的輸出代入到<span>kill</span>命令中。</p>
			<p>建立文本檔案，並將下述命令放在檔案內的<span>1</span>行上：</p>
			<pre><span>SET PASSWORD FOR &#39;root&#39;@&#39;localhost&#39; = PASSWORD(&#39;MyNewPassword&#39;);</span></pre>
			<p>用任意名稱保存檔案。對於本例，檔案為<span>~/mysql-init</span>。</p>
			<p>用特殊的「<span>--init-file=~/mysql-init</span>」選項重啟<span>MySQL</span>伺服器：</p>
			<pre><span>shell&gt; <span><b>mysqld_safe --init-file=~/mysql-init &amp;</b></span></span></pre>
			<p>檔案<span>init-file</span>的內容在伺服器啟動時執行，更改根用戶密碼。伺服器成功啟動後，應刪除<span>~/mysql-init</span>。</p>
			<p>應能使用新密碼進行連接。</p>
			<p>作為可選方式，在任何平台上，可使用<strong><span>mysql</span></strong>客戶端設置新密碼（但該方法不夠安全）：</p>
			<p>停止<strong><span>mysqld</span></strong>，並用「<span><span>--skip-grant-tables 
			--user=root」</span>選項重啟它</span>（<span>Windows</span>用戶可省略<span><span>--user=root</span>部分）。</span></p>
			<p>使用下述命令連接到<strong><span>mysqld</span></strong>伺服器：</p>
			<pre><span>shell&gt; <span><b>mysql -u root</b></span></span></pre>
			<p>在<strong><span>mysql</span></strong>客戶端發出下述語句：</p>
			<pre><span>mysql&gt; <span><b>UPDATE mysql.user SET Password=PASSWORD(&#39;<i>newpwd</i>&#39;)</b></span></span></pre>
			<pre><span>&nbsp;&nbsp;&nbsp; -&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span><b>WHERE User=&#39;root&#39;;</b></span></span></pre>
			<pre><span>mysql&gt; <span><b>FLUSH PRIVILEGES;</b></span></span></pre>
			<p>用打算使用的實際根用戶密碼替換「<span><i><span>newpwd</span></i></span>」。</p>
			<p>應能使用新密碼進行連接。</div>
		<div class="section">
			<div class="titlepage">
				<div>
					<div>
						<h3 class="title"><a name="crashing"></a>A.4.2.&nbsp;如果MySQL依然崩潰，應作些什麼</h3>
					</div></div></div><a class="indexterm" name="id3078037"></a>
			<p>正式發佈之前，每個<span>MySQL</span>版本均在很多平台上進行了測試。這不資料表示<span>MySQL</span>中不存在問題，但是，如果存在問題，它們應很少，而且很難發現。如果您遇到問題，如果您嘗試找出導致系統崩潰的準確原因，這始終很有幫助，這是因為，如果這樣的話，快速解決問題的機會很大。</p>
			<p>首先，應嘗試找出問題是否與<strong><span>mysqld</span></strong>伺服器有關，或是否與客戶端有關。通過執行<strong><span>mysqladmin 
			version</span></strong>，可檢查<strong><span>mysqld</span></strong>伺服器運行了多長時間。如果<strong><span>mysqld</span></strong>宕機並重啟，應查看伺服器的錯誤日誌以找出原因。請參見<a href="database-administration.html#error-log" title="5.11.1. The Error Log">5.11.1節，「錯誤日誌」</a>。</p>
			<p>在某些系統上，在錯誤日誌中，可發現<strong><span>mysqld</span></strong>宕機的堆棧跟蹤，可使用<span><span>resolve_stack_dump</span>程式解決它</span>。請參見<a href="porting.html#using-stack-trace" title="E.1.4. Using a Stack Trace">E.1.4節，「使用堆棧跟蹤」</a>。注意，錯誤日誌中的變數值並非始終是<span>100</span>％正確的。</p>
			<p>很多伺服器崩潰是因損壞的數據檔案或索引檔案而導致的，每次執行完<span>SQL</span>語句之後並在向客戶端通告結果之前，<span>MySQL</span>將使用<span><span>write()</span>系統使用</span>更新磁盤上的檔案（如果您使用了「<span>--delay-key-write</span>」選項，情況並非如此，此時將寫入數據檔案而不是索引檔案）。這意味著，即使<span>mysqld</span>崩潰，數據檔案的內容也是安全的，這是因為作業系統能保證將未刷新的數據寫入磁盤。使用「<span>--flush</span>」選項啟動<strong><span>mysqld</span></strong>，這樣，每次執行完<span>SQL</span>語句後，可強制<span>MySQL</span>將所有內容寫入磁盤。</p>
			<p>前述介紹表明，在正常情況下不會出現損壞的資料表，除非出現了下述情況之一：</p>
			<p>在更新過程中，<span>MySQL</span>伺服器或伺服器主機被停止。</p>
			<p>您發現了<strong><span>mysqld</span></strong>中存在的<span>1</span>個問題，該問題導致<strong><span>mysqld</span></strong>在更新中途中止。</p>
			<p>在<strong><span>mysqld</span></strong>操作的同時，某些外部程式正在操控數據檔案或索引檔案，未恰當鎖定資料表。</p>
			<p>您正使用系統上的相同數據目錄運行很多<strong><span>mysqld</span></strong>伺服器，該系統不支援良好的檔案系統鎖定（通常是由<span><span>lockd</span>鎖定管理器負責的</span>），或使用「<span>--skip-external-locking</span>」選項運行了多個伺服器。</p>
			<p>崩潰的數據檔案或索引檔案，其中包含導致<span>mysqld</span>混亂的損壞很嚴重的數據。</p>
			<p>在數據儲存節點發現問題。這種可能性不大，但至少是可能的。在該情況下，可在修復的資料表副本上，通過使用<span><span>ALTER 
			TABLE</span>，</span>嘗試將資料表類型更改為另一種儲存引擎。</p>
			<p>由於很難得知為什麼某事會出現崩潰，首先請檢查用於其他方面的事項是否崩潰。請嘗試採取下述措施：</p>
			<p>用<strong><span>mysqladmin 
			shutdown</span></strong>停止<strong><span>mysqld</span></strong>伺服器，從數據目錄運行<strong><span>myisamchk 
			--silent --force */*.MYI</span></strong>，檢查所有的<span><span>MyISAM</span>資料表，並重啟</span><strong><span>mysqld</span></strong>。這樣，就能確保從乾淨的狀態運行伺服器。請參見<a href="database-administration.html" title="Chapter 5. Database Administration">第5章：資料庫管理</a>。</p>
			<p>使用「<span>--log</span>」選項啟動<strong><span>mysqld</span></strong>，並根據寫入日誌的訊息確定是否某些特殊的查詢殺死了伺服器。約<span>95%</span>的問題與特定的查詢有關。正常情況下，這是伺服器重啟前日誌檔案中最夠數個查詢中的<span>1</span>個。請參見<a href="database-administration.html#query-log" title="5.11.2. The General Query Log">5.11.2節，「通用查詢日誌」</a>。如果能夠用特殊查詢重複殺死<span>MySQL</span>，即使在發出查詢前檢查了所有資料表的情況下也同樣，那麼您就應能確定問題，並應提交關於該問題的問題報告。請參見<a href="introduction.html#bug-reports" title="1.7.1.3. How to Report Bugs or Problems">1.7.1.3節，「如何通報問題和問題」</a>。</p>
			<p>嘗試提供一個測試範例，我們應能利用該範例重複問題。請參見<a href="porting.html#reproduceable-test-case" title="E.1.6. Making a Test Case If You Experience Table Corruption">E.1.6節，「如果出現資料表崩潰，請生成測試案例」</a>。</p>
			<p>請在<span><span>mysql-test</span>目錄下並根據<span>MySQL</span>基準進行測試。</span>請參見<a href="extending-mysql.html#mysql-test-suite" title="27.1.2. MySQL Test Suite">27.1.2節，「MySQL測試套件」</a>。它們能相當良好地測試<span>MySQL</span>。您也可以為基準測試增加代碼，以模擬您的應用程式。基準測試可在原始碼分發版的<span><span>sql-bench</span>目錄下找到，對於</span>二進制分發版，可在<span>MySQL</span>安裝目錄下的<span>sql-bench</span>目錄下找到。</p>
			<p>嘗試使用<span><span>fork_big.pl</span>指令</span>（它位於原始碼分發版的測試目錄下）。</p>
			<p>如果您將<span>MySQL</span>配置為調試模式，如果某事出錯，可更為容易地搜集關於可能錯誤的訊息。如果將<span>MySQL</span>配置為調試模式，可生成<span>1</span>個安全的內存分配程式，可使用它發現某些錯誤。此外，它還提供了很多輸出，這類輸出與出現的問題相關。在<strong><span>configure</span></strong>上使用「<span>--with-debug</span>」或「<span>--with-debug=full</span>」選項重新配置<span>MySQL</span>，然後再編譯它。請參見<a href="porting.html#debugging-server" title="E.1. Debugging a MySQL Server">E.1節，「調試MySQL伺服器」</a>。</p>
			<p>確保為您的作業系統應用了最新的補丁。</p>
			<p>對<strong><span>mysqld</span></strong>使用「<span>--skip-external-locking</span>」選項。在某些系統上，<span><span>lockd</span>鎖定管理器不能正確工作，</span>「<span><span>--skip-external-locking」</span>選項通知</span><strong><span>mysqld</span></strong>不使用外部鎖定。（這意味著，您不能在相同的數據目錄上運行<span>2</span>個<strong><span>mysqld</span></strong>伺服器，如果使用<strong><span>myisamchk</span></strong>，必須謹慎。然而，嘗試將該選項用作測試也是有益的）。</p>
			<p>當<span>mysqld</span>看上去正在運行但並未響應時，是否運行了<strong><span>mysqladmin 
			-u root processlist</span></strong>？某些時候，即使您認為<strong><span>mysqld</span></strong>處於閒置狀態時，實際情況並非如此。問題可能是因為所有連接均已使用，或存在某些內部鎖定問題。即使在該情況下，<strong><span>mysqladmin 
			-u root processlist</span></strong>通常能夠進行連接，並能提供關於當前連接數以及其狀態的有用訊息。</p>
			<p>在運行其他查詢的同時，在單獨的窗口中運行命令<strong><span>mysqladmin 
			-i 5 status</span></strong>或<strong><span>mysqladmin 
			-i 5 -r status</span></strong>，以生成統計訊息。</p>
			<p>嘗試採用下述方法：</p>
			<p>從<span>gdb</span>（或另一個調試器）啟動<strong><span>mysqld</span></strong>。請參見<a href="porting.html#using-gdb-on-mysqld" title="E.1.3. Debugging mysqld under gdb">E.1.3節，「在gdb環境下調試m<span><strong class="command">ysqld</strong></span>」</a>。</p>
			<p>運行測試指令。</p>
			<p>在<span>3</span>個較低層面上輸出<span>backtrace</span>（向後跟蹤）和局部變數。在<strong><span>gdb</span></strong>中，當<span>mysqld</span>在<span>gdb</span>內崩潰時，可使用下述命令完成該任務：</p>
			<pre><span>backtrace</span></pre>
			<pre><span>info local</span></pre>
			<pre><span>up</span></pre>
			<pre><span>info local</span></pre>
			<pre><span>up</span></pre>
			<pre><span>info local</span></pre>
			<p>使用<strong><span>gdb</span></strong>，您還能檢查與<span>info</span>線程共存的線程，並切換至特定的線程<span>N</span>，其中，<span>N</span>是線程<span>ID</span>。</p>
			<p>嘗試用<span>Perl</span>指令模擬您的應用程式，強制<span>MySQL</span>崩潰或行為異常。</p>
			<p>發送正常的問題報告。請參見<a href="introduction.html#bug-reports" title="1.7.1.3. How to Report Bugs or Problems">1.7.1.3節，「如何通報問題和問題」</a>。應比通常的報告更詳細。由於<span>MySQL</span>是為很多人提供服務的，它可能因僅存在於您的計算機上的某事崩潰（例如，與您的特定系統庫有關的錯誤）。</p>
			<p>如果您遇到與包含動態長度行的資料表有關的問題，而且您僅使用<span><span>VARCHAR</span>列</span>（而不是<span>BLOB</span>或<span><span>TEXT</span>列），可嘗試用<span>ALTER 
			TABLE</span>將所有<span>VARCHAR</span>列更改為<span>CHAR</span>列。這樣，就會強制</span><span>MySQL</span>使用固定大小的行。固定大小的行佔用的空間略多，但對損壞的容忍度更高。</p>
			<p>目前的動態行代碼在<span>MySQL AB</span>已使用多年，很少遇到問題，但從本質上看，動態長度行更傾向於出現錯誤，因此，不妨嘗試採用該策略以查看它是否有幫助，這不失為一個好主意。</p>
			<p>診斷問題時不要將您的伺服器硬件排除在外。有問題的硬件能夠導致數據損壞。對硬件進行故障診斷與排除操作時，尤其應注意<span>RAM</span>和硬盤驅動器。</div>
		<div class="section">
			<div class="titlepage">
				<div>
					<div>
						<h3 class="title"><a name="full-disk"></a>A.4.3.&nbsp;MySQL處理磁盤滿的方式</h3>
					</div></div></div><a class="indexterm" name="id3078668"></a>
			<a class="indexterm" name="id3078675"></a>
			<p>在本節中，介紹了<span>MySQL</span>響應磁盤滿錯誤的方式（如「設備上無剩餘空間」），以及響應超配額錯誤的方式（如「寫入失敗」或「達到了用戶屏蔽限制」）。</p>
			<p>本節介紹的內容與寫入<span><span>MyISAM</span>資料表有關。它也適用於寫入二進制日誌檔案和二進制索引檔案，但對</span>「<span class="quote"><span>row</span></span>」和「<span class="quote"><span>record</span></span>」的應用應被視為「<span class="quote"><span>event</span></span>」。</p>
			<p>出現磁盤滿狀況時，<span>MySQL</span>將：</p>
			<p>每分鐘檢查一次，查看是否有足夠空間寫入當前行。如果有足夠空間，將繼續，就像什麼也未發生一樣。</p>
			<p>每<span>10</span>分鐘將<span>1</span>個條目寫入日誌檔案，提醒磁盤滿狀況。</p>
			<p>為了減輕問題，可採取下述措施：</p>
			<p>要想繼續，僅需有足夠的磁盤空間以插入所有記錄。</p>
			<p>要想放棄線程，必須使用<strong><span>mysqladmin 
			kill</span></strong>。下次檢查磁盤時將放棄線程（<span>1</span>分鐘）。</p>
			<p>其他線程可能會正在等待導致磁盤滿狀況的資料表。如果有數個「已鎖定」的線程，殺死正在磁盤滿狀況下等待的某一線程，以便允許其他線程繼續。</p>
			<p>對前述行為的例外是，當您使用<span>REPAIR 
			TABLE</span>或<span><span>OPTIMIZE 
			TABLE</span>時，或當索引是在<span>LOAD DATA INFILE</span></span>或<span><span>ALTER 
			TABLE</span>語句後、在批操作中建立的。所有這些語句能建立大的臨時檔案，如果保留這些檔案，會導致系統其他部分出現大問題。如果在<span>MySQL</span>執行這類操作的同時磁盤已滿，它將刪除大的臨時檔案，並將資料表標注為崩潰。但對於<span>ALTER 
			TABLE</span>例外，舊資料表保持不變。</span></div>
		<div class="section">
			<div class="titlepage">
				<div>
					<div>
						<h3 class="title"><a name="temporary-files"></a>A.4.4.&nbsp;MySQL將臨時檔案儲存在哪裡</h3>
					</div></div></div>
			<p><span>MySQL</span>使用環境變數<span><span>TMPDIR</span>的值作為保存臨時檔案的目錄的路徑名。如果未設置<span>TMPDIR</span>，</span><span>MySQL</span>將使用系統的預設值，通常為<span>/tmp</span>、<span>/var/tmp</span>或<span>/usr/tmp</span>。如果包含臨時檔案目錄的檔案系統過小，可對<span>mysqld</span>使用「<span><span>—tmpdir」</span>選項，</span>在具有足夠空間的檔案系統內指定<span>1</span>個目錄。</p>
			<p>在<span>MySQL 5.1</span>中，「<span><span>—tmpdir」</span>選項可被設置為數個路徑的列資料表，以循環方式使用。在<span>Unix</span>平台上，路徑用冒號字元<span>「:」</span>隔開，在</span><span>Windows</span>、<span>NetWare</span>和<span>OS/2</span>平台上，<span>路徑用分號字元<span>「;」</span>隔開。注意，</span>為了有效分佈負載，這些路徑應位於不同的物理磁盤上，而不是位於相同磁盤的不同分區中。</p>
			<p>如果<span>MySQL</span>伺服器正作為複製從伺服器使用，不應將「<span><span>--tmpdir」</span>設置為指向基於內存的檔案系統的目錄，或當伺服器主機重啟時將清空的目錄。對於複製從伺服器，</span>需要在機器重啟時仍保留一些臨時檔案，以便能夠複製臨時資料表或執行<span><span>LOAD 
			DATA INFILE</span>操作。如果在伺服器重啟時丟失了臨時檔案目錄下的檔案，複製將失敗。</span></p>
			<p><span>MySQL</span>會以隱含方式建立所有的臨時檔案。這樣，就能確保中止<strong><span>mysqld</span></strong>時會刪除所有臨時檔案。使用隱含檔案的缺點在於，在臨時檔案目錄所在的位置中，看不到佔用了檔案系統的大臨時檔案。</p>
			<p>進行排序時（<span>ORDER BY</span>或<span>GROUP 
			BY</span>），<span>MySQL</span>通常會使用<span>1</span>個或多個臨時檔案。所需的最大磁盤空間由下述資料表達式決定：</p>
			<pre><span>(length of what is sorted + sizeof(row pointer))</span></pre>
			<pre><span>* number of matched rows</span></pre>
			<pre><span>* 2</span></pre>
			<p>「<span>row pointer</span>」（行指針）的大小通常是<span>4</span>字節，但在以後，對於大的資料表，該值可能會增加。</p>
			<p>對於某些<span><span>SELECT</span>查詢，</span><span>MySQL</span>還會建立臨時<span>SQL</span>資料表。它們不是隱含資料表，並具有<span>SQL_*</span>形式的名稱。</p>
			<p><span><span>ALTER TABLE</span>會在與原始資料表目錄相同的目錄下建立臨時資料表。</span></div>
		<div class="section">
			<div class="titlepage">
				<div>
					<div>
						<h3 class="title"><a name="problems-with-mysql-sock">
						</a>A.4.5.&nbsp;如何保護或更改MySQL套接字檔案/tmp/mysql.sock<code class="filename"></code></h3>
					</div></div></div><a class="indexterm" name="id3078995"></a>
			<a class="indexterm" name="id3079006"></a>
			<p>對於伺服器用來與本地客戶端進行通信的<span>Unix</span>套接字檔案，其預設位置是<span>/tmp/mysql.sock</span>。這有可能導致問題，原因在於，在某些版本的<span>Unix</span>上，任何人都能刪除<span><span>/tmp</span>目錄下的檔案。</span></p>
			<p>在大多數<span>Unix</span>版本中，可對<span><span>/tmp</span>目錄進行保護，使得檔案只能被其所有這或超級用戶（根用戶）刪除。為此，以根用戶身份登錄，並使用下述命令在<span>/tmp</span>目錄上設置粘著位：</span></p>
			<pre><span>shell&gt; <span><b>chmod +t /tmp</b></span></span></pre>
			<p>通過執行<span><span>ls -ld /tmp</span>，可檢查是否設置了粘著位。如果最後一個授權字元是<span>「t」</span>，表明設置了粘著位。</span></p>
			<p>另一種方法是改變伺服器建立<span>Unix</span>套接字檔案的位置。如果進行了這類操作，還應讓客戶端程式知道檔案的位置。能夠以多種不同方式指定檔案位置：</p>
			<p>在全局或局部選項檔案中指定路徑。例如，將下述行置於檔案<span>/etc/my.cnf</span>中：</p>
			<pre><span>[mysqld]</span></pre>
			<pre><span>socket=/path/to/socket</span></pre>
			<pre><span>&nbsp;</span></pre>
			<pre><span>[client]</span></pre>
			<pre><span>socket=/path/to/socket</span></pre>
			<p>請參見<a href="using-mysql-programs.html#option-files" title="4.3.2. Using Option Files">4.3.2節，「使用選項檔案」</a>。</p>
			<p>在運行客戶端程式時，在命令行上為<strong><span>mysqld_safe</span><span>指定</span></strong>「<span><span>--socket」</span>選項。</span></p>
			<p>將<span><span>MYSQL_UNIX_PORT</span>環境變數設置為<span>Unix</span>套接字檔案的路徑。</span></p>
			<p>重新從原始碼編譯<span>MySQL</span>，以使用不同的預設<span>Unix</span>套接字檔案位置。運行<strong><span>configure</span></strong>時，用「<span>--with-unix-socket-path</span>」選項定義檔案路徑。請參見<a href="installing.html#configure-options" title="2.8.2. Typical configure Options">2.8.2節，「典型配置選項<span><strong class="command"></strong></span>」</a>。</p>
			<p>用下述命令連接伺服器，能夠測試新的套接字位置是否工作：</p>
			<pre><span>shell&gt; <span><b>mysqladmin --socket=/path/to/socket version</b></span></span></pre>
		</div>
		<div class="section">
			<div class="titlepage">
				<div>
					<div>
						<h3 class="title"><a name="timezone-problems"></a>A.4.6.&nbsp;時區問題</h3>
					</div></div></div><a class="indexterm" name="id3079200"></a>
			<a class="indexterm" name="id3079207"></a>
			<a class="indexterm" name="id3079217"></a>
			<a class="indexterm" name="id3079226"></a>
			<p>如果遇到與<span><span>SELECT NOW()</span>有關的問題，它返回</span><span>GMT</span>值而不是當地時間，就應通知伺服器您的當前失去。如果<span><span>UNIX_TIMESTAMP()</span>返回錯誤值，上述方式同樣適用。應為伺服器所運行的環境進行這類設置，例如，在</span><strong><span>mysqld_safe</span></strong>或<strong><span>mysql.server</span></strong>中。請參見<a href="environment-variables.html">附錄F：</a><a href="environment-variables.html" title="Appendix F. Environment Variables"><i>環境變數</i></a>。</p>
			<p>也可以對<strong><span>mysqld_safe</span></strong>使用「<span>--timezone=<i>timezone_name</i></span>」選項，為伺服器設置失去。也可以在啟動<span>mysqld</span>之前，通過設置<span>TZ</span>環境變數完成該設置。</p>
			<p>「<span>--timezone</span>」或<span>TZ</span>的允許值與系統有關。關於可接受的值，請參見作業系統文檔。</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="query-issues"></a>
		A.5.&nbsp;與查詢有關的事宜</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="problems.html#case-sensitivity">
			A.5.1. 搜索中的大小寫敏感性</a></span></dt><dt><span class="section"><a href="problems.html#using-date">
			A.5.2. 使用DATE列方面的問題<code class="literal"></code></a></span></dt><dt><span class="section"><a href="problems.html#problems-with-null">
			A.5.3. 與NULL值有關的問題<code class="literal"></code></a></span></dt><dt><span class="section"><a href="problems.html#problems-with-alias">
			A.5.4. 與列別名有關的問題</a></span></dt><dt><span class="section"><a href="problems.html#non-transactional-tables">
			A.5.5. 非事務資料表回滾失敗</a></span></dt><dt><span class="section"><a href="problems.html#deleting-from-related-tables">
			A.5.6. 從相關資料表刪除行</a></span></dt><dt><span class="section"><a href="problems.html#no-matching-rows">
			A.5.7. 解決與不匹配行有關的問題</a></span></dt><dt><span class="section"><a href="problems.html#problems-with-float">
			A.5.8. 與浮點比較有關的問題</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="case-sensitivity"></a>
			A.5.1.&nbsp;搜索中的大小寫敏感性</h3></div></div></div><a class="indexterm" name="id3079327"></a><a class="indexterm" name="id3079338"></a><a class="indexterm" name="id3079348"></a><a class="indexterm" name="id3079355"></a>
			<p>在預設情況下，<span>MySQL</span>搜索不區分大小寫（但某些字元編碼始終區分大小寫，如<span>czech</span>）。這意味著，如果您使用<span><i><span>col_name</span></i><span> 
			LIKE &#39;a%&#39;</span>進行搜索，您將獲得以<span>A</span>或<span>a</span>開始的所有列。如果打算使搜索區分大小寫，</span>請確保操作數之一具有區分大小寫的或二進制校對。例如，如果您正在比較均適用<span>latin1</span>字元編碼的列和字串，可使用<span><span>COLLATE</span>操作符</span>，使<span>1</span>個操作數具有<span>latin1_general_cs</span>或<span><span>latin1_bin</span>校對</span>特性。例如：</p>
			<pre><span><i><span>col_name</span></i></span><span> COLLATE latin1_general_cs LIKE &#39;a%&#39;</span></pre>
			<pre><span><i><span>col_name</span></i></span><span> LIKE &#39;a%&#39; COLLATE latin1_general_cs</span></pre>
			<pre><span><i><span>col_name</span></i></span><span> COLLATE latin1_bin LIKE &#39;a%&#39;</span></pre>
			<pre><span><i><span>col_name</span></i></span><span> LIKE &#39;a%&#39; COLLATE latin1_bin</span></pre>
			<p>如果希望總是以區分大小寫的方式處理列，可使用區分大小寫的或二進制校對聲明它。請參見<a href="sql-syntax.html#create-table" title="13.1.5. CREATE TABLE Syntax">13.1.5節，「CREATE 
		TABLE語法」</a>。</p>
			<p>簡單的比較操作（<span>&gt;=, &gt;, =, 
			&lt;, &lt;=</span><span>, </span>
			排序和分組）基於每個字元的「排序值」。具有相同排序值的字元（如『<span>E</span>』<span>,
			</span>『<span>e</span>』<span>,</span>和『<span>Ac</span>』）將被當作相同的寫字元。</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="using-date"></a>
			A.5.2.&nbsp;使用DATE列方面的問題<code class="literal"></code></h3></div></div></div><a class="indexterm" name="id3079478"></a><a class="indexterm" name="id3079487"></a><a class="indexterm" name="id3079497"></a>
			<p><span><span>DATE</span>值的格式是<span>&#39;YYYY-MM-DD&#39;</span>。</span>按照標準的<span>SQL</span>，不允許其他格式。在<span><span>UPDATE</span>資料表達式以及<span>SELECT</span>語句的<span>WHERE</span>子句中應使用該格式。例如：</span></p>
			<pre><span>mysql&gt; <span><b>SELECT * FROM <i>tbl_name</i> WHERE date &gt;= &#39;2003-05-05&#39;;</b></span></span></pre>
			<p>為了方便，如果日期是在數值環境下使用的，<span>MySQL</span>會自動將日期轉換為數值（反之亦然）。它還具有相當的智能，在更新時或在與<span>TIMESTAMP</span>、<span>DATE</span>或<span><span>DATETIME</span>列比較日期的<span>WHERE</span>子句中，允許<span>「</span>寬鬆的<span>」</span>字串形式（<span>「</span>寬鬆形式<span>」</span>資料表示，任何標點字元均能用作各部分之間的分隔符。例如，<span>&#39;2004-08-15&#39;</span></span>和<span><span>&#39;2004#08#15&#39;</span>是等同的）。</span><span>MySQL</span>還能轉換不含任何分隔符的字串（如<span><span>&#39;20040815&#39;</span>），前體是它必須是有意義的日期。</span></p>
			<p>使用<span>&lt;</span>、<span>&lt;=</span>、<span>=</span>、<span>&gt;=</span>、<span>&gt;</span>、或<span><span>BETWEEN</span>操作符將<span>DATE</span></span>、<span>TIME</span>、<span>DATETIME</span>或<span><span>TIMESTAMP</span>與常量字串進行比較時，</span><span>MySQL</span>通常會將字串轉換為內部長整數，以便進行快速比較（以及略為「寬鬆」的字串檢查）。但是，該轉換具有下述例外：</p>
			<p>比較兩列時</p>
			<p>將<span>DATE</span>、<span>TIME</span>、<span>DATETIME</span>或<span><span>TIMESTAMP</span>列與資料表達式進行比較時</span></p>
			<p>使用其他比較方法時，如<span>IN</span>或<span>STRCMP()</span>。</p>
			<p>對於這些例外情形，會將對像轉換為字串並執行字串比較，採用該方式進行比較。</p>
			<p>為了保持安全，假定按字串比較字串，如果您打算比較臨時值和字串，將使用恰當的字串函數。</p>
			<p>對於特殊日期<span><span>&#39;0000-00-00&#39;</span>，能夠以<span>&#39;0000-00-00&#39;</span>形式保存和檢索。在</span><span>MyODBC</span>中使用<span><span>&#39;0000-00-00&#39;</span>日期時，對於</span><span>MyODBC 
			2.50.12</span>或更高版本，該日期將被自動轉換為<span>NULL</span>，這是因為<span>ODBC</span>不能處理這類日期。</p>
			<p>由於<span>MySQL</span>能夠執行前面所介紹的轉換，下述語句均能正常工作：</p>
			<pre><span>mysql&gt; <span><b>INSERT INTO <i>tbl_name</i> (idate) VALUES (19970505);</b></span></span></pre>
			<pre><span>mysql&gt; <span><b>INSERT INTO <i>tbl_name</i> (idate) VALUES (&#39;19970505&#39;);</b></span></span></pre>
			<pre><span>mysql&gt; <span><b>INSERT INTO <i>tbl_name</i> (idate) VALUES (&#39;97-05-05&#39;);</b></span></span></pre>
			<pre><span>mysql&gt; <span><b>INSERT INTO <i>tbl_name</i> (idate) VALUES (&#39;1997.05.05&#39;);</b></span></span></pre>
			<pre><span>mysql&gt; <span><b>INSERT INTO <i>tbl_name</i> (idate) VALUES (&#39;1997 05 05&#39;);</b></span></span></pre>
			<pre><span>mysql&gt; <span><b>INSERT INTO <i>tbl_name</i> (idate) VALUES (&#39;0000-00-00&#39;);</b></span></span></pre>
			<pre><span>&nbsp;</span></pre>
			<pre><span>mysql&gt; <span><b>SELECT idate FROM <i>tbl_name</i> WHERE idate &gt;= &#39;1997-05-05&#39;;</b></span></span></pre>
			<pre><span>mysql&gt; <span><b>SELECT idate FROM <i>tbl_name</i> WHERE idate &gt;= 19970505;</b></span></span></pre>
			<pre><span>mysql&gt; <span><b>SELECT MOD(idate,100) FROM <i>tbl_name</i> WHERE idate &gt;= 19970505;</b></span></span></pre>
			<pre><span>mysql&gt; <span><b>SELECT idate FROM <i>tbl_name</i> WHERE idate &gt;= &#39;19970505&#39;;</b></span></span></pre>
			<p>但是，下述語句不能正常工作：</p>
			<pre><span>mysql&gt; <span><b>SELECT idate FROM <i>tbl_name</i> WHERE STRCMP(idate,&#39;20030505&#39;)=0;</b></span></span></pre>
			<p><span>STRCMP()</span>是一種字串函數，它能將<span><span>idate</span>轉換為<span>&#39;YYYY-MM-DD&#39;</span>格式的字串，</span>並執行字串比較。它不能將<span><span>&#39;20030505&#39;</span>轉換為</span>日期<span><span>&#39;2003-05-05&#39;</span>並進行日期比較。</span></p>
			<p>如果您正在使用<span>ALLOW_INVALID_DATES</span><span> 
			SQL</span>模式，<span>MySQL</span>允許以僅執行給定的有限檢查方式保存日期：<span>MySQL</span>僅保證天位於<span>1</span>～<span>31</span>的範圍內，月位於<span>1</span>～<span>12</span>的範圍內。</p>
			<p>這樣就使得<span>MySQL</span>很適合於<span>Web</span>應用程式，其中，您能獲得三個不同字段中的年、月、日值，也能準確保存用戶插入的值（無日期驗證）。</p>
			<p>如果未使用<span>NO_ZERO_IN_DATE</span><span> 
			SQL</span>模式，「天」和「月」部分可能為<span>0</span>。如果您打算將生日保存在<span>DATE</span>列而且僅知道部分日期，它十分方便。</p>
			<p>如果未使用<span>NO_ZERO_DATE</span><span> 
			SQL</span>模式，<span>MySQL</span>也允許您將<span>&#39;0000-00-00&#39;</span>保存為「偽日期」。在某些情況下，它比使用<span>NULL</span>值更方便。</p>
			<p>如果無法將日期轉換為任何合理值，「<span>0</span>」將保存在<span><span>DATE</span>列中，並被檢索為<span>&#39;0000-00-00&#39;</span>。這是兼顧速度和便利性的事宜。我們認為，資料庫伺服器的職責是檢索與您保存的日期相同的日期</span>（即使在任何情況下，數據在邏輯上不正確也同樣）。我們認為，對日期的檢查應由應用程式而不是伺服器負責。</p>
			<p>如果您希望<span>MySQL</span>檢查所有日期並僅接受合法日期（除非由<span>IGNORE</span>覆蓋），應將<span><span>sql_mode</span>設置為<span>&quot;NO_ZERO_IN_DATE,NO_ZERO_DATE&quot;</span></span>。</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="problems-with-null"></a>
			A.5.3.&nbsp;與NULL值有關的問題<code class="literal"></code></h3></div></div></div><a class="indexterm" name="id3079960"></a><a class="indexterm" name="id3079972"></a>
			<p>對於<span>SQL</span>的新手，<span>NULL</span>值的概念常常會造成混淆，他們常認為<span><span>NULL</span>是與空字串<span>&#39;&#39;</span>相同的事。</span>情況並非如此。例如，下述語句是完全不同的：</p>
			<pre><span>mysql&gt; <span><b>INSERT INTO my_table (phone) VALUES (NULL);</b></span></span></pre>
			<pre><span>mysql&gt; <span><b>INSERT INTO my_table (phone) VALUES (&#39;&#39;);</b></span></span></pre>
			<p>這兩條語句均會將值插入<span><span>phone</span>（電話）列，</span>但第<span>1</span>條語句插入的是<span>NULL</span>值，第<span>2</span>條語句插入的是空字串。第<span>1</span>種情況的含義可被解釋為「電話號碼未知」，而第<span>2</span>種情況的含義可被解釋為「該人員沒有電話，因此沒有電話號碼」。</p>
			<p>為了進行<span><span>NULL</span>處理，可使用<span>IS 
			NULL</span></span>和<span><span>IS 
			NOT NULL</span>操作符以及<span>IFNULL()</span></span>函數。</p>
			<p>在<span>SQL</span>中，<span><span>NULL</span>值</span>與任何其它值的比較（即使是<span>NULL</span>）永遠不會為「真」。包含<span>NULL</span>的資料表達式總是會導出<span>NULL</span>值，除非在關於操作符的文檔中以及資料表達式的函數中作了其他規定。下述示範中的所有列均返回<span>NULL</span>：</p>
			<pre><span>mysql&gt; <span><b>SELECT NULL, 1+NULL, CONCAT(&#39;Invisible&#39;,NULL);</b></span></span></pre>
			<p>如果打算搜索列值為<span>NULL</span>的列，不能使用<span><span>expr 
			= NULL</span>測試。下述語句不返回任何行，</span>這是因為，對於任何資料表達式，<span><span>expr 
			= NULL</span>永遠不為<span>「</span>真<span>」</span>：</span></p>
			<pre><span>mysql&gt; <span><b>SELECT * FROM my_table WHERE phone = NULL;</b></span></span></pre>
			<p>要想搜尋<span>NULL</span>值，必須使用<span><span>IS 
			NULL</span>測試。</span>在下面的語句中，介紹了搜尋<span>NULL</span>電話號碼和空電話號碼的方式：</p>
			<pre><span>mysql&gt; <span><b>SELECT * FROM my_table WHERE phone IS NULL;</b></span></span></pre>
			<pre><span>mysql&gt; <span><b>SELECT * FROM my_table WHERE phone = &#39;&#39;;</b></span></span></pre>
			<p>更多訊息和示範，請參見<a href="tutorial.html#working-with-null" title="3.3.4.6. Working with NULL Values">3.3.4.6節，「使用NULL值」</a>。</p>
			<p>如果您正在使用<span>MyISAM</span>、<span>InnoDB</span>、<span>BDB</span>、或<span><span>MEMORY</span>儲存引擎，能夠在可能具有<span>NULL</span>值的列上增加<span>1</span>條索引。如不然，必須聲明索引列為<span>NOT 
			NULL</span>，而且不能將<span>NULL</span>插入到列中。</span></p>
			<p>用<span><span>LOAD DATA INFILE</span>讀取數據時，對於空的或丟失的列，將用<span>&#39;&#39;</span>更新它們。如果希望在列中具有<span>NULL</span>值，</span>應在數據檔案中使用<span>\N</span>。在某些情況下，也可以使用文字性單詞「<span>NULL</span>」。請參見<span><a title="13.2.5.&nbsp;LOAD DATA INFILE Syntax"  href="../../../../../../澶┼渤/2006.1/1/third/sql-syntax.html#load-data">13.2.5
			<span>「</span><span>LOAD DATA 
			INFILE</span><span>語法」</span></a></span>。</p>
			<p>使用<span>DISTINCT</span>、<span>GROUP 
			BY</span>或<span><span>ORDER 
			BY</span>時，所有<span>NULL</span>值將被視為等同的。</span></p>
			<p>使用<span><span>ORDER BY</span>時，首先將顯示<span>NULL</span>值，</span>如果指定了<span>DESC</span>按降序排列，<span>NULL</span>值將最後顯示。</p>
			<p>對於聚合（累計）函數，如<span>COUNT()</span>、<span>MIN()</span>和<span><span>SUM()</span>，將忽略<span>NULL</span>值。</span>對此的例外是<span><span>COUNT(*)</span>，它將計數行而不是單獨的</span>列值。例如，下述語句產生兩個計數。首先計數資料表中的行數，其次計數<span>age</span>列中的非<span>NULL</span>值數目：</p>
			<pre><span>mysql&gt; <span><b>SELECT COUNT(*), COUNT(age) FROM person;</b></span></span></pre>
			<p>對於某些列類型，<span>MySQL</span>將對<span>NULL</span>值進行特殊處理。如果將<span>NULL</span>插入<span><span>TIMESTAMP</span>列，將插入當前日期和時間。如果將<span>NULL</span>插入具有<span>AUTO_INCREMENT</span>屬性的整數列，將插入序列中的下一個編號。</span></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="problems-with-alias"></a>
			A.5.4.&nbsp;與列別名有關的問題</h3></div></div></div><a class="indexterm" name="id3080404"></a></div><div class="section"><div class="titlepage"><div><div>
			可以使用別名來引用<span>GROUP BY</span>、<span>ORDER 
			BY</span>或<span><span>HAVING</span>子句中的列。別名也能用於為列提供更好的名稱：</span><pre><span>SELECT SQRT(a*b) AS root FROM <span><i>tbl_name</i></span> GROUP BY root HAVING root &gt; 0;</span></pre>
			<pre><span>SELECT id, COUNT(*) AS cnt FROM <span><i>tbl_name</i></span> GROUP BY id HAVING cnt &gt; 0;</span></pre>
			<pre><span>SELECT id AS &#39;Customer identity&#39; FROM <span><i>tbl_name</i></span>;</span></pre>
			<p>標準<span>SQL</span>不允許在<span>WHERE</span>子句中已用列別名。這是因為，執行<span>WHERE</span>代碼時，可能尚未確定列值。例如，下述查詢是非法的：</p>
			<pre><span>SELECT id, COUNT(*) AS cnt FROM <span><i>tbl_name</i></span> WHERE cnt &gt; 0 GROUP BY id;</span></pre>
			<p>執行<span><span>WHERE</span>語句以確定</span>哪些行應被包含在<span><span>GROUP 
			BY</span>部分中，而<span>HAVING</span></span>用於確定應使用結果集中的哪些行。</p>
			<h3 class="title"><a name="non-transactional-tables"></a>
			A.5.5.&nbsp;非事務資料表回滾失敗</h3></div></div></div><a class="indexterm" name="id3080504"></a>
			<p>執行<span><span>ROLLBACK</span>（回滾）時，如果收到下述消息，資料表示事務中使用的<span>1</span>個或多個資料表不支援事務：</span></p>
			<pre>警告：某些更改的非事務性資料表不能被回滾。</pre>
			<p>這些非事務性資料表不受<span><span>ROLLBACK</span>語句的影響。</span></p>
			<p>如果在事務中意外地混合了事務性資料表和非事務性資料表，導致該消息的最可能原因是，您認為本應是事務性的資料表實際上不是。如您試圖使用<span>mysqld</span>伺服器不支援的事務性儲存引擎（或用啟動選項禁止了它）建立資料表，就可能出現該情況。如果<strong><span>mysqld</span></strong>不支援儲存引擎，它將以<span><span>MyISAM</span>資料表建立資料表，這是非事務性資料表。</span></p>
			<p>可使用下述語句之一檢查資料表的標類型：</p>
			<pre><span>SHOW TABLE STATUS LIKE &#39;<span><i>tbl_name</i></span>&#39;;</span></pre>
			<pre><span>SHOW CREATE TABLE <span><i>tbl_name</i></span>;</span></pre>
			<p>請參見<a href="sql-syntax.html#show-table-status" title="13.5.4.18. SHOW TABLE STATUS Syntax">13.5.4.18節，「SHOW 
		TABLE STATUS語法</a>以及<a href="sql-syntax.html#show-create-table" title="13.5.4.5. SHOW CREATE TABLE Syntax">13.5.4.5節，「SHOW 
		CREATE TABLE語法」</a>。</p>
			<p>使用下述語句，可檢查<span>mysqld</span>伺服器支援的儲存引擎：</p>
			<pre><span>SHOW ENGINES;</span></pre>
			<p>也可以使用下述語句，檢查與您感興趣的儲存引擎有關的變數值：</p>
			<pre><span>SHOW VARIABLES LIKE &#39;have_%&#39;;</span></pre>
			<p>例如，要想確定<span><span>InnoDB</span>儲存引擎是否可用，可檢查<span>have_innodb</span></span>變數的值。</p>
			<p>請參見<a href="sql-syntax.html#show-engines" title="13.5.4.8. SHOW ENGINES Syntax">13.5.4.8節，「SHOW 
		ENGINES語法」</a>和<a href="sql-syntax.html#show-variables" title="13.5.4.21. SHOW VARIABLES Syntax">13.5.4.21節，「SHOW 
		VARIABLES語法」</a>。</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="deleting-from-related-tables"></a>
			A.5.6.&nbsp;從相關資料表刪除行</h3></div></div></div><a class="indexterm" name="id3080648"></a><a class="indexterm" name="id3080658"></a><a class="indexterm" name="id3080669"></a></div><div class="section"><div class="titlepage"><div><div>
			如果針對<span><span>related_table</span>的<span>DELETE</span>語句的總長度超過<span>1MB</span></span>（系統變數<span><span>max_allowed_packet</span>的預設值），應將其分為較小的部分，並執行多個<span>DELETE</span>語句。如果<span>related_column</span>是索引列，為每條語句指定<span>100</span>～<span>1000</span>個<span>related_column</span>值，或許能獲得更快的<span>DELETE</span>速度。如果<span>related_column</span></span>不是索引列，速度與<span>IN</span>子句中的參量數目無關。<h3 class="title"><a name="no-matching-rows"></a>
			A.5.7.&nbsp;解決與不匹配行有關的問題</h3></div></div></div><a class="indexterm" name="id3080735"></a><a class="indexterm" name="id3080742"></a>
			<p>如果有使用了很多資料表的複雜查詢，但未返回任何行，應採用下述步驟找出什麼出錯：</p>
			<p>用<span><span>EXPLAIN</span>測試查詢，以檢查</span>是否發現某事顯然出錯。請參見<a href="optimization.html#explain" title="7.2.1. EXPLAIN Syntax (Get Information About a SELECT)">7.2.1節，「EXPLAIN語法（獲取關於SELECT的訊息）<code class="literal"></code>」</a>。</p>
			<p>僅選擇在<span>WHERE</span>子句中使用的列。</p>
			<p>從查詢中<span>1</span>次刪除<span>1</span>個資料表，直至返回了某些行為止。如果資料表很大，較好的主意是在查詢中使用<span><span>LIMIT 
			10</span>。</span></p>
			<p>對於具有與上次從查詢中刪除的資料表匹配的行的列，發出<span><span>SELECT</span>查詢。</span></p>
			<p>如果將<span>FLOAT</span>或<span><span>DOUBLE</span>列與具有數值類型的數值進行比較，不能使用</span>等式<span>(<span>=</span>)</span>比較。在大多數計算機語言中，該問題很常見，這是因為，並非所有的浮點值均能以準確的精度保存。在某些情況下，將<span><span>FLOAT</span>更改為<span>DOUBLE</span>可更正該問題。</span>請參見<a href="problems.html#problems-with-float" title="A.5.8. Problems with Floating-Point Comparisons">A.5.8節，「與浮點比較有關的問題」</a>。</p>
			<p>如果仍不能找出問題之所在，請建立能與顯示問題的「<span>mysql 
			test &lt; query.sql</span>」一起運行的最小測試。通過使用<strong><span>mysqldump 
			--quick db_name </span></strong><span><b><i>
			<span>tbl_name_1</span></i></b></span><strong><span> 
			... </span></strong><span><b><i>
			<span>tbl_name_n</span></i></b></span><strong><span> 
			&gt; query.sql</span></strong>轉儲資料表，可建立測試檔案。在編輯器中打開檔案，刪除某些插入的行（如果有超出演示問題所需的行），並在檔案末尾新增<span>SELECT</span>語句。</p>
			<p>通過執行下述命令，驗證測試檔案能演示問題：</p>
			<pre><span>shell&gt; <span><b>mysqladmin create test2</b></span></span></pre>
			<pre><span>shell&gt; <span><b>mysql test2 &lt; query.sql</b></span></span></pre>
			<p>使用<strong><span>mysqlbug</span></strong>將測試檔案張貼到喲娜通用<span>MySQL</span>郵件列資料表。請參見<a href="introduction.html#mailing-list" title="1.7.1.1. The MySQL Mailing Lists">1.7.1.1節，「The MySQL郵件列資料表」</a>。</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="problems-with-float"></a>
			A.5.8.&nbsp;與浮點比較有關的問題</h3></div></div></div></div></div><div class="section"><div class="titlepage"><div><div>
		注意，下述部分主要與<span><span>DOUBLE</span>和<span>FLOAT</span>列相關，原因在於浮點數的不準確本質。</span><span>MySQL</span>使用<span>64</span>位十進制數值的精度執行<span><span>DECIMAL</span>操作，當處理<span>DECIMAL</span>列時，應能解決大多數常見的不準確問題。</span><p>
		浮點數有時會導致混淆，這是因為它們無法以準確值保存在計算機體系結構中。您在屏幕上所看到的值通常不是數值的準確值。對於<span>FLOAT</span>和<span><span>DOUBLE</span>列類型，情況就是如此。<span>DECIMAL</span>列能保存具有準確精度的值，這是因為它們是由字串資料表示的。</span></p>
		<p>在下面的示範中，介紹了使用<span><span>DOUBLE</span>時的問題：</span></p>
		<pre><span>mysql&gt; <span><b>CREATE TABLE t1 (i INT, d1 DOUBLE, d2 DOUBLE);</b></span></span></pre>
		<pre><span>mysql&gt; <span><b>INSERT INTO t1 VALUES (1, 101.40, 21.40), (1, -80.00, 0.00),</b></span></span></pre>
		<pre><span>&nbsp;&nbsp;&nbsp; -&gt; <span><b>(2, 0.00, 0.00), (2, -13.20, 0.00), (2, 59.60, 46.40),</b></span></span></pre>
		<pre><span>&nbsp;&nbsp;&nbsp; -&gt; <span><b>(2, 30.40, 30.40), (3, 37.00, 7.40), (3, -29.60, 0.00),</b></span></span></pre>
		<pre><span>&nbsp;&nbsp;&nbsp; -&gt; <span><b>(4, 60.00, 15.40), (4, -10.60, 0.00), (4, -34.00, 0.00),</b></span></span></pre>
		<pre><span>&nbsp;&nbsp;&nbsp; -&gt; <span><b>(5, 33.00, 0.00), (5, -25.80, 0.00), (5, 0.00, 7.20),</b></span></span></pre>
		<pre><span>&nbsp;&nbsp;&nbsp; -&gt; <span><b>(6, 0.00, 0.00), (6, -51.40, 0.00);</b></span></span></pre>
		<pre><span>&nbsp;</span></pre>
		<pre><span>mysql&gt; <span><b>SELECT i, SUM(d1) AS a, SUM(d2) AS b</b></span></span></pre>
		<pre><span>&nbsp;&nbsp;&nbsp; -&gt; <span><b>FROM t1 GROUP BY i HAVING a &lt;&gt; b;</b></span></span></pre>
		<pre><span>&nbsp;</span></pre>
		<pre><span>+------+-------+------+</span></pre>
		<pre><span>| i&nbsp;&nbsp;&nbsp; | a&nbsp;&nbsp;&nbsp;&nbsp; | b&nbsp;&nbsp;&nbsp; |</span></pre>
		<pre><span>+------+-------+------+</span></pre>
		<pre><span>| &nbsp;&nbsp;&nbsp;1 |&nbsp; 21.4 | 21.4 |</span></pre>
		<pre><span>|&nbsp;&nbsp;&nbsp; 2 |&nbsp; 76.8 | 76.8 |</span></pre>
		<pre><span>|&nbsp;&nbsp;&nbsp; 3 |&nbsp;&nbsp; 7.4 |&nbsp; 7.4 |</span></pre>
		<pre><span>|&nbsp;&nbsp;&nbsp; 4 |&nbsp; 15.4 | 15.4 |</span></pre>
		<pre><span>|&nbsp;&nbsp;&nbsp; 5 |&nbsp;&nbsp; 7.2 |&nbsp; 7.2 |</span></pre>
		<pre><span>|&nbsp;&nbsp;&nbsp; 6 | -51.4 |&nbsp;&nbsp;&nbsp; 0 |</span></pre>
		<pre><span>+------+-------+------+</span></pre>
		<p>結果是正確的。儘管前<span>5</span>個記錄看上去不應能進行比較測試（<span>a</span>和<span>b</span>的值看上去沒有什麼不同），但它們能進行比較，這是因為顯示的數值間的差異在十分位左右，具體情況取決於計算機的體系結構。</p>
		<p>如果列<span>d1</span>和<span><span>d2</span>定義為<span>DECIMAL</span>而不是<span>DOUBLE</span>，<span>SELECT</span>查詢的結果僅包含<span>1</span>行，即上面顯示的最後<span>1</span>行。</span></p>
		<h2 class="title"><a name="optimizer-issues"></a>
		A.6.&nbsp;與最佳化器有關的事宜</h2></div></div></div>
		<p><span>MySQL</span>採用了基於開銷的最佳化器，以確定處理查詢的最解方式。在很多情況下，<span>MySQL</span>能夠計算最佳的可能查詢計劃，但在某些情況下，<span>MySQL</span>沒有關於數據的足夠訊息，不得不就數據進行「有教養」的估測。</p>
		<p>當<span>MySQL</span>未能做「正確的」事時，可使用下述工具來幫助<span>MySQL</span>：</p>
		<p>使用<span><span>EXPLAIN</span>語句獲取關於</span><span>MySQL</span>如何處理查詢的訊息。要想使用它，可在<span>SELECT</span>語句前新增關鍵字<span><span>EXPLAIN</span>：</span></p>
		<pre><span>mysql&gt; <span><b>EXPLAIN SELECT * FROM t1, t2 WHERE t1.i = t2.i;</b></span></span></pre>
		<p><span>關於<span>EXPLAIN</span>的詳細討論，請參見</span><a href="optimization.html#explain" title="7.2.1. EXPLAIN Syntax (Get Information About a SELECT)">7.2.1節，「EXPLAIN語法（獲取關於SELECT的訊息）<code class="literal"></code>」</a>。</p>
		<p>使用<span>ANALYZE TABLE <i>
		tbl_name</i></span>，為已掃瞄的資料表更新鍵分配。請參見<a href="sql-syntax.html#analyze-table" title="13.5.2.1. ANALYZE TABLE Syntax">13.5.2.1節，「ANALYZE 
			TABLE語法」</a>。</p>
		<p>為已掃瞄的資料表使用<span>FORCE INDEX</span>，通知<span>MySQL</span>：與使用給定的索引相比，資料表掃瞄開銷昂貴。請參見<a href="sql-syntax.html#select" title="13.2.7. SELECT Syntax">13.2.7節，「SELECT語法」</a>。</p>
		<pre><span>SELECT * FROM t1, t2 FORCE INDEX (index_for_column)</span></pre>
		<pre><span>WHERE t1.col_name=t2.col_name;</span></pre>
		<p>
          <a class="indexterm" name="id3081908"></a>

          <span><span>USE INDEX</span>和<span>IGNORE 
		INDEX</span>也有一定的幫助。</span></p>
		<p>關於全局和資料表級別的<span>STRAIGHT_JOIN</span>。請參見<a href="sql-syntax.html#select" title="13.2.7. SELECT Syntax">13.2.7節，「SELECT語法」</a>。</p>
		<p>您可以調節全局或線程類系統變數。例如，用「<span><span>--max-seeks-for-key=1000<span>」</span></span>選項啟動</span><strong><span>mysqld</span></strong>，或使用<span><span>「SET 
		max_seeks_for_key=1000」</span>來通知最佳化器：假定任何資料表掃瞄均不會導致<span>1000</span>個以上的鍵搜索。</span>請參見<a href="database-administration.html#server-system-variables" title="5.3.3. Server System Variables">5.3.3節，「伺服器系統變數」</a>。</div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="table-definition-issues"></a>
		A.7.&nbsp;與資料表定義有關的事宜</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="problems.html#alter-table-problems">
			A.7.1. 與ALTER TABLE有關的問題</a></span></dt><dt><span class="section"><a href="problems.html#change-column-order">
			A.7.2. 如何更改資料表中的列順序</a></span></dt><dt><span class="section"><a href="problems.html#temporary-table-problems">A.7.3. 
			TEMPORARY TABLE問題</a></span></dt></dl></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="alter-table-problems"></a>
			A.7.1.&nbsp;與ALTER TABLE有關的問題</h3></div></div></div><a class="indexterm" name="id3081318"></a><a class="indexterm" name="id3081327"></a><a class="indexterm" name="id3081337"></a>
			<p><span>ALTER TABLE</span>將資料表更改為當前字元編碼。如果在執行<span><span>ALTER 
			TABLE</span>操作期間遇到</span>重複鍵錯誤，原因在於新的字元編碼將<span>2</span>個鍵映射到了相同值，或是資料表已損壞。在後一種情況下，應在資料表上運行<span><span>REPAIR 
			TABLE</span>。</span></p>
			<p>如果<span><span>ALTER TABLE</span>失敗並給出下述錯誤，問題可能是因為在<span>ALTER 
			TABLE</span>操作的早期階段出現</span><span>MySQL</span>崩潰，沒有名為<span>A-<i>xxx</i></span>或<span>B-<i>xxx</i></span>的舊資料表：</p>
			<pre><span>Error on rename of &#39;./database/name.frm&#39;</span></pre>
			<pre><span>to &#39;./database/B-<span><i>xxx</i></span>.frm&#39; (Errcode: 17)</span></pre>
			<p>在該情況下，進入<span>MySQL</span>數據目錄，並刪除其名稱為以<span><span>A-</span>或<span>B-</span>開始的所有檔案</span>（或許您希望將它們移動到其他地方而不是刪除它們）。</p>
			<p><span><span>ALTER TABLE</span>的工作方式如下：</span></p>
			<ul>
				<li>用請求的結構變化建立名為<span>A-<i>xxx</i></span>的新資料表。</li>
				<li>將所有行從原始資料表拷貝到<span>A-<i>xxx</i></span>。</li>
				<li>將原始資料表重命名為<span>B-<i>xxx</i></span>。</li>
				<li>將<span>A-<i>xxx</i></span>重命名為原始資料表的名稱。</li>
				<li>刪除<span>B-<i>xxx</i></span>。</li>
			</ul>
			<p>如果在重命名操作中出錯，<span>MySQL</span>將嘗試撤銷更改。如果錯誤很嚴重（儘管這不應出現），<span>MySQL</span>會將舊資料表保留為<span>B-<i>xxx</i></span>。簡單地在系統級別上重命名資料表檔案，應能使數據復原。</p>
			<p>如果在事務性資料表上使用<span><span>ALTER 
			TABLE</span>，或正在使用</span><span>Windows</span>或<span>OS/2</span>作業系統，如果已在資料表上執行了<span><span>LOCK 
			TABLE</span>操作，<span>ALTER TABLE</span>將對資料表執行解鎖操作。這是因為<span>InnoDB</span>和這類作業系統不能撤銷正在使用的資料表。</span></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="change-column-order"></a>
			A.7.2.&nbsp;如何更改資料表中的列順序</h3></div></div></div><a class="indexterm" name="id3081539"></a><a class="indexterm" name="id3081549"></a><a class="indexterm" name="id3081559"></a><a class="indexterm" name="id3081569"></a>
			<p>首先，請考慮是否的確需要更改資料表中的列順序。<span>SQL</span>的核心要點是從數據儲存格式獲取應用。總應指定檢索數據的順序。在下面的第<span>1</span>條語句中，以<span><i><span>col_name1</span></i></span>、<span><i><span>col_name2</span></i></span>、<span><i><span>col_name3</span></i></span>順序返回列；在第<span>2</span>條語句中，以<span><i><span>col_name1</span></i></span>、<span><i><span>col_name3</span></i></span>、<span><i><span>col_name2</span></i></span>順序返回列：</p>
			<pre><span>mysql&gt; <span><b>SELECT <i>col_name1</i>, <i>col_name2</i>, <i>col_name3</i> FROM <i>tbl_name</i>;</b></span></span></pre>
			<pre><span>mysql&gt; <span><b>SELECT <i>col_name1</i>, <i>col_name3</i>, <i>col_name2</i> FROM <i>tbl_name</i>;</b></span></span></pre>
			<p>如果決定更改資料表列的順序，可執行下述操作：</p>
			<ol>
				<li>用具有新順序的列建立新資料表。</li>
				<li>執行該語句：</li>
			</ol>
			<pre><span>mysql&gt; <span><b>INSERT INTO new_table</b></span></span></pre>
			<pre><span>&nbsp;&nbsp;&nbsp; -&gt; <span><b>SELECT columns-in-new-order FROM old_table;</b></span></span></pre>
			<ol start="3">
				<li>撤銷或重命名<span>old_table</span>。</li>
				<li>將新資料表重命名為原始名稱：</li>
			</ol>
			<pre><span>mysql&gt; <span><b>ALTER TABLE new_table RENAME old_table;</b></span></span></pre>
			<p><span>SELECT *</span>十分適合於測試查詢。但是，在應用程式中，永遠不要依賴<span><span>SELECT 
			*</span>的使用，不要依賴根據其位置檢索列。如果新增、移動或刪除了列，所返回的列的順序和位置不會保持相同。對資料表結構的簡單更改也會導致應用程式失敗。</span></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="temporary-table-problems"></a>A.7.3. TEMPORARY 
			TABLE問題</h3></div></div></div><a class="indexterm" name="id3081748"></a>
			<p>下面介紹了對使用<span>TEMPORARY</span>資料表的限制：</p>
			<ul>
				<li><span><span>TEMPORARY</span>資料表只能是<span>HEAP</span></span>、<span>ISAM</span>、<span>MyISAM</span>、<span>MERGE</span>、或<span>InnoDB</span>類型。</li>
				<li>在相同的查詢中，不能引用<span><span>TEMPORARY</span>資料表<span>1</span>次以上。例如，下例不能正常工作：</span></li>
			</ul>
			<pre><span>mysql&gt; <span><b>SELECT * FROM temp_table, temp_table AS t2;</b></span></span></pre>
			<pre>錯誤<span>1137</span>：不能再次打開資料表：<span>&#39;temp_table&#39;</span></pre>
			<ul>
				<li><span><span>SHOW TABLES</span>語句</span>不會列出<span>TEMPORARY</span>資料表。</li>
				<li>不能使用<span><span>RENAME</span>重命名<span>TEMPORARY</span>資料表。</span>但能使用<span>ALTER 
				TABLE</span>取而代之：</li>
			</ul>
			<pre><span>mysql&gt; <span><b>ALTER TABLE orig_name RENAME new_name;</b></span></span></pre>
		</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a name="bugs"></a>
		A.8.&nbsp;MySQL中的已知事宜</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="problems.html#open-bugs">
			A.8.1. MySQL中的打開事宜</a></span></dt></dl></div><a class="indexterm" name="id3081875"></a><a class="indexterm" name="id3081885"></a><a class="indexterm" name="id3081896"></a><a class="indexterm" name="id3081906"></a>
		<p>在本節中，列出了當前<span>MySQL</span>版本中的已知事宜。</p>
		<p>關於平台相關事宜的更多訊息，請參見<a href="installing.html#operating-system-specific-notes" title="2.12. Operating System-Specific Notes">2.12節，「具體作業系統相關的注意事項」</a>和<a href="porting.html">附錄E：</a><a href="porting.html" title="Appendix E. Porting to Other Systems"><i>移植到其他系統</i></a>中的安裝和移植說明。</p>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="open-bugs"></a>
			A.8.1.&nbsp;MySQL中的打開事宜</h3></div></div></div>
			<p>下面列出了已知問題，更正它們具有較高的優先級：</p>
			<ul>
				<li>如果將<span><span>NULL</span>值與</span>使用<span><span>ALL/ANY/SOME</span>的子查詢進行比較，而且子查詢返回</span>空的結果，比較操作會評估<span>NULL</span>的非標準結果而不是<span>TRUE</span>或<span>FALSE</span>。在<span>MySQL 
				5.1</span>中將更正該問題。</li>
				<li>對於<span>IN</span>的線子查詢最佳化不像「<span>=</span>」那樣有效。</li>
				<li>即使使用了<span>lower_case_table_names=2</span>（允許<span>MySQL</span>記住資料庫名和資料表名使用的大小寫），對於函數<span><span>DATABASE()</span>或在各種日誌內（在不區分大小寫的系統上），</span><span>MySQL</span>也不會記住資料庫名使用的大小寫情況。</li>
				<li>在複製操作中，撤銷<span><span>FOREIGN 
				KEY</span>約束不工作，這是因為約束可能在從伺服器上有另一個名稱。</span></li>
				<li><span><span>REPLACE</span>（以及具有<span>REPLACE</span>選項的<span>LOAD 
				DATA</span>）不會觸發<span>ON DELETE CASCADE</span></span>。</li>
				<li><span>如果未使用所有列而且僅使用<span>DISTINCT</span>列資料表中的列，在<span>GROUP_CONCAT()</span>中，<span>DISTINCT</span></span>不能與<span><span>ORDER 
				BY</span>一起工作。</span></li>
				<li>如果<span>1</span>位用戶擁有長時間運行的事務，而且另<span>1</span>位用戶撤銷了在事務中更新的某<span>1</span>資料表，那麼在資料表用於事務本身之前，存在較小的機會，會在二進制日誌中包含<span><span>DROP 
				TABLE</span>命令。我們計劃更正該問題，方法是讓<span>DROP TABLE</span>命令等待，直至資料表未在任何事務中使用為止。</span></li>
				<li>將大的整數值（介於<span>2<sup>63</sup></span>和<span>2<sup>64</sup></span>–<span>1</span>之間）插入數值或字串列時，它將作為負值插入，這是因為該數值是在有符號整數環境下評估的。</li>
				<li><span>如果伺服器運行在不具備二進制日誌功能的條件下，<span>FLUSH 
				TABLES WITH READ LOCK</span></span>不能屏蔽<span><span>COMMIT</span>，執行完整備份時這可能會導致問題（資料表間的一致性問題）。</span></li>
				<li><span>在某些情況下，作用在<span>BDB</span>資料表上的<span>ANALYZE 
				TABLE</span>會導致資料表不可用，直至重啟</span><strong><span>mysqld</span></strong>為止。如果出現該情況，請在<span>MySQL</span>錯誤檔案中搜尋下述形式的錯誤：</li>
			</ul>
			<pre><span>001207 22:07:56&nbsp; bdb:&nbsp; log_flush: LSN past current end-of-log</span></pre>
			<ul>
				<li>在所有事務完成之前，不要在<span>BDB</span>資料表（正在其上運行多語句事務）上執行<span><span>ALTER 
				TABLE</span>（可能會忽略事務）。</span></li>
				<li><span>對於正在使用<span>INSERT 
				DELAYED</span>的資料表，在其上執行<span>ANALYZE TABLE</span></span>、<span><span>OPTIMIZE 
				TABLE</span>和<span>REPAIR TABLE</span>時，可能會導致問題。</span></li>
				<li>在資料表上執行<span>LOCK 
				TABLE ...</span>和<span><span>FLUSH 
				TABLES ...</span>時，不保證沒有完成一半的事務。</span></li>
				<li><span><span>BDB</span>資料表</span>打開的速度相對較慢。如果您在資料庫上有很多<span><span>BDB</span>資料表，如果未使用<span>「-A」</span>選項或正使用再混編功能，要想在資料庫上使用<span>mysql</span>客戶端，需要花費較長的時間。當您有大的資料表高速緩衝時，這點尤其明顯。</span></li>
				<li>
				複製功能採用了查詢級日誌功能：主伺服器將已執行的查詢寫入二進制日誌。這是一種速度很快、簡潔和有效的記錄方法，在大多數情況下工作良好。</li>
			</ul>
			<p>
			如果以特定的方式設計查詢，使得數據更改是非決定性（通常不推薦，即使在複製之外也同樣），主伺服器和從伺服器上的數據將變得不同。</p>
			<p>例如：</p>
			<blockquote>
				<ul>
					<li>將0或NULL值插入AUTO_INCREMENT列中的CREATE ... SELECT或INSERT ... 
					SELECT語句。</li>
					<li>DELETE，如果從具有ON DELETE CASCADE屬性的外部鍵的資料表中刪除行。</li>
					<li>REPLACE ... SELECT、INSERT IGNORE ... 
					SELECT，如果在插入的數據中具有重複鍵。</li>
				</ul>
			</blockquote>
			<p><strong>
			<span>當且僅當前述查詢沒有保證決定行順序的</span></strong><span><b><span>ORDER 
			BY</span>子句時。</b></span></p>
			<p>例如，對於不具有<span><span>ORDER 
			BY</span>的<span>INSERT ... SELECT</span></span>，<span><span>SELECT</span>可能會以不同的順序返回行</span>（它會導致具有不同等級的行，從而導致<span><span>AUTO_INCREMENT</span>列中的不同數值），具體情況取決於最佳化器在主伺服器和從伺服器上所作的選擇。</span></p>
			<p>在主伺服器和從伺服器上，查詢將進行不同的最佳化，僅當：</p>
			<blockquote>
				<ul>
					<li>
					使用不同的儲存引擎在主伺服器上而不是從伺服器上保存資料表。（能夠在主伺服器和從伺服器上使用不同的儲存引擎。例如，如果從伺服器具有較少的可用磁盤空間，可以在主伺服器上使用<span><span>InnoDB</span>，但在</span> 
					從伺服器桑使用<span><span>MyISAM</span>）。</span></li>
					<li>在主伺服器和從伺服器上，<span>MySQL</span>緩衝區大小是不同的（<span>key_buffer_size</span>等）。</li>
					<li>在主伺服器和從伺服器上運行不同的<span>MySQL</span>版本，版本間的最佳化器代碼也不同。</li>
				</ul>
			</blockquote>
			<p>該問題也會影響使用<strong><span>mysqlbinlog|mysql</span></strong>的資料庫恢復。</p>
			<p>避免該問題的最簡單方法是，為前述的非決定性查詢增加<span>ORDER 
			BY</span>子句，以確保總是以相同的順序保存或更改行。</p>
			<p>在將來的<span>MySQL</span>版本中，需要時，我們將自動增加<span><span>ORDER 
			BY</span>子句。</span></p>
			<p>下面列出了已知的事宜，這些事宜將在恰當的時候更正：</p>
			<ul>
				<li>日誌檔案名基於伺服器主機名（如果未使用啟動選項指定檔案名的話）。如果更改了主機名，您將不得不使用諸如「<span>--log-bin=<i>old_host_name</i>-bin</span>」等選下美國。另一種選擇是重命名舊檔案，以反映主機名變更情況（如果是二進制日誌，需要編輯二進制日誌索引檔案，並更正<span>binlog</span>名稱）。請參見<a href="database-administration.html#server-options" title="5.3.1. mysqld Command-Line Options">5.3.1節，「<span><strong class="command">mysqld</strong></span>命令行選項」</a>。</li>
				<li><strong><span>Mysqlbinlog</span></strong>不刪除執行<span><span>LOAD 
				DATA INFILE</span>命令後遺留的臨時檔案</span>。請參見<a href="client-side-scripts.html#mysqlbinlog" title="8.6. mysqlbinlog — Utility for Processing Binary Log Files">8.6節，「mysqlbinlog：用於處理二進制日誌檔案的實用工具」</a>。</li>
				<li><span>RENAME</span>不能與<span><span>TEMPORARY</span>資料表一起工作，也不能與<span>MERGE</span>資料表中使用的資料表一起工作。</span></li>
				<li>由於資料表定義檔案的保存方式，不能在資料表名、列名或枚舉中使用字元<span>255</span>（<span>CHAR(255)</span>）。按照安排，當我們實施了新的資料表定義格式檔案時，將在<span>5.1</span>版中更正該問題。</li>
				<li>使用<span><span>SET 
				CHARACTER SET</span>時，不能在資料庫、資料表和列名中使用</span>轉換的字元。</li>
				<li>不能在<span><span>LIKE ... 
				ESCAPE</span>中與<span>ESCAPE</span>一起使用</span>『<span>_</span>』或『<span>%</span>』。</li>
				<li>如果您有<span>1</span>個<span><span>DECIMAL</span>列，其中，相同的數值以不同的格式保存（例如，<span>+01.00</span></span>、<span>1.00</span>、<span>01.00</span>），<span>GROUP 
				BY</span>可能會將每個值當作不同的值。</li>
				<li>使用<span>MIT-pthreads</span>時，不能在另一個目錄下建立伺服器。這是因為它需要更改<span>MIT-pthreads</span>，我們不太會更正該問題。請參見<span><a title="2.8.5.&nbsp;MIT-pthreads Notes"  href="../../../third/installing.html#mit-pthreads">2.8.5
				<span>「</span>MIT-pthreads<span>注意事項」</span></a></span>。</li>
				<li><span>在<span>GROUP BY</span></span>、<span>ORDER 
				BY</span>或<span><span>DISTINCT</span>中，不能可靠地使用<span>BLOB</span>和<span>TEXT</span>值。在這類情況下，與<span>BLOB</span>值進行比較時，僅使用最前的<span>max_sort_length</span></span>字節。<span><span>max_sort_length</span>的預設值是</span><span>1024</span>，可在伺服器啟動時或運行時更改它。</li>
				<li>數值計算是使用<span>BIGINT</span>或<span><span>DOUBLE</span>（正常情況下均為<span>64</span>位長）進行的。</span>您所能獲得的精度取決於函數。通用規則是位函數是按<span><span>BIGINT</span>精度執行的，<span>IF</span>和<span>ELT()</span>是按<span>BIGINT</span>或<span>DOUBLE</span>精度執行的，其餘的函數是按<span>DOUBLE</span>精度執行的。對於除位元外的其他數，如果大於<span>63</span>位（</span><span>9223372036854775807</span><span>），應避免使用</span>無符號長<span>long</span>值。</li>
				<li>在<span>1</span>個資料表中，最多能有<span>255</span>個<span><span>ENUM</span>和<span>SET</span>列。</span></li>
				<li>在<span>MIN()</span>、<span>MAX()</span>以及其他聚合函數中，<span>MySQL</span>目前會根據其字串值比較<span>ENUM</span>和<span><span>SET</span>列，而不是根據字串在集合中的相對位置。</span></li>
				<li><strong><span>mysqld_safe</span></strong>會將來自<strong><span>mysqld</span></strong>的所有消息再定向到<strong><span>mysqld</span></strong>日誌。與之相關的<span>1</span>個問題是，如果您執行<strong><span>mysqladmin 
				refresh</span></strong>關閉並再次打開日誌，<span>stdout</span>和<span><span>stderr</span>仍會被重定向到舊的日誌。</span>如果您以廣義方式使用「<span><span>--log」</span>，</span>應編輯<strong><span>mysqld_safe</span></strong>以記錄到<span><i><span>host_name</span></i><span>.err</span></span>而不是<span><i><span>host_name</span></i><span>.log</span></span>，以便通過刪除它並執行<strong><span>mysqladmin 
				refresh</span></strong>，方便地收回為舊日誌分配的空間。</li>
				<li>在<span><span>UPDATE</span>語句中，列從左向右更新。如果引用了已更新的列，您將得到更新值而不是原始值。例如，</span>下述語句會將<span><span>KEY</span>增加<span>2</span>，而不是<span>1</span>：</span></li>
			</ul>
			<pre><span>mysql&gt; <span><b>UPDATE <i>tbl_name</i> SET KEY=KEY+1,KEY=KEY+1;</b></span></span></pre>
			<ul>
				<li>您可以在相同查詢中引用多個臨時資料表，但不能引用任何給定的臨時資料表<span>1</span>次以上。例如，下述語句不能正常工作：</li>
			</ul>
			<pre><span>mysql&gt; <span><b>SELECT * FROM temp_table, temp_table AS t2;</b></span></span></pre>
			<pre>錯誤<span>1137</span>：不能再次打開資料表：<span>&#39;temp_table&#39;</span></pre>
			<ul>
				<li>當您在聯合操作中使用「隱含」列時，與未使用隱含列相比，最佳化器將以不同的方式處理<span>DISTINCT</span>。在聯合操作中，隱含列將作為結果的組成部份計數（即使未顯示），但在正常查詢中，隱含列不參與<span><span>DISTINCT</span>比較。在以後，我們可能會更改該情況，</span>在執行<span>DISTINCT</span>時不比較隱含列。</li>
			</ul>
			<p>例如：</p>
			<pre><span>SELECT DISTINCT mp3id FROM band_downloads</span></pre>
			<pre><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE userid = 9 ORDER BY id DESC;</span></pre>
			<p>以及</p>
			<pre><span>SELECT DISTINCT band_downloads.mp3id</span></pre>
			<pre><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FROM band_downloads,band_mp3</span></pre>
			<pre><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHERE band_downloads.userid = 9</span></pre>
			<pre><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AND band_mp3.id = band_downloads.mp3id</span></pre>
			<pre><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ORDER BY band_downloads.id DESC;</span></pre>
			<p>在第<span>2</span>種情況下，使用<span>MySQL</span>伺服器<span>3.23.x</span>，可在結果集中獲得<span>2</span>個等同行（這是因為，隱藏<span>ID</span>列中的值可能不同）。</p>
			<p>注意，在結果集中，僅對不含<span><span>ORDER 
			BY</span>列的查詢才會出現該情況。</span></p>
			<ul>
				<li>如果在返回空集的查詢上執行<span><span>PROCEDURE</span>，在某些情況下，<span>PROCEDURE</span>不轉換列。</span></li>
				<li>建立具有<span>MERGE</span>類型的資料表時，不檢查基本資料表是否具有兼容的類型。</li>
				<li>如果使用<span><span>ALTER 
				TABLE</span>為<span>MERGE</span>資料表中使用的資料表增加了<span>UNIQUE</span>索引，然後在<span>MERGE</span>資料表上增加了正常索引，如果在資料表中存在舊的、非<span>UNIQUE</span>鍵，對於這些資料表，鍵順序是不同的。這是因為，<span>ALTER 
				TABLE</span>會將<span>UNIQUE</span>索引放在</span>正常索引之前，以便能盡早檢測到重複的鍵。</li>
			</ul>
			<div class="itemizedlist">&nbsp;</div></div></div></div><div><hr>
	<p>這是MySQL參考手冊的翻譯版本，關於MySQL參考手冊，請訪問<a target="_top"  href="http://dev.mysql.com/doc/mysql/en">dev.mysql.com</a>。原始參考手冊為英文版，與英文版參考手冊相比，本翻譯版可能不是最新的。</div>
</body></html>
